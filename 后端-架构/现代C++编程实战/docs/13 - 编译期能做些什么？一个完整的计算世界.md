ä½ å¥½ï¼Œæˆ‘æ˜¯å´å’ç‚œã€‚

ä¸Šä¸€è®²æˆ‘ä»¬ç®€å•ä»‹ç»äº†æ¨¡æ¿çš„åŸºæœ¬ç”¨æ³•åŠå…¶åœ¨æ³›å‹ç¼–ç¨‹ä¸­çš„åº”ç”¨ã€‚è¿™ä¸€è®²æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ¨¡æ¿çš„å¦å¤–ä¸€ç§é‡è¦ç”¨é€”â€”â€”ç¼–è¯‘æœŸè®¡ç®—ï¼Œä¹Ÿç§°ä½œâ€œæ¨¡æ¿å…ƒç¼–ç¨‹â€ã€‚

## ç¼–è¯‘æœŸè®¡ç®—

é¦–å…ˆï¼Œæˆ‘ä»¬ç»™å‡ºä¸€ä¸ªå·²ç»è¢«è¯æ˜çš„ç»“è®ºï¼šC++ æ¨¡æ¿æ˜¯å›¾çµå®Œå…¨çš„ \[1]ã€‚è¿™å¥è¯çš„æ„æ€æ˜¯ï¼Œä½¿ç”¨ C++ æ¨¡æ¿ï¼Œä½ å¯ä»¥åœ¨ç¼–è¯‘æœŸé—´æ¨¡æ‹Ÿä¸€ä¸ªå®Œæ•´çš„å›¾çµæœºï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥å®Œæˆä»»ä½•çš„è®¡ç®—ä»»åŠ¡ã€‚

å½“ç„¶ï¼Œè¿™åªæ˜¯ç†è®ºä¸Šçš„ç»“è®ºã€‚ä»å®é™…çš„è§’åº¦ï¼Œæˆ‘ä»¬å¹¶ä¸**æƒ³**ã€ä¹Ÿä¸å¯èƒ½åœ¨ç¼–è¯‘æœŸå®Œæˆæ‰€æœ‰çš„è®¡ç®—ï¼Œæ›´ä¸ç”¨è¯´ç¼–è¯‘æœŸçš„ç¼–ç¨‹æ˜¯å¾ˆå®¹æ˜“è®©äººçœ‹ä¸æ‡‚çš„â€”â€”å› ä¸ºè¿™å¹¶ä¸æ˜¯è¯­è¨€è®¾è®¡çš„åˆè¡·ã€‚å³ä¾¿å¦‚æ­¤ï¼Œæˆ‘ä»¬ä¹Ÿè¿˜æ˜¯éœ€è¦äº†è§£ä¸€ä¸‹æ¨¡æ¿å…ƒç¼–ç¨‹çš„åŸºæœ¬æ¦‚å¿µï¼šå®ƒä»ç„¶æœ‰ä¸€äº›å®ç”¨çš„åœºæ™¯ï¼Œå¹¶ä¸”åœ¨å®é™…çš„å·¥ç¨‹ä¸­ä½ ä¹Ÿå¯èƒ½ä¼šé‡åˆ°è¿™æ ·çš„ä»£ç ã€‚è™½ç„¶æˆ‘ä»¬åœ¨å¼€ç¯‡å°±è¯´è¿‡ä¸è¦ç‚«æŠ€ï¼Œä½†ä½¿ç”¨æ¨¡æ¿å…ƒç¼–ç¨‹å†™å‡ºçš„ä»£ç ä»ç„¶æ˜¯å¯ç†è§£çš„ï¼Œå°¤å…¶æ˜¯å¦‚æœä½ å¯¹é€’å½’ä¸å‘æ€µçš„è¯ã€‚

å¥½ï¼Œé—²è¯å°‘å™ï¼Œæˆ‘ä»¬ä»ç„¶æ‹¿ä»£ç è¯´è¯ï¼š

```c++
template <int n>
struct factorial {
  static const int value =
    n * factorial<n - 1>::value;
};

template <>
struct factorial<0> {
  static const int value = 1;
};
```
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ29ï¼‰</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/16/8c/df/77acb793.jpg" width="30px"><span>ç¦¾æ¡ƒ</span> ğŸ‘ï¼ˆ22ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>è„‘å£³å„¿ç–¼çš„å…„å¼Ÿå§å¦¹ä»¬ï¼Œæˆ‘è¿™æœ‰ä¸ªå°åæ–¹ï¼Œ å“ˆå“ˆ

While&lt; Sum&lt;2&gt;::type &gt;::type::value å®ä¾‹åŒ–(instantiation)è¿‡ç¨‹
--&gt; While&lt; SumLoop&lt;0, 2&gt; &gt;::type::value
--&gt; WhileLoop&lt;SumLoop&lt;0, 2&gt;::cond_value, SumLoop&lt;0, 2&gt;&gt;::type::value
--&gt; WhileLoop&lt;true, SumLoop&lt;0, 2&gt;&gt;::type::value

--&gt; WhileLoop&lt;SumLoop&lt;0, 2&gt;::cond_value, SumLoop&lt;0, 2&gt;::next_type&gt;::type::value
--&gt; WhileLoop&lt;true, SumLoop&lt;2, 1&gt;&gt;::type::value

--&gt; WhileLoop&lt;SumLoop&lt;2, 1&gt;::cond_value, SumLoop&lt;2, 1&gt;::next_type&gt;::type::value
--&gt; WhileLoop&lt;true, SumLoop&lt;3, 0&gt;&gt;::type::value

--&gt; WhileLoop&lt;SumLoop&lt;3, 0&gt;::cond_value, SumLoop&lt;3, 0&gt;::next_type&gt;::type::value
--&gt; WhileLoop&lt;false, SumLoop&lt;3, -1&gt;&gt;::type::value

--&gt; SumLoop&lt;3, -1&gt;::res_type::value

--&gt;integral_constant&lt;int, 3&gt;::value
--&gt;3</div>2019-12-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/bc/96/c679bb3d.jpg" width="30px"><span>æ€»ç»Ÿè€å”</span> ğŸ‘ï¼ˆ10ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è®°å¾—å´è€å¸ˆä¹‹å‰é¢„å‘Šè¿‡ï¼Œè¿™ä¸€èŠ‚å¯èƒ½ä¼šæ¯”è¾ƒéš¾ï¼Œç¡®å®è¢«éš¾ä½äº†ã€‚åœ¨ç¬¬ä¸€ä¸ª If æ¨¡æ¿è¿™é‡Œå°±è¢«å¡ä½äº†ï¼Œè€å¸ˆèƒ½ç»™ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜è¿™ä¸ª If æ¨¡æ¿è¯¥å¦‚ä½•ä½¿ç”¨ä¹ˆï¼Ÿ</div>2019-12-25</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/2ibrq71Y5Ww3KDRibDxF1gt9YDEPuZkv4ITHEP1u4vvjpPDukkLoK4ngQy1hKKzccnsicLkUAda7sPpibR6Kyb0cfQ/132" width="30px"><span>chang</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æ¯”å¦‚ï¼Œå¦‚æœæˆ‘ä»¬å¯¹ const string&amp; åº”ç”¨ remove_constï¼Œå°±ä¼šå¾—åˆ° string&amp;ï¼Œå³ï¼Œremove_const::type ç­‰ä»·äº string&amp;ã€‚

remove_conståªèƒ½å»é¡¶å±‚constã€‚const string&amp;åº”ç”¨remove_conståè¿˜æ˜¯const string&amp;ï¼Œconst stringåº”ç”¨remove_conståæ˜¯stringã€‚</div>2021-06-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/cf/db/9693d08f.jpg" width="30px"><span>YouCompleteMe</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>template &lt;typename Body&gt;
struct whileLoop&lt;true, Body&gt;
éƒ¨åˆ†ä¼¼ä¹æ”¹æˆä¸‹é¢è¿™æ ·ï¼Œæ›´ç›´è§‚ï¼Œ
ç¼–è¯‘æ—¶è®¡ç®—æ›´å°‘å‘¢

template &lt;typename Body&gt;
struct whileLoop&lt;true, Body&gt; {
    typedef typename whileLoop&lt;
      Body::next_type::cond_value, 
      typename Body::next_type&gt;::type 
      type;
};</div>2020-01-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/21/2d/0b/e6836053.jpg" width="30px"><span>è«è¨€</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>template &lt;  template &lt;typename, typename&gt;  class OutContainer = vector,  typename F, class R&gt;
è¯·é—®è€å¸ˆï¼Œè¿™ä¸ªOutConContainerå‰é¢çš„template&lt;typename,typename&gt;åº”è¯¥æ€ä¹ˆç†è§£</div>2021-12-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/30/db/86/51ec4c41.jpg" width="30px"><span>æäº‘é¾™</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>åˆ†äº«ä¸€ä¸‹æˆ‘çš„ä»£ç ï¼šå®ç°æ±‚æœ€å¤§å…¬çº¦æ•°çš„è¾—è½¬ç›¸é™¤æ³•
template &lt;bool Cond, typename Body&gt;
struct WhileLoop;

template &lt;typename Body&gt;
struct WhileLoop&lt;true, Body&gt;
{
    typedef typename WhileLoop&lt;Body::Cond, typename Body::NextType&gt;::type type;
};

template &lt;typename Body&gt;
struct WhileLoop&lt;false, Body&gt;
{
    typedef typename Body::ResType type;
};

template &lt;typename Body&gt;
struct While
{
    typedef typename WhileLoop&lt;Body::Cond, Body&gt;::type type;
};

template &lt;typename T, T val&gt;
struct integer
{
    typedef T ValueType;
    static const T Value = val;
    typedef integer type;
};

template &lt;int lhs, int rhs&gt;
struct GCD
{
    static const bool Cond = lhs % rhs != 0;
    static const int result = lhs;
    typedef integer&lt;int, result&gt; ResType;
    typedef GCD&lt;rhs, lhs % rhs&gt; NextType;
};

int main()
{
    cout &lt;&lt; While&lt;GCD&lt;100, 56&gt;&gt;::type::Value &lt;&lt; endl;
    return 0;
}</div>2023-10-14</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Wjsc175urqxxBcCsxSDG5iaWcEq4hIg4SCCVJCIC108Ul5l7US4iaE3iaaMWodSJeybGemicEnfetHFCj9P6QI17xw/132" width="30px"><span>Geek_15f2c9</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆï¼Œå¯¹ä¸‡èƒ½å¼•ç”¨ä½¿ç”¨å®Œç¾è½¬å‘æ˜¯å¦å¥½ç‚¹ï¼Œresult.push_back(std::forward&lt;decltype(f(item))&gt;(f(item)))æˆ–result.emplace_back(std::forward&lt;decltype(f(item))&gt;(f(item)));;</div>2021-04-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1f/47/12/0186b64e.jpg" width="30px"><span>Gazelle</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æˆ‘å®è·µå†™äº†ä¸‹remove_constï¼Œå¥½åƒæ²¡æœ‰æŠŠconstå»æ‰ã€‚è¿™é‡Œæ˜¯ä¸æ˜¯æœ‰ç‚¹é—®é¢˜å‘¢ï¼Ÿ
https:&#47;&#47;stackoverflow.com&#47;questions&#47;15887144&#47;stdremove-const-with-const-references
æˆ‘çœ‹è¿™é‡Œè¯´æ˜¯å¦‚æœåŒæ—¶æœ‰constå’Œå¼•ç”¨çš„è¯ï¼Œè¿˜éœ€è¦å»æ‰å¼•ç”¨ï¼Ÿ
std::remove_const&lt;std::remove_reference&lt;const string&amp;&gt;::type&gt;::type</div>2020-11-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/76/53/21d62a23.jpg" width="30px"><span>é²Â·æœ¬</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>å¯¹While&lt;Sum&lt;10&gt;::type&gt;::type::valueè¿›è¡Œæ‰‹åŠ¨æ¨å¯¼ï¼Œæœ€ç»ˆæ˜¯èƒ½æ¨å¯¼å‡ºå®é™…è¯­å¥æ˜¯ integral_constant&lt;intï¼Œ10+9+...1&gt;::valueçš„ï¼Œä½†è®©æˆ‘ç‹¬ç«‹å†™å‡º å®Œæ•´çš„ä»£ç æ˜¯ä¸‡ä¸‡ä¸èƒ½çš„ğŸ˜„</div>2020-10-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1e/9a/ee/f996f864.jpg" width="30px"><span>åƒé±¼</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>â€œå¦‚æœè¦å¾—åˆ°å¸ƒå°”å€¼çš„è¯ï¼Œå½“ç„¶ä½¿ç”¨ `is_trivially_destructible::value` å°±å¯ä»¥ï¼Œä½†æ­¤å¤„ä¸éœ€è¦ã€‚éœ€è¦çš„æ˜¯ï¼Œä½¿ç”¨ `()` è°ƒç”¨è¯¥ç±»å‹çš„æ„é€ å‡½æ•°ï¼Œè®©ç¼–è¯‘å™¨æ ¹æ®æ•°å€¼ç±»å‹æ¥é€‰æ‹©åˆé€‚çš„é‡è½½ã€‚è¿™æ ·ï¼Œåœ¨ä¼˜åŒ–ç¼–è¯‘çš„æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨å¯ä»¥æŠŠä¸éœ€è¦çš„ææ„æ“ä½œå½»åº•å…¨éƒ¨åˆ é™¤ã€‚â€
è€å¸ˆï¼Œè¿™é‡Œæ²¡å¤ªæ‡‚ï¼Œä½¿ç”¨ `()` è°ƒç”¨è¯¥ç±»å‹çš„æ„é€ ï¼Œè¿™é‡Œçš„è°ƒç”¨æ˜¯åœ¨å“ªé‡Œè°ƒç”¨ï¼Œä¸ºä»€ä¹ˆ destroy è¦è°ƒç”¨æ„é€ å‡½æ•°</div>2020-06-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1a/e4/ec/88ccd50b.jpg" width="30px"><span>åƒä¸€ä¸ªèŠ’æœ</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>template &lt;int num1, int num2&gt;
struct Add_
{
    const static int res = num1 + num2;
};

template &lt;int num1, int num2&gt;
struct Sub_
{
    const static int res = num1 - num2;
};

template &lt;bool Condition&gt;
struct If_;

template &lt;&gt;
struct If_ &lt;true&gt;
{
    template&lt;int num1, int num2&gt;
    using type = Add_&lt;num1, num2&gt;;
};

template &lt;&gt;
struct If_ &lt;false&gt;
{
    template&lt;int num1, int num2&gt;
    using type = Sub_&lt;num1, num2&gt;;
};

template&lt;int num1, int num2&gt;
template&lt;bool Condition&gt;
using If = typename If_&lt;Condition&gt;::template type&lt;num1, num2&gt;;

template&lt;int num1, int num2&gt;
using True = If&lt;true&gt;;

template&lt;int num1, int num2&gt;
using False = If&lt;false&gt;;

è€å¸ˆä½ å¥½ï¼Œæˆ‘æƒ³é—®ä¸€ä¸ªè¯­æ³•æ–¹é¢å¯èƒ½æ¯”è¾ƒé’»ç‰›è§’å°–çš„é—®é¢˜
æˆ‘å®šä¹‰äº†If_,ç”¨æ¥åœ¨trueå’Œfalseçš„æ—¶å€™è¿”å›ä¸åŒçš„æ¨¡æ¿ã€‚åˆå®šä¹‰äº†Trueå’ŒFalseï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡True&lt;a, b&gt;::resæˆ–è€…False&lt;a, b&gt;::resæ¥è·å–ä¸åŒæ¨¡æ¿çš„è®¡ç®—ç»“æœã€‚ä½†æ˜¯å¦‚æœæˆ‘æƒ³ç”¨ç±»ä¼¼If&lt;condition&gt;&lt;a, b&gt;::resè¿™æ ·çš„è°ƒç”¨ï¼ˆä¸çŸ¥é“æˆ‘è¡¨è¾¾æ¸…æ¥šæ²¡æœ‰ï¼‰æ¥è·å–ä¸åŒçš„ç»“æœï¼ˆåœ¨ä¸æ”¹If_å®šä¹‰çš„æƒ…å†µä¸‹ï¼‰ï¼Œåº”è¯¥æ€ä¹ˆå†™å‘¢ï¼Ÿè°¢è°¢ï¼</div>2020-01-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/bc/96/c679bb3d.jpg" width="30px"><span>æ€»ç»Ÿè€å”</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>å´è€å¸ˆï¼Œå…³äºæœ€åè¿™ä¸ªä¾‹å­ï¼Œæœ‰ä¸¤ä¸ªå°é—®é¢˜ï¼š
1ï¼Œæˆ‘ä»¬å¹³æ—¶å®šä¹‰ä¸€ä¸ª vector çš„æ—¶å€™ï¼Œä¸€èˆ¬å¹¶ä¸ä¼šå†™æˆ vector&lt;int, allocator&lt;int&gt;&gt; vec è¿™ç§å½¢å¼ï¼Œä¸ºä»€ä¹ˆæ¨¡æ¿å‡½æ•°é‡Œé¢å®šä¹‰è¿”å›å€¼ result æ—¶ï¼Œéœ€è¦å¤šä¸€ä¸ª allocatorï¼Ÿ
2ï¼Œfmapå‡½æ•°çš„å…¥å‚å’Œforå¾ªç¯ï¼Œå…¨éƒ½ç”¨çš„å³å€¼å¼•ç”¨ï¼Œæœ‰ä»€ä¹ˆç‰¹æ®Šè€ƒé‡ä¹ˆï¼Ÿ</div>2019-12-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1e/b3/32/0ee78a1a.jpg" width="30px"><span>é™ˆç‹„</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ç¼–è¯‘æœŸç¼–ç¨‹ç¡®å®6ï¼Œæ¨¡ç‰ˆå†™å¾ªç¯ç¡®å®ç»•ï¼Œå±•å¼€å¦‚ä¸‹ï¼š
While&lt;Sum&lt;10&gt;::type&gt;::type::value
While&lt;SumLoop&lt;0, 10&gt;&gt;::type::value
WhileLoop&lt;SumLoop&lt;0, 10&gt;::cond_value, SumLoop&lt;0, 10&gt;&gt;::type::value
WhileLoop&lt;true, SumLoop&lt;0, 10&gt;&gt;::type::value
WhileLoop&lt;SumLoop&lt;0, 10&gt;::cond_value, SumLoop&lt;0, 10&gt;::next_type&gt;::type::value
WhileLoop&lt;true, SumLoop&lt;10, 9&gt;&gt;::type::value
WhileLoop&lt;SumLoop&lt;10, 9&gt;&gt;::cond_value,SumLoop&lt;10, 9&gt;&gt;::next_type&gt;::type::value
...
WhileLoop&lt;SumLoop&lt;55, 0&gt;&gt;::cond_value,SumLoop&lt;55, 0&gt;&gt;::next_type&gt;::type::value
WhileLoop&lt;false,SumLoop&lt;55, -1&gt;&gt;::type::value
SumLoop&lt;55, -1&gt;::res_type::value
integral_constant&lt;int, 55&gt;::value</div>2022-04-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/75/54/73cc7f73.jpg" width="30px"><span>ç‹æ—§ä¸š</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>While&lt;Sum&lt;10&gt;::type&gt;::type::valueçš„ä¾‹å­ä¸­ä¼šä½¿ç”¨åˆ°äº†è‡ªå·±integral_constantæ¨¡æ¿ï¼Œä½†æ˜¯stlä¸­ä¹Ÿæœ‰ä¸€ä»½integral_constantï¼Œæ‰€ä»¥è¿è¡Œæœ¬ç¤ºä¾‹ä»£ç æ—¶å¦‚æœä¸€å¼€å§‹ç›´æ¥ using namespace stdä¼šç¼–è¯‘æŠ¥é”™</div>2021-02-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/9b/ee/211e86cd.jpg" width="30px"><span>talor</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è„‘å­çƒ§åäº†</div>2020-08-07</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqf54z1ZmqQY1kmJ6t1HAnrqMM3j6WKf0oDeVLhtnA2ZUKY6AX9MK6RjvcO8SiczXy3uU0IzBQ3tpw/132" width="30px"><span>Geek_68d3d2</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>typedef SumLoop&lt;0, n&gt; type;è¿™ä¸ªè¯­æ³•ä¸æ˜¯ç»™ç±»å‹å®šä¹‰åˆ«åå— æ€ä¹ˆä»£ç é‡Œå˜æˆäº†å˜é‡å®šä¹‰???</div>2020-08-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/91/00/2007d2f3.jpg" width="30px"><span>zhengfan</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è¿™ä¸€è¯¾çœ‹çš„è„‘æµ†éƒ½æ²¸è…¾äº†â€¦â€¦
å´è€å¸ˆï¼Œæ‚¨å¥½ã€‚æœ‰å¦‚ä¸‹å‡ ä¸ªé—®é¢˜è¯·æ•™ä¸€ä¸‹ï¼š
åœ¨SumLoopä¸­å®šä¹‰çš„res_valueçš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨
typedef integral_constant&lt;int, result&gt; res_type è€Œæ˜¯
typedef integral_constant&lt;int, res_value&gt; res_typeå‘¢ï¼Ÿå‰è€…ç¼–è¯‘æ‰§è¡Œéƒ½æ²¡æœ‰é—®é¢˜çš„ã€‚
åœ¨integral_constantå®šä¹‰typedef integral_constant typeç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ
å¦å¤–æˆ‘å°è¯•ç¨å¾®æ”¹åŠ¨äº†ä¸€ä¸‹æ–‡ä¸­ä¾‹å­å¦‚ä¸‹ï¼š
template &lt;class T, T v&gt;
struct type_constant {
  static const T value = v;
  typedef T value_type;
  typedef type_constant type;
};

template &lt;typename T, T result, T n&gt;
struct SumLoop {
  static const bool cond_value = (n &gt; (T)0);
  &#47;&#47; static const int res_value = result;
  typedef type_constant&lt;T, result&gt; res_type;
  typedef SumLoop&lt;T, result + n, n - (T)1&gt; next_type;
};

template &lt;typename T, T n&gt;
struct Sum {
  typedef SumLoop&lt;T, (T)0, n&gt; type;
};
ç»“æœå‘ç°åªèƒ½å¤Ÿæ”¯æŒèŒƒæ•´å‹ç±»å‹å¦‚int,size_t,ulongç­‰ç­‰ï¼š
While&lt;Sum&lt;size_t, 10&gt;::type&gt;::type::valueç¼–è¯‘æ‰§è¡Œå·¥ä½œæ­£å¸¸ï¼›ä½†å¯¹äºæµ®ç‚¹å‹å¦‚ï¼š
While&lt;Sum&lt;float, 10.0)&gt;::type&gt;::type::valueç¼–è¯‘æŠ¥é”™ï¼š
error: â€˜floatâ€™ is not a valid type for a template non-type parameter
è¯·é—®è¿™æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ</div>2020-07-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/5f/e5/54325854.jpg" width="30px"><span>èŒƒé—²</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æœ€è¿‘åœ¨çœ‹STlæºç åˆ†æã€‚
1.ä¸€ç›´å†æƒ³allocatorç±»ä¸ºä»€ä¹ˆè¦å­˜åœ¨ï¼Ÿ
   ä¸ºä¸åŒçš„å®¹å™¨ç±»å‹æä¾›äº†å†…å­˜èµ„æºç®¡ç†ç±»ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒç”¨æˆ·è‡ªå®šä¹‰ï¼Œæ›´æ–¹ä¾¿å’Œçµæ´»ã€‚å®é™…ä¸Šå¯¹äºå®¹å™¨è€Œè¨€å†…éƒ¨çš„èµ„æºéƒ½æ˜¯åˆ†å¸ƒåœ¨å¯¹ä¸Šçš„ï¼Œæ ˆä¸Šçš„åªä¸è¿‡æ˜¯ä¸ªç¬¦å·ã€‚
2.ä¸ºä»€ä¹ˆè¦æœ‰type_traitsï¼Ÿ
   iteratoræ˜¯å¯¹å®¹å™¨ç±»çš„ä¸€ç§åº•å±‚æŠ½è±¡.type_traitså®é™…ä¸Šä¹Ÿæ˜¯è¿™æ ·çš„æŠ½è±¡ï¼Œåªä¸è¿‡æ›´æŠ½è±¡ã€‚
</div>2020-03-31</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/4f/f3/05f5c779.jpg" width="30px"><span>oozero</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆå¯ä»¥å°†æ–‡ä¸­ç¤ºä¾‹ä»£ç ç‰‡æ®µæ•´ç†æˆæ–‡ä»¶ï¼Œåˆ†äº«åˆ°GitHubï¼Œè®©c++åŸºç¡€ä¸æ‰å®çš„åŒå­¦å¯ä»¥æ›´ç›´è§‚çš„å­¦ä¹ å—ï¼Ÿ</div>2020-02-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/21/4d/90ea92f8.jpg" width="30px"><span>å…‰åŸ~å…´</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>åœ¨æ–‡ä¸­æåˆ°è¿™ä¹ˆä¸€å¥è¯ï¼šâ€œå®é™…ä¸Šï¼Œåˆ°ç°åœ¨ä¸ºæ­¢ï¼Œæˆ‘ä»¬è®²çš„ä¸œè¥¿è¿˜æ²¡æœ‰ç¦»å¼€ C++98ã€‚è€Œæˆ‘ä»¬ä¸‹é¢å‡ è®²é‡Œå¾ˆå¿«å°±ä¼šè®²åˆ°ï¼Œå¦‚ä½•åœ¨ç°ä»£ C++ é‡Œä¸ä½¿ç”¨è¿™ç§éº»çƒ¦çš„æ–¹å¼ä¹Ÿèƒ½è¾¾åˆ°åŒæ ·çš„æ•ˆæœã€‚â€
æƒ³é—®ä¸€ä¸‹å¦‚æœç”¨ç°ä»£C++å®ç°ä¸Šè¿°çš„IFæˆ–è€…WhileLoopï¼Œç©¶ç«Ÿè·Ÿä¸Šè¿°çš„æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚</div>2020-01-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/c9/e3/28c16afa.jpg" width="30px"><span>ä¸‰å‘³</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è¿™ä¸ªè¯¾åæ€è€ƒé¢˜çœŸä¸æ˜¯ç›–å¾—ã€‚ã€‚ã€‚è¿˜çœ‹åˆ°äº†5åˆ†é’Ÿç¼–è¯‘æœŸå †æ’åºçš„æ®µå­ã€‚ã€‚ã€‚çœ‹å¾—æˆ‘å¿ƒæƒŠèƒ†æˆ˜ã€‚ã€‚ã€‚
ä¸è¿‡è¿˜æ˜¯ä¸€å †ç™¾åº¦å†™å‡ºäº†ä¸€ä¸ªï¼Œé’ˆå¯¹intå‹ï¼Œå†™å‡ºä»[0, N)çš„ç¼–è¯‘æœŸç”Ÿæˆæ•°ç»„çš„ä¾‹å­ã€‚ã€‚ã€‚å…¼å®¹å…¶ä»–ç±»å‹è¿˜è¦å†é¢å¤–å†™å¥½å¤šä»£ç ã€‚ã€‚å·æ‡’ç›´æ¥å†™äº†intå‹ã€‚ã€‚ã€‚
æˆ‘åœ¨msvcä¸‹æµ‹è¯•äº†ï¼Œåº”è¯¥æ²¡é—®é¢˜ã€‚ã€‚ã€‚ç”¨åˆ°äº†æ¨¡æ¿ä¸å®šå‚æ•°ï¼Œå…¶ä»–ä¸çŸ¥é“ä»€ä¹ˆæŠ€å·§çš„æ–¹æ³•ã€‚ã€‚ã€‚
æƒ³è¦è®©int Nè½¬æ¢æˆä»0ï¼Œ1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5 ã€‚ã€‚ã€‚å¡åœ¨äº†å¦‚ä½•æŠŠè¿™å †å‚æ•°å±•å¼€ã€‚ã€‚å†™å¾—å¯èƒ½å¤æ‚ä¸€äº›ã€‚ã€‚ä¸çŸ¥é“æ€ä¹ˆæ›´ç®€å•ã€‚ã€‚ ä¸‹é¢ä»£ç å§ï¼š

template&lt;int... values&gt;
struct IntegerSequence {};

template&lt;typename T, T v, typename INTEGER_SEQUENCE&gt;
struct PushBack;

template&lt;int v, int... values&gt;
struct PushBack&lt;int, v, IntegerSequence&lt;values...&gt;&gt; {
	using type = IntegerSequence&lt;values..., v&gt;;
};

template&lt;int N&gt;
struct IntegerRange {
	using type = typename PushBack&lt;int, N-1, typename IntegerRange&lt;N-1&gt;::type&gt;::type;
};

template&lt;&gt;
struct IntegerRange&lt;1&gt; {
	using type = IntegerSequence&lt;0&gt;;
};

template&lt;int N, typename INTEGER_SEQUENCE&gt;
struct RangeArray;

template&lt;int N, int... values&gt;
struct RangeArray&lt;N, IntegerSequence&lt;values...&gt;&gt; {
	static constexpr std::array&lt;int, N&gt; value = {values...};
};

template&lt;int N&gt; using Range = RangeArray&lt;N, typename IntegerRange&lt;N&gt;::type&gt;;

æµ‹è¯•ï¼š
auto A = Range&lt;5&gt;::value; 
ä¸å‡ºæ„å¤–ï¼Œä¼šç”Ÿæˆstd::array&lt;int, 5&gt;{0,1,2,3,4};</div>2019-12-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/bc/96/c679bb3d.jpg" width="30px"><span>æ€»ç»Ÿè€å”</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ5ï¼‰<div>å´è€å¸ˆï¼Œçœ‹äº†ä½ çš„Whileæ¨¡æ¿ï¼Œè¯•ç€æƒ³æŠŠè¿™ä¸ªè®¡ç®—ç´¯åŠ çš„åŠŸèƒ½æ‰©å±•ä¸€ä¸‹ï¼Œè¾“å…¥ä»»æ„ä¸¤ä¸ªæ•°ï¼Œå¯ä»¥æ±‚ä»–ä»¬ä¹‹é—´çš„æ•°çš„ç´¯åŠ å’Œï¼Œä»£ç å¦‚ä¸‹ï¼š
template &lt;int from, int to, int sum&gt;
struct SumAnyTwo_A
{
    static const bool cond_value = from != to;
    static const int res_value = sum;
    typedef integral_constant&lt;int, res_value&gt; res_type;
    typedef SumAnyTwo_A&lt;from + 1, to, sum + from&gt; next_type;
};

template &lt;int from, int to, int sum&gt;
struct SumAnyTwo_B
{
    static const bool cond_value = from != to;
    static const int res_value = sum;
    typedef integral_constant&lt;int, res_value&gt; res_type;
    typedef SumAnyTwo_B&lt;from - 1, to, sum + from&gt; next_type;
};

template &lt;bool valueCompare, int from, int to&gt;
struct SumAnyTwo;

template &lt;int from, int to&gt;
struct SumAnyTwo&lt;true, from, to&gt;
{
    typedef SumAnyTwo_A&lt;from, to, 0&gt; addType;
};

template &lt;int from, int to&gt;
struct SumAnyTwo&lt;false, from, to&gt;
{
    typedef SumAnyTwo_B&lt;from, to, 0&gt; addType;
};

template &lt;int from, int to&gt;
struct SumTwo
{
    typedef SumAnyTwo&lt;(from &gt; to), from, to&gt; type;
};

é‡åˆ°äº†ä¸¤ä¸ªé—®é¢˜ï¼š
1ï¼Œè¿™æ®µä»£ç çœ‹èµ·æ¥ä¸å¤Ÿä¼˜é›…ï¼Œåœ¨C++ 98 çš„èŒƒç•´å†…ï¼Œæœ‰æ›´å¥½çš„æ¨¡æ¿å…ƒç¼–ç¨‹å®ç°æ–¹å¼ä¹ˆï¼Ÿ
2ï¼Œå½“æˆ‘è¯•å›¾è°ƒç”¨è¿™ä¸ªWhileæ¨¡æ¿æ—¶ï¼Œå‡ºç°å¦‚ä¸‹çŠ¶å†µï¼Œä¸æ˜ç™½ä¸ºä»€ä¹ˆç¬¬ä¸€ä¸ªä¼šæŠ¥é”™
        While&lt;SumTwo&lt;8, 3&gt;::type::addType&gt;::type::value &#47;&#47; æŠ¥é”™ï¼Œtemplate  instantiation depth exceeds maximum of 900
        While&lt;SumAnyTwo_B&lt;8, 3, 0&gt;&gt;::type::value &#47;&#47; OK
       While&lt;SumAnyTwo&lt;(8 - 3 &lt; 0), 8, 3&gt;::addType&gt;::type::value &#47;&#47;OK

</div>2019-12-27</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEIRm3kWsgiaEXjO0rr0Aiav7o89StFTFSXbLTkEmiaibmnw8EQTejibrtzKla0emibePT0R0KXjFRIpfXrQ/132" width="30px"><span>zhang</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>æ‚¨å¥½ï¼Œæˆ‘æƒ³é—®ä¸€ä¸ªmutexç›¸å…³çš„é—®é¢˜ï¼Œè™½ç„¶è¿™éƒ¨åˆ†å†…å®¹ä»¥åä¼šè®²ï¼Œä½†æˆ‘ç°åœ¨å·¥ä½œä¸­æœ‰ä¸€ä¸ªç–‘é—®ï¼Œéº»çƒ¦æ‚¨çœ‹ä¸€ä¸‹ï¼Œè°¢è°¢ã€‚
ä»£ç ç®€å†™å¦‚ä¸‹ï¼š
class Mutex {
public:
    pthread_mutex_t mutex;
    Mutex():mutex(PTHREAD_MUTEX_INITIALIZER) {}
    void lock() {
        pthread_mutex_lock(&amp;mutex);
    }
    void unlock() {
        pthread_mutex_unlock(&amp;mutex);
    }
};
class Cond {
public:
    pthread_cond_t cond;
    Cond():cond(PTHREAD_COND_INITIALIZER) {}
    void signal() {
        pthread_cond_signal(&amp;cond);
    }
    void broadcast() {
        pthread_cond_broadcast(&amp;cond);
    }
    void wait(Mutex &amp;mutex) {
        pthread_cond_wait(&amp;cond, &amp;mutex.mutex);
    }
};
class ScopeLock {
    Mutex &amp;mutex;
public:
    ScopeLock(CanMutex &amp;_mutex):mutex(_mutex) {
        mutex.lock();
    };
    ~ScopeLock() {
        mutex.unlock();
    };
};

class Client
{
public:
    Mutex inter_mutex;
    Mutex mutex;
    Cond cond;
    bool pending;
    Client():pending(false){}
    ~Client(){}
    void Lock() {
        mutex.lock();
    }
    void Unlock() {
        mutex.unlock();
    }
    void sendData() {
        const ScopeLock inter_protect(inter_mutex);
        const ScopeLock protect(mutex);

        &#47;&#47;send_to_server();

        while (!pending) {
            cond.wait(mutex);
        }
        pending = false;
    }
    void recvData() {
        const ScopeLock protect(mutex);
        pending = true;
        cond.signal();
    }
};
æˆ‘æœ‰å‡ ä¸ªçº¿ç¨‹ä¼šæ‰§è¡ŒåŒä¸€ä¸ªClientå¯¹è±¡çš„sendDataå‡½æ•°ï¼Œæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒClientå¯¹è±¡çš„recvDataå‡½æ•°ã€‚æˆ‘ä¸»è¦æƒ³é—®æˆ‘å‡ ä¸ªsendDataçº¿ç¨‹éœ€è¦åŒæ­¥æ‰§è¡Œï¼Œæ‰§è¡Œå®Œä¸€ä¸ªsendDataå‘é€åï¼Œå†æ‰§è¡Œå¦ä¸€ä¸ªsendDataã€‚é‚£ä¹ˆæˆ‘åœ¨sendDataå‡½æ•°æœ€å¼€å§‹åŠ æ•´ä¸ªå‡½æ•°èŒƒå›´çš„é”const ScopeLock inter_protect(inter_mutex);ï¼Œæ˜¯å¦å¯ä»¥è¿™æ ·åšï¼Ÿè°¢è°¢ï¼</div>2019-12-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/55/29/4fa6e9fb.jpg" width="30px"><span>å®‰é™çš„é›¨</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æ¨¡ç‰ˆç¼–ç¨‹å¾ˆæœ‰è¶£ï¼ŒæœŸå¾…è€å¸ˆçš„æ›´æ–°ã€‚</div>2019-12-25</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKtVXiaJbfkpeXH4udkPUIlFte7z3HWMebdogk8jFpgFEkJ0ruGiawUMUcZj9RLpLkIWxV7QOzbHoSg/132" width="30px"><span>å°ä¸€æ—¥ä¸€</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>#include &lt;iostream&gt;
#include &lt;vector&gt;
#include &lt;type_traits&gt;

using namespace std;

template&lt; class T &gt;
using decay_t = typename decay&lt;T&gt;::type;

template &lt; template &lt;typename, typename&gt; class OutContainer = vector,
           typename F, class R&gt;
auto fmap(F&amp;&amp; f, R&amp;&amp; inputs)
{
    typedef decay_t&lt;decltype( f(*inputs.begin()))&gt; result_type;
    OutContainer&lt; result_type, allocator&lt;result_type&gt;&gt; result;
    for (auto&amp;&amp; item : inputs) {
        result.push_back(f(item));
    }
    return result;
}

int add_1(int x)
{
    return x + 1;
}

int main()
{
    vector&lt;int&gt; v{1, 2, 3, 4, 5};

    auto result = fmap(add_1, v);

    for (auto &amp;&amp;v : result) {
        cout &lt;&lt; v &lt;&lt; endl;
    }
}

ç”¨g++ 4.8.5 å¸¦std=c++11å‚æ•°ç¼–è¯‘èƒ½é€šè¿‡å¹¶æ­£ç¡®è¿è¡Œï¼Œä½†æ˜¯æœ‰warning:
13_5.cc:12:28: warning: â€˜fmapâ€™ function uses â€˜autoâ€™ type specifier without trailing return type [enabled by default] auto fmap(F&amp;&amp; f, R&amp;&amp; inputs)

è¯·é—®è€å¸ˆå¦‚ä½•åŠ å°¾ç½®è¿”å›ç±»å‹æ¶ˆé™¤warning?</div>2019-12-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1a/e4/9b/fcb4b8b7.jpg" width="30px"><span>æä¹‰ç››</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ä¸€åˆ°æ¨¡æ¿å°±å¤„äºçœ‹ä¸æ‡‚çŠ¶æ€äº†ã€‚</div>2019-12-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/8c/df/77acb793.jpg" width="30px"><span>ç¦¾æ¡ƒ</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>â€œå¸¸ç”¨çš„ä¸€ä¸ªæŠ€å·§å°±æ˜¯ç”¨ is_trivially_destructible æ¨¡æ¿æ¥åˆ¤æ–­ç±»æ˜¯å¦æ˜¯å¯å¹³å‡¡ææ„çš„â€”â€”ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸è°ƒç”¨ææ„å‡½æ•°ï¼Œä¸ä¼šé€ æˆä»»ä½•èµ„æºæ³„æ¼é—®é¢˜ã€‚â€

éº»çƒ¦è§£é‡Šä¸€ä¸‹ï¼Œ
#1 è¿™ä¸ªç±»æ¨¡ç‰ˆæ˜¯å¦‚ä½•è¯†åˆ«â€œï¼Œä¸è°ƒç”¨ææ„å‡½æ•°ï¼Œä¸ä¼šé€ æˆä»»ä½•èµ„æºæ³„æ¼é—®é¢˜â€ï¼Ÿ è¿™çš„èµ„æºåŒ…æ‹¬newçš„å †å†…å­˜å—ï¼Ÿ
#2 triviallyè¿™ä¸ªè¯æ€»æ˜¯è§‰å¾—å¾ˆéš¾ç†è§£ï¼ŒC++é‡Œï¼Œä½¿ç”¨è¿™ä¸ªè¯çš„ç›®çš„ï¼Œåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</div>2019-12-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/6c/ea/e03fec22.jpg" width="30px"><span>æ³°ä¼¦å¢</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ä¸€ç›´å¯¹æ¨¡æ¿å…ƒç¼–ç¨‹æ„Ÿå…´è¶£ï¼Œä½†æ€»æ˜¯æä¸æ˜ç™½ï¼Œä»Šå¤©å­¦ä¹ å¾ˆæœ‰æ”¶è·ï¼Œç‰¹åˆ«æ˜¯æœ€åçš„fmapï¼Œæ„Ÿè°¢è€å¸ˆï¼Œè®°å¾—æ¨¡æ¿ç¼–ç¨‹è¿˜æœ‰policyä¹‹ç±»çš„ä¸œè¥¿ï¼Œè€å¸ˆä¹‹ååœ¨ç¼–è¯‘æœŸè¿™æ–¹é¢è¿˜ä¼šæ›´è¯¦ç»†è®²è§£å—</div>2019-12-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/af/a6/3f15ba2f.jpg" width="30px"><span>czh</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>ç±»æ¯”åˆšå­¦å‡½æ•°æ—¶çš„æ„Ÿè§‰ã€‚æ¨¡æ¿ç±»å‹æ¨å¯¼=å‡½æ•°åµŒå¥—ï¼Œç”¨äºæä¾›é€»è¾‘è¿‡ç¨‹ï¼›è®¡ç®—è¿‡ç¨‹ç”±å‚æ•°ä¼ é€’çš„è¿‡ç¨‹ä¸­è¿›è¡Œã€‚é€»è¾‘+è®¡ç®—ï¼Œè¿™æ ·å°±å®Œæˆäº†æ¨¡æ¿è®¡ç®—ã€‚</div>2020-02-03</li><br/>
</ul>