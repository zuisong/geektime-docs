ä¸Šä¸¤èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å·¥å‚æ¨¡å¼ï¼Œè®²äº†å·¥å‚æ¨¡å¼çš„åº”ç”¨åœºæ™¯ï¼Œå¹¶å¸¦ä½ å®ç°äº†ä¸€ä¸ªç®€å•çš„DIå®¹å™¨ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å†æ¥å­¦ä¹ å¦å¤–ä¸€ä¸ªæ¯”è¾ƒå¸¸ç”¨çš„åˆ›å»ºå‹è®¾è®¡æ¨¡å¼ï¼Œ**Builderæ¨¡å¼**ï¼Œä¸­æ–‡ç¿»è¯‘ä¸º**å»ºé€ è€…æ¨¡å¼**æˆ–è€…**æ„å»ºè€…æ¨¡å¼**ï¼Œä¹Ÿæœ‰äººå«å®ƒ**ç”Ÿæˆå™¨æ¨¡å¼**ã€‚

å®é™…ä¸Šï¼Œå»ºé€ è€…æ¨¡å¼çš„åŸç†å’Œä»£ç å®ç°éå¸¸ç®€å•ï¼ŒæŒæ¡èµ·æ¥å¹¶ä¸éš¾ï¼Œéš¾ç‚¹åœ¨äºåº”ç”¨åœºæ™¯ã€‚æ¯”å¦‚ï¼Œä½ æœ‰æ²¡æœ‰è€ƒè™‘è¿‡è¿™æ ·å‡ ä¸ªé—®é¢˜ï¼šç›´æ¥ä½¿ç”¨æ„é€ å‡½æ•°æˆ–è€…é…åˆsetæ–¹æ³•å°±èƒ½åˆ›å»ºå¯¹è±¡ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦å»ºé€ è€…æ¨¡å¼æ¥åˆ›å»ºå‘¢ï¼Ÿå»ºé€ è€…æ¨¡å¼å’Œå·¥å‚æ¨¡å¼éƒ½å¯ä»¥åˆ›å»ºå¯¹è±¡ï¼Œé‚£å®ƒä»¬ä¸¤ä¸ªçš„åŒºåˆ«åœ¨å“ªé‡Œå‘¢ï¼Ÿ

è¯ä¸å¤šè¯´ï¼Œå¸¦ç€ä¸Šé¢ä¸¤ä¸ªé—®é¢˜ï¼Œè®©æˆ‘ä»¬å¼€å§‹ä»Šå¤©çš„å­¦ä¹ å§ï¼

## ä¸ºä»€ä¹ˆéœ€è¦å»ºé€ è€…æ¨¡å¼ï¼Ÿ

åœ¨å¹³æ—¶çš„å¼€å‘ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªå¯¹è±¡æœ€å¸¸ç”¨çš„æ–¹å¼æ˜¯ï¼Œä½¿ç”¨newå…³é”®å­—è°ƒç”¨ç±»çš„æ„é€ å‡½æ•°æ¥å®Œæˆã€‚æˆ‘çš„é—®é¢˜æ˜¯ï¼Œä»€ä¹ˆæƒ…å†µä¸‹è¿™ç§æ–¹å¼å°±ä¸é€‚ç”¨äº†ï¼Œå°±éœ€è¦é‡‡ç”¨å»ºé€ è€…æ¨¡å¼æ¥åˆ›å»ºå¯¹è±¡å‘¢ï¼Ÿä½ å¯ä»¥å…ˆæ€è€ƒä¸€ä¸‹ï¼Œä¸‹é¢æˆ‘é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥å¸¦ä½ çœ‹ä¸€ä¸‹ã€‚

å‡è®¾æœ‰è¿™æ ·ä¸€é“è®¾è®¡é¢è¯•é¢˜ï¼šæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªèµ„æºæ± é…ç½®ç±»ResourcePoolConfigã€‚è¿™é‡Œçš„èµ„æºæ± ï¼Œä½ å¯ä»¥ç®€å•ç†è§£ä¸ºçº¿ç¨‹æ± ã€è¿æ¥æ± ã€å¯¹è±¡æ± ç­‰ã€‚åœ¨è¿™ä¸ªèµ„æºæ± é…ç½®ç±»ä¸­ï¼Œæœ‰ä»¥ä¸‹å‡ ä¸ªæˆå‘˜å˜é‡ï¼Œä¹Ÿå°±æ˜¯å¯é…ç½®é¡¹ã€‚ç°åœ¨ï¼Œè¯·ä½ ç¼–å†™ä»£ç å®ç°è¿™ä¸ªResourcePoolConfigç±»ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ30ï¼‰</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/17/86/25/25ded6c3.jpg" width="30px"><span>zhengyu.nie</span> ğŸ‘ï¼ˆ47ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>ä¾èµ–å…³ç³»ï¼ˆDependenciesï¼‰ã€åˆæ³•æ ¡éªŒï¼ˆPreconditionsï¼‰ã€ä¸å¯å˜ï¼ˆImmutableï¼‰ã€‚
äº‰å“¥è¿™å‡ ä¸ªæè¿°å¾ˆç²¾å‡†ï¼
å€Ÿç€æ€è·¯å»¶ä¼¸ä¸€ä¸‹çš„è¯ï¼Œå¾ˆå¤šåº“å’Œè®¾è®¡éƒ½æ˜¯ä»¥ä¸Šè¿™äº›ç†å¿µçš„ã€‚
æ¯”å¦‚com.google.guavaçš„æ ¡éªŒã€ä¸å¯å˜é›†åˆï¼Œå¤šçº¿ç¨‹è®¾è®¡æ¨¡å¼ä¸­çš„Immutableæ¨¡å¼ã€ä¿æŠ¤æ€§æ‹·è´ï¼ˆå…¶ä¸­åˆå¯ä»¥åˆ†æ·±æµ…apiï¼‰ï¼Œjava.lang.Stringçš„ä¸å¯å˜è®¾è®¡ã€‚è¿˜æœ‰å…³äºç±»çŠ¶æ€çš„æ§åˆ¶ï¼Œè¿˜æœ‰Effective Javaä¸­ç±»åˆ›å»ºè¿™ä¸€ç« ä¸­å¯¹äºæ„é€ æ–¹æ³•ã€setæ–¹æ³•ã€Builderæ„å»ºã€æšä¸¾ã€é™æ€å·¥å‚æ–¹æ³•æ„å»ºç­‰å¯¹æ¯”ï¼ŒåƒGuava Listsã€Setsã€Mapsã€ImmutableListè¿™ç§åˆ›å»ºæ–¹å¼ç°åœ¨ä¹Ÿå¾ˆä¸»æµäº†</div>2020-04-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/12/6c/61a598e9.jpg" width="30px"><span>è‹æš®æ²‰è§</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>       å°äº‰å“¥ï¼Œæˆ‘åœ¨å­¦ä¹ å»ºé€ è€…æ¨¡å¼çš„æ—¶å€™ï¼Œå‘ç°ä¼ ç»Ÿçš„æ„å»ºè€…æ¨¡å¼å†™æ³•è·Ÿæ–‡ä¸­çš„ä¸å¤ªä¸€æ ·ï¼Œä¼ ç»Ÿçš„æ„å»ºè€…æ¨¡å¼å­˜åœ¨ç›‘å·¥ï¼ŒæŠ½è±¡Builderï¼Œå…·ä½“Builderï¼Œäº§å“ç±»ã€‚å¯ä»¥é€šè¿‡ä¸åŒçš„å…·ä½“Builderï¼Œåˆ›å»ºå¯¹åº”çš„äº§å“ç±»ã€‚è€Œä½ åœ¨æ–‡ç« ä¸­çš„è®¾è®¡æ¨¡å¼çš„å†™æ³•ï¼Œåœ¨æŸäº›æ–‡ç« ä¸­ï¼Œè¢«ç§°ä¸ºå˜ç§çš„æ„é€ è€…æ¨¡å¼ã€‚
       æˆ‘æ¯”è¾ƒäº†ä¸€ä¸‹ä¸¤ç§æ–¹å¼ï¼Œæ„Ÿè§‰ä¼ ç»Ÿçš„æ„å»ºè€…æ¨¡å¼éœ€è¦æå‰å®šä¹‰å¥½ä½ è¦ç”Ÿäº§çš„äº§å“å¯¹åº”çš„å±æ€§ï¼Œè€Œæ–‡ä¸­è¿™ç§æ–¹æ³•åˆ™æ˜¯åœ¨æ„å»ºäº§å“æ—¶ï¼Œè‡ªå·±åŠ¨æ€çš„è®¾ç½®äº§å“å±æ€§ï¼Œè™½ç„¶è¯´è¿™ç§æ–¹æ³•æ›´åŠ çµæ´»ï¼Œä½†æ˜¯ä¾µå…¥æ€§æ›´é«˜ã€‚
      é‚£ä¹ˆè€ƒè™‘åˆ°ä»¥åéœ€æ±‚å˜æ›´ï¼Œæ˜¯ä¸æ˜¯åº”è¯¥æ˜¯ç”¨ä¼ ç»Ÿçš„æ„å»ºè€…æ¨¡å¼å‘¢ï¼Ÿä¸ç„¶è¦æ˜¯èµ„æºæ± å¯¹åº”çš„å‚æ•°å˜äº†ï¼Œå°±è¦ä¿®æ”¹ä¸šåŠ¡ä»£ç ä¸­çš„å‚æ•°äº†ã€‚</div>2020-05-21</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/20/96/31/d3a58c6f.jpg" width="30px"><span>æ˜¯éï½æˆè´¥ï½</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>&#47;**
 * éœ€æ±‚ï¼š
 * å½“ isRef ä¸º true çš„æ—¶å€™ï¼Œarg è¡¨ç¤º String ç±»å‹çš„ refBeanIdï¼Œtype ä¸éœ€è¦è®¾ç½®ï¼›
 * å½“ isRef ä¸º false çš„æ—¶å€™ï¼Œargã€type éƒ½éœ€è¦è®¾ç½®ã€‚
 * è¯·æ ¹æ®è¿™ä¸ªéœ€æ±‚ï¼Œå®Œå–„ ConstructorArg ç±»ã€‚
 *&#47;
public class ConstructorArg_02 {
    private boolean isRef;
    private Class type;
    private Object arg;

    private ConstructorArg_02(Builder builder) {
        this.isRef = builder.isRef;
        this.type = builder.type;
        this.arg = builder.arg;
    }

    public static class Builder {
        private boolean isRef;
        private Class type;
        private Object arg;

        &#47;&#47; åé¢ä¸¤ä¸ªå‚æ•°ä¾èµ–isRefï¼Œæ‰€ä»¥isRefè®¾ç½®æˆå¿…é€‰å‚æ•°
        public Builder(boolean isRef) {
            this.isRef = isRef;
        }

        public ConstructorArg_02 build() {
            return new ConstructorArg_02(this);
        }

        public Builder setType(Class type) {
            this.type = type;
            return this;
        }

        public Builder setArg(Object arg) {
            &#47;&#47; isRefä¸ºtrue, argä¸æ˜¯Stringç±»å‹å°±æŠ¥é”™
            if (isRef &amp;&amp; arg.getClass() != String.class) {
                throw new RuntimeException(&quot;å‚æ•°é”™è¯¯&quot;);
            }
            this.arg = arg;
            return this;
        }
    }
}
å’±ä¹Ÿä¸çŸ¥é“å†™çš„å¥½ä¸å¥½ï¼Œå¸Œæœ›äº‰å“¥çœ‹åˆ°äº†æ£€è§†æŒ‡å¯¼ä¸€äºŒ</div>2020-11-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/36/ef/83c2a743.jpg" width="30px"><span>æ‚ å—</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>ä½ è¿™å»ºé€ è€…æ¨¡å¼ä»£ç ï¼Œçœ‹ä¸æ‡‚ï¼Œæ„é€ æ–¹æ³•ç§æœ‰äº†ï¼Œæ€ä¹ˆæ¥çš„Builder æ–¹æ³•</div>2020-06-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/c8/5d/1e3685e6.jpg" width="30px"><span>Morse</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ5ï¼‰<div>ä¸ºä»€ä¹ˆå®šä¹‰äº†ä¸€ä¸ªé•¿æ–¹å½¢ç±»ï¼Œå¦‚æœä¸ä½¿ç”¨å»ºé€ è€…æ¨¡å¼ï¼Œé‡‡ç”¨å…ˆåˆ›å»ºå set çš„æ–¹å¼ï¼Œé‚£å°±ä¼šå¯¼è‡´åœ¨ç¬¬ä¸€ä¸ª set ä¹‹åï¼Œå¯¹è±¡å¤„äºæ— æ•ˆçŠ¶æ€ï¼Ÿæ±‚å¤§ä½¬è§£ç­”</div>2020-08-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg" width="30px"><span>Darren</span> ğŸ‘ï¼ˆ128ï¼‰ ğŸ’¬ï¼ˆ4ï¼‰<div>ç®€å•ç†è§£å°±æ˜¯ï¼šå·¥å‚æ¨¡å¼æ˜¯æ ¹æ®ä¸åŒçš„æ¡ä»¶ç”Ÿæˆä¸åŒClassçš„å¯¹è±¡ï¼Œæ„å»ºè€…æ¨¡å¼æ˜¯æ ¹æ®ä¸åŒå‚æ•°ç”Ÿæˆä¸€ä¸ªclassçš„ä¸åŒå¯¹è±¡ã€‚</div>2020-04-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/f9/e6/47742988.jpg" width="30px"><span>webmin</span> ğŸ‘ï¼ˆ114ï¼‰ ğŸ’¬ï¼ˆ13ï¼‰<div>public class ConstructorArg {
    private boolean isRef;
    private Class type;
    private Object arg;

    public boolean isRef() {
        return isRef;
    }

    public Class getType() {
        return type;
    }

    public Object getArg() {
        return arg;
    }

    private ConstructorArg(Builder builder) {
        this.isRef = builder.isRef;
        this.type = builder.type;
        this.arg = builder.arg;
    }

    public static class Builder {
        private boolean isRef;
        private Class type;
        private Object arg;

        public ConstructorArg build() {
            if(isRef &amp;&amp; type != null) {
                throw new IllegalArgumentException(&quot;...&quot;);
            }

            if (!isRef &amp;&amp; type == null) {
                throw new IllegalArgumentException(&quot;...&quot;);
            }

            if (this.isRef &amp;&amp; (arg != null &amp;&amp; arg.getClass() != String.class)) {
                throw new IllegalArgumentException(&quot;...&quot;);
            }

            if (!this.isRef &amp;&amp; arg == null) {
                throw new IllegalArgumentException(&quot;...&quot;);
            }

            return new ConstructorArg(this);
        }

        public Builder setRef(boolean ref) {
            if(ref &amp;&amp; this.type != null) {
                throw new IllegalArgumentException(&quot;...&quot;);
            }
            this.isRef = ref;
            return this;
        }

        public Builder setType(Class type) {
            if (this.isRef || type == null) {
                throw new IllegalArgumentException(&quot;...&quot;);
            }
            this.type = type;
            return this;
        }

        public Builder setArg(Object arg) {
            if (this.isRef &amp;&amp; (arg != null &amp;&amp; arg.getClass() != String.class)) {
                throw new IllegalArgumentException(&quot;...&quot;);
            }

            if (!this.isRef &amp;&amp; arg == null) {
                throw new IllegalArgumentException(&quot;...&quot;);
            }
            this.arg = arg;
            return this;
        }
    }
}</div>2020-02-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/2f/7a/ab6c811c.jpg" width="30px"><span>ç›¸é€¢æ˜¯ç¼˜</span> ğŸ‘ï¼ˆ55ï¼‰ ğŸ’¬ï¼ˆ4ï¼‰<div>æ‰“å¡
ä¸€ã€ä½¿ç”¨åœºæ™¯ï¼š
1ï¼‰ç±»çš„æ„é€ å‡½æ•°å¿…å¡«å±æ€§å¾ˆå¤šï¼Œé€šè¿‡setè®¾ç½®ï¼Œæ²¡æœ‰åŠæ³•æ ¡éªŒå¿…å¡«å±æ€§
2ï¼‰å¦‚æœç±»çš„å±æ€§ä¹‹é—´æœ‰ä¸€å®šçš„ä¾èµ–å…³ç³»ï¼Œæ„é€ å‡½æ•°é…åˆsetæ–¹å¼ï¼Œæ— æ³•è¿›è¡Œä¾èµ–å…³ç³»å’Œçº¦æŸæ¡ä»¶æ ¡éªŒ
3ï¼‰éœ€è¦åˆ›å»ºä¸å¯å˜å¯¹è±¡ï¼Œä¸èƒ½æš´éœ²setæ–¹æ³•ã€‚
ï¼ˆå‰ææ˜¯éœ€è¦ä¼ é€’å¾ˆå¤šçš„å±æ€§ï¼Œå¦‚æœå±æ€§å¾ˆå°‘ï¼Œå¯ä»¥ä¸éœ€è¦å»ºé€ è€…æ¨¡å¼ï¼‰
äºŒã€å®ç°æ–¹å¼ï¼š
æŠŠæ„é€ å‡½æ•°å®šä¹‰ä¸ºprivateï¼Œå®šä¹‰public static class Builder å†…éƒ¨ç±»ï¼Œé€šè¿‡Builder ç±»çš„setæ–¹æ³•è®¾ç½®å±æ€§ï¼Œè°ƒç”¨buildæ–¹æ³•åˆ›å»ºå¯¹è±¡ã€‚

ä¸‰ã€å’Œå·¥å‚æ¨¡å¼çš„åŒºåˆ«ï¼š
1ï¼‰å·¥å‚æ¨¡å¼ï¼šåˆ›å»ºä¸åŒçš„åŒä¸€ç±»å‹å¯¹è±¡ï¼ˆé›†æˆåŒä¸€ä¸ªçˆ¶ç±»æˆ–æ˜¯æ¥å£çš„ä¸€ç»„å­ç±»ï¼‰ï¼Œç”±ç»™å®šçš„å‚æ•°æ¥åˆ›å»ºå“ªç§ç±»å‹çš„å¯¹è±¡ï¼›
2ï¼‰å»ºé€ è€…æ¨¡å¼ï¼šåˆ›å»ºä¸€ç§ç±»å‹çš„å¤æ‚å¯¹è±¡ï¼Œé€šè¿‡å¾ˆå¤šå¯è®¾ç½®å‚æ•°ï¼Œâ€œå®šåˆ¶åŒ–â€çš„åˆ›å»ºå¯¹è±¡</div>2020-02-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/44/47/3ddb94d0.jpg" width="30px"><span>javaadu</span> ğŸ‘ï¼ˆ52ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>è¯¾å ‚è®¨è®ºé¢˜ï¼š

&#47;**
 * åœ¨ä¸‹é¢çš„ ConstructorArg ç±»ä¸­ï¼Œ
 * å½“ isRef ä¸º true çš„æ—¶å€™ï¼Œarg è¡¨ç¤º String ç±»å‹çš„ refBeanIdï¼Œtype ä¸éœ€è¦è®¾ç½®ï¼›
 * å½“ isRef ä¸º false çš„æ—¶å€™ï¼Œargã€type éƒ½éœ€è¦è®¾ç½®
 *
 * @author javaadu
 *&#47;
public class ConstructorArg {
    private boolean isRef;
    private Class type;
    private Object arg;

    private ConstructorArg(Builder builder) {
        this.isRef = builder.isRef;
        this.type = builder.type;
        this.arg = builder.arg;
    }

    public static class Builder {
        private boolean isRef;
        private Class type;
        private Object arg;

        public ConstructorArg build() {
            if (arg == null) {
                throw new IllegalArgumentException(&quot;argå¿…é¡»è®¾ç½®&quot;);
            }
            if (isRef) {
                if (!(arg instanceof String)) {
                    throw new IllegalArgumentException(&quot;argå¿…é¡»ä¸ºStringç±»å‹çš„å¯¹è±¡&quot;);
                }
            } else {
                if (type == null) {
                    throw new IllegalArgumentException(&quot;argå¿…é¡»è®¾ç½®&quot;);
                }
            }

            return new ConstructorArg(this)
        }

        public Builder setRef(boolean ref) {
            isRef = ref;
            return this;
        }

        public Builder setArg(Object arg) {
            this.arg = arg;
            return this;
        }

        public Builder setType(Class type) {
            this.type = type;
            return this;
        }
    }
}</div>2020-02-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/49/a5/e4c1c2d4.jpg" width="30px"><span>å°æ–‡åŒå­¦</span> ğŸ‘ï¼ˆ18ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>è¯´è¯´è‡ªå·±è¯»äº† Builder æ¨¡å¼çš„æœ€å¤§æ„Ÿæ‚Ÿï¼š
1ã€Builder æ¨¡å¼å¯ä»¥ä¿è¯å¯¹è±¡çš„çŠ¶æ€ã€‚
2ã€Builder æ¨¡å¼å¯ä»¥æŠŠå¯¹è±¡çš„æ„é€ é‰´å®šé€»è¾‘å†™åœ¨Builderç±»ä¸­ï¼Œä¿è¯äº†ç±»çš„ç®€æ´ã€‚

å¹³æ—¶æ™®æ™®é€šé€šåœ°ä½¿ç”¨ lombok ç”Ÿæˆ Builderï¼Œåº”è¯¥æ›´åŠ æ·±å…¥åœ°äº†è§£ä¸€ä¸‹ã€‚</div>2020-03-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/ca/c7/00e544c2.jpg" width="30px"><span>é»„æ—æ™´</span> ğŸ‘ï¼ˆ12ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>æ‰“å¡~
æœ€è¿‘åŠå¹´ç”¨çš„æœ€å¤šçš„å°±æ˜¯Builderæ¨¡å¼äº†</div>2020-02-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/17/c1/66/e8dfeef4.jpg" width="30px"><span>ç‹æ¶›</span> ğŸ‘ï¼ˆ9ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>æœ€è¿‘ï¼Œåœ¨å­¦ä¹ æœ¬ä¸“æ çš„è¿‡ç¨‹ä¸­ã€‚
é€æ¸ä½“ä¼šåˆ°â€œçŸ¥å…¶ç„¶ï¼Œæ›´çŸ¥å…¶æ‰€ä»¥ç„¶â€çš„æ„Ÿè§‰
</div>2020-02-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/a0/a3/8da99bb0.jpg" width="30px"><span>ä¸šä½™çˆ±å¥½è€…</span> ğŸ‘ï¼ˆ7ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>åˆ›å»ºå‹æ¨¡å¼çš„ä½œç”¨åœ¨äºï¼Œå°†å¯¹è±¡â€œè·å–â€ï¼ˆæ²¡æœ‰ç”¨åˆ›å»ºï¼‰çš„è¿‡ç¨‹ç‹¬ç«‹å‡ºæ¥ï¼Œå½¢æˆå•ç‹¬çš„ç±»ã€‚è¿™åœ¨è·å–å¤æ‚æˆ–è€…æœ‰ç‰¹æ®Šéœ€æ±‚çš„å¯¹è±¡æ—¶å¯ä»¥æ›´å¥½çš„ä½“ç°å•ä¸€èŒè´£åŸåˆ™---æˆ‘è´Ÿè´£æ‹¿åˆ°ï¼ˆready to useï¼‰å¯¹è±¡,ä½ åªç®¡ä½¿ç”¨å°±å¯ä»¥äº†ã€‚ä½ ä¸éœ€è¦å…³ç³»æˆ‘æ˜¯ä¸æ˜¯æ‡’åŠ è½½ä¹‹ç±»çš„é—®é¢˜ã€‚

ä¸€ä¸ªå¯ä»¥ä½¿ç”¨çš„å¯¹è±¡ï¼Œå®ƒçš„æ„ä¹‰ç»ä¸å•å•æ˜¯newä¸€ä¸‹å°±å®Œäº‹äº†ï¼Œè¿˜æœ‰ä¸€ç³»åˆ—å…¶ä»–çš„è€ƒé‡ã€‚
å¦‚æœè¦æ±‚ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„å¯¹è±¡ï¼Œå¦‚åŸºæœ¬ä¸å˜åŒ–çš„é…ç½®ä¿¡æ¯ç±»ï¼Œè¿™å°±æ˜¯å•ä¾‹æ¨¡å¼ã€‚å¦‚ä½•æ§åˆ¶åªæœ‰ä¸€ä¸ªå¯¹è±¡ï¼Œå½“ç„¶æ˜¯æ‹¦æˆªæ‰æ‰€æœ‰å…¶ä»–åˆ›å»ºå¯¹è±¡çš„è·¯å¾„ï¼Œåªç•™ä¸‹ä¸€æ¡è·¯---ä½¿ç”¨ç±»å”¯ä¸€çš„é™æ€æ–¹æ³•è·å–å¯¹è±¡ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆï¼Œå•ä¾‹ä¸€èˆ¬éƒ½è¦æ±‚å°†æ„é€ æ–¹æ³•ç§æœ‰åŒ–ã€‚ï¼ˆspringçš„å•ä¾‹beanå…¶å®åªæ˜¯ä¸€ç§å•ä¾‹çš„çº¦å®šï¼Œä½ å®Œå…¨å¯ä»¥è‡ªå·±newä¸€ä¸ªã€‚ï¼‰å•ä¾‹æ¨¡å¼è¿˜è®¾è®¡åˆ°æ‡’åŠ è½½çš„é—®é¢˜ï¼Œä¸è¿‡ç”±äºåªæœ‰ä¸€ä¸ªè®¿é—®å…¥å£ï¼Œå¤„ç†èµ·æ¥æ¯”è¾ƒç®€å•ã€‚

å·¥å‚æ¨¡å¼å°±æ¯”è¾ƒçº¯ç²¹äº†ï¼Œå·¥å‚çš„æ„ä¹‰å°±æ˜¯åœ¨äºè·å–ä¸€ä¸ªå¯¹è±¡ã€‚ç®€å•å·¥å·¥å‚ç±»å¦‚æœæ˜¯æ— çŠ¶æ€çš„è¯ï¼Œå®Œå…¨å¯ä»¥ä½¿ç”¨é™æ€æ–¹æ³•çš„å½¢å¼ï¼Œæ²¡æœ‰å¿…è¦æ¯åˆ›å»ºä¸€ä¸ªå¯¹è±¡éƒ½å…ˆå¼„ä¸ªå®Œå…¨ä¸€æ ·çš„å·¥å‚å‡ºæ¥ã€‚
å½“éœ€è¦æœ‰æ ¹æ®ä¸åŒæƒ…å†µåˆ›å»ºä¸åŒå­ç±»çš„æ—¶å€™ï¼Œå¦‚æœåˆ†æ”¯ä¸å¤šçš„è¯ï¼Œå®Œå…¨å¯ä»¥ä½¿ç”¨if else,ä¸è¿‡ä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨å¤šæ€ã€‚ä¸åŒçš„æƒ…å†µåˆ›å»ºä¸åŒçš„å·¥å‚ï¼Œå°†ç›¸åº”å­ç±»å„å¼‚çš„åˆ›å»ºé€»è¾‘åˆ†å¼€ã€‚è¿™å°±æ˜¯å·¥å‚æ–¹æ³•ã€‚
è€Œå¦‚æœæ˜¯åˆ›å»ºä¸€ä¸ªäº§å“ç³»åˆ—çš„è¯ï¼Œå°±ä½¿ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼ã€‚

å»ºé€ è€…ç”¨äºå¤„ç†åˆ›å»ºå‚æ•°è¿‡å¤šçš„æƒ…å½¢ï¼ŒåŒæ—¶å¯ä»¥æ ¡éªŒå‚æ•°ï¼Œé¿å…å¯¹è±¡åˆ›å»ºè¿‡ç¨‹ä¸­çš„ä¸ä¸€è‡´çŠ¶æ€ã€‚

åŸå‹ç”¨äºå¿«é€Ÿæ‹·è´ä¸€ä¸ªå¯¹è±¡ã€‚</div>2020-08-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/93/c7/86352ccc.jpg" width="30px"><span>1024</span> ğŸ‘ï¼ˆ7ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>åšäº†ä¸€ä¸‹è¯¾åé¢˜ï¼Œå’Œå…¶ä»–åŒå­¦çš„ç­”æ¡ˆæ¯”è¾ƒäº†ä¸‹ï¼Œè¿˜æ˜¯æœ‰äº›ç–‘æƒ‘ï¼Œç–‘æƒ‘åœ¨å±æ€§çš„åˆ¤æ–­é€»è¾‘æ˜¯æ”¾åœ¨Builderçš„setAttr()å†…è¿˜æ˜¯æ”¾åœ¨build()å†…
ä¸ªäººè®¤ä¸ºï¼š
setAttr()æ”¾å±æ€§è‡ªå·±çš„é€»è¾‘åˆ¤æ–­ï¼Œæ¯”å¦‚ä¸è¦ä¸ºnullï¼Œä¸èƒ½å¤§äºæˆ–å°äºæŸä¸ªå¸¸é‡
build()æ–¹æ³•æ”¾å¤šä¸ªå±æ€§é—´çš„æ ¡éªŒé€»è¾‘ï¼Œå› ä¸ºè°ƒç”¨builde()æ—¶ï¼Œå±æ€§éƒ½setå®Œæˆï¼Œè¿™æ—¶å€™æ‰æœ‰æœºä¼šé€šè¿‡builde()æ¥å…¨å±€è€ƒè™‘æ‰€æœ‰å±æ€§çš„é€»è¾‘ã€‚
åŸºäºæ­¤ï¼Œæˆ‘çš„ç­”æ¡ˆå¦‚ä¸‹
public class ConstructorArg {
    private boolean isRef;
    private Class type;
    private Object arg;

    private ConstructorArg(Builder builder) {
        this.isRef = builder.isRef;
        this.type = builder.type;
        this.arg = builder.arg;
    }
    &#47;&#47; çœç•¥getteræ–¹æ³•

    public static class Builder {
        private Object arg;
        private Class type;
        private boolean isRef;

        private ConstructorArg build() {
            if (isRef) {
                if (!(arg instanceof String)) {
                    &#47;&#47;è¿™é‡ŒrefBeanIdæ˜¯ConstructorArgå—ï¼Ÿåªæ˜¯åˆ¤æ–­äº†ä¸‹argç±»å‹æ˜¯å¦ä¸ºString
                    throw new IllegalArgumentException(&quot;å½“ isRef ä¸º true çš„æ—¶å€™ï¼Œarg è¡¨ç¤º String ç±»å‹refBeanId&quot;);
                }
                if (type != null) {
                    throw new IllegalArgumentException(&quot;å½“ isRef ä¸º true çš„æ—¶å€™ï¼Œtype ä¸éœ€è¦è®¾ç½®&quot;);
                }
            }
            if (!isRef) {
                if (arg == null || type == null) {
                    throw new IllegalArgumentException(&quot;å½“ isRef ä¸º false çš„æ—¶å€™ï¼Œargã€type éƒ½éœ€è¦è®¾ç½®&quot;);
                }
            }
            return new ConstructorArg(this);
        }

        public Builder setRef(boolean ref) {
            isRef = ref;
            return this;
        }

        public Builder setArg(Object arg) {
            this.arg = arg;
            return this;
        }

        public Builder setType(Class type) {
            this.type = type;
            return this;
        }
    }
public static void main(String[] args) {
        ConstructorArg.Builder builder = new ConstructorArg.Builder();
&#47;&#47;        java.lang.IllegalArgumentException: å½“ isRef ä¸º true çš„æ—¶å€™ï¼Œarg è¡¨ç¤º String ç±»å‹refBeanId
        builder.setRef(true).setArg(1).build();
    }</div>2020-03-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/44/a7/171c1e86.jpg" width="30px"><span>å•¦å•¦å•¦</span> ğŸ‘ï¼ˆ7ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>ç”¨phpå®ç°äº†ä¸€ä¸ª
&lt;?php
class ResourcePoolConfig{
    private $maxTotal;
    private $maxIdle;
    private $minIdle;
    public function __construct(build $build)
    {
        $this-&gt;maxTotal = $build-&gt;maxTotal;
        $this-&gt;maxIdle = $build-&gt;maxIdle;
        $this-&gt;minIdle = $build-&gt;minIdle;
        echo &#39;maxTotal&#39;.$this-&gt;maxTotal;
        echo &#39;&lt;br &#47;&gt;&#39;;
        echo &#39;maxIdle&#39;.$this-&gt;maxIdle;
        echo &#39;&lt;br &#47;&gt;&#39;;
        echo &#39;minIdle&#39;.$this-&gt;minIdle;
        echo &#39;&lt;br &#47;&gt;&#39;;
    }
}

class Builder{
    public $maxTotal;
    public $maxIdle;
    public $minIdle;
    public function noodleValidate(){
        if($this-&gt;maxIdle&gt;$this-&gt;maxTotal){
            throw new Exception(&quot;maxIdleæŠ›å‡ºå¼‚å¸¸&quot;);
        }
        if($this-&gt;minIdle&gt;$this-&gt;maxTotal){
            throw new Exception(&quot;minIdleæŠ›å‡ºå¼‚å¸¸&quot;);
        }
    }

    public function setMaxTotal($value=20){
        $this-&gt;maxTotal = $value;
        return $this;
    }

    public function setMaxIdle($value=10){
        $this-&gt;maxIdle = $value;
        return $this;
    }

    public function setMinIdle($value=10){
        $this-&gt;minIdle = $value;
        return $this;
    }
}

$b = new Builder();
$b-&gt;setMaxTotal(5)-&gt;setMaxIdle()-&gt;setMinIdle()-&gt;noodleValidate();
new ResourcePoolConfig($b);</div>2020-02-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/4e/d0/d8a5f720.jpg" width="30px"><span>Kenå¼ äº‘å¿ </span> ğŸ‘ï¼ˆ7ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>public class ConstructorArg {
    private boolean isRef;
    private Class type;
    private Object arg;
    public ConstructorArg(ConstructorArgBuilder builder) {
        this.isRef = builder.isRef;
        this.type = builder.type;
        this.arg = builder.arg;
    }
    public static class ConstructorArgBuilder {
        private boolean isRef;
        private Class type;
        private Object arg;
        public ConstructorArg builder() {
            if (arg == null) {
                throw new IllegalArgumentException(&quot;arg should not be null&quot;);
            }
            if (isRef == true) {
                if (arg instanceof String) {
                    type = String.class;
                } else {
                    throw  new IllegalArgumentException(&quot;when isRef is true,arg should be String type&quot;);
                }
            } else {
                type = arg.getClass();
            }
            return new ConstructorArg(this);
        }
        public ConstructorArgBuilder(boolean isRef) {
            this.isRef = isRef;
        }
        public ConstructorArgBuilder setArg(Object arg) {
            this.arg = arg;
            return this;
        }
    }
}
 &#47;&#47; use case
ConstructorArg constructorArg = new ConstructorArgBuilder(true).setArg(0).builder();
ConstructorArg constructorArg1 = new ConstructorArgBuilder(false).setArg(1).builder();</div>2020-02-17</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/bvj76PmeUvW8kokyu91IZWuRATKmabibDWbzAj2TajeEic7WvKCJOLaOh6jibEmdQ36EO3sBUZ0HibAiapsrZo64U8w/132" width="30px"><span>æ¢¦å€šæ æ†</span> ğŸ‘ï¼ˆ6ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>â€œå¦‚æœæˆ‘ä»¬å¹¶ä¸æ˜¯å¾ˆå…³å¿ƒå¯¹è±¡æ˜¯å¦æœ‰çŸ­æš‚çš„æ— æ•ˆçŠ¶æ€â€

ä¸­é—´çŸ­æš‚çš„æ— æ•ˆçŠ¶æ€ä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿæ²¡ç†è§£ã€‚æ˜¯åœ¨å¤šçº¿ç¨‹ä¸‹ä¼šæœ‰é—®é¢˜å—ï¼Ÿå¦‚æœæ˜¯ï¼Œå¦‚æœæ˜¯ç±»å¯¹è±¡ï¼Œè¿™æœ¬èº«ä¸€ç»„æ“ä½œå°±åº”è¯¥åŠ é”ï¼Œå¦‚æœæ˜¯æ–¹æ³•å†…éƒ¨ä¸å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œæ‰€ä»¥æ²¡ç†è§£çŸ­æš‚çš„æ— æ•ˆçŠ¶æ€ä¼šæ€ä¹ˆæ ·


</div>2020-03-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/23/a1/b08f3ee7.jpg" width="30px"><span>ä½•å¦¨</span> ğŸ‘ï¼ˆ6ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>å»ºé€ è€…æ¨¡å¼:ç”¨äºå·²çŸ¥ç±»åˆ›å»ºï¼Œåˆ›å»ºæ„é€ å¤æ‚éœ€æ ¡éªŒå‚æ•°çš„ç±»
å·¥å‚æ¨¡å¼:ç”¨äºæœªçŸ¥ç±»åˆ›å»ºï¼Œæ ¹æ®ä¼ å…¥å‚æ•°åˆ›å»ºç›¸ä¼¼çš„ç±»å¤„ç†ä¸åŒé€»è¾‘</div>2020-02-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/47/31/f35367c8.jpg" width="30px"><span>å°æ™å­</span> ğŸ‘ï¼ˆ5ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è¯¾åè®¨è®ºé¢˜ï¼š

 public class ConstructorArg {
    private boolean isRef;
    private Class type;
    private Object arg;
    &#47;&#47; TODO: å¾…å®Œå–„...

    private ConstructorArg(Builder builder) {
        this.isRef = builder.isRef;
        this.type  = builder.type;
        this.arg   = builder.arg;
    }

    public static class Builder {
        private boolean isRef;
        private Class type;
        private Object arg;

        public ConstructorArg build() {
            if (!isRef) {
                if (type == null || arg == null){
                    throw new IllegalArgumentException(&quot;type and arg must be set when isRef is false&quot;)
                }
            } else {
                if (!(arg instanceof String)) {
                    throw new IllegalArgumentException(&quot;arg must be a String instance when isRef is true&quot;)
                }
            }
            return new ConstructorArg(this);
        }
    }

    public Builder setIsRef(boolean isRef){
        this.isRef = isRef;
        return this;
    }

    public Builder setType(Class type) {
        this.type = type;
        return this;
    }

    public Builder setObject(Object arg) {
        this.arg = arg;
        return this;
    }
  }

  &#47;&#47;use case
  ConstructorArg ca = ConstructorArg.Builder()
        .setIfRef(false)
        .setType(Integer)
        .setObject(2)
        .build();</div>2020-02-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/8a/02/828938c9.jpg" width="30px"><span>Frank</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>å½“åœ¨å¼€å‘ä¸­éœ€è¦åˆ›å»ºä¸€ä¸ªå…·ä½“çš„å¯¹è±¡ï¼Œå¦‚æœå¿…å¡«å±æ€§å¾ˆå¤šï¼Œå±æ€§å­˜åœ¨å¤æ‚çš„æ ¡éªŒå’Œå±æ€§ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»ï¼Œå¯ä»¥ä½¿ç”¨å»ºé€ è€…æ¨¡å¼æ¥é¿å…ç±»çš„æ„é€ å‡½æ•°å‚æ•°åˆ—è¡¨è¿‡é•¿ï¼Œå¯¼è‡´å¯è¯»æ€§å·®ï¼Œä¸æ˜“ä½¿ç”¨çš„é—®é¢˜ã€‚å»ºé€ è€…æ¨¡å¼å¯ä»¥å°†ç±»çš„æ„é€ æ–¹æ³•ç§æœ‰ï¼Œä¸æä¾›ç±»çš„setteræ–¹æ³•ï¼Œå› æ­¤å¯ä»¥åˆ›å»ºä¸€ä¸ªä¸å˜çš„å¯¹è±¡ã€‚åŒæ—¶åœ¨æŸäº›åœºæ™¯ä¸‹å°†å±æ€§æ„é€ å¥½å¯ä»¥è§£å†³ç±»çš„æ— æ•ˆçŠ¶æ€ã€‚
ä½¿ç”¨æ€è·¯ï¼šæŠŠæ ¡éªŒé€»è¾‘æ”¾ç½®åˆ° Builder ç±»ä¸­ï¼Œå…ˆåˆ›å»ºå»ºé€ è€…ï¼Œå¹¶ä¸”é€šè¿‡ set() æ–¹æ³•è®¾ç½®å»ºé€ è€…çš„å˜é‡å€¼ï¼Œç„¶ååœ¨ä½¿ç”¨ build() æ–¹æ³•çœŸæ­£åˆ›å»ºå¯¹è±¡ä¹‹å‰ï¼Œåšé›†ä¸­çš„æ ¡éªŒï¼Œæ ¡éªŒé€šè¿‡ä¹‹åæ‰ä¼šåˆ›å»ºå¯¹è±¡ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬æŠŠä¸»ç±»çš„æ„é€ å‡½æ•°ä¸ºäº†private ç§æœ‰æƒé™ï¼Œåªèƒ½é€šè¿‡å»ºé€ è€…æ¥åˆ›å»º ç±»å¯¹è±¡ï¼Œå¹¶ä¸”ä¸»ç±»æ²¡æœ‰æä¾›ä»»ä½• set() æ–¹æ³•ï¼Œè¿™æ ·åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡å°±æ˜¯ä¸å¯å˜å¯¹è±¡äº†ã€‚</div>2020-02-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/64/9b/d1ab239e.jpg" width="30px"><span>J.Smile</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>å»ºé€ è€…æ¨¡å¼æ ¸å¿ƒä»£ç :
ResourcePoolConfig config = new ResourcePoolConfig.Builder()
        .setName(&quot;dbconnectionpool&quot;)
        .setMaxTotal(16)
        .setMaxIdle(10)
        .setMinIdle(12)
        .build();</div>2020-02-17</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/QYKSUV20DMgBHAPLfgngdw4N8FHRCSBLCJueVRu9Ya1Ba2x4icx70zoVVFOZtG1K6TkHj5CFbuztQhRFyCjWXHQ/132" width="30px"><span>zaab</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>å†™å¾—çœŸå¥½ï¼Œä¹‹å‰çœ‹äº†å‡ æ¬¡ä¸çŸ¥é“å»ºé€ è€…æ¨¡å¼çš„ä½œç”¨ï¼Œä¸çŸ¥é“ä¸ºå•¥çœ‹äº†ä¸€ä¸‹è¿™ç¯‡æˆ‘å°±ç†è§£äº†ã€‚ã€‚</div>2020-12-11</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIma3PJUyqDEQKt40nEh3Jt840af6hKnuK8k8dIscm43EUzJwLvynbxRnvO9Ivibv7KssUSqoBdY1w/132" width="30px"><span>PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„éœ€è¦</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ6ï¼‰<div>æ€»æ„Ÿè§‰åªæ˜¯æŠŠæ ¡éªŒé€»è¾‘æŒªåˆ°äº†bulder é‡Œã€‚æ²¡ç›´è§‚çš„æ„Ÿè§‰åˆ°builder çš„æœ‰ç‚¹å‘¢ã€‚è€å¸ˆ~</div>2020-02-17</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKhABWsNOGReVBNqwYCn52ibbaog3AWU6lPRARibCkibhlNf885vaQPQ8n37ic4wFr7HMBw2wRLcpYkcw/132" width="30px"><span>å°å­¦ç”Ÿ</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>å‚æ•°ææˆä¸€ä¸ªç±»ï¼Œä¼ å…¥æ„é€ å‡½æ•°æ˜¯å¦ä¹Ÿå¯ä»¥è§£å†³å‚æ•°è¿‡é•¿+æ ¡éªŒçš„é—®é¢˜ï¼Ÿ</div>2020-10-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/68/ba/c0cf8bf3.jpg" width="30px"><span>å¤©å¤©å‘ä¸Šå¡ç´¢</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>åœ¨ .net core å¤§é‡ä½¿ç”¨äº† builder æ¨¡å¼ä»£ç </div>2020-07-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/e4/2e/899a8fa2.jpg" width="30px"><span>Riley</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>1ã€è¯·é—®lomboxä¸­@builderæ€æƒ³æ˜¯ä¸æ˜¯æ¥è‡ªå»ºé€ è€…æ¨¡å¼çš„æ€æƒ³ï¼Ÿ
2ã€ è¿˜æœ‰ç½‘ä¸Šå¾ˆå¤šäººä¸å»ºè®®ç”¨lomboxæ’ä»¶ï¼Œè¯·é—®ä½ å¯¹æ­¤æœ‰ä½•å»ºè®®ï¼Ÿ</div>2020-04-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/4c/6d/c20f2d5a.jpg" width="30px"><span>LJK</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>æ„Ÿè§‰è¯¾åæ€è€ƒé¢˜çš„argumentsé€»è¾‘åˆ¤æ–­ç›¸å¯¹å¤æ‚ï¼Œå†åŠ ä¸Šæƒ³å°è¯•ä¸€ä¸‹å»ºé€ è€…æ¨¡å¼ï¼Œæ‰€ä»¥æŠ›ç –å¼•ç‰ï¼Œç»™ä¸€ä¸ªPythonçš„å°è¯•ï¼Œæœ‰ä¸€ä¸ªå›°æƒ‘æ˜¯å¯¹äºPythonè¿™ç§è¯­è¨€ï¼Œå¦‚ä½•é¿å…å¯¹ç”¨æˆ·æš´éœ²åœ¨è°ƒç”¨builderä¹‹å‰buildæ–¹æ³•ä¹‹å‰åˆå§‹åŒ–çš„ConstructorArgå¯¹è±¡ï¼Ÿ

class ConstructorArg(object):
    def __init__(self, isRef):  #å¦‚ä½•é¿å…æš´éœ²è¿™ä¸ªå®ä¾‹å¯¹è±¡ï¼Ÿ
        self.isRef = isRef
        self.type = None
        self.arg = None
    
    def __repr__(self):
        string = f&quot;isRef:  {self.isRef}\n&quot; + \
                 f&quot;type:   {self.type}\n&quot; + \
                 f&quot;arg:    {self.arg}\n&quot;
        return string

    class ConstructorArgBuilder(object):
        def __init__(self, isRef):
            self.constructorArg = ConstructorArg(isRef)

        def addType(self, typeObj):
            self.constructorArg.type = typeObj
            return self

        def addArg(self, argObj):
            self.constructorArg.arg = argObj
            return self

        def build(self):
            if self.constructorArg.isRef:
                if self.constructorArg.type is None:
                    raise Exception(&quot;type cannot be None when isRef&quot;)
                elif not isinstance(self.constructorArg.type, str):
                    raise Exception(&quot;type must be string when isRef&quot;)
            elif not self.constructorArg.isRef:
                if self.constructorArg.type is None:
                    raise Exception(&quot;type cannot be None when not isRef&quot;)
                if self.constructorArg.arg is None:
                    raise Exception(&quot;arg cannot be None when not isRef&quot;)
            return self.constructorArg</div>2020-02-17</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLe9iavda8ia7vNkbMVEHsCKs43l6U6HGWibiaxxKd9PuiaYu5wRedicC96PLicZ9VIh0ic5Jg8YHPrta3IAQ/132" width="30px"><span>Geek_00e01b</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>å¯¹äºæ²¡æœ‰å†…éƒ¨ç±»æœºåˆ¶çš„ç¼–ç¨‹è¯­è¨€ï¼Œå°±æ²¡é‚£ä¹ˆå‹å¥½äº†ã€‚éœ€è¦å•ç‹¬ä¸ºéœ€è¦åˆ›å»ºå¯¹è±¡çš„ç±»åˆ›å»ºä¸€ä¸ªbuilderç±»ã€‚è€Œä¸”ï¼Œä¹Ÿæ˜¯å› ä¸ºå•ç‹¬åˆ›å»ºäº†ä¸€ä¸ªç±»ï¼Œæ‰€ä»¥éœ€è¦åˆ›å»ºå¯¹è±¡çš„ç±»çš„æ„é€ å‡½æ•°æ²¡åŠæ³•å˜ä¸ºprivate</div>2021-11-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/8d/5b/383a49e4.jpg" width="30px"><span>charmsongo</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>æ€»ç»“
1ã€ä¸ºä»€ä¹ˆéœ€è¦å»ºé€ è€…æ¨¡å¼ï¼Ÿ
	æˆå‘˜å˜é‡è¿‡å¤šï¼Œå˜é‡èµ‹å€¼é€»è¾‘åˆ¤æ–­å¤æ‚ï¼Œå°±éœ€è¦è€ƒè™‘ä½¿ç”¨å»ºé€ è€…æ¨¡å¼ï¼Œå…ˆè®¾ç½®å»ºé€ è€…çš„å˜é‡ï¼Œç„¶åå†ä¸€æ¬¡æ€§åœ°åˆ›å»ºå¯¹è±¡
	é¿å…å¯¹è±¡å­˜åœ¨æ— æ•ˆçŠ¶æ€
	ç¼ºç‚¹æ˜¯ï¼Œä¼šæœ‰é‡å¤ä»£ç ï¼Œæˆå‘˜å˜é‡ï¼Œè¦åœ¨ Builder ç±»ä¸­é‡æ–°å†å®šä¹‰ä¸€éã€‚
2ã€ä¸å·¥å‚æ¨¡å¼æœ‰ä½•åŒºåˆ«ï¼Ÿ
	å·¥å‚æ¨¡å¼æ˜¯ç”¨æ¥åˆ›å»ºä¸åŒä½†æ˜¯ç›¸å…³ç±»å‹çš„å¯¹è±¡ï¼ˆç»§æ‰¿åŒä¸€çˆ¶ç±»æˆ–è€…æ¥å£çš„ä¸€ç»„å­ç±»ï¼‰ï¼Œç”±ç»™å®šçš„å‚æ•°æ¥å†³å®šåˆ›å»ºå“ªç§ç±»å‹çš„å¯¹è±¡ã€‚
	å»ºé€ è€…æ¨¡å¼æ˜¯ç”¨æ¥åˆ›å»ºä¸€ç§ç±»å‹çš„å¤æ‚å¯¹è±¡ï¼Œé€šè¿‡è®¾ç½®ä¸åŒçš„å¯é€‰å‚æ•°ï¼Œâ€œå®šåˆ¶åŒ–â€åœ°åˆ›å»ºä¸åŒçš„å¯¹è±¡ã€‚
	ç®€å•ç†è§£å°±æ˜¯ï¼šå·¥å‚æ¨¡å¼æ˜¯æ ¹æ®ä¸åŒçš„æ¡ä»¶ç”Ÿæˆä¸åŒClassçš„å¯¹è±¡ï¼Œæ„å»ºè€…æ¨¡å¼æ˜¯æ ¹æ®ä¸åŒå‚æ•°ç”Ÿæˆä¸€ä¸ªclassçš„ä¸åŒå¯¹è±¡ã€‚</div>2021-11-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/28/1b/f9/018197f1.jpg" width="30px"><span>å°æ±Ÿçˆ±å­¦æœ¯</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>&#47;**
 * æ„é€ è€…æ¨¡å¼demo: ConstructorArg
 *&#47;
public class ConstructorArg {
    private boolean isRef;
    private Class type;
    private Object arg;

    private ConstructorArg(boolean isRef, Class type, Object arg) {
        this.isRef = isRef;
        this.type = type;
        this.arg = arg;
    }

    public static class Builder {
        private boolean isRef;
        private Class type;
        private Object arg;

        public ConstructorArg build() throws Exception {
            if (isValidParams()) {
                return new ConstructorArg(isRef, type, arg);
            }
            throw new Exception(&quot;params invalid&quot;);
        }

        public Builder setIsRef(boolean isRef) {
            this.isRef = isRef;
            return this;
        }

        public Builder setType(Class type) {
            this.type = type;
            return this;
        }

        public Builder setObject(Object arg) {
            this.arg = arg;
            return this;
        }

        private boolean isValidParams() {
            if (isRef &amp;&amp; arg instanceof String) {
                return true;
            }
            if (!isRef &amp;&amp; arg != null &amp;&amp; type != null) {
                return true;
            }
            return false;
        }
    }
}</div>2021-06-09</li><br/>
</ul>