ä½ å¥½ï¼Œæˆ‘æ˜¯åˆ˜è¶…ã€‚

å¼€å§‹ä»Šå¤©çš„å­¦ä¹ ä¹‹å‰ï¼Œæˆ‘æƒ³å…ˆè¯·ä½ æ€è€ƒä¸€ä¸ªé—®é¢˜ã€‚å‡è®¾ç°åœ¨æœ‰è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼Œè®©ä½ è®¾è®¡ä¸€ä¸ªè£…ä¿®åŠŸèƒ½ï¼Œç”¨æˆ·å¯ä»¥åŠ¨æ€é€‰æ‹©ä¸åŒçš„è£…ä¿®åŠŸèƒ½æ¥è£…é¥°è‡ªå·±çš„æˆ¿å­ã€‚ä¾‹å¦‚ï¼Œæ°´ç”µè£…ä¿®ã€å¤©èŠ±æ¿ä»¥åŠç²‰åˆ·å¢™ç­‰å±äºåŸºæœ¬åŠŸèƒ½ï¼Œè€Œè®¾è®¡çª—å¸˜è£…é¥°çª—æˆ·ã€è®¾è®¡åŠé¡¶è£…é¥°æˆ¿é¡¶ç­‰æœªå¿…æ˜¯æ‰€æœ‰ç”¨æˆ·éƒ½éœ€è¦çš„ï¼Œè¿™äº›åŠŸèƒ½åˆ™éœ€è¦å®ç°åŠ¨æ€æ·»åŠ ã€‚è¿˜æœ‰å°±æ˜¯ä¸€æ—¦æœ‰æ–°çš„è£…ä¿®åŠŸèƒ½ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å®ç°åŠ¨æ€æ·»åŠ ã€‚å¦‚æœè¦ä½ æ¥è´Ÿè´£ï¼Œä½ ä¼šæ€ä¹ˆè®¾è®¡å‘¢ï¼Ÿ

æ­¤æ—¶ä½ å¯èƒ½ä¼šæƒ³äº†ï¼Œé€šå¸¸ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ åŠŸèƒ½ï¼Œè¦ä¹ˆç›´æ¥ä¿®æ”¹ä»£ç ï¼Œåœ¨å¯¹è±¡ä¸­æ·»åŠ ç›¸åº”çš„åŠŸèƒ½ï¼Œè¦ä¹ˆæ´¾ç”Ÿå¯¹åº”çš„å­ç±»æ¥æ‰©å±•ã€‚ç„¶è€Œï¼Œå‰è€…æ¯æ¬¡éƒ½éœ€è¦ä¿®æ”¹å¯¹è±¡çš„ä»£ç ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯ç†æƒ³çš„é¢å‘å¯¹è±¡è®¾è®¡ï¼Œå³ä¾¿åè€…æ˜¯é€šè¿‡æ´¾ç”Ÿå¯¹åº”çš„å­ç±»æ¥æ‰©å±•ï¼Œä¹Ÿå¾ˆéš¾æ»¡è¶³å¤æ‚çš„éšæ„ç»„åˆåŠŸèƒ½éœ€æ±‚ã€‚

é¢å¯¹è¿™ç§æƒ…å†µï¼Œä½¿ç”¨è£…é¥°å™¨æ¨¡å¼åº”è¯¥å†åˆé€‚ä¸è¿‡äº†ã€‚å®ƒçš„ä¼˜åŠ¿æˆ‘æƒ³ä½ å¤šå°‘çŸ¥é“ä¸€ç‚¹ï¼Œæˆ‘åœ¨è¿™é‡Œæ€»ç»“ä¸€ä¸‹ã€‚

è£…é¥°å™¨æ¨¡å¼èƒ½å¤Ÿå®ç°ä¸ºå¯¹è±¡åŠ¨æ€æ·»åŠ è£…ä¿®åŠŸèƒ½ï¼Œå®ƒæ˜¯ä»ä¸€ä¸ªå¯¹è±¡çš„å¤–éƒ¨æ¥ç»™å¯¹è±¡æ·»åŠ åŠŸèƒ½ï¼Œæ‰€ä»¥æœ‰éå¸¸çµæ´»çš„æ‰©å±•æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¯¹åŸæ¥çš„ä»£ç æ¯«æ— ä¿®æ”¹çš„å‰æä¸‹ï¼Œä¸ºå¯¹è±¡æ·»åŠ æ–°åŠŸèƒ½ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè£…é¥°å™¨æ¨¡å¼è¿˜èƒ½å¤Ÿå®ç°å¯¹è±¡çš„åŠ¨æ€ç»„åˆï¼Œå€Ÿæ­¤æˆ‘ä»¬å¯ä»¥å¾ˆçµæ´»åœ°ç»™åŠ¨æ€ç»„åˆçš„å¯¹è±¡ï¼ŒåŒ¹é…æ‰€éœ€è¦çš„åŠŸèƒ½ã€‚

ä¸‹é¢æˆ‘ä»¬å°±é€šè¿‡å®è·µï¼Œå…·ä½“çœ‹çœ‹è¯¥æ¨¡å¼çš„ä¼˜åŠ¿ã€‚

## ä»€ä¹ˆæ˜¯è£…é¥°å™¨æ¨¡å¼ï¼Ÿ

åœ¨è¿™ä¹‹å‰ï¼Œæˆ‘å…ˆç®€å•ä»‹ç»ä¸‹ä»€ä¹ˆæ˜¯è£…é¥°å™¨æ¨¡å¼ã€‚è£…é¥°å™¨æ¨¡å¼åŒ…æ‹¬äº†ä»¥ä¸‹å‡ ä¸ªè§’è‰²ï¼šæ¥å£ã€å…·ä½“å¯¹è±¡ã€è£…é¥°ç±»ã€å…·ä½“è£…é¥°ç±»ã€‚

æ¥å£å®šä¹‰äº†å…·ä½“å¯¹è±¡çš„ä¸€äº›å®ç°æ–¹æ³•ï¼›å…·ä½“å¯¹è±¡å®šä¹‰äº†ä¸€äº›åˆå§‹åŒ–æ“ä½œï¼Œæ¯”å¦‚å¼€å¤´è®¾è®¡è£…ä¿®åŠŸèƒ½çš„æ¡ˆä¾‹ä¸­ï¼Œæ°´ç”µè£…ä¿®ã€å¤©èŠ±æ¿ä»¥åŠç²‰åˆ·å¢™ç­‰éƒ½æ˜¯åˆå§‹åŒ–æ“ä½œï¼›è£…é¥°ç±»åˆ™æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä¸»è¦ç”¨æ¥åˆå§‹åŒ–å…·ä½“å¯¹è±¡çš„ä¸€ä¸ªç±»ï¼›å…¶å®ƒçš„å…·ä½“è£…é¥°ç±»éƒ½ç»§æ‰¿äº†è¯¥æŠ½è±¡ç±»ã€‚

ä¸‹é¢æˆ‘ä»¬å°±é€šè¿‡è£…é¥°å™¨æ¨¡å¼æ¥å®ç°ä¸‹è£…ä¿®åŠŸèƒ½ï¼Œä»£ç å¦‚ä¸‹ï¼š

```
/**
 * å®šä¹‰ä¸€ä¸ªåŸºæœ¬è£…ä¿®æ¥å£
 * @author admin
 *
 */
public interface IDecorator {
	
	/**
	 * è£…ä¿®æ–¹æ³•
	 */
	void decorate();

}
```

```
/**
 * è£…ä¿®åŸºæœ¬ç±»
 * @author admin
 *
 */
public class Decorator implements IDecorator{

	/**
	 * åŸºæœ¬å®ç°æ–¹æ³•
	 */
	public void decorate() {
		System.out.println("æ°´ç”µè£…ä¿®ã€å¤©èŠ±æ¿ä»¥åŠç²‰åˆ·å¢™ã€‚ã€‚ã€‚");
	}

}
```

```
/**
 * åŸºæœ¬è£…é¥°ç±»
 * @author admin
 *
 */
public abstract class BaseDecorator implements IDecorator{

	private IDecorator decorator;
	
	public BaseDecorator(IDecorator decorator) {
		this.decorator = decorator;
	}
	
	/**
	 * è°ƒç”¨è£…é¥°æ–¹æ³•
	 */
	public void decorate() {
		if(decorator != null) {
			decorator.decorate();
		}
	}
}
```

```
/**
 * çª—å¸˜è£…é¥°ç±»
 * @author admin
 *
 */
public class CurtainDecorator extends BaseDecorator{

	public CurtainDecorator(IDecorator decorator) {
		super(decorator);
	}
	
	/**
	 * çª—å¸˜å…·ä½“è£…é¥°æ–¹æ³•
	 */
	@Override
	public void decorate() {
		System.out.println("çª—å¸˜è£…é¥°ã€‚ã€‚ã€‚");
		super.decorate();
	}

}
```

```
    public static void main( String[] args )
    {
    	IDecorator decorator = new Decorator();
    	IDecorator curtainDecorator = new CurtainDecorator(decorator);
    	curtainDecorator.decorate();
        
    }
```

è¿è¡Œç»“æœï¼š

```
çª—å¸˜è£…é¥°ã€‚ã€‚ã€‚
æ°´ç”µè£…ä¿®ã€å¤©èŠ±æ¿ä»¥åŠç²‰åˆ·å¢™ã€‚ã€‚ã€‚
```

é€šè¿‡è¿™ä¸ªæ¡ˆä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£åˆ°ï¼šå¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨åŸºç¡€ç±»ä¸Šæ·»åŠ æ–°çš„è£…ä¿®åŠŸèƒ½ï¼Œåªéœ€è¦åŸºäºæŠ½è±¡ç±»BaseDecoratorå»å®ç°ç»§æ‰¿ç±»ï¼Œé€šè¿‡æ„é€ å‡½æ•°è°ƒç”¨çˆ¶ç±»ï¼Œä»¥åŠé‡å†™è£…ä¿®æ–¹æ³•å®ç°è£…ä¿®çª—å¸˜çš„åŠŸèƒ½å³å¯ã€‚åœ¨mainå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å®ä¾‹åŒ–è£…é¥°ç±»ï¼Œè°ƒç”¨è£…ä¿®æ–¹æ³•ï¼Œå³å¯åœ¨åŸºç¡€è£…ä¿®çš„å‰æä¸‹ï¼Œè·å¾—çª—å¸˜è£…ä¿®åŠŸèƒ½ã€‚

åŸºäºè£…é¥°å™¨æ¨¡å¼å®ç°çš„è£…ä¿®åŠŸèƒ½çš„ä»£ç ç»“æ„ç®€æ´æ˜“è¯»ï¼Œä¸šåŠ¡é€»è¾‘ä¹Ÿéå¸¸æ¸…æ™°ï¼Œå¹¶ä¸”å¦‚æœæˆ‘ä»¬éœ€è¦æ‰©å±•æ–°çš„è£…ä¿®åŠŸèƒ½ï¼Œåªéœ€è¦æ–°å¢ä¸€ä¸ªç»§æ‰¿äº†æŠ½è±¡è£…é¥°ç±»çš„å­ç±»å³å¯ã€‚

åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬ä»…å®ç°äº†ä¸šåŠ¡æ‰©å±•åŠŸèƒ½ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘å°†é€šè¿‡è£…é¥°å™¨æ¨¡å¼ä¼˜åŒ–ç”µå•†ç³»ç»Ÿä¸­çš„å•†å“ä»·æ ¼ç­–ç•¥ï¼Œå®ç°ä¸åŒä¿ƒé”€æ´»åŠ¨çš„çµæ´»ç»„åˆã€‚

## ä¼˜åŒ–ç”µå•†ç³»ç»Ÿä¸­çš„å•†å“ä»·æ ¼ç­–ç•¥

ç›¸ä¿¡ä½ ä¸€å®šä¸é™Œç”Ÿï¼Œè´­ä¹°å•†å“æ—¶ç»å¸¸ä¼šç”¨åˆ°çš„é™æ—¶æŠ˜æ‰£ã€çº¢åŒ…ã€æŠµæ‰£åˆ¸ä»¥åŠç‰¹æ®ŠæŠµæ‰£é‡‘ç­‰ï¼Œç§ç±»å¾ˆå¤šï¼Œå¦‚æœæ¢åˆ°å¼€å‘è§†è§’ï¼Œå®ç°èµ·æ¥å°±æ›´å¤æ‚äº†ã€‚

ä¾‹å¦‚ï¼Œæ¯é€¢åŒåä¸€ï¼Œä¸ºäº†åŠ å¤§å•†åŸçš„ä¼˜æƒ åŠ›åº¦ï¼Œå¼€å‘å¾€å¾€è¦è®¾è®¡çº¢åŒ…+é™æ—¶æŠ˜æ‰£æˆ–çº¢åŒ…+æŠµæ‰£åˆ¸ç­‰ç»„åˆæ¥å®ç°å¤šé‡ä¼˜æƒ ã€‚è€Œåœ¨å¹³æ—¶ï¼Œç”±äºæŸäº›ç‰¹æ®ŠåŸå› ï¼Œå•†å®¶è¿˜ä¼šèµ é€ç‰¹æ®ŠæŠµæ‰£åˆ¸ç»™è´­ä¹°ç”¨æˆ·ï¼Œè€Œç‰¹æ®ŠæŠµæ‰£åˆ¸+å„ç§ä¼˜æƒ åˆæ˜¯å¦ä¸€ç§ç»„åˆæ–¹å¼ã€‚

è¦å®ç°ä»¥ä¸Šè¿™ç±»ç»„åˆä¼˜æƒ çš„åŠŸèƒ½ï¼Œæœ€å¿«ã€æœ€æ™®éçš„å®ç°æ–¹å¼å°±æ˜¯é€šè¿‡å¤§é‡if-elseçš„æ–¹å¼æ¥å®ç°ã€‚ä½†è¿™ç§æ–¹å¼åŒ…å«äº†å¤§é‡çš„é€»è¾‘åˆ¤æ–­ï¼Œè‡´ä½¿å…¶ä»–å¼€å‘äººå‘˜å¾ˆéš¾è¯»æ‡‚ä¸šåŠ¡ï¼Œ å¹¶ä¸”ä¸€æ—¦æœ‰æ–°çš„ä¼˜æƒ ç­–ç•¥æˆ–è€…ä»·æ ¼ç»„åˆç­–ç•¥å‡ºç°ï¼Œå°±éœ€è¦ä¿®æ”¹ä»£ç é€»è¾‘ã€‚

è¿™æ—¶ï¼Œåˆšåˆšä»‹ç»çš„è£…é¥°å™¨æ¨¡å¼å°±å¾ˆé€‚åˆç”¨åœ¨è¿™é‡Œï¼Œå…¶ç›¸äº’ç‹¬ç«‹ã€è‡ªç”±ç»„åˆä»¥åŠæ–¹ä¾¿åŠ¨æ€æ‰©å±•åŠŸèƒ½çš„ç‰¹æ€§ï¼Œå¯ä»¥å¾ˆå¥½åœ°è§£å†³if-elseæ–¹å¼çš„å¼Šç«¯ã€‚ä¸‹é¢æˆ‘ä»¬å°±ç”¨è£…é¥°å™¨æ¨¡å¼åŠ¨æ‰‹å®ç°ä¸€å¥—å•†å“ä»·æ ¼ç­–ç•¥çš„ä¼˜åŒ–æ–¹æ¡ˆã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆå»ºç«‹è®¢å•å’Œå•†å“çš„å±æ€§ç±»ï¼Œåœ¨æœ¬æ¬¡æ¡ˆä¾‹ä¸­ï¼Œä¸ºäº†ä¿è¯ç®€æ´æ€§ï¼Œæˆ‘åªå»ºç«‹äº†å‡ ä¸ªå…³é”®å­—æ®µã€‚ä»¥ä¸‹å‡ ä¸ªé‡è¦å±æ€§å…³ç³»ä¸ºï¼Œä¸»è®¢å•åŒ…å«è‹¥å¹²è¯¦ç»†è®¢å•ï¼Œè¯¦ç»†è®¢å•ä¸­è®°å½•äº†å•†å“ä¿¡æ¯ï¼Œå•†å“ä¿¡æ¯ä¸­åŒ…å«äº†ä¿ƒé”€ç±»å‹ä¿¡æ¯ï¼Œä¸€ä¸ªå•†å“å¯ä»¥åŒ…å«å¤šä¸ªä¿ƒé”€ç±»å‹ï¼ˆæœ¬æ¡ˆä¾‹åªè®¨è®ºå•ä¸ªä¿ƒé”€å’Œç»„åˆä¿ƒé”€ï¼‰ï¼š

```
/**
 * ä¸»è®¢å•
 * @author admin
 *
 */
public class Order {
	
	private int id; //è®¢å•ID
	private String orderNo; //è®¢å•å·
	private BigDecimal totalPayMoney; //æ€»æ”¯ä»˜é‡‘é¢
	private List<OrderDetail> list; //è¯¦ç»†è®¢å•åˆ—è¡¨
}
```

```
/**
 * è¯¦ç»†è®¢å•
 * @author admin
 *
 */
public class OrderDetail {
	private int id; //è¯¦ç»†è®¢å•ID
	private int orderId;//ä¸»è®¢å•ID
	private Merchandise merchandise; //å•†å“è¯¦æƒ…
	private BigDecimal payMoney; //æ”¯ä»˜å•ä»·
}
```

```
/**
 * å•†å“
 * @author admin
 *
 */
public class Merchandise {
	
	private String sku;//å•†å“SKU
	private String name; //å•†å“åç§°
	private BigDecimal price; //å•†å“å•ä»·
	private Map<PromotionType, SupportPromotions> supportPromotions; //æ”¯æŒä¿ƒé”€ç±»å‹
}
```

```
/**
 * ä¿ƒé”€ç±»å‹
 * @author admin
 *
 */
public class SupportPromotions implements Cloneable{

	private int id;//è¯¥å•†å“ä¿ƒé”€çš„ID
	private PromotionType promotionType;//ä¿ƒé”€ç±»å‹ 1\ä¼˜æƒ åˆ¸ 2\çº¢åŒ…
	private int priority; //ä¼˜å…ˆçº§
	private UserCoupon userCoupon; //ç”¨æˆ·é¢†å–è¯¥å•†å“çš„ä¼˜æƒ åˆ¸
	private UserRedPacket userRedPacket; //ç”¨æˆ·é¢†å–è¯¥å•†å“çš„çº¢åŒ…
	
	//é‡å†™cloneæ–¹æ³•
    public SupportPromotions clone(){
    	SupportPromotions supportPromotions = null;
        try{
        	supportPromotions = (SupportPromotions)super.clone();
        }catch(CloneNotSupportedException e){
            e.printStackTrace();
        }
        return supportPromotions;
    }
}
```

```
/**
 * ä¼˜æƒ åˆ¸
 * @author admin
 *
 */
public class UserCoupon {
	
	private int id; //ä¼˜æƒ åˆ¸ID
	private int userId; //é¢†å–ä¼˜æƒ åˆ¸ç”¨æˆ·ID
	private String sku; //å•†å“SKU
	private BigDecimal coupon; //ä¼˜æƒ é‡‘é¢
}
```

```
/**
 * çº¢åŒ…
 * @author admin
 *
 */
public class UserRedPacket {

	private int id; //çº¢åŒ…ID
	private int userId; //é¢†å–ç”¨æˆ·ID
	private String sku; //å•†å“SKU
	private BigDecimal redPacket; //é¢†å–çº¢åŒ…é‡‘é¢
}
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†å»ºç«‹ä¸€ä¸ªè®¡ç®—æ”¯ä»˜é‡‘é¢çš„æ¥å£ç±»ä»¥åŠåŸºæœ¬ç±»ï¼š

```
/**
 * è®¡ç®—æ”¯ä»˜é‡‘é¢æ¥å£ç±»
 * @author admin
 *
 */
public interface IBaseCount {
	
	BigDecimal countPayMoney(OrderDetail orderDetail);

}
```

```
/**
 * æ”¯ä»˜åŸºæœ¬ç±»
 * @author admin
 *
 */
public class BaseCount implements IBaseCount{

	public BigDecimal countPayMoney(OrderDetail orderDetail) {
orderDetail.setPayMoney(orderDetail.getMerchandise().getPrice());
		System.out.println("å•†å“åŸå•ä»·é‡‘é¢ä¸ºï¼š" +  orderDetail.getPayMoney());
		
		return orderDetail.getPayMoney();
	}

}
```

ç„¶åï¼Œæˆ‘ä»¬å†å»ºç«‹ä¸€ä¸ªè®¡ç®—æ”¯ä»˜é‡‘é¢çš„æŠ½è±¡ç±»ï¼Œç”±æŠ½è±¡ç±»è°ƒç”¨åŸºæœ¬ç±»ï¼š

```
/**
 * è®¡ç®—æ”¯ä»˜é‡‘é¢çš„æŠ½è±¡ç±»
 * @author admin
 *
 */
public abstract class BaseCountDecorator implements IBaseCount{
	
	private IBaseCount count;
	
	public BaseCountDecorator(IBaseCount count) {
		this.count = count;
	}

	public BigDecimal countPayMoney(OrderDetail orderDetail) {
		BigDecimal payTotalMoney = new BigDecimal(0);
		if(count!=null) {
			payTotalMoney = count.countPayMoney(orderDetail);
		}
		return payTotalMoney;
	}
}
```

ç„¶åï¼Œæˆ‘ä»¬å†é€šè¿‡ç»§æ‰¿æŠ½è±¡ç±»æ¥å®ç°æˆ‘ä»¬æ‰€éœ€è¦çš„ä¿®é¥°ç±»ï¼ˆä¼˜æƒ åˆ¸è®¡ç®—ç±»ã€çº¢åŒ…è®¡ç®—ç±»ï¼‰ï¼š

```
/**
 * è®¡ç®—ä½¿ç”¨ä¼˜æƒ åˆ¸åçš„é‡‘é¢
 * @author admin
 *
 */
public class CouponDecorator extends BaseCountDecorator{

	public CouponDecorator(IBaseCount count) {
		super(count);
	}
	
	public BigDecimal countPayMoney(OrderDetail orderDetail) {
		BigDecimal payTotalMoney = new BigDecimal(0);
		payTotalMoney = super.countPayMoney(orderDetail);
		payTotalMoney = countCouponPayMoney(orderDetail);
		return payTotalMoney;
	}
	
	private BigDecimal countCouponPayMoney(OrderDetail orderDetail) {
		
		BigDecimal coupon =  orderDetail.getMerchandise().getSupportPromotions().get(PromotionType.COUPON).getUserCoupon().getCoupon();
		System.out.println("ä¼˜æƒ åˆ¸é‡‘é¢ï¼š" + coupon);
		
		orderDetail.setPayMoney(orderDetail.getPayMoney().subtract(coupon));
		return orderDetail.getPayMoney();
	}
}
```

```
/**
 * è®¡ç®—ä½¿ç”¨çº¢åŒ…åçš„é‡‘é¢
 * @author admin
 *
 */
public class RedPacketDecorator extends BaseCountDecorator{

	public RedPacketDecorator(IBaseCount count) {
		super(count);
	}
	
	public BigDecimal countPayMoney(OrderDetail orderDetail) {
		BigDecimal payTotalMoney = new BigDecimal(0);
		payTotalMoney = super.countPayMoney(orderDetail);
		payTotalMoney = countCouponPayMoney(orderDetail);
		return payTotalMoney;
	}
	
	private BigDecimal countCouponPayMoney(OrderDetail orderDetail) {
		
		BigDecimal redPacket = orderDetail.getMerchandise().getSupportPromotions().get(PromotionType.REDPACKED).getUserRedPacket().getRedPacket();
		System.out.println("çº¢åŒ…ä¼˜æƒ é‡‘é¢ï¼š" + redPacket);
		
		orderDetail.setPayMoney(orderDetail.getPayMoney().subtract(redPacket));
		return orderDetail.getPayMoney();
	}
}
```

æœ€åï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå·¥å‚ç±»æ¥ç»„åˆå•†å“çš„ä¿ƒé”€ç±»å‹ï¼š

```
/**
 * è®¡ç®—ä¿ƒé”€åçš„æ”¯ä»˜ä»·æ ¼
 * @author admin
 *
 */
public class PromotionFactory {
	
	public static BigDecimal getPayMoney(OrderDetail orderDetail) {
		
		//è·å–ç»™å•†å“è®¾å®šçš„ä¿ƒé”€ç±»å‹
		Map<PromotionType, SupportPromotions> supportPromotionslist = orderDetail.getMerchandise().getSupportPromotions();
		
		//åˆå§‹åŒ–è®¡ç®—ç±»
		IBaseCount baseCount = new BaseCount();
		if(supportPromotionslist!=null && supportPromotionslist.size()>0) {
			for(PromotionType promotionType: supportPromotionslist.keySet()) {//éå†è®¾ç½®çš„ä¿ƒé”€ç±»å‹ï¼Œé€šè¿‡è£…é¥°å™¨ç»„åˆä¿ƒé”€ç±»å‹
				baseCount = protmotion(supportPromotionslist.get(promotionType), baseCount);
			}
		}
		return baseCount.countPayMoney(orderDetail);
	}
	
	/**
	 * ç»„åˆä¿ƒé”€ç±»å‹
	 * @param supportPromotions
	 * @param baseCount
	 * @return
	 */
	private static IBaseCount protmotion(SupportPromotions supportPromotions, IBaseCount baseCount) {
		if(supportPromotions.getPromotionType()==PromotionType.COUPON) {
			baseCount = new CouponDecorator(baseCount);
		}else if(supportPromotions.getPromotionType()==PromotionType.REDPACKED) {
			baseCount = new RedPacketDecorator(baseCount);
		}
		return baseCount;
	}

}
```

```
    public static void main( String[] args ) throws InterruptedException, IOException
    {
    	Order order = new Order();
    	init(order);
    	
    	for(OrderDetail orderDetail: order.getList()) {
    		BigDecimal payMoney = PromotionFactory.getPayMoney(orderDetail);
    		orderDetail.setPayMoney(payMoney);
    		System.out.println("æœ€ç»ˆæ”¯ä»˜é‡‘é¢ï¼š" + orderDetail.getPayMoney());
    	}
    }
```

è¿è¡Œç»“æœï¼š

```
å•†å“åŸå•ä»·é‡‘é¢ä¸ºï¼š20
ä¼˜æƒ åˆ¸é‡‘é¢ï¼š3
çº¢åŒ…ä¼˜æƒ é‡‘é¢ï¼š10
æœ€ç»ˆæ”¯ä»˜é‡‘é¢ï¼š7
```

ä»¥ä¸Šæºç å¯ä»¥é€šè¿‡ [Github](https://github.com/nickliuchao/decorator.git) ä¸‹è½½è¿è¡Œã€‚é€šè¿‡ä»¥ä¸Šæ¡ˆä¾‹å¯çŸ¥ï¼šä½¿ç”¨è£…é¥°å™¨æ¨¡å¼è®¾è®¡çš„ä»·æ ¼ä¼˜æƒ ç­–ç•¥ï¼Œå®ç°å„ä¸ªä¿ƒé”€ç±»å‹çš„è®¡ç®—åŠŸèƒ½éƒ½æ˜¯ç›¸äº’ç‹¬ç«‹çš„ç±»ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡å·¥å‚ç±»è‡ªç”±ç»„åˆå„ç§ä¿ƒé”€ç±»å‹ã€‚

## æ€»ç»“

è¿™è®²ä»‹ç»çš„è£…é¥°å™¨æ¨¡å¼ä¸»è¦ç”¨æ¥ä¼˜åŒ–ä¸šåŠ¡çš„å¤æ‚åº¦ï¼Œå®ƒä¸ä»…ç®€åŒ–äº†æˆ‘ä»¬çš„ä¸šåŠ¡ä»£ç ï¼Œè¿˜ä¼˜åŒ–äº†ä¸šåŠ¡ä»£ç çš„ç»“æ„è®¾è®¡ï¼Œä½¿å¾—æ•´ä¸ªä¸šåŠ¡é€»è¾‘æ¸…æ™°ã€æ˜“è¯»æ˜“æ‡‚ã€‚

é€šå¸¸ï¼Œè£…é¥°å™¨æ¨¡å¼ç”¨äºæ‰©å±•ä¸€ä¸ªç±»çš„åŠŸèƒ½ï¼Œä¸”æ”¯æŒåŠ¨æ€æ·»åŠ å’Œåˆ é™¤ç±»çš„åŠŸèƒ½ã€‚åœ¨è£…é¥°å™¨æ¨¡å¼ä¸­ï¼Œè£…é¥°ç±»å’Œè¢«è£…é¥°ç±»éƒ½åªå…³å¿ƒè‡ªèº«çš„ä¸šåŠ¡ï¼Œä¸ç›¸äº’å¹²æ‰°ï¼ŒçœŸæ­£å®ç°äº†è§£è€¦ã€‚

## æ€è€ƒé¢˜

è´£ä»»é“¾æ¨¡å¼ã€ç­–ç•¥æ¨¡å¼ä¸è£…é¥°å™¨æ¨¡å¼æœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ã€‚å¹³æ—¶ï¼Œè¿™äº›è®¾è®¡æ¨¡å¼é™¤äº†åœ¨ä¸šåŠ¡ä¸­è¢«ç”¨åˆ°ä»¥å¤–ï¼Œåœ¨æ¶æ„è®¾è®¡ä¸­ä¹Ÿç»å¸¸è¢«ç”¨åˆ°ï¼Œä½ æ˜¯å¦åœ¨æºç ä¸­è§è¿‡è¿™å‡ ç§è®¾è®¡æ¨¡å¼çš„ä½¿ç”¨åœºæ™¯å‘¢ï¼Ÿæ¬¢è¿ä½ ä¸å¤§å®¶åˆ†äº«ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ15ï¼‰</strong></div><ul>
<li><span>å¯†ç 123456</span> ğŸ‘ï¼ˆ50ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>è´£ä»»é“¾ã€‚æœ€å¸¸è§åˆ°çš„å°±æ˜¯æ¥æ”¶httpè¯·æ±‚äº†ã€‚å¸®æˆ‘ä»¬è½¬ç ï¼Œè½¬åŒ–æˆå®ä½“ç±»ï¼Œç­‰ç­‰ã€‚ç­–ç•¥æ¨¡å¼ã€‚æœ€å¸¸ç®€å•å’Œç”¨åˆ°çš„å°±æ˜¯é›†åˆæ’åºï¼Œè‡ªå®šä¹‰æ’åºè§„åˆ™ã€‚è£…é¥°å™¨ï¼Œæœ€å¸¸è§åˆ°çš„å°±æ˜¯å„ç§æµï¼Œæ¯”å¦‚å­—ç¬¦æµï¼Œå­—èŠ‚æµç­‰</p>2019-08-01</li><br/><li><span>nightmare</span> ğŸ‘ï¼ˆ23ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>nettyä¸­çš„pipelineï¼Œtomcatä¸­çš„filterï¼Œå±äºè´£ä»»é“¾ï¼Œ   springmvcä¸­å¯¹å‚æ•°è§£æçš„å°±æ˜¯ ç­–ç•¥æ¨¡å¼ï¼Œæ¯ä¸€ä¸ªå‚æ•°ç±»å‹ä¸€ä¸ªå®ç°ç±»ï¼Œç”¨forå¾ªç¯è§£æå‚æ•°     java. ioå°±æ˜¯ç»å…¸çš„è£…é¥°å™¨æ¨¡å¼</p>2019-08-01</li><br/><li><span>å°”ä¸œæ©™</span> ğŸ‘ï¼ˆ8ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼Œä¸ºä»€ä¹ˆjava ioæ˜¯è£…é¥°å™¨æ¨¡å¼</p>2019-09-01</li><br/><li><span>neohope</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆæ‚¨å¥½ï¼Œæƒ³è¯·æ•™ä¸€ä¸‹ï¼Œåœ¨å®é™…åšä¼˜æƒ æ´»åŠ¨æ—¶ï¼Œå¾ˆå¤šæ´»åŠ¨ç­–ç•¥ä¹‹é—´æ˜¯ç›¸äº’æ’æ–¥çš„ï¼Œç”¨äº†ä¼˜æƒ 1å°±ä¸èƒ½ç”¨ä¼˜æƒ 2ï¼Œç”¨äº†ä¼˜æƒ 2å°±ä¸èƒ½ç”¨çº¢åŒ…ã€‚è¿™ç§è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜ä¼˜æƒ ç­–ç•¥ï¼Œåœ¨å“ªé‡Œå®ç°æ¯”è¾ƒåˆç†å‘¢ï¼Ÿå¤šè°¢ï¼</p>2019-11-24</li><br/><li><span>å³°</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æ„Ÿè§‰è€å¸ˆåœ¨çº¢åŒ…è¿™ä¸ªä¾‹å­é‡Œé¢ï¼Œå…¶å®æœ€é‡è¦çš„è§£è€¦æ˜¯è£…é¥°å™¨å®ç°çš„å„ç§åŸºæœ¬çš„ä¼˜æƒ æ‰“æŠ˜æ‰‹æ®µä¸å·¥å‚çš„å„ç§ä¼˜æƒ è§„åˆ™æ¯”å¦‚çº¢åŒ…æŠµç”¨åˆ¸å¯å åŠ ç­‰ç­‰ã€‚
</p>2019-08-02</li><br/><li><span>å†¯ä¼ åš</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ4ï¼‰<p>å¸Œæœ›èƒ½æœ‰ä¸ªç±»å›¾ï¼Œè¿™æ ·å°±èƒ½ä¸€ç›®äº†ç„¶çš„çœ‹æ¸…æ¥šå„ä¸ªç±»ä¹‹é—´çš„å…³ç³»äº†</p>2019-08-01</li><br/><li><span>Liam</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è¯·é—®è€å¸ˆï¼Œè£…é¥°å™¨å’Œä»£ç†æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Œä»£ç†ä¹Ÿå¯ä»¥å®ç°è¢«ä»£ç†çš„æ¥å£ï¼Œå¹¶æ³¨å…¥è¢«ä»£ç†å¯¹è±¡å®ç°åŠŸèƒ½æ‰©å±•ï¼Œæœ€åå¯ä»¥å§”æ‰˜è¢«ä»£ç†å¯¹è±¡å®ŒæˆåŸºç¡€åŠŸèƒ½</p>2019-08-06</li><br/><li><span>-W.LI-</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>public BigDecimal countPayMoney(OrderDetail orderDetail) {
		BigDecimal payTotalMoney = new BigDecimal(0);
		payTotalMoney = super.countPayMoney(orderDetail);
		payTotalMoney = countCouponPayMoney(orderDetail);
		return payTotalMoney;
	}
è€å¸ˆå¥½!è¿™é‡Œä¸ºå•¥è¦è°ƒç”¨çˆ¶ç±»çš„countPayMoney()æ–¹æ³•å•Š?
è´£ä»»é“¾æ¨¡å¼:æ„Ÿè§‰è´£ä»»è¿æ¨¡å¼æ¯”è¾ƒå›ºå®šä¸æ€ä¹ˆä¼šå˜ä¸€å±‚å¾€ä¸€å±‚è°ƒç”¨ï¼Œè§£è€¦ï¼ŒæŸä¸€å±‚å˜äº†ä¸å½±å“åˆ«çš„å±‚ã€‚
ç­–ç•¥æ¨¡å¼:ç­–ç•¥æ¨¡å¼ï¼Œè™½ç„¶ä¹Ÿæ˜¯å°è£…äº†å¾ˆå¤šä¸åŒçš„ç­–ç•¥ï¼Œä½†æ˜¯ä½¿ç”¨æ—¶ä¸€èˆ¬ä¸€æ¬¡åªé€‰ä¸€ä¸ªå®ç°ç±»ä½¿ç”¨ï¼Œä¸ä¼šæœ‰åµŒå¥—ã€‚
è£…é¥°è€…æ¨¡å¼:è´£ä»»é“¾æœ‰çš„ä¼˜ç‚¹ä»–éƒ½æœ‰ï¼Œè£…é¥°è€…è¿˜èƒ½åŠ¨æ€ç»„åˆã€‚
è°¢è°¢è€å¸ˆï¼Œå¸Œæœ›ç»™å‡ºè¯¦ç»†ç­”æ¡ˆè°¢è°¢</p>2019-08-01</li><br/><li><span>å¥‹æ–—çš„å°ç™½é¼ </span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼Œé—®ä¸€ä¸ªå°ç™½é—®é¢˜ï¼Œäº§å“Map&lt;PromotionType, SupportPromotions&gt; supportPromotions; &#47;&#47;æ”¯æŒä¿ƒé”€ç±»å‹  æ€ä¹ˆå­˜å…¥æ•°æ®åº“äº†ï¼Ÿ</p>2019-12-04</li><br/><li><span>ä¾ç„¶äº¦æ™¨</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼Œæœ‰ä¸ªç–‘é—®ï¼Œä¿ƒé”€ç±»å‹ç±»é‡Œçœ‹åˆ°ç”¨äº†cloneæ–¹æ³•ï¼ŒåŸå‹æ¨¡å¼ï¼Œä¸ºä»€ä¹ˆåè¾¹éƒ½æ²¡ç”¨è°ƒç”¨cloneæ–¹æ³•çš„åœ°æ–¹å‘¢ï¼Ÿ</p>2019-09-21</li><br/><li><span>é£è½»æ‰¬</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼Œè£…ä¿®åŠŸèƒ½é‡Œé¢çš„BaseDecoratorä¸ºä»€ä¹ˆè¦ç”¨abstractä¿®é¥°å‘¢ï¼Ÿä¹Ÿæ²¡æœ‰æŠ½è±¡æ–¹æ³•å‘¢</p>2019-09-16</li><br/><li><span>é’±</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ğŸ˜€è€å¸ˆï¼Œè£…é¥°å™¨æ¨¡å¼çš„æ€§èƒ½ä¼˜åŒ–ç‚¹åœ¨å“ªé‡Œï¼Ÿæ˜¯ä¸æ˜¯åŠ é€Ÿäº†ç ”å‘è°ƒæ•´ä»£ç æ‰©å±•ä»£ç çš„é€Ÿåº¦!</p>2019-09-13</li><br/><li><span>Gred</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼Œæ‚¨åœ¨SupportPromotionsé‡å†™ clone æ–¹æ³•ï¼Œåªå¯¹ç±»è¿›è¡Œæ‹·è´ï¼Œä½†æ˜¯æˆå‘˜å˜é‡åªæ˜¯æµ…æ‹·è´ï¼Œå¦‚æœè¦å®é™…åº”ç”¨ä¸šåŠ¡åœºæ™¯ï¼Œæ˜¯ä¸æ˜¯åº”è¯¥æ”¹ç”¨æ·±æ‹·è´ï¼Œé¿å…å…¶ä»–è®¢å•çš„ä¼˜åŒ–åˆ¸ç­‰ä¿¡æ¯å½±å“åˆ°äº†ã€‚</p>2019-08-13</li><br/><li><span>çŸ¥è¡Œåˆä¸€</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>BigDecimal payTotalMoney = new BigDecimal(0);
payTotalMoney = super.countPayMoney(orderDetail);
payTotalMoney = countCouponPayMoney(orderDetail);
payTotalMoneyä¸å°±è¢«è¦†ç›–äº†å—ï¼Ÿ</p>2019-08-08</li><br/><li><span>å¤©å¤©å‘ä¸Š</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æœ‰ä¸ªé—®é¢˜ï¼Œå¯¹äºä¸šåŠ¡ç³»ç»Ÿï¼Œéƒ½æ˜¯å¯¹æ•°æ®åº“çš„å¢åˆ æ”¹æŸ¥ï¼Œè¿™ç§çš„ï¼Œå¾ˆéš¾ç”¨åˆ°è®¾è®¡æ¨¡å¼å§ã€‚</p>2020-05-04</li><br/>
</ul>