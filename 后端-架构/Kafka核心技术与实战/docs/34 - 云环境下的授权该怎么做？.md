ä½ å¥½ï¼Œæˆ‘æ˜¯èƒ¡å¤•ã€‚ä»Šå¤©æˆ‘è¦åˆ†äº«çš„ä¸»é¢˜æ˜¯ï¼šKafkaçš„æˆæƒæœºåˆ¶ã€‚

## ä»€ä¹ˆæ˜¯æˆæƒæœºåˆ¶ï¼Ÿ

æˆ‘ä»¬åœ¨ä¸Šä¸€è®²ä¸­èŠ±äº†ä¸å°‘æ—¶é—´è®¨è®ºKafkaçš„è®¤è¯æœºåˆ¶ï¼Œä»Šå¤©æˆ‘ä»¬æ¥çœ‹çœ‹Kafkaçš„æˆæƒæœºåˆ¶ï¼ˆAuthorizationï¼‰ã€‚æ‰€è°“æˆæƒï¼Œä¸€èˆ¬æ˜¯æŒ‡å¯¹ä¸ä¿¡æ¯å®‰å…¨æˆ–è®¡ç®—æœºå®‰å…¨ç›¸å…³çš„èµ„æºæˆäºˆè®¿é—®æƒé™ï¼Œç‰¹åˆ«æ˜¯å­˜å–æ§åˆ¶ã€‚

å…·ä½“åˆ°æƒé™æ¨¡å‹ï¼Œå¸¸è§çš„æœ‰å››ç§ã€‚

- ACLï¼šAccess-Control Listï¼Œè®¿é—®æ§åˆ¶åˆ—è¡¨ã€‚
- RBACï¼šRole-Based Access Controlï¼ŒåŸºäºè§’è‰²çš„æƒé™æ§åˆ¶ã€‚
- ABACï¼šAttribute-Based Access Controlï¼ŒåŸºäºå±æ€§çš„æƒé™æ§åˆ¶ã€‚
- PBACï¼šPolicy-Based Access Controlï¼ŒåŸºäºç­–ç•¥çš„æƒé™æ§åˆ¶ã€‚

åœ¨å…¸å‹çš„äº’è”ç½‘åœºæ™¯ä¸­ï¼Œå‰ä¸¤ç§æ¨¡å‹åº”ç”¨å¾—å¤šï¼Œåé¢è¿™ä¸¤ç§åˆ™æ¯”è¾ƒå°‘ç”¨ã€‚

ACLæ¨¡å‹å¾ˆç®€å•ï¼Œå®ƒè¡¨å¾çš„æ˜¯ç”¨æˆ·ä¸æƒé™çš„ç›´æ¥æ˜ å°„å…³ç³»ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://static001.geekbang.org/resource/image/eb/ad/eb85325aa6858b45a53ecaae6e58d0ad.jpg?wh=1022%2A222)

è€ŒRBACæ¨¡å‹åˆ™åŠ å…¥äº†è§’è‰²çš„æ¦‚å¿µï¼Œæ”¯æŒå¯¹ç”¨æˆ·è¿›è¡Œåˆ†ç»„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://static001.geekbang.org/resource/image/43/aa/4368827128d1309709fe51199a11b7aa.jpg?wh=1162%2A222)

Kafkaæ²¡æœ‰ä½¿ç”¨RBACæ¨¡å‹ï¼Œå®ƒç”¨çš„æ˜¯ACLæ¨¡å‹ã€‚ç®€å•æ¥è¯´ï¼Œè¿™ç§æ¨¡å‹å°±æ˜¯è§„å®šäº†ä»€ä¹ˆç”¨æˆ·å¯¹ä»€ä¹ˆèµ„æºæœ‰ä»€ä¹ˆæ ·çš„è®¿é—®æƒé™ã€‚æˆ‘ä»¬å¯ä»¥å€Ÿç”¨å®˜ç½‘çš„ä¸€å¥è¯æ¥ç»Ÿä¸€è¡¨ç¤ºè¿™ç§æ¨¡å‹ï¼šâ€œ**Principal P is \[Allowed/Denied] Operation O From Host H On Resource R.**â€ è¿™å¥è¯ä¸­å‡ºç°äº†å¾ˆå¤šä¸ªä¸»ä½“ï¼Œæˆ‘æ¥åˆ†åˆ«è§£é‡Šä¸‹å®ƒä»¬çš„å«ä¹‰ã€‚

- Principalï¼šè¡¨ç¤ºè®¿é—®Kafkaé›†ç¾¤çš„ç”¨æˆ·ã€‚
- Operationï¼šè¡¨ç¤ºä¸€ä¸ªå…·ä½“çš„è®¿é—®ç±»å‹ï¼Œå¦‚è¯»å†™æ¶ˆæ¯æˆ–åˆ›å»ºä¸»é¢˜ç­‰ã€‚
- Hostï¼šè¡¨ç¤ºè¿æ¥Kafkaé›†ç¾¤çš„å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºIPåœ°å€ã€‚Hostæ”¯æŒæ˜Ÿå·å ä½ç¬¦ï¼Œè¡¨ç¤ºæ‰€æœ‰IPåœ°å€ã€‚
- Resourceï¼šè¡¨ç¤ºKafkaèµ„æºç±»å‹ã€‚å¦‚æœä»¥æœ€æ–°çš„2.3ç‰ˆæœ¬ä¸ºä¾‹ï¼ŒResourceå…±æœ‰5ç§ï¼Œåˆ†åˆ«æ˜¯TOPICã€CLUSTERã€GROUPã€TRANSACTIONALIDå’ŒDELEGATION TOKENã€‚

å½“å‰ï¼ŒKafkaæä¾›äº†ä¸€ä¸ªå¯æ’æ‹”çš„æˆæƒå®ç°æœºåˆ¶ã€‚è¯¥æœºåˆ¶ä¼šå°†ä½ é…ç½®çš„æ‰€æœ‰ACLé¡¹ä¿å­˜åœ¨ZooKeeperä¸‹çš„/kafka-aclèŠ‚ç‚¹ä¸­ã€‚ä½ å¯ä»¥é€šè¿‡Kafkaè‡ªå¸¦çš„kafka-aclsè„šæœ¬åŠ¨æ€åœ°å¯¹ACLé¡¹è¿›è¡Œå¢åˆ æ”¹æŸ¥ï¼Œå¹¶è®©å®ƒç«‹å³ç”Ÿæ•ˆã€‚

## å¦‚ä½•å¼€å¯ACLï¼Ÿ

åœ¨Kafkaä¸­ï¼Œå¼€å¯ACLçš„æ–¹æ³•ç‰¹åˆ«ç®€å•ï¼Œä½ åªéœ€è¦åœ¨Brokerç«¯çš„é…ç½®æ–‡ä»¶ä¸­å¢åŠ ä¸€è¡Œè®¾ç½®å³å¯ï¼Œä¹Ÿå°±æ˜¯åœ¨server.propertiesæ–‡ä»¶ä¸­é…ç½®ä¸‹é¢è¿™ä¸ªå‚æ•°å€¼ï¼š

```
authorizer.class.name=kafka.security.auth.SimpleAclAuthorizer
```

authorizer.class.nameå‚æ•°æŒ‡å®šäº†ACLæˆæƒæœºåˆ¶çš„å®ç°ç±»ã€‚å½“å‰Kafkaæä¾›äº†Authorizeræ¥å£ï¼Œå…è®¸ä½ å®ç°ä½ è‡ªå·±çš„æˆæƒæœºåˆ¶ï¼Œä½†æ›´å¸¸è§çš„åšæ³•ï¼Œè¿˜æ˜¯ç›´æ¥ä½¿ç”¨Kafkaè‡ªå¸¦çš„**SimpleAclAuthorizerå®ç°ç±»**ã€‚ä¸€æ—¦è®¾ç½®å¥½è¿™ä¸ªå‚æ•°çš„å€¼ï¼Œå¹¶ä¸”å¯åŠ¨Brokeråï¼Œè¯¥Brokerå°±é»˜è®¤å¼€å¯äº†ACLæˆæƒéªŒè¯ã€‚åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä½ éœ€è¦ä¸ºé›†ç¾¤ä¸­çš„æ¯å°Brokeréƒ½åšæ­¤è®¾ç½®ã€‚

## è¶…çº§ç”¨æˆ·ï¼ˆSuper Userï¼‰

åœ¨å¼€å¯äº†ACLæˆæƒä¹‹åï¼Œä½ è¿˜å¿…é¡»æ˜¾å¼åœ°ä¸ºä¸åŒç”¨æˆ·è®¾ç½®è®¿é—®æŸé¡¹èµ„æºçš„æƒé™ï¼Œå¦åˆ™ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæ²¡æœ‰é…ç½®ä»»ä½•ACLçš„èµ„æºæ˜¯ä¸èƒ½è¢«è®¿é—®çš„ã€‚ä¸è¿‡ï¼Œè¿™é‡Œä¹Ÿæœ‰ä¸€ä¸ªä¾‹å¤–ï¼š**è¶…çº§ç”¨æˆ·èƒ½å¤Ÿè®¿é—®æ‰€æœ‰çš„èµ„æºï¼Œå³ä½¿ä½ æ²¡æœ‰ä¸ºå®ƒä»¬è®¾ç½®ä»»ä½•ACLé¡¹**ã€‚

é‚£ä¹ˆï¼Œæˆ‘ä»¬å¦‚ä½•åœ¨ä¸€ä¸ªKafkaé›†ç¾¤ä¸­è®¾ç½®è¶…çº§ç”¨æˆ·å‘¢ï¼Ÿæ–¹æ³•å¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨Brokerç«¯çš„é…ç½®æ–‡ä»¶server.propertiesä¸­ï¼Œè®¾ç½®super.userså‚æ•°å³å¯ï¼Œæ¯”å¦‚ï¼š

```
super.users=User:superuser1;User:superuser2
```

**æ³¨æ„ï¼Œå¦‚æœä½ è¦ä¸€æ¬¡æ€§æŒ‡å®šå¤šä¸ªè¶…çº§ç”¨æˆ·ï¼Œé‚£ä¹ˆåˆ†éš”ç¬¦æ˜¯åˆ†å·è€Œä¸æ˜¯é€—å·ï¼Œè¿™æ˜¯ä¸ºäº†é¿å…å‡ºç°ç”¨æˆ·åä¸­åŒ…å«é€—å·ä»è€Œæ— æ³•åˆ†å‰²çš„é—®é¢˜**ã€‚

é™¤äº†è®¾ç½®super.userså‚æ•°ï¼ŒKafkaè¿˜æ”¯æŒå°†æ‰€æœ‰ç”¨æˆ·éƒ½é…ç½®æˆè¶…çº§ç”¨æˆ·çš„ç”¨æ³•ã€‚å¦‚æœæˆ‘ä»¬åœ¨server.propertiesæ–‡ä»¶ä¸­è®¾ç½®allow.everyone.if.no.acl.found=trueï¼Œé‚£ä¹ˆæ‰€æœ‰ç”¨æˆ·éƒ½å¯ä»¥è®¿é—®æ²¡æœ‰è®¾ç½®ä»»ä½•ACLçš„èµ„æºã€‚ä¸è¿‡ï¼Œæˆ‘ä¸ªäººä¸å¤ªå»ºè®®è¿›è¡Œè¿™æ ·çš„è®¾ç½®ã€‚æ¯•ç«Ÿï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œç‰¹åˆ«æ˜¯åœ¨é‚£äº›å¯¹å®‰å…¨æœ‰è¾ƒé«˜è¦æ±‚çš„ç¯å¢ƒä¸­ï¼Œé‡‡ç”¨ç™½åå•æœºåˆ¶è¦æ¯”é»‘åå•æœºåˆ¶æ›´åŠ ä»¤äººæ”¾å¿ƒã€‚

## kafka-aclsè„šæœ¬

åœ¨äº†è§£äº†Kafkaçš„ACLæ¦‚å¿µä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å¦‚ä½•è®¾ç½®å®ƒä»¬ã€‚å½“å‰åœ¨Kafkaä¸­ï¼Œé…ç½®æˆæƒçš„æ–¹æ³•æ˜¯é€šè¿‡kafka-aclsè„šæœ¬ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬è¦ä¸ºç”¨æˆ·Aliceå¢åŠ äº†é›†ç¾¤çº§åˆ«çš„æ‰€æœ‰æƒé™ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™æ®µå‘½ä»¤ã€‚

```
$ kafka-acls --authorizer-properties zookeeper.connect=localhost:2181 --add --allow-principal User:Alice --operation All --topic '*' --cluster
```

åœ¨è¿™ä¸ªå‘½ä»¤ä¸­ï¼ŒAllè¡¨ç¤ºæ‰€æœ‰æ“ä½œï¼Œtopicä¸­çš„æ˜Ÿå·åˆ™è¡¨ç¤ºæ‰€æœ‰ä¸»é¢˜ï¼ŒæŒ‡å®š --clusteråˆ™è¯´æ˜æˆ‘ä»¬è¦ä¸ºAliceè®¾ç½®çš„æ˜¯é›†ç¾¤æƒé™ã€‚

è¿™ä¸ªè„šæœ¬çš„å‚æ•°æœ‰å¾ˆå¤šï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹å®ƒçš„å¦ä¸€ä¸ªå¸¸è§ç”¨æ³•ã€‚

```
$ bin/kafka-acls --authorizer-properties zookeeper.connect=localhost:2181 --add --allow-principal User:'*' --allow-host '*' --deny-principal User:BadUser --deny-host 10.205.96.119 --operation Read --topic test-topic
```

Useråé¢çš„æ˜Ÿå·è¡¨ç¤ºæ‰€æœ‰ç”¨æˆ·ï¼Œallow-hoståé¢çš„æ˜Ÿå·åˆ™è¡¨ç¤ºæ‰€æœ‰IPåœ°å€ã€‚è¿™ä¸ªå‘½ä»¤çš„æ„æ€æ˜¯ï¼Œå…è®¸æ‰€æœ‰çš„ç”¨æˆ·ä½¿ç”¨ä»»æ„çš„IPåœ°å€è¯»å–åä¸ºtest-topicçš„ä¸»é¢˜æ•°æ®ï¼ŒåŒæ—¶ä¹Ÿç¦æ­¢BadUserç”¨æˆ·å’Œ10.205.96.119çš„IPåœ°å€è®¿é—®test-topicä¸‹çš„æ¶ˆæ¯ã€‚

kafka-aclsè„šæœ¬è¿˜æœ‰å…¶ä»–çš„åŠŸèƒ½ï¼Œæ¯”å¦‚åˆ é™¤ACLã€æŸ¥è¯¢å·²æœ‰ACLç­‰ã€‚å®ƒä»¬çš„å®é™…ç”¨æ³•ä¸ä¸Šé¢è¿™æ¡å‘½ä»¤ç±»ä¼¼ï¼Œæˆ‘åœ¨è¿™é‡Œå°±ä¸ä¸€ä¸€åˆ—ä¸¾äº†ï¼Œä½ å¯ä»¥ä½¿ç”¨kafka-acls.shæ¥æŸ¥è¯¢å®ƒçš„æ‰€æœ‰ç”¨æ³•ã€‚

## ACLæƒé™åˆ—è¡¨

åˆšæ‰çš„è¿™ä¸¤æ¡å‘½ä»¤ï¼Œåˆ†åˆ«æ¶‰åŠäº†ä¸»é¢˜çš„é›†ç¾¤æƒé™å’Œè¯»æƒé™ã€‚ä½ å¯èƒ½ä¼šé—®ï¼ŒKafkaåˆ°åº•æä¾›äº†å¤šå°‘ç§ACLæƒé™å‘¢ï¼Ÿæˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹ä¸‹é¢è¿™å¼ è¡¨æ ¼ï¼Œå®ƒå®Œæ•´åœ°å±•ç¤ºäº†Kafkaæ‰€æœ‰çš„ACLæƒé™ã€‚

![](https://static001.geekbang.org/resource/image/62/bc/620bc02b57c49fa2d7390c698db515bc.jpg?wh=1683%2A8403)

çœ‹åˆ°è¿™ä¹ˆå¤§ä¸€å¼ è¡¨æ ¼ï¼Œä½ æ˜¯ä¸æ˜¯å¾ˆæƒŠè®¶ï¼Ÿå…¶å®ï¼Œè¿™æ°å¥½è¯æ˜Kafkaå½“å‰æä¾›çš„æˆæƒæœºåˆ¶æ˜¯éå¸¸ç»†ç²’åº¦çš„ã€‚ç°åœ¨ï¼Œæˆ‘æ¥è·Ÿä½ åˆ†äº«ä¸€ä¸‹è¿™ä¸ªè¡¨æ ¼çš„ä½¿ç”¨æ–¹æ³•ã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œå‡å¦‚ä½ è¦ä¸ºä½ çš„ç”Ÿäº§è€…ç¨‹åºèµ‹äºˆå†™æƒé™ï¼Œé‚£ä¹ˆé¦–å…ˆï¼Œä½ è¦åœ¨Resourceåˆ—æ‰¾åˆ°Topicç±»å‹çš„æƒé™ï¼Œç„¶ååœ¨Operationåˆ—å¯»æ‰¾WRITEæ“ä½œæƒé™ã€‚è¿™ä¸ªWRITEæƒé™æ˜¯é™åˆ¶Producerç¨‹åºèƒ½å¦å‘å¯¹åº”ä¸»é¢˜å‘é€æ¶ˆæ¯çš„å…³é”®ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼ŒProducerç¨‹åºè¿˜å¯èƒ½æœ‰**åˆ›å»ºä¸»é¢˜ã€è·å–ä¸»é¢˜æ•°æ®**çš„æƒé™ï¼Œæ‰€ä»¥Kafkaä¸ºProduceréœ€è¦çš„è¿™äº›å¸¸è§æƒé™åˆ›å»ºäº†å¿«æ·æ–¹å¼ï¼Œå³ --producerã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ‰§è¡Œkafka-aclså‘½ä»¤æ—¶ï¼Œç›´æ¥æŒ‡å®š --producerå°±èƒ½åŒæ—¶è·å¾—è¿™ä¸‰ä¸ªæƒé™äº†ã€‚ --consumerä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼ŒæŒ‡å®š --consumerå¯ä»¥åŒæ—¶è·å¾—Consumerç«¯åº”ç”¨æ‰€éœ€çš„æƒé™ã€‚

## æˆæƒæœºåˆ¶èƒ½å¦å•ç‹¬ä½¿ç”¨ï¼Ÿ

å…³äºæˆæƒï¼Œæœ‰ä¸€ä¸ªå¾ˆå¸¸è§çš„é—®é¢˜æ˜¯ï¼ŒKafkaæˆæƒæœºåˆ¶èƒ½ä¸é…ç½®è®¤è¯æœºåˆ¶è€Œå•ç‹¬ä½¿ç”¨å—ï¼Ÿå…¶å®ï¼Œè¿™æ˜¯å¯ä»¥çš„ï¼Œåªæ˜¯ä½ åªèƒ½ä¸ºIPåœ°å€è®¾ç½®æƒé™ã€‚æ¯”å¦‚ï¼Œä¸‹é¢è¿™ä¸ªå‘½ä»¤ä¼šç¦æ­¢è¿è¡Œåœ¨127.0.0.1IPåœ°å€ä¸Šçš„Produceråº”ç”¨å‘testä¸»é¢˜å‘é€æ•°æ®ï¼š

```
$ bin/kafka-acls.sh --authorizer-properties zookeeper.connect=localhost:2181 --add --deny-principal User:* --deny-host 127.0.0.1 --operation Write --topic test

$ bin/kafka-console-producer.sh --broker-list localhost:9092 --topic test
>hello
[2019-07-16 10:10:57,283] WARN [Producer clientId=console-producer] Error while fetching metadata with correlation id 3 : {test=TOPIC_AUTHORIZATION_FAILED} (org.apache.kafka.clients.NetworkClient)
[2019-07-16 10:10:57,284] ERROR [Producer clientId=console-producer] Topic authorization failed for topics [test] (org.apache.kafka.clients.Metadata)
[2019-07-16 10:10:57,284] ERROR Error when sending message to topic test with key: null, value: 5 bytes with error: (org.apache.kafka.clients.producer.internals.ErrorLoggingCallback)
org.apache.kafka.common.errors.TopicAuthorizationException: Not authorized to access topics: [test]
```

è¯·æ³¨æ„ä¸€ä¸‹è¾“å‡ºä¸­çš„æ©™è‰²å­—ä½“éƒ¨åˆ†ã€‚è™½ç„¶æ²¡æœ‰è®¾ç½®ä»»ä½•è®¤è¯æœºåˆ¶ï¼Œä½†æ˜¯é€šè¿‡è®¾ç½®IPåœ°å€çš„ACLæˆæƒï¼Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥ç¦æ­¢è¿™äº›IPåœ°å€ä¸Šçš„å®¢æˆ·ç«¯è®¿é—®Kafkaèµ„æºã€‚ä¸è¿‡ï¼Œå°½ç®¡æˆæƒæœºåˆ¶èƒ½å¤Ÿæœ‰é™åº¦åœ°å•ç‹¬ä½¿ç”¨ï¼Œä½†æˆ‘æ›´æ¨èçš„åšæ³•æ˜¯ï¼Œå’Œæˆ‘ä»¬åœ¨ä¸“æ ä¸Šä¸€è®²æåˆ°çš„è®¤è¯æœºåˆ¶æ­é…ä½¿ç”¨ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘æ¥ç»™å‡ºä¸€ä¸ªSSL + ACLé…ç½®çš„å®ä¾‹ï¼Œæ¥æ¼”ç¤ºä¸€ä¸‹äº‘ç¯å¢ƒä¸‹çš„ACLæˆæƒåº”è¯¥æ€ä¹ˆåšã€‚

## é…ç½®å®ä¾‹

åœ¨æ¼”ç¤ºACLä¹‹å‰ï¼Œæˆ‘å…ˆç®€å•è¯´ä¸€ä¸‹SSLçš„é…ç½®ã€‚æˆ‘ç»™å‡ºä¸€ä¸ªSHELLè„šæœ¬ï¼Œå®ƒå¯ä»¥æ–¹ä¾¿ä½ è®¾ç½®SSLï¼Œä»£ç å¦‚ä¸‹ï¼š

```
#!/bin/bash

#è®¾ç½®ç¯å¢ƒå˜é‡
BASE_DIR=/Users/huxi/testenv #ä½ éœ€è¦ä¿®æ”¹æ­¤å¤„
CERT_OUTPUT_PATH="$BASE_DIR/certificates"
PASSWORD=test1234
KEY_STORE="$CERT_OUTPUT_PATH/server.keystore.jks"
TRUST_STORE="$CERT_OUTPUT_PATH/server.truststore.jks"
CLIENT_KEY_STORE="$CERT_OUTPUT_PATH/client.keystore.jks"
CLIENT_TRUST_STORE="$CERT_OUTPUT_PATH/client.truststore.jks"
KEY_PASSWORD=$PASSWORD
STORE_PASSWORD=$PASSWORD
TRUST_KEY_PASSWORD=$PASSWORD
TRUST_STORE_PASSWORD=$PASSWORD
CERT_AUTH_FILE="$CERT_OUTPUT_PATH/ca-cert"
DAYS_VALID=365
DNAME="CN=Xi Hu, OU=YourDept, O=YourCompany, L=Beijing, ST=Beijing, C=CN"


mkdir -p $CERT_OUTPUT_PATH

echo "1. äº§ç”Ÿkeyå’Œè¯ä¹¦......"
keytool -keystore $KEY_STORE -alias kafka-server -validity $DAYS_VALID -genkey -keyalg RSA \
-storepass $STORE_PASSWORD -keypass $KEY_PASSWORD -dname "$DNAME"

keytool -keystore $CLIENT_KEY_STORE -alias kafka-client -validity $DAYS_VALID -genkey -keyalg RSA \
-storepass $STORE_PASSWORD -keypass $KEY_PASSWORD -dname "$DNAME"

echo "2. åˆ›å»ºCA......"
openssl req -new -x509 -keyout $CERT_OUTPUT_PATH/ca-key -out "$CERT_AUTH_FILE" -days "$DAYS_VALID" \
-passin pass:"$PASSWORD" -passout pass:"$PASSWORD" \
-subj "/C=CN/ST=Beijing/L=Beijing/O=YourCompany/OU=YourDept,CN=Xi Hu"

echo "3. æ·»åŠ CAæ–‡ä»¶åˆ°broker truststore......"
keytool -keystore "$TRUST_STORE" -alias CARoot \
-importcert -file "$CERT_AUTH_FILE" -storepass "$TRUST_STORE_PASSWORD" -keypass "$TRUST_KEY_PASS" -noprompt

echo "4. æ·»åŠ CAæ–‡ä»¶åˆ°client truststore......"
keytool -keystore "$CLIENT_TRUST_STORE" -alias CARoot \
-importcert -file "$CERT_AUTH_FILE" -storepass "$TRUST_STORE_PASSWORD" -keypass "$TRUST_KEY_PASS" -noprompt

echo "5. ä»keystoreä¸­å¯¼å‡ºé›†ç¾¤è¯ä¹¦......"
keytool -keystore "$KEY_STORE" -alias kafka-server -certreq -file "$CERT_OUTPUT_PATH/server-cert-file" \
-storepass "$STORE_PASSWORD" -keypass "$KEY_PASSWORD" -noprompt

keytool -keystore "$CLIENT_KEY_STORE" -alias kafka-client -certreq -file "$CERT_OUTPUT_PATH/client-cert-file" \
-storepass "$STORE_PASSWORD" -keypass "$KEY_PASSWORD" -noprompt

echo "6. ä½¿ç”¨CAç­¾å‘è¯ä¹¦......"
openssl x509 -req -CA "$CERT_AUTH_FILE" -CAkey $CERT_OUTPUT_PATH/ca-key -in "$CERT_OUTPUT_PATH/server-cert-file" \
-out "$CERT_OUTPUT_PATH/server-cert-signed" -days "$DAYS_VALID" -CAcreateserial -passin pass:"$PASSWORD"

openssl x509 -req -CA "$CERT_AUTH_FILE" -CAkey $CERT_OUTPUT_PATH/ca-key -in "$CERT_OUTPUT_PATH/client-cert-file" \
-out "$CERT_OUTPUT_PATH/client-cert-signed" -days "$DAYS_VALID" -CAcreateserial -passin pass:"$PASSWORD"

echo "7. å¯¼å…¥CAæ–‡ä»¶åˆ°keystore......"
keytool -keystore "$KEY_STORE" -alias CARoot -import -file "$CERT_AUTH_FILE" -storepass "$STORE_PASSWORD" \
 -keypass "$KEY_PASSWORD" -noprompt

keytool -keystore "$CLIENT_KEY_STORE" -alias CARoot -import -file "$CERT_AUTH_FILE" -storepass "$STORE_PASSWORD" \
 -keypass "$KEY_PASSWORD" -noprompt

echo "8. å¯¼å…¥å·²ç­¾å‘è¯ä¹¦åˆ°keystore......"
keytool -keystore "$KEY_STORE" -alias kafka-server -import -file "$CERT_OUTPUT_PATH/server-cert-signed" \
 -storepass "$STORE_PASSWORD" -keypass "$KEY_PASSWORD" -noprompt

keytool -keystore "$CLIENT_KEY_STORE" -alias kafka-client -import -file "$CERT_OUTPUT_PATH/client-cert-signed" \
 -storepass "$STORE_PASSWORD" -keypass "$KEY_PASSWORD" -noprompt

echo "9. åˆ é™¤ä¸´æ—¶æ–‡ä»¶......"
rm "$CERT_OUTPUT_PATH/ca-cert.srl"
rm "$CERT_OUTPUT_PATH/server-cert-signed"
rm "$CERT_OUTPUT_PATH/client-cert-signed"
rm "$CERT_OUTPUT_PATH/server-cert-file"
rm "$CERT_OUTPUT_PATH/client-cert-file"
```

ä½ å¯ä»¥æŠŠä¸Šé¢çš„ä»£ç ä¿å­˜æˆä¸€ä¸ªSHELLè„šæœ¬ï¼Œç„¶ååœ¨ä¸€å°Brokerä¸Šè¿è¡Œã€‚è¯¥è„šæœ¬ä¸»è¦çš„äº§å‡ºæ˜¯4ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯ï¼šserver.keystore.jksã€server.truststore.jksã€client.keystore.jkså’Œclient.truststore.jksã€‚

ä½ éœ€è¦æŠŠä»¥serverå¼€å¤´çš„ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ‹·è´åˆ°é›†ç¾¤ä¸­çš„æ‰€æœ‰Brokeræœºå™¨ä¸Šï¼ŒæŠŠä»¥clientå¼€å¤´çš„ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ‹·è´åˆ°æ‰€æœ‰è¦è¿æ¥Kafkaé›†ç¾¤çš„å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºæœºå™¨ä¸Šã€‚

æ¥ç€ï¼Œä½ è¦é…ç½®æ¯ä¸ªBrokerçš„server.propertiesæ–‡ä»¶ï¼Œå¢åŠ ä»¥ä¸‹å†…å®¹ï¼š

```
listeners=SSL://localhost:9093
ssl.truststore.location=/Users/huxi/testenv/certificates/server.truststore.jks
ssl.truststore.password=test1234
ssl.keystore.location=/Users/huxi/testenv/certificates/server.keystore.jks
ssl.keystore.password=test1234
security.inter.broker.protocol=SSL
ssl.client.auth=required
ssl.key.password=test1234
```

ç°åœ¨æˆ‘ä»¬å¯åŠ¨Brokerè¿›ç¨‹ã€‚å€˜è‹¥ä½ å‘ç°æ— æ³•å¯åŠ¨æˆ–å¯åŠ¨å¤±è´¥ï¼Œé‚£ä¹ˆä½ éœ€è¦æ£€æŸ¥ä¸€ä¸‹æŠ¥é”™ä¿¡æ¯ï¼Œçœ‹çœ‹å’Œä¸Šé¢çš„å“ªäº›é…ç½®æœ‰å…³ï¼Œç„¶åæœ‰é’ˆå¯¹æ€§åœ°è¿›è¡Œè°ƒæ•´ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥é…ç½®å®¢æˆ·ç«¯çš„SSLã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªåä¸ºclient-ssl.configçš„æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š

```
security.protocol=SSL
ssl.truststore.location=/Users/huxi/testenv/certificates/client.truststore.jks
ssl.truststore.password=test1234
ssl.keystore.location=/Users/huxi/testenv/certificates/server.keystore.jks
ssl.keystore.password=test1234
ssl.key.password=test1234
ssl.endpoint.identification.algorithm=
```

æ³¨æ„ï¼Œä¸€å®šè¦åŠ ä¸Šæœ€åä¸€è¡Œã€‚å› ä¸ºè‡ªKafka 2.0ç‰ˆæœ¬å¼€å§‹ï¼Œå®ƒé»˜è®¤ä¼šéªŒè¯æœåŠ¡å™¨ç«¯çš„ä¸»æœºåæ˜¯å¦åŒ¹é…Brokerç«¯è¯ä¹¦é‡Œçš„ä¸»æœºåã€‚å¦‚æœä½ è¦ç¦æ‰æ­¤åŠŸèƒ½çš„è¯ï¼Œä¸€å®šè¦å°†è¯¥å‚æ•°è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²ã€‚

é…ç½®å¥½è¿™äº›ï¼Œä½ å¯ä»¥ä½¿ç”¨ConsoleConsumerå’ŒConsoleProduceræ¥æµ‹è¯•ä¸€ä¸‹Producerå’ŒConsumeræ˜¯å¦èƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚æ¯”å¦‚ï¼Œä¸‹åˆ—å‘½ä»¤æŒ‡å®šproducer-configæŒ‡å‘åˆšæ‰æˆ‘ä»¬åˆ›å»ºçš„client-sslé…ç½®æ–‡ä»¶ã€‚

```
$ bin/kafka-console-producer.sh --broker-list localhost:9093 --topic test --producer.config client-ssl.config
```

å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬æ¥è¯´è¯´ACLçš„é…ç½®ã€‚

å¦‚æœä½ åœ¨è¿è¥ä¸€ä¸ªäº‘ä¸Šçš„Kafkaé›†ç¾¤ï¼Œé‚£ä¹ˆåŠ¿å¿…ä¼šé¢ä¸´å¤šç§Ÿæˆ·çš„é—®é¢˜ã€‚**é™¤äº†è®¾ç½®åˆç†çš„è®¤è¯æœºåˆ¶å¤–ï¼Œä¸ºæ¯ä¸ªè¿æ¥Kafkaé›†ç¾¤çš„å®¢æˆ·ç«¯æˆäºˆæ°å½“çš„æƒé™ï¼Œä¹Ÿæ˜¯éå¸¸å…³é”®çš„**ã€‚ç°åœ¨æˆ‘æ¥ç»™å‡ºä¸€äº›æœ€ä½³å®è·µã€‚

ç¬¬ä¸€ï¼Œå°±åƒå‰é¢è¯´çš„ï¼Œè¦å¼€å¯ACLï¼Œä½ éœ€è¦è®¾ç½®authorizer.class.name=kafka.security.auth.SimpleAclAuthorizerã€‚

ç¬¬äºŒï¼Œæˆ‘å»ºè®®ä½ é‡‡ç”¨ç™½åå•æœºåˆ¶ï¼Œè¿™æ ·çš„è¯ï¼Œæ²¡æœ‰æ˜¾å¼è®¾ç½®æƒé™çš„ç”¨æˆ·å°±æ— æƒè®¿é—®ä»»ä½•èµ„æºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨Kafkaçš„server.propertiesæ–‡ä»¶ä¸­ï¼Œä¸è¦è®¾ç½®allow.everyone.if.no.acl.found=trueã€‚

ç¬¬ä¸‰ï¼Œä½ å¯ä»¥ä½¿ç”¨kafka-aclsè„šæœ¬ä¸ºSSLç”¨æˆ·æˆäºˆé›†ç¾¤çš„æƒé™ã€‚æˆ‘ä»¬ä»¥å‰é¢çš„ä¾‹å­æ¥è¿›è¡Œä¸€ä¸‹è¯´æ˜ã€‚

åœ¨é…ç½®SSLæ—¶ï¼Œæˆ‘ä»¬æŒ‡å®šç”¨æˆ·çš„Distinguished Nameä¸ºâ€œCN=Xi Hu, OU=YourDept, O=YourCompany, L=Beijing, ST=Beijing, C=CNâ€ã€‚ä¹‹å‰åœ¨è®¾ç½®Brokerç«¯å‚æ•°æ—¶ï¼Œæˆ‘ä»¬æŒ‡å®šäº†security.inter.broker.protocol=SSLï¼Œå³å¼ºåˆ¶æŒ‡å®šBrokeré—´çš„é€šè®¯ä¹Ÿé‡‡ç”¨SSLåŠ å¯†ã€‚

å¦‚æœä¸ä¸ºæŒ‡å®šçš„Distinguished Nameæˆäºˆé›†ç¾¤æ“ä½œçš„æƒé™ï¼Œä½ æ˜¯æ— æ³•æˆåŠŸå¯åŠ¨Brokerçš„ã€‚å› æ­¤ï¼Œä½ éœ€è¦åœ¨å¯åŠ¨Brokerä¹‹å‰æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š

```
$ bin/kafka-acls.sh --authorizer-properties zookeeper.connect=localhost:2181 --add --allow-principal User:"CN=Xi Hu,OU=YourDept,O=YourCompany,L=Beijing,ST=Beijing,C=CN" --operation All --cluster
```

ç¬¬å››ï¼Œä½ è¦ä¸ºå®¢æˆ·ç«¯ç¨‹åºæˆäºˆç›¸åº”çš„æƒé™ï¼Œæ¯”å¦‚ä¸ºç”Ÿäº§è€…æˆäºˆproduceræƒé™ï¼Œä¸ºæ¶ˆè´¹è€…æˆäºˆconsumeræƒé™ã€‚å‡è®¾å®¢æˆ·ç«¯è¦è®¿é—®çš„ä¸»é¢˜åå­—æ˜¯testï¼Œé‚£ä¹ˆå‘½ä»¤å¦‚ä¸‹ï¼š

```
$ bin/kafka-acls.sh --authorizer-properties zookeeper.connect=localhost:2181 --add --allow-principal User:"CN=Xi Hu,OU=YourDept,O=YourCompany,L=Beijing,ST=Beijing,C=CN" --producer --topic 'test'
```

```
$ bin/kafka-acls.sh --authorizer-properties zookeeper.connect=localhost:2181 --add --allow-principal User:"CN=Xi Hu,OU=YourDept,O=YourCompany,L=Beijing,ST=Beijing,C=CN" --consumer --topic 'test' --group '*'
```

æ³¨æ„è¿™ä¸¤æ¡å‘½ä»¤ä¸­çš„ --producerå’Œ --consumerï¼Œå®ƒä»¬ç±»ä¼¼äºä¸€ä¸ªå¿«æ·æ–¹å¼ï¼Œç›´æ¥å°†Producerå’ŒConsumerå¸¸ç”¨çš„æƒé™è¿›è¡Œäº†ä¸€æ¬¡æ€§çš„æˆäºˆã€‚

ä½œä¸ºäº‘ç¯å¢ƒPaaSç®¡ç†å‘˜ï¼Œé™¤äº†ä»¥ä¸Šè¿™äº›å¿…è¦çš„æƒé™ï¼Œä½ æœ€å¥½ä¸è¦æŠŠå…¶ä»–æƒé™æˆäºˆå®¢æˆ·ç«¯ï¼Œæ¯”å¦‚åˆ›å»ºä¸»é¢˜çš„æƒé™ã€‚æ€»ä¹‹ï¼Œä½ æˆäºˆçš„æƒé™è¶Šå°‘ï¼Œä½ çš„Kafkaé›†ç¾¤å°±è¶Šå®‰å…¨ã€‚

## å°ç»“

è®²åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±å®Œæ•´åœ°æŠŠKafkaæˆæƒæœºåˆ¶æ¢³ç†äº†ä¸€éã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘è¿˜é™„èµ äº†SSLç«¯é…ç½®æ–¹æ³•ã€‚å¸Œæœ›ä½ èƒ½å°†è¿™ä¸¤è®²å…³äºå®‰å…¨é…ç½®çš„å†…å®¹ç»“åˆèµ·æ¥å­¦ä¹ ï¼Œæ‰“é€ ä¸€ä¸ªè¶…çº§å®‰å…¨çš„Kafkaé›†ç¾¤ã€‚

![](https://static001.geekbang.org/resource/image/39/66/39431082a84db9a3ed0dacd085f60f66.jpg?wh=2069%2A2535)

## å¼€æ”¾è®¨è®º

Kafkaæä¾›çš„æƒé™æœ‰å¾ˆå¤šç§ï¼Œæˆ‘ä»¬ä»Šå¤©è®¨è®ºçš„å†…å®¹åªè¦†ç›–äº†å…¶ä¸­æœ€é‡è¦çš„å‡ ä¸ªæƒé™ã€‚å¦‚æœè¦è®©ä¸€ä¸ªå®¢æˆ·ç«¯èƒ½å¤ŸæŸ¥è¯¢æ¶ˆè´¹è€…ç»„çš„æäº¤ä½ç§»æ•°æ®ï¼Œä½ è§‰å¾—åº”è¯¥æˆäºˆå®ƒä»€ä¹ˆæƒé™ï¼Ÿ

æ¬¢è¿å†™ä¸‹ä½ çš„æ€è€ƒå’Œç­”æ¡ˆï¼Œæˆ‘ä»¬ä¸€èµ·è®¨è®ºã€‚å¦‚æœä½ è§‰å¾—æœ‰æ‰€æ”¶è·ï¼Œä¹Ÿæ¬¢è¿æŠŠæ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ15ï¼‰</strong></div><ul>
<li><span>J.Smile</span> ğŸ‘ï¼ˆ6ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æ€è€ƒé¢˜ï¼šåº”è¯¥æ˜¯æ¶ˆè´¹è€…ç«¯çš„TOPICçš„WRITEæƒé™</p>2020-06-20</li><br/><li><span>James</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ä¸ºå•¥æ˜¯æ¶ˆè´¹è€…ç«¯çš„TOPICçš„WRITEæƒé™</p>2020-07-04</li><br/><li><span>æ‹ˆèŠ±å¾®ç¬‘</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<p>è€å¸ˆ,æˆ‘ä»Šå¤©åœ¨ideaä¸‹æ­å»ºkafkaæºç ,å‡†å¤‡ç ”ç©¶ä¸€ä¸‹,gradleç¼–è¯‘è¿‡äº†,ä½†åœ¨ideaé‡Œç¼–è¯‘ä¸è¿‡,åœ¨clientå¯¹åº”çš„é¡¹ç›®æŠ¥è¿™ä¸ªé”™:Error:(19, 39) java: ç¨‹åºåŒ…org.apache.kafka.common.messageä¸å­˜åœ¨.
kafkaæºç ç‰ˆæœ¬æ˜¯V2.3.0, scalaçš„ç‰ˆæœ¬æ˜¯2.12.7,æºç ç¼ºå¤±äº†mesage,æ€ä¹ˆè§£å†³?
æˆ‘è¯•äº†V2.2.1ç‰ˆæœ¬,ä»ç„¶æ˜¯ä¸€æ ·çš„é—®é¢˜.</p>2019-08-20</li><br/><li><span>è€é™ˆçš„ç©ºé…’æ¡¶</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ä½ å¥½ï¼Œèƒ¡å¤•è€å¸ˆï¼Œkafka_version=2.12.2.3.0ï¼Œä½¿ç”¨çš„æˆæƒæ–¹å¼æ˜¯SASL_PLAINTEXTï¼Œåœ¨config&#47;server.propertiesé…ç½®allow.everyone.if.no.acl.found=trueï¼Œä½¿ç”¨æœªè®¾ç½®æƒé™çš„topicï¼Œå‘é€æ¶ˆæ¯ï¼Œä¼šæœ‰æˆæƒå¤±è´¥çš„æ—¥å¿—ã€‚
æ—¥å¿—å¦‚ä¸‹ï¼š
SocketServer brokerId=0] Failed authentication with &#47;10.192.0.1 (Unexpected Kafka request of type METADATA during SASL handshake.) (org.apache.kafka.common.network.Selector)
é’ˆå¯¹æ­¤é—®é¢˜ï¼Œè€å¸ˆå›ç­”éœ€è¦èµ‹å€¼METADATAè¯·æ±‚çš„æƒé™ï¼Œèƒ½é—®ä¸€ä¸‹å…·ä½“æ˜¯é…ç½®ä»€ä¹ˆå‘¢ï¼Ÿ
</p>2020-03-30</li><br/><li><span>å’¸æ·¡ä¸€é¦–è¯—</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>èƒ¡è€å¸ˆï¼ŒACL æƒé™åˆ—è¡¨ä¸­çš„ä¸‰åˆ— Operationï¼ŒResourceï¼ŒAPIæ²¡æœ‰æ˜ç™½å…·ä½“ä»€ä¹ˆæ„æ€ï¼Œæ¯”å¦‚ï¼š
READ Topic Fetch
READ Topic OffsetCommit
READ Topic TxnOffsetCommit
è¿™ä¸‰ä¸ªREAD åªæœ‰API åˆ—ä¸åŒï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä»–ä»¬æ€ä¹ˆä¸å‘½ä»¤è¡Œå‚æ•°åŒ¹é…å’Œä½¿ç”¨çš„ï¼Ÿ</p>2020-03-14</li><br/><li><span>èŠ±å¼€æ¼«å¤</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>èƒ¡è€å¸ˆæ‚¨å¥½ï¼Œä¸Šæ–‡ SASL å’Œæœ¬æ–‡çš„ SSL + ACL æ–¹æ¡ˆå¦‚ä½•é€‰æ‹©ï¼Ÿ</p>2020-02-19</li><br/><li><span>13761642169</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ5ï¼‰<p>ä½ å¥½ï¼Œèƒ¡å¤•è€å¸ˆï¼Œkafka_version=2.12.2.3.0ï¼Œä½¿ç”¨çš„æˆæƒæ–¹å¼æ˜¯SASL_PLAINTEXTï¼Œåœ¨config&#47;server.propertiesé…ç½®allow.everyone.if.no.acl.found=trueï¼Œä½¿ç”¨æœªè®¾ç½®æƒé™çš„topicï¼Œå‘é€æ¶ˆæ¯ï¼Œä¼šæœ‰æˆæƒå¤±è´¥çš„æ—¥å¿—ã€‚
æ—¥å¿—å¦‚ä¸‹ï¼š
SocketServer brokerId=0] Failed authentication with &#47;10.192.0.1 (Unexpected Kafka request of type METADATA during SASL handshake.) (org.apache.kafka.common.network.Selector)</p>2019-08-26</li><br/><li><span>å¼ æ´‹</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆ æŒ‰ç…§è¿™ä¸¤èŠ‚çš„é…ç½® å¯åŠ¨kafka ä¸€ç›´æç¤ºè¿™ä¸ªError 
Connection to node 0 failed authentication due to :SSL handshake falied 
WaRN SSL handshake failed 
SSLHandshakeException: General SSLEngine problem</p>2020-07-08</li><br/><li><span>Mick</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è®©ä¸€ä¸ªå®¢æˆ·ç«¯èƒ½å¤ŸæŸ¥è¯¢æ¶ˆè´¹è€…ç»„çš„æäº¤ä½ç§»æ•°æ®:
kafka-acls --authorizer-properties zookeeper.connect=localhost:2181 --add --allow-principal User:&quot;CN=Xi Hu,OU=YourDept,O=YourCompany,L=Beijing,ST=Beijing,C=CN&quot; --OffsetCommit  --operation Read  --group &quot;group_id&quot;
è€å¸ˆä¸çŸ¥é“è¿™ä¹ˆå†™å¯¹ä¸å¯¹ï¼Ÿ</p>2019-10-09</li><br/><li><span>Geek_edc612</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ä¸å¤ªæ‡‚æœ€åè¿™å—çš„æˆæƒï¼š
bin&#47;kafka-acls.sh --authorizer-properties zookeeper.connect=localhost:2181 --add --allow-principal User:&quot;CN=Xi Hu,OU=YourDept,O=YourCompany,L=Beijing,ST=Beijing,C=CN&quot; --consumer --topic &#39;test&#39; --group &#39;*&#39;

ä¸ºå•¥è¿™ä¸ªç”¨æˆ·åè¿™ä¹ˆé•¿ï¼Œè¿™æ˜¯æˆæƒçš„sslçš„ç”¨æˆ·åå—ï¼Ÿ</p>2019-08-20</li><br/><li><span>éŸ¦å®é¡º</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>1.client-ssl.config æ–‡ä»¶è®¾ç½®çš„æ˜¯serverï¼Œæ˜¯ä¸æ˜¯é”™äº†ï¼Ÿ
ssl.keystore.location=&#47;Users&#47;huxi&#47;testenv&#47;certificates&#47;server.keystore.jks


2.DNAME æ˜¯å¹²å˜›ç”¨çš„ï¼Ÿ æ˜¯sslç”¨æˆ·ï¼Ÿ

3.ssl çš„ç”¨æˆ·ä»å“ªé‡Œæ¥ï¼Ÿæ¯”å¦‚æƒ³æ–°å¢ä¸€ä¸ª writerç”¨æˆ·ï¼Ÿ
</p>2021-08-18</li><br/><li><span>Richard123m</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>Brokeré—´ç”¨SSLæˆ–saslï¼Œä¸ä¸ç”¨ç›¸æ¯”ï¼Œé€šä¿¡çš„é€Ÿç‡ä¼šæ˜¯å¤šå°‘ï¼Œç‰¹åˆ«æ˜¯å¤šå‰¯æœ¬æƒ…å†µ</p>2021-05-24</li><br/><li><span>èƒ¡å°ç¦¾</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>
bin&#47;kafka-acls.sh --authorizer-properties zookeeper.connect=localhost:2181 --add --allow-principal User:Bob --producer --topic Test-topic
å‡å¦‚æˆ‘ä¸åšè®¤è¯ï¼Œåªä½¿ç”¨è¿™ä¸ªå‘½ä»¤æ¥è®¾ç½®æˆæƒï¼Œèµ·ä¸åˆ°æ•ˆæœçš„å—ï¼Ÿ</p>2021-03-05</li><br/><li><span>ileruza</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼Œè¯·é—®keystoreå’Œtruststoreæœ‰æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«å•Šï¼Œæ—¢ç”Ÿç‘œä½•ç”Ÿäº®ï¼Ÿ</p>2020-11-28</li><br/><li><span>Geek_02ab73</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼Œä¸€ç›´æœ‰ä¸ªç–‘é—®ï¼Ÿ openssl ç”Ÿæˆçš„è¯ä¹¦å’ŒLet&#39;s Encrypt é¢å‘ç»™æˆ‘ä»¬çš„æœ‰ä»€ä¹ˆåŒºåˆ«
1. Let&#39;s Encrypt æ˜¯æ¯ä¸‰ä¸ªæœˆåˆ°æœŸï¼Œç”¨æ¥æœåŠ¡å™¨å…¬å¼€HTTPSæœåŠ¡ï¼Œ
2. keystore + openssl å¼„å‡ºæ¥çš„SSLæ˜¯ç”¨æ¥åšå†…éƒ¨æœåŠ¡æ²Ÿé€šçš„

ä¸çŸ¥é“æˆ‘ç†è§£çš„å¯¹ä¸ï¼Ÿ</p>2020-11-24</li><br/>
</ul>