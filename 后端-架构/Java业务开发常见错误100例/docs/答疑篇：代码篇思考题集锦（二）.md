ä½ å¥½ï¼Œæˆ‘æ˜¯æœ±æ™”ã€‚

ä»Šå¤©ï¼Œæˆ‘ä»¬ç»§ç»­ä¸€èµ·åˆ†æè¿™é—¨è¯¾ç¬¬7~12è®²çš„è¯¾åæ€è€ƒé¢˜ã€‚è¿™äº›é¢˜ç›®æ¶‰åŠäº†æ•°æ®åº“ç´¢å¼•ã€åˆ¤ç­‰é—®é¢˜ã€æ•°å€¼è®¡ç®—ã€é›†åˆç±»ã€ç©ºå€¼å¤„ç†å’Œå¼‚å¸¸å¤„ç†çš„12é“é—®é¢˜ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ä¸€ä¸€å…·ä½“åˆ†æå§ã€‚

### [07 | æ•°æ®åº“ç´¢å¼•ï¼šç´¢å¼•å¹¶ä¸æ˜¯ä¸‡èƒ½è¯](https://time.geekbang.org/column/article/213342)

**é—®é¢˜1ï¼š**åœ¨ä»‹ç»äºŒçº§ç´¢å¼•ä»£ä»·æ—¶ï¼Œæˆ‘ä»¬é€šè¿‡EXPLAINå‘½ä»¤çœ‹åˆ°äº†ç´¢å¼•è¦†ç›–å’Œå›è¡¨çš„ä¸¤ç§æƒ…å†µã€‚ä½ èƒ½ç”¨optimizer traceæ¥åˆ†æä¸€ä¸‹è¿™ä¸¤ç§æƒ…å†µçš„æˆæœ¬å·®å¼‚å—ï¼Ÿ

ç­”ï¼šå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼Œæ‰“å¼€optimizer\_traceåï¼Œå†æ‰§è¡ŒSQLå°±å¯ä»¥æŸ¥è¯¢information\_schema.OPTIMIZER\_TRACEè¡¨æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’äº†ï¼Œæœ€åå¯ä»¥å…³é—­optimizer\_traceåŠŸèƒ½ï¼š

```
SET optimizer_trace="enabled=on";
SELECT * FROM person WHERE NAME >'name84059' AND create_time>'2020-01-24 05:00:00';
SELECT * FROM information_schema.OPTIMIZER_TRACE;
SET optimizer_trace="enabled=off";
```

å‡è®¾æˆ‘ä»¬ä¸ºè¡¨personçš„NAMEå’ŒSCOREåˆ—å»ºäº†è”åˆç´¢å¼•ï¼Œé‚£ä¹ˆä¸‹é¢ç¬¬äºŒæ¡è¯­å¥åº”è¯¥å¯ä»¥èµ°ç´¢å¼•è¦†ç›–ï¼Œè€Œç¬¬ä¸€æ¡è¯­å¥éœ€è¦å›è¡¨ï¼š

```
explain select * from person where NAME='name1';
explain select NAME,SCORE from person where NAME='name1';
```

é€šè¿‡è§‚å¯ŸOPTIMIZER\_TRACEçš„è¾“å‡ºå¯ä»¥çœ‹åˆ°ï¼Œç´¢å¼•è¦†ç›–ï¼ˆindex\_only=trueï¼‰çš„æˆæœ¬æ˜¯1.21è€Œå›è¡¨æŸ¥è¯¢ï¼ˆindex\_only=falseï¼‰çš„æ˜¯2.21ï¼Œä¹Ÿå°±æ˜¯ç´¢å¼•è¦†ç›–èŠ‚çœäº†å›è¡¨çš„æˆæœ¬1ã€‚

ç´¢å¼•è¦†ç›–ï¼š

```
analyzing_range_alternatives": {
  "range_scan_alternatives": [
  {
    "index": "name_score",
    "ranges": [
      "name1 <= name <= name1"
    ] /* ranges */,
    "index_dives_for_eq_ranges": true,
    "rowid_ordered": false,
    "using_mrr": false,
    "index_only": true,
    "rows": 1,
    "cost": 1.21,
    "chosen": true
  }
]
```

å›è¡¨ï¼š
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ2ï¼‰</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/13/f9/a1/0396e1fb.jpg" width="30px"><span>é•ç ºæ‹¬ç¾½</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æˆ‘æœ‰ä¸ªé—®é¢˜æƒ³é—®  where  1=1  æ˜¯ä¸æ˜¯æ¢æˆ&lt;where&gt;æ›´å¥½ä¸€äº›</div>2022-05-11</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoMGQgj0b7PWkqB2dL2hejUrvkQA5NNHw4EibMu23XhLnHVR9vrK9jicG5EfG9BzHVyW4dY5czuc9iaw/132" width="30px"><span>fusion</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>è€å¸ˆä¸ºä»€ä¹ˆæˆ‘æŸ¥è¯¢çš„ç»“æœæ˜¯
SET SQL_SELECT_LIMIT=1000	{
  &quot;steps&quot;: [
  ]
}	0	false

è¯­å¥æ˜¯ï¼š
SET optimizer_trace=&quot;enabled=on&quot;;
SELECT name,score FROM person WHERE NAME=&#39;name1&#39;
 SELECT * FROM information_schema.OPTIMIZER_TRACE;
SET optimizer_trace=&quot;enabled=off&quot;;</div>2024-01-17</li><br/>
</ul>