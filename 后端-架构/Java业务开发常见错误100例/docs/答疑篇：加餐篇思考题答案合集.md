ä½ å¥½ï¼Œæˆ‘æ˜¯æœ±æ™”ã€‚

ä»Šå¤©ï¼Œæˆ‘ä»¬ç»§ç»­ä¸€èµ·åˆ†æè¿™é—¨è¯¾çš„â€œä¸å®šæœŸåŠ é¤â€ç¯‡ä¸­5è®²çš„è¯¾åæ€è€ƒé¢˜ã€‚è¿™äº›é¢˜ç›®æ¶‰åŠäº†Java 8åŸºç¡€çŸ¥è¯†ã€å®šä½å’Œåˆ†æåº”ç”¨é—®é¢˜ç›¸å…³çš„å‡ å¤§çŸ¥è¯†ç‚¹ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ä¸€ä¸€å…·ä½“åˆ†æå§ã€‚

### [åŠ é¤1 | å¸¦ä½ åƒé€è¯¾ç¨‹ä¸­Java 8çš„é‚£äº›é‡è¦çŸ¥è¯†ç‚¹ï¼ˆä¸€ï¼‰](https://time.geekbang.org/column/article/212374)

**é—®é¢˜ï¼š**å¯¹äºå¹¶è¡Œæµéƒ¨åˆ†çš„å¹¶è¡Œæ¶ˆè´¹å¤„ç†1åˆ°100çš„ä¾‹å­ï¼Œå¦‚æœæŠŠforEachæ›¿æ¢ä¸ºforEachOrderedï¼Œä½ è§‰å¾—ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ

ç­”ï¼šforEachOrdered ä¼šè®©parallelStreamä¸§å¤±éƒ¨åˆ†çš„å¹¶è¡Œèƒ½åŠ›ï¼Œä¸»è¦åŸå› æ˜¯forEachéå†çš„é€»è¾‘æ— æ³•å¹¶è¡Œèµ·æ¥ï¼ˆéœ€è¦æŒ‰ç…§å¾ªåºéå†ï¼Œæ— æ³•å¹¶è¡Œï¼‰ã€‚

æˆ‘ä»¬æ¥æ¯”è¾ƒä¸‹é¢çš„ä¸‰ç§å†™æ³•ï¼š

```
//æ¨¡æ‹Ÿæ¶ˆæ¯æ•°æ®éœ€è¦1ç§’æ—¶é—´
private static void consume(int i) {
    try {
        TimeUnit.SECONDS.sleep(1);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
    System.out.print(i);
}
//æ¨¡æ‹Ÿè¿‡æ»¤æ•°æ®éœ€è¦1ç§’æ—¶é—´
private static boolean filter(int i) {
    try {
        TimeUnit.SECONDS.sleep(1);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
    return i % 2 == 0;
}
@Test
public void test() {
    System.setProperty("java.util.concurrent.ForkJoinPool.common.parallelism", String.valueOf(10));

    StopWatch stopWatch = new StopWatch();
    stopWatch.start("stream");
    stream();
    stopWatch.stop();
    stopWatch.start("parallelStream");
    parallelStream();
    stopWatch.stop();
    stopWatch.start("parallelStreamForEachOrdered");
    parallelStreamForEachOrdered();
    stopWatch.stop();
    System.out.println(stopWatch.prettyPrint());
}
//filtreå’ŒforEachä¸²è¡Œ
private void stream() {
    IntStream.rangeClosed(1, 10)
            .filter(ForEachOrderedTest::filter)
            .forEach(ForEachOrderedTest::consume);
}
//filterå’ŒforEachå¹¶è¡Œ
private void parallelStream() {
    IntStream.rangeClosed(1, 10).parallel()
            .filter(ForEachOrderedTest::filter)
            .forEach(ForEachOrderedTest::consume);
}
//filterå¹¶è¡Œè€ŒforEachä¸²è¡Œ
private void parallelStreamForEachOrdered() {
    IntStream.rangeClosed(1, 10).parallel()
            .filter(ForEachOrderedTest::filter)
            .forEachOrdered(ForEachOrderedTest::consume);
}
```

å¾—åˆ°è¾“å‡ºï¼š

```
---------------------------------------------
ns         %     Task name
---------------------------------------------
15119607359  065%  stream
2011398298  009%  parallelStream
6033800802  026%  parallelStreamForEachOrdered
```

ä»è¾“å‡ºä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š

- streamæ–¹æ³•çš„è¿‡æ»¤å’Œéå†å…¨éƒ¨ä¸²è¡Œæ‰§è¡Œï¼Œæ€»æ—¶é—´æ˜¯10ç§’+5ç§’=15ç§’ï¼›
- parallelStreamæ–¹æ³•çš„è¿‡æ»¤å’Œéå†å…¨éƒ¨å¹¶è¡Œæ‰§è¡Œï¼Œæ€»æ—¶é—´æ˜¯1ç§’+1ç§’=2ç§’ï¼›
- parallelStreamForEachOrderedæ–¹æ³•çš„è¿‡æ»¤å¹¶è¡Œæ‰§è¡Œï¼Œéå†ä¸²è¡Œæ‰§è¡Œï¼Œæ€»æ—¶é—´æ˜¯1ç§’+5ç§’=6ç§’ã€‚

### [åŠ é¤2 | å¸¦ä½ åƒé€è¯¾ç¨‹ä¸­Java 8çš„é‚£äº›é‡è¦çŸ¥è¯†ç‚¹ï¼ˆäºŒï¼‰](https://time.geekbang.org/column/article/212398)

**é—®é¢˜1ï¼š**ä½¿ç”¨Streamå¯ä»¥éå¸¸æ–¹ä¾¿åœ°å¯¹Liståšå„ç§æ“ä½œï¼Œé‚£æœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥å®ç°åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­è§‚å¯Ÿæ•°æ®å˜åŒ–å‘¢ï¼Ÿæ¯”å¦‚ï¼Œæˆ‘ä»¬è¿›è¡Œfilter+mapæ“ä½œï¼Œå¦‚ä½•è§‚å¯Ÿfilteråmapçš„åŸå§‹æ•°æ®å‘¢ï¼Ÿ
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ1ï¼‰</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg" width="30px"><span>å¾€äº‹éšé£ï¼Œé¡ºå…¶è‡ªç„¶</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>windowså¹³å°ä¸‹jmapä½¿ç”¨æ–¹ä¾¿ï¼Ÿæ‰§è¡Œä¸Šé¢æ¡ˆä¾‹</div>2020-08-29</li><br/>
</ul>