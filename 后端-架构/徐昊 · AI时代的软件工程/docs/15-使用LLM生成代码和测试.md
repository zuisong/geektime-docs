ä½ å¥½ï¼Œæˆ‘æ˜¯å¾æ˜Šï¼Œä»Šå¤©æˆ‘ä»¬æ¥ç»§ç»­å­¦ä¹ AIæ—¶ä»£çš„è½¯ä»¶å·¥ç¨‹ã€‚

é€šè¿‡å‰é¢çš„å­¦ä¹ ï¼Œæˆ‘ä»¬äº†è§£äº†å¦‚ä½•ä½¿ç”¨å¤§è¯­è¨€æ¨¡å‹ï¼ˆLarge Language Modelï¼ŒLLMï¼‰è¾…åŠ©è¿›è¡Œä¸šåŠ¡çŸ¥è¯†ç®¡ç†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç»§ç»­å­¦ä¹ ä½¿ç”¨LLMè¾…åŠ©è½¯ä»¶äº¤ä»˜çš„æ•´ä½“æµç¨‹ï¼Œä»¥åŠå…¶ä¸­æ¶‰åŠåˆ°çš„çŸ¥è¯†ç®¡ç†ã€‚

ä»ä»Šå¤©è¿™èŠ‚è¯¾å¼€å§‹ï¼Œæˆ‘ä»¬å°†è¿›å…¥å¦‚ä½•ä½¿ç”¨LLMè¾…åŠ©è½¯ä»¶å¼€å‘çš„ç¯èŠ‚ã€‚è®©æˆ‘ä»¬ä»ä¸€ä¸ªä¾‹å­å¼€å§‹ã€‚

## å‘½ä»¤è¡Œå‚æ•°è§£æ

æˆ‘ä»¬æ‰€ä½¿ç”¨çš„ä¾‹å­æºè‡ªRobert C. Martinçš„ *Clean Code* ç¬¬åå››ç« ï¼Œä¹Ÿæ˜¯æˆ‘çš„æµ‹è¯•é©±åŠ¨ä¸“æ [ã€ŠTDDé¡¹ç›®å®æˆ˜70è®²ã€‹](https://time.geekbang.org/column/intro/100109401)è®²è¿‡çš„ç¬¬ä¸€ä¸ªé¡¹ç›®ï¼Œéœ€æ±‚æè¿°å¦‚ä¸‹ï¼š

> æˆ‘ä»¬ä¸­çš„å¤§å¤šæ•°äººéƒ½ä¸å¾—ä¸æ—¶ä¸æ—¶åœ°è§£æä¸€ä¸‹å‘½ä»¤è¡Œå‚æ•°ã€‚å¦‚æœæˆ‘ä»¬æ²¡æœ‰ä¸€ä¸ªæ–¹ä¾¿çš„å·¥å…·ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç®€å•åœ°å¤„ç†ä¸€ä¸‹ä¼ å…¥mainå‡½æ•°çš„å­—ç¬¦ä¸²æ•°ç»„ã€‚æœ‰å¾ˆå¤šå¼€æºå·¥å…·å¯ä»¥å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œä½†å®ƒä»¬å¯èƒ½å¹¶ä¸èƒ½å®Œå…¨æ»¡è¶³æˆ‘ä»¬çš„è¦æ±‚ã€‚æ‰€ä»¥æˆ‘ä»¬å†å†™ä¸€ä¸ªå§ã€‚  
> Â   
> ä¼ é€’ç»™ç¨‹åºçš„å‚æ•°ç”±æ ‡å¿—å’Œå€¼ç»„æˆã€‚æ ‡å¿—åº”è¯¥æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼Œå‰é¢æœ‰ä¸€ä¸ªå‡å·ã€‚æ¯ä¸ªæ ‡å¿—éƒ½åº”è¯¥æœ‰é›¶ä¸ªæˆ–å¤šä¸ªä¸ä¹‹ç›¸å…³çš„å€¼ã€‚ä¾‹å¦‚ï¼š  
> Â   
> -l -p 8080 -d /usr/logs  
> Â   
> â€œlâ€ï¼ˆæ—¥å¿—ï¼‰æ²¡æœ‰ç›¸å…³çš„å€¼ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¸ƒå°”æ ‡å¿—ï¼Œå¦‚æœå­˜åœ¨åˆ™ä¸ºtrueï¼Œä¸å­˜åœ¨åˆ™ä¸ºfalseã€‚â€œpâ€ï¼ˆç«¯å£ï¼‰æœ‰ä¸€ä¸ªæ•´æ•°å€¼ï¼Œâ€œdâ€ï¼ˆç›®å½•ï¼‰æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²å€¼ã€‚æ ‡å¿—åé¢å¦‚æœå­˜åœ¨å¤šä¸ªå€¼ï¼Œåˆ™è¯¥æ ‡å¿—è¡¨ç¤ºä¸€ä¸ªåˆ—è¡¨ï¼š  
> Â   
> -g this is a list -d 1 2 -3 5  
> Â   
> â€œgâ€ è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨\[â€œthisâ€, â€œisâ€, â€œaâ€, â€œlistâ€]ï¼Œ"d"æ ‡å¿—è¡¨ç¤ºä¸€ä¸ªæ•´æ•°åˆ—è¡¨\[1, 2, -3, 5]ã€‚  
> Â   
> å¦‚æœå‚æ•°ä¸­æ²¡æœ‰æŒ‡å®šæŸä¸ªæ ‡å¿—ï¼Œé‚£ä¹ˆè§£æå™¨åº”è¯¥æŒ‡å®šä¸€ä¸ªé»˜è®¤å€¼ã€‚ä¾‹å¦‚ï¼Œfalseä»£è¡¨å¸ƒå°”å€¼ï¼Œ0ä»£è¡¨æ•°å­—ï¼Œ `""` ä»£è¡¨å­—ç¬¦ä¸²ï¼Œ\[]ä»£è¡¨åˆ—è¡¨ã€‚å¦‚æœç»™å‡ºçš„å‚æ•°ä¸æ¨¡å¼ä¸åŒ¹é…ï¼Œé‡è¦çš„æ˜¯ç»™å‡ºä¸€ä¸ªå¥½çš„é”™è¯¯ä¿¡æ¯ï¼Œå‡†ç¡®åœ°è§£é‡Šä»€ä¹ˆæ˜¯é”™è¯¯çš„ã€‚  
> Â   
> ç¡®ä¿ä½ çš„ä»£ç æ˜¯å¯æ‰©å±•çš„ï¼Œå³å¦‚ä½•å¢åŠ æ–°çš„æ•°å€¼ç±»å‹æ˜¯ç›´æ¥å’Œæ˜æ˜¾çš„ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ5ï¼‰</strong></div><ul>
<li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKkdXSdtiahZTGT2ArFNGa93OaDf9dRE96Vz82YwUDsFJOWXYkGFibkjNHhQ7CPITERuicv6MHKS2Kxw/132" width="30px"><span>ç©¿é´å­çš„åŠ è²çŒ«</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>â€œlâ€ï¼ˆæ—¥å¿—ï¼‰æ²¡æœ‰ç›¸å…³çš„å€¼ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¸ƒå°”æ ‡å¿—ï¼Œå¦‚æœå­˜åœ¨åˆ™ä¸º trueï¼Œä¸å­˜åœ¨åˆ™ä¸º falseã€‚â€œpâ€ï¼ˆç«¯å£ï¼‰æœ‰ä¸€ä¸ªæ•´æ•°å€¼ï¼Œâ€œdâ€ï¼ˆç›®å½•ï¼‰æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²å€¼ã€‚æ ‡å¿—åé¢å¦‚æœå­˜åœ¨å¤šä¸ªå€¼ï¼Œåˆ™è¯¥æ ‡å¿—è¡¨ç¤ºä¸€ä¸ªåˆ—è¡¨ï¼š
Â 
-g this is a list -d 1 2 -3 5
Â 
â€œgâ€ è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨[â€œthisâ€, â€œisâ€, â€œaâ€, â€œlistâ€]ï¼Œ&quot;d&quot;æ ‡å¿—è¡¨ç¤ºä¸€ä¸ªæ•´æ•°åˆ—è¡¨[1, 2, -3, 5]ã€‚
Â 
è¿™é‡Œç¬¬äºŒä¸ªdæ˜¯ä¸æ˜¯æ¢ä¸ªå­—æ¯å¥½ç‚¹ï¼Œåæ–‡ç¬¬äºŒæ¬¡è°ƒè¯•æ—¶dä»£è¡¨å­—ç¬¦ä¸²ï¼Œä¼šå¢åŠ ç†è§£æˆæœ¬</div>2024-04-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1c/f6/27/c27599ae.jpg" width="30px"><span>æœ¯å­ç±³å¾·</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ğŸ¤”â˜•ï¸ğŸ¤”â˜•ï¸ğŸ¤”
ã€Qã€‘å‰é¢çš„è¯¾ç¨‹ï¼Œæ‹‰æ¥è®¤çŸ¥æ¨¡å‹ï¼Œæ‹‰å‡ºLLMè¾…åŠ©å»ºæ¨¡å’Œç”¨æˆ·æ•…äº‹ï¼Œåšäº†è¿™ä¹ˆå¤šå‡†å¤‡ï¼Œæ€ä¹ˆå°±è·³è·ƒåˆ°CleanCodeçš„parseCmdLineArgsï¼Œè¿™æ˜¯å‡ºç°å¹»è§‰äº†å˜›ï¼Ÿé¡¹ç›®é‡Œï¼Œéš¾é“ä¸æ˜¯åŸºäºç”¨æˆ·æ•…äº‹å’Œå»ºå‡ºæ¥çš„æ¨¡å‹ï¼Œå¼€å§‹æ‹†è§£åˆ°ä»»åŠ¡åˆ—è¡¨ï¼Œè®©LLMæµ¸æ³¡åœ¨è¿™ä¸ªKnowledgeContexté‡ŒæŒç»­è¾…åŠ©ï¼Œç„¶åç”¨TDDçš„æ–¹æ³•è¾¹éªŒè¯ã€è¾¹å®ç°ã€è¾¹è¯¦ç»†è®¾è®¡ã€è¾¹èºæ—‹è¿­ä»£å˜›ï¼Ÿ å¿½ç„¶é—´åˆ‡æ¢KnowledgeContextï¼Œè¿™ä¸ªäººä¹Ÿé€‚ç”¨ä¸äº†ï¼Œæ›´ä½•å†µLLMæ€ä¹ˆé€‚åº”ï¼Œè¿™ä¸ªè·³è·ƒçœŸä¸æ‡‚ã€‚
â€” by æœ¯å­ç±³å¾·@2024å¹´4æœˆ10æ—¥</div>2024-04-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1c/f6/27/c27599ae.jpg" width="30px"><span>æœ¯å­ç±³å¾·</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>
&#47;&#47;BEGIN UT CODE GENERATED BY GITHUB COPILOT, EXCEPT FIRST LINE COMMENT
&#47;&#47;use gtest to test the function CC_parseCmdLineArgs defined in CC_parseCmdLineArgs.h
#include &quot;CC_parseCmdLineArgs.h&quot;
#include &lt;gtest&#47;gtest.h&gt;

TEST(CC_parseCmdLineArgs, NullCmdLineArgs) {
  CC_CmdLineArgs_T CmdLineArgs;
  EXPECT_EQ(CC_FAIL, CC_parseCmdLineArgs(0, NULL, &amp;CmdLineArgs));
}

TEST(CC_parseCmdLineArgs, NullCmdLineArgsPtr) {
  EXPECT_EQ(CC_FAIL, CC_parseCmdLineArgs(0, NULL, NULL));
}

TEST(CC_parseCmdLineArgs, NoArgs) {
  CC_CmdLineArgs_T CmdLineArgs;
  char *argv[] = { (char *)&quot;test&quot; };
  EXPECT_EQ(CC_SUCCESS, CC_parseCmdLineArgs(1, argv, &amp;CmdLineArgs));
  EXPECT_FALSE(CmdLineArgs.IsLoggingEnabled);
  EXPECT_EQ(0, CmdLineArgs.RecvPort);
  EXPECT_EQ(NULL, CmdLineArgs.pLogSavingDir);
}

...

TEST(CC_parseCmdLineArgs, RecvPort) {
  CC_CmdLineArgs_T CmdLineArgs;
  char *argv[] = { (char *)&quot;test&quot;, (char *)&quot;-p&quot;, (char *)&quot;1234&quot; };
  EXPECT_EQ(CC_SUCCESS, CC_parseCmdLineArgs(3, argv, &amp;CmdLineArgs));
  EXPECT_FALSE(CmdLineArgs.IsLoggingEnabled);
  EXPECT_EQ(1234, CmdLineArgs.RecvPort);
  EXPECT_EQ(NULL, CmdLineArgs.pLogSavingDir);
}

TEST(CC_parseCmdLineArgs, LogSavingDir) {
  CC_CmdLineArgs_T CmdLineArgs;
  char *argv[] = { (char *)&quot;test&quot;, (char *)&quot;-d&quot;, (char *)&quot;&#47;tmp&quot; };
  EXPECT_EQ(CC_SUCCESS, CC_parseCmdLineArgs(3, argv, &amp;CmdLineArgs));
  EXPECT_FALSE(CmdLineArgs.IsLoggingEnabled);
  EXPECT_EQ(0, CmdLineArgs.RecvPort);
  EXPECT_STREQ(&quot;&#47;tmp&quot;, CmdLineArgs.pLogSavingDir);
}

TEST(CC_parseCmdLineArgs, AllArgs) {
  CC_CmdLineArgs_T CmdLineArgs;
  char *argv[] = { (char *)&quot;test&quot;, (char *)&quot;-l&quot;, (char *)&quot;-p&quot;, (char *)&quot;1234&quot;, (char *)&quot;-d&quot;, (char *)&quot;&#47;tmp&quot; };
  EXPECT_EQ(CC_SUCCESS, CC_parseCmdLineArgs(7, argv, &amp;CmdLineArgs));
  EXPECT_TRUE(CmdLineArgs.IsLoggingEnabled);
  EXPECT_EQ(1234, CmdLineArgs.RecvPort);
  EXPECT_STREQ(&quot;&#47;tmp&quot;, CmdLineArgs.pLogSavingDir);
}

int main(int argc, char **argv) {
  testing::InitGoogleTest(&amp;argc, argv);
  return RUN_ALL_TESTS();
}</div>2024-04-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1c/f6/27/c27599ae.jpg" width="30px"><span>æœ¯å­ç±³å¾·</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>&#47;&#47;BEGIN CODE&amp;COMMENT BY ME

typedef enum {
  CC_SUCCESS = 0,
  CC_FAIL    = 1,
} CC_Result_T;

typedef struct {
  bool IsLoggingEnabled;  &#47;&#47;-l
  int RecvPort;           &#47;&#47;-p &lt;port&gt;
  char *pLogSavingDir;    &#47;&#47;-d &lt;dir&gt;
} CC_CmdLineArgs_T;

&#47;**
 * @brief: Use CC_parseCmdLineArgs to parse command line arguments and save them in CC_CmdLingArgs_T.
 *
 * @param argc same as main
 * @param argv same as main
 * @param pCmdLineArgs pointer to CC_CmdLineArgs_T
 * @return CC_SUCCESS if successful, CC_FAIL otherwise in CC_Result_T
 *&#47;
CC_Result_T CC_parseCmdLineArgs(int argc, char *argv[], CC_CmdLineArgs_T *pCmdLineArgs);
</div>2024-04-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg" width="30px"><span>aoe</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ä½¿ç”¨ AI ç”Ÿæˆçš„æµ‹è¯•é€šè¿‡ 9 ä¸ªï¼Œå¤±è´¥ 7 ä¸ªã€‚åœ¨å·²æœ‰ä»£ç ä¸Šä¿®è¡¥ï¼Œæ¯”è‡ªå·±ä» 0 åˆ° 1 å®ç°å¿«äº†éå¸¸å¤šï¼Œè¿™ä¸ªåªç”¨äº†åå‡ åˆ†é’Ÿï¼

ä¸»è¦æ­¥éª¤ï¼š
1. 15 è¯¾çš„ä¾‹å­æ‰”ç»™ coze çš„ GPT4ï¼Œå¾—åˆ°çš„ä»£ç ç®€å•ç²—æš´
2. ä½¿ç”¨ Optimize åŠŸèƒ½ä¼˜åŒ–ä¸€ä¸‹ prompt
3. åœ¨ä¼˜åŒ–çš„ prompt ä¸Šæ·»åŠ è‡ªå·±çš„æƒ³æ³•
4. å› è¿”å› token é™åˆ¶ï¼Œéœ€è¦å¤šæ¬¡å¯¹è¯å®Œæˆç»“æœ
  4.1 è¯·ç»™å‡º CommandLineParser çš„å®Œæ•´ä»£ç 
  4.2 è¯·ç»™å‡ºå®Œæ•´æµ‹è¯•ä»£ç 
  4.3 è¡¥å…¨æµ‹è¯•ä»£ç ï¼šæµ‹è¯•ç”¨ä¾‹å¯ä»¥ç»§ç»­å¢åŠ ï¼ŒåŒ…æ‹¬å„ç§è¾¹ç•Œæƒ…å†µå’Œæ— æ•ˆè¾“å…¥
5. æœ€ç»ˆå¾—åˆ°çš„ä»£ç è™½ç„¶æµ‹è¯•æ²¡è·‘é€šï¼Œä½†åŠŸèƒ½å¼ºå¤§</div>2024-04-10</li><br/>
</ul>