ä½ å¥½ï¼Œæˆ‘æ˜¯ä¿Šè¾¾ã€‚

MySQLè¿è¡Œåœ¨å…·ä½“çš„æ“ä½œç³»ç»Ÿç¯å¢ƒä¸­ï¼Œå› æ­¤è¿è¡Œæ•ˆç‡å—é™äºåº•å±‚æ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶ç¯å¢ƒã€‚åœ¨åˆ†ææ•°æ®åº“çš„é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åŒæ—¶å…³æ³¨æ“ä½œç³»ç»Ÿæ•´ä½“è¿è¡Œæƒ…å†µã€‚åœ¨æ“ä½œç³»ç»Ÿå±‚é¢ï¼Œæˆ‘ä»¬éœ€è¦å…³æ³¨CPUã€å†…å­˜ã€IOã€æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œè¿™å‡ å¤§èµ„æºçš„ä½¿ç”¨æƒ…å†µï¼Œåˆ†æè¿™äº›èµ„æºæ˜¯å¦ç¹å¿™ã€æ˜¯å¦æœ‰æŠ¥é”™ã€æ˜¯å¦æœ‰å…¶å®ƒå¼‚å¸¸ç°è±¡ã€‚è¿™èŠ‚è¯¾æˆ‘ä»¬å°±æ¥çœ‹ä¸€ä¸‹å¦‚ä½•åˆ†æè¿™å‡ ç§èµ„æºçš„ä½¿ç”¨æƒ…å†µã€‚

## CPUèµ„æº

Linuxä¸­æœ‰å¾ˆå¤šæŸ¥çœ‹CPUä½¿ç”¨ç‡çš„å·¥å…·ï¼Œtopå°±æ˜¯å…¶ä¸­æ¯”è¾ƒå¸¸ç”¨çš„ä¸€ä¸ªå·¥å…·ã€‚ä½¿ç”¨topå¯ä»¥å®æ—¶æŸ¥çœ‹ç³»ç»Ÿçš„æ•´ä½“è´Ÿè½½å’ŒCPUä½¿ç”¨ç‡ï¼Œè¿˜èƒ½åŒæ—¶å±•ç¤ºCPUä½¿ç”¨ç‡æœ€é«˜çš„é‚£äº›è¿›ç¨‹ã€‚

ä½ å¯ä»¥çœ‹ä¸€ä¸‹topå‘½ä»¤çš„è¾“å‡ºã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/80/d9/80a25ff51dd2c42fd166860c33df18d9.png?wh=1148x480)

æˆ‘ä»¬ä¸»è¦å…³æ³¨å‡ ç‚¹ï¼š

- ç³»ç»Ÿæ•´ä½“CPUä½¿ç”¨ç‡ï¼ŒåŒ…æ‹¬usï¼Œsyï¼Œidï¼Œwaç­‰æŒ‡æ ‡ã€‚

usæ˜¯ç”¨æˆ·æ€çš„CPUä½¿ç”¨ç‡ï¼Œsyæ˜¯å†…æ ¸çš„CPUä½¿ç”¨ç‡ï¼Œidæ˜¯CPUç©ºé—²ç‡ï¼Œwaæ˜¯è¿›ç¨‹ç­‰å¾…IOæ“ä½œå®Œæˆçš„æ—¶é—´å æ¯”ã€‚ä¸Šé¢çš„è¾“å‡ºä¸­ï¼Œç”¨æˆ·æ€CPU 79.1%ï¼Œç³»ç»ŸCPU 19.8%ï¼Œç©ºé—²CPU 0.8%ã€‚ç³»ç»Ÿå¤„äºCPUç¹å¿™çŠ¶æ€ã€‚

- å„çŠ¶æ€è¿›ç¨‹æ•°é‡ï¼ŒåŒ…æ‹¬è¿è¡Œä¸­ï¼ˆrunningï¼‰çš„è¿›ç¨‹æ•°ã€ç¡çœ ï¼ˆsleepï¼‰è¿›ç¨‹æ•°ã€åœæ­¢ï¼ˆstoppedï¼‰çš„è¿›ç¨‹æ•°ã€åƒµå°¸ï¼ˆzombieï¼‰è¿›ç¨‹æ•°ã€‚
- æŒ‰CPUä½¿ç”¨ç‡æ’åºçš„è¿›ç¨‹åˆ—è¡¨ã€‚æ˜¾ç¤ºäº†è¿›ç¨‹å·ï¼ˆPIDï¼‰ã€å ç”¨å†…å­˜ï¼ˆRSSï¼‰ï¼Œè¿›ç¨‹çŠ¶æ€ï¼ˆSï¼‰ï¼Œè¿›ç¨‹CPUä½¿ç”¨ç‡ï¼Œè¿›ç¨‹çš„å†…å­˜ä½¿ç”¨ç‡ï¼Œæ‰§è¡Œçš„å‘½ä»¤ï¼ˆcommandï¼‰ã€‚

è¿›ç¨‹åˆ—è¡¨è¿˜å¯ä»¥æŒ‰ä¸åŒçš„å­—æ®µæ’åºï¼Œå¦‚è¾“å…¥Måï¼ŒæŒ‰å†…å­˜ä½¿ç”¨ç‡æ’åˆ—ã€‚è¾“å…¥Påï¼ŒæŒ‰CPUä½¿ç”¨ç‡æ’åºã€‚ä¸Šé¢çš„æ¡ˆä¾‹ä¸­ï¼Œmysqldè¿›ç¨‹å ç”¨äº†391.7%çš„CPUã€‚æˆ‘ä»¬ä½¿ç”¨äº†ä¸€å°4æ ¸çš„æœåŠ¡å™¨ï¼Œç›¸å½“äºMySQLå‡ ä¹å ç”¨äº†ç³»ç»Ÿæ‰€æœ‰çš„CPUèµ„æºã€‚

å¦‚æœMySQLè¿›ç¨‹çš„CPUä½¿ç”¨ç‡å¾ˆé«˜ï¼Œä¸€èˆ¬ä¼šè€ƒè™‘æ˜¯å¦æœ‰SQLæ‰§è¡Œæ•ˆç‡ä¸é«˜ï¼Œæˆ–SQLæ‰§è¡Œçš„é¢‘ç‡è¿‡é«˜ã€‚åœ¨æœ‰äº›æ…¢å¡çš„æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨CPUä½¿ç”¨ç‡å¯èƒ½ä¸é«˜ï¼Œæˆ–è€…æ˜¯å…¶ä»–è¿›ç¨‹æ¶ˆè€—äº†CPUï¼Œè¿™æ—¶æ’æŸ¥é—®é¢˜çš„æ–¹å‘å°±ä¼šæœ‰æ‰€ä¸åŒã€‚

æœ‰æ—¶ï¼ŒCPUçš„å¤šä¸ªæ ¸å¿ƒçš„ä½¿ç”¨ç‡å¯èƒ½ä¼šå­˜åœ¨æ¯”è¾ƒå¤§çš„å·®å¼‚ï¼Œæœ‰çš„æ ¸å¿ƒå¾ˆç©ºï¼Œæœ‰çš„æ ¸å¿ƒå¾ˆç¹å¿™ï¼Œè¿™ä¹Ÿä¼šå½±å“æ•°æ®åº“çš„æ•´ä½“æ€§èƒ½ï¼Œå¯ä»¥ä½¿ç”¨mpstatæ¥åˆ†ææ˜¯å¦å­˜åœ¨è¿™æ ·çš„é—®é¢˜ã€‚ä¸‹é¢å°±æ˜¯mpstatçš„ä¸€ä¸ªä¾‹å­ï¼Œå¯ä»¥çœ‹åˆ°æœåŠ¡å™¨ä¸­æ¯ä¸ªCPUæ ¸å¿ƒçš„ä½¿ç”¨æƒ…å†µã€‚

```go
mpstat -P ALL 3
```

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/86/32/86c498f4893f796fbee557a7f478cf32.png?wh=1372x222)

## å†…å­˜

ä½¿ç”¨freeå‘½ä»¤æŸ¥çœ‹ç³»ç»Ÿå½“å‰çš„å†…å­˜å ç”¨æƒ…å†µã€‚

```go
free -m
              total        used        free      shared  buff/cache   available
Mem:           7820        2219        1099         400        4501        4901
Swap:             0           0           0
```

freeå‘½ä»¤è¾“å‡ºä»¥ä¸‹æŒ‡æ ‡ï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/a1/00/a18b9e0b1cdf2daf93eb0c8218e7ed00.png?wh=1920x1076)

è¿™å‡ ä¸ªæŒ‡æ ‡æ»¡è¶³è¿™ä¸ªå…¬å¼ï¼štotal = used + buff + cached + free

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/a0/5c/a02bbf391f5c90ffe36c8f15bc883d5c.png?wh=896x182)

å¹³æ—¶æˆ‘ä»¬ç»å¸¸ä¼šç›‘æ§å†…å­˜ä½¿ç”¨ç‡ï¼Œ ä¸€èˆ¬ä½¿ç”¨å…¬å¼ï¼ˆ1 - available / totalï¼‰ * 100%æ¥è®¡ç®—å†…å­˜ä½¿ç”¨ç‡ã€‚

æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åˆ†æå†…å­˜åˆ°åº•åˆ†é…ç»™è°äº†ã€‚ä»/proc/meminfoé‡Œå¯ä»¥æŸ¥çœ‹æ›´è¯¦ç»†çš„å†…å­˜åˆ†é…æƒ…å†µã€‚

```go
# cat /proc/meminfo
MemTotal:        8008628 kB
MemFree:         3402780 kB
MemAvailable:    4852264 kB
Buffers:          130588 kB
Cached:          1898772 kB
SwapCached:            0 kB
Active:          3699600 kB
Inactive:         498932 kB
......
```

å…¶ä¸­freeå‘½ä»¤è¾“å‡ºä¸­usedæŒ‡æ ‡ä¸»è¦åŒ…æ‹¬äº†è¿™å‡ ä¸ªéƒ¨åˆ†ï¼š

- AnonPagesï¼šåŒ¿åé¡µï¼ŒåŒ…æ‹¬ç¨‹åºçš„æ ˆå’Œå †å†…å­˜ã€‚ä¸€èˆ¬é€šè¿‡mallocåˆ†é…çš„å†…å­˜å°±å±äºåŒ¿åé¡µã€‚

ä½¿ç”¨topæˆ–psæŸ¥çœ‹å„ä¸ªè¿›ç¨‹åˆ†åˆ«å ç”¨äº†å¤šå°‘å†…å­˜ï¼Œä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹ç³»ç»Ÿå†…å­˜ï¼ˆRSSï¼‰å ç”¨æœ€é«˜çš„å‡ ä¸ªè¿›ç¨‹ã€‚

```go
#  ps aux | head -1; ps aux | sort -nr -k +6 | head
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
mysql    18646  0.7  6.6 3025548 528812 ?      Sl   May21 229:17 /usr/local/mysql/bin/mysqld --defaults-file=/data/mysql01/my.cnf --basedir=/usr/local/mysql --datadir=/data/mysql01/data --plugin-dir=/usr/local/mysql/lib/plugin --user=mysql --log-error=/data/mysql01/log/alert.log --open-files-limit=1024 --pid-file=/data/mysql01/run/mysqld.pid --socket=/data/mysql01/run/mysql.sock
mysql     3588  0.4  4.9 3098484 397020 ?      Sl    2023 2157:28 /opt/mysql/bin/mysqld --defaults-file=/data/full_restore/my.cnf --basedir=/opt/mysql --datadir=/data/full_restore/data --plugin-dir=/opt/mysql/lib/plugin --user=mysql --log-error=/data/full_restore/log/alert.log --open-files-limit=1024 --pid-file=/data/full_restore/run/mysqld.pid --socket=/data/full_restore/run/mysql.sock --port=6380
mysql     2581  0.4  4.8 2715428 388512 ?      Sl    2023 2141:44 /opt/mysql/bin/mysqld --defaults-file=/data/servebinlog/my.cnf --basedir=/opt/mysql --datadir=/data/servebinlog/data --plugin-dir=/opt/mysql/lib/plugin --user=mysql --log-error=/data/servebinlog/log/alert.log --open-files-limit=1024 --pid-file=/data/servebinlog/run/mysqld.pid --socket=/data/servebinlog/run/mysql.sock --port=16380
mysql    14265  0.4  4.8 2780136 387664 ?      Sl   Jan23 875:28 /opt/mysql8.0/bin/mysqld --defaults-file=/data/mysql03/my.cnf --basedir=/opt/mysql8.0 --datadir=/data/mysql03/data --plugin-dir=/opt/mysql8.0/lib/plugin --user=mysql --log-error=/data/mysql03/log/alert.log --open-files-limit=1024 --pid-file=/data/mysql03/run/mysqld.pid --socket=/data/mysql03/run/mysql.sock --port=3308
mysql     7225  0.0  2.6 1898836 213940 ?      Sl   Feb18 154:14 /opt/mysql5.7/bin/mysqld --defaults-file=/data/mysql5.7/my.cnf --basedir=/opt/mysql5.7 --datadir=/data/mysql5.7/data --plugin-dir=/opt/mysql5.7/lib/plugin --user=mysql --log-error=/data/mysql5.7/log/alert.log --open-files-limit=1024 --pid-file=/data/mysql5.7/run/mysqld.pid --socket=/data/mysql5.7/run/mysql.sock --port=3357
proxysql 19098  0.6  0.8 480580 66468 ?        Sl    2023 2973:55 /usr/bin/proxysql --idle-threads -c /etc/proxysql.cnf
```

å½“ç„¶ï¼Œæˆ‘ä»¬ä¸èƒ½ç®€å•åœ°å°†æ‰€æœ‰è¿›ç¨‹ä½¿ç”¨çš„å†…å­˜ç›¸åŠ æ¥è®¡ç®—ç¨‹åºå ç”¨çš„å†…å­˜ï¼Œå› ä¸ºè¿›ç¨‹ä¹‹é—´å¯èƒ½ä¼šæœ‰ä¸€éƒ¨åˆ†å…±äº«çš„å†…å­˜ã€‚å¦‚æœè¦ç²¾ç¡®åœ°è®¡ç®—æ¯ä¸ªè¿›ç¨‹ç‹¬å äº†å¤šå°‘å†…å­˜ï¼Œå¯ä»¥å°† `/proc/<pid>/smaps` æ–‡ä»¶ä¸­çš„Psséƒ¨åˆ†çš„å†…å­˜ç›¸åŠ ã€‚

```go
# head smaps
00400000-01c4a000 r-xp 00000000 fd:02 48394553  ...
Size:              24872 kB
Rss:                2924 kB
Pss:                2924 kB
......
```

- Slabï¼šå†…æ ¸å¯¹è±¡ç¼“å­˜ï¼Œç¼“å­˜äº†å†…æ ¸ä¸­çš„å„ç±»æ•°æ®ç»“æ„ã€‚ä½¿ç”¨slabtopå‘½ä»¤å¯ä»¥æŸ¥çœ‹æ˜¯å“ªäº›å†…æ ¸å¯¹è±¡æ¶ˆè€—çš„ç©ºé—´ã€‚

<!--THE END-->

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/9b/98/9beafef112d9febcc3d06c2d2d761f98.png?wh=1140x554)

- PageTablesï¼šé¡µè¡¨å ç”¨çš„ç©ºé—´ã€‚åœ¨å¤§å†…å­˜æœºå™¨ä¸Šï¼Œæœ‰æ—¶PageTablesä¼šå ç”¨å¤§é‡å†…å­˜ã€‚ä½¿ç”¨å¤šè¿›ç¨‹æ¨¡å¼æ•°æ®åº“å¦‚Oracleæ—¶ï¼Œè¿™ä¸ªé—®é¢˜ä¼šæ¯”è¾ƒçªå‡ºã€‚å¼€å¯å¤§é¡µå¯ä»¥æœ‰æ•ˆåœ°é¿å…è¿™ä¸ªé—®é¢˜ã€‚

å†…å­˜ä½¿ç”¨ç‡åªèƒ½å¤§è‡´åæ˜ æœåŠ¡å™¨çš„å†…å­˜ä½¿ç”¨æ°´ä½ï¼Œæœ‰æ—¶æˆ‘ä»¬è¿˜éœ€è¦å…³æ³¨å†…å­˜çš„åŠ¨æ€åˆ†é…å’Œå›æ”¶æƒ…å†µã€‚Linuxå†…æ ¸ç»Ÿä¸€ç®¡ç†æ“ä½œç³»ç»Ÿçš„æ‰€æœ‰å†…å­˜ï¼Œåº”ç”¨ç¨‹åºä½¿ç”¨å†…å­˜æ—¶æœ€ç»ˆéœ€è¦å‘å†…æ ¸ç”³è¯·ã€‚å½“å†…æ ¸å‘ç°ç³»ç»Ÿçš„ç©ºé—²å†…å­˜ä¸å¤Ÿæ—¶ï¼Œéœ€è¦è¿è¡Œä¸€ç³»åˆ—çš„ç®—æ³•æ¥å›æ”¶å†…å­˜ã€‚

ä¸‹é¢è¿™ä¸ªå›¾æ ‡è¯†äº†é€šå¸¸æ¶ˆè€—å†…å­˜æœ€å¤§çš„å‡ ä¸ªéƒ¨åˆ†ï¼ŒåŒ…æ‹¬Buffer/Cacheï¼ŒåŒ¿åé¡µï¼ˆAnonPagesï¼‰ã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/48/6a/48077b199e445abyy016bd2c7806ae6a.jpg?wh=1136x540)

æ ¹æ®å†…å­˜çš„ä¸åŒç”¨é€”ï¼Œå›æ”¶æ—¶éœ€è¦é‡‡å–ä¸åŒçš„æ–¹å¼ï¼š

- buffers / cachedï¼šå›æ”¶è¿™éƒ¨åˆ†çš„å†…å­˜æ—¶ï¼Œéœ€è¦å°†å†…å­˜é¡µçš„è„æ•°æ®å†™å›åˆ°å­˜å‚¨è®¾å¤‡ä¸­ã€‚
- AnonPagesï¼šå›æ”¶è¿™éƒ¨åˆ†å†…å­˜æ—¶ï¼Œéœ€è¦å°†å†…å­˜é¡µæ¢å‡ºï¼ˆswapï¼‰åˆ°SWAPè®¾å¤‡ä¸­ã€‚swapä¼šä¸¥é‡å½±å“ç³»ç»Ÿæ€§èƒ½ã€‚

å†…æ ¸ä¼šæ ¹æ®å‚æ•°vm.swappinessçš„è®¾ç½®ï¼Œæ¥å†³å®šä¼˜å…ˆä»å“ªä¸ªéƒ¨åˆ†å›æ”¶å†…å­˜ã€‚å½“vm.swappinessçš„è®¾ç½®æ¥è¿‘100æ—¶ï¼Œå†…æ ¸å€¾å‘äºå°†è¿›ç¨‹æ¢å‡ºåˆ°swapè®¾å¤‡ã€‚å½“vm.swappinessçš„è®¾ç½®æ¥è¿‘0æ—¶ï¼Œå†…æ ¸å€¾å‘äºå›æ”¶Buffers/Cachedéƒ¨åˆ†çš„å†…å­˜ã€‚å¯¹äºæ•°æ®åº“æœåŠ¡å™¨ï¼Œå»ºè®®å°†å†…æ ¸å‚æ•°vm.swappinessè®¾ç½®ä¸ºæ¯”è¾ƒå°çš„å€¼ï¼Œå¦‚0æˆ–1ï¼Œè¿™æ ·èƒ½å°½é‡é¿å…ç”±äºSWAPè€Œå¯¼è‡´æœåŠ¡å™¨æ€§èƒ½ä¸‹é™ã€‚

ä½¿ç”¨vmstatå‘½ä»¤æŸ¥çœ‹ç³»ç»Ÿæ˜¯å¦æ­£åœ¨è¿›è¡Œswapã€‚å‘½ä»¤è¾“å‡ºä¸­siå’Œsoåˆ—å±•ç¤ºäº†å¹³å‡æ¯ç§’æ¢å‡ºå’Œæ¢å…¥çš„é¡µé¢æ•°ã€‚

```go
# vmstat 3
procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----
 r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st
 2  3      0 165068 115608 4403772    0    0     3     2    0    0  0  0 100  0  0
 1  2      0 163472 115608 4406064    0    0     0 76485 1532 2634  0  4 42 54  0
 0  3      0 164172 115608 4405640    0    0     0 59403 1474 2475  0  4 34 61  0
 0  3      0 151440 115608 4418524    0    0     0 85520 1581 2458  0  6 35 59  0
 0  3      0 169916 115608 4398456    0    0     0 80576 1442 2407  0  3 38 58  0
 0  3      0 123476 115608 4448100    0    0     0 84989 1477 2362  1  4 35 61  0
```

ä½¿ç”¨sar -Bå‘½ä»¤å¯ä»¥æŸ¥çœ‹å†…å­˜çš„åˆ†é…å’Œå›æ”¶çš„é¢‘ç‡ï¼Œéœ€è¦é‡ç‚¹å…³æ³¨pgscank/sã€pgscand/så’Œ%vmeffè¿™å‡ åˆ—çš„è¾“å‡ºã€‚

å½“æœåŠ¡å™¨ä¸­çš„ç©ºé—²å†…å­˜å°‘äºä¸€å®šçš„é˜ˆå€¼ï¼ˆè·Ÿå‚æ•°vm.min\_free\_kbytesæœ‰å…³ï¼‰æ—¶ï¼Œå†…æ ¸ä¸­æœ‰ä¸“é—¨çš„çº¿ç¨‹ï¼ˆkswapdï¼‰ä¼šå°è¯•å›æ”¶å†…å­˜ï¼Œæ‰«æçš„å†…å­˜é¡µæ•°é€šè¿‡æŒ‡æ ‡pgscank/sè¾“å‡ºã€‚å¦‚æœè¿›ç¨‹åœ¨åˆ†é…å†…å­˜æ—¶å‘ç°ç©ºé—²å†…å­˜ä¸è¶³ï¼Œé‚£ä¹ˆè¿›ç¨‹ä¹Ÿä¼šå°è¯•é‡Šæ”¾ä¸€éƒ¨åˆ†ç¼“å­˜ä¸­çš„å†…å­˜ã€‚è¿›ç¨‹æ‰«æçš„é¡µé¢æ•°é€šè¿‡æŒ‡æ ‡pgscand/sè¾“å‡ºã€‚

å½“pgscandæ¯”è¾ƒé«˜ï¼ŒåŒæ—¶%vmeffæ¯”è¾ƒä½çš„æ—¶å€™ï¼Œè¯´æ˜æœåŠ¡å™¨å†…å­˜èµ„æºå¾ˆç´§å¼ ï¼Œéœ€è¦æ‰«æå¤§é‡çš„é¡µé¢æ‰èƒ½å›æ”¶å°‘é‡å†…å­˜ï¼Œæ­¤æ—¶æœåŠ¡å™¨çš„æ€§èƒ½é€šå¸¸ä¼šæ¯”è¾ƒå·®ã€‚æˆ‘åœ¨çœŸå®ç¯å¢ƒä¸­å¤šæ¬¡é‡åˆ°è¿‡è¿™ä¸ªé—®é¢˜ã€‚å¦‚æœä»…ä»…çœ‹å†…å­˜ä½¿ç”¨ç‡ï¼Œå¹¶ä¸èƒ½å‘ç°é—®é¢˜ã€‚

ä¸‹é¢æ˜¯sar -Bçš„è¾“å‡ºã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/0e/29/0ed6cd80f82afb6effaca0b54bb97c29.png?wh=682x262)

æœåŠ¡å™¨å†…å­˜èµ„æºç‰¹åˆ«ç´§å¼ ï¼Œä½¿ç”¨å‰é¢æåˆ°çš„å‡ ç§æ–¹å¼éƒ½æ— æ³•å›æ”¶è¶³å¤Ÿçš„å†…å­˜æ—¶ï¼Œå¯èƒ½è¿˜ä¼šè§¦å‘OOM-Killerã€‚OOM-Killerä¼šé€šè¿‡ä¸€å®šçš„è§„åˆ™Killæ‰ä¸€äº›è¿›ç¨‹ï¼Œä»¥æ­¤æ¥é‡Šæ”¾å†…å­˜ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨dmesgå‘½ä»¤æˆ–åˆ°ç³»ç»Ÿæ—¥å¿—ï¼ˆå¦‚/var/log/messages)ä¸­æŸ¥çœ‹æ˜¯å¦æœ‰OOMå‡ºç°ã€‚

```go
[16508339.852674] Out of memory: Kill process 22072 (mysqld) score 85 or sacrifice child
[16508339.853626] Killed process 22072 (mysqld), UID 1000, total-vm:6674180kB, anon-rss:682784kB, file-rss:0kB, shmem-rss:0kB
[16508339.855371] systemd-journal invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0
[16508339.855374] systemd-journal cpuset=/ mems_allowed=0
[16508339.855376] CPU: 3 PID: 384 Comm: systemd-journal Kdump: loaded Not tainted 3.10.0-1160.el7.x86_64 #1
[16508339.855378] Hardware name: Red Hat KVM, BIOS 1.11.0-3.el7 04/01/2014
[16508339.855379] Call Trace:
[16508339.855385]  [<ffffffffb9f81340>] dump_stack+0x19/0x1b
[16508339.855387]  [<ffffffffb9f7bc60>] dump_header+0x90/0x229
[16508339.855390]  [<ffffffffb9906362>] ? ktime_get_ts64+0x52/0xf0
[16508339.855394]  [<ffffffffb995db7f>] ? delayacct_end+0x8f/0xb0
[16508339.855397]  [<ffffffffb99c208d>] oom_kill_process+0x2cd/0x490
[16508339.855399]  [<ffffffffb99c1a7d>] ? oom_unkillable_task+0xcd/0x120
[16508339.855401]  [<ffffffffb99c277a>] out_of_memory+0x31a/0x500
[16508339.855404]  [<ffffffffb9f7c77d>] __alloc_pages_slowpath+0x5db/0x729
[16508339.855406]  [<ffffffffb99c8d76>] __alloc_pages_nodemask+0x436/0x450
[16508339.855410]  [<ffffffffb9a189d8>] alloc_pages_current+0x98/0x110
[16508339.855412]  [<ffffffffb99bdb47>] __page_cache_alloc+0x97/0xb0
[16508339.855414]  [<ffffffffb99c0ae0>] filemap_fault+0x270/0x420
[16508339.855443]  [<ffffffffc028791e>] __xfs_filemap_fault+0x7e/0x1d0 [xfs]
[16508339.855456]  [<ffffffffc0287b1c>] xfs_filemap_fault+0x2c/0x30 [xfs]
[16508339.855459]  [<ffffffffb99ede3a>] __do_fault.isra.61+0x8a/0x100
[16508339.855461]  [<ffffffffb99ee3ec>] do_read_fault.isra.63+0x4c/0x1b0
[16508339.855463]  [<ffffffffb99f5c30>] handle_mm_fault+0xa20/0xfb0
[16508339.855466]  [<ffffffffb9f8e653>] __do_page_fault+0x213/0x500
[16508339.855468]  [<ffffffffb9f8ea26>] trace_do_page_fault+0x56/0x150
[16508339.855469]  [<ffffffffb9f8dfa2>] do_async_page_fault+0x22/0xf0
[16508339.855472]  [<ffffffffb9f8a7a8>] async_page_fault+0x28/0x30
[16508339.855473] Mem-Info:
```

åœ¨å¤§å†…å­˜çš„æœºå™¨ä¸Šï¼Œä¸€èˆ¬å»ºè®®å°†å‚æ•°vm.min\_free\_kbytesç¨å¾®è®¾ç½®å¾—å¤§ä¸€äº›ï¼Œæ¯”å¦‚ç³»ç»Ÿæ€»å†…å­˜çš„5%ï¼Œè¿™æ ·å†…æ ¸ä¼šåœ¨å¹³æ—¶å¤šé¢„ç•™ä¸€äº›ç©ºé—²å†…å­˜ï¼Œå½“ç¨‹åºçªç„¶éœ€è¦å¤§é‡å†…å­˜æ—¶ï¼Œå¯ä»¥åšä¸€äº›ç¼“å†²ã€‚

## ç£ç›˜IO

æ•°æ®åº“æ˜¯IOå¯†é›†å‹çš„åº”ç”¨ï¼Œåœ¨æ•°æ®åº“æœåŠ¡å™¨ä¸­ï¼Œç£ç›˜IOæ¯”è¾ƒå®¹æ˜“æˆä¸ºç“¶é¢ˆã€‚ä½¿ç”¨iostatå‘½ä»¤å¯ä»¥å¤§è‡´äº†è§£ç³»ç»Ÿå½“å‰ç£ç›˜IOçš„æƒ…å†µã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/3f/40/3f9b04b35155e7acd3b823a0913b7140.png?wh=1716x690)

iostatå‘½ä»¤ä¸ºç³»ç»Ÿé‡Œçš„æ¯ä¸ªç£ç›˜è®¾å¤‡éƒ½æä¾›äº†å‡ ä¸ªåŸºæœ¬çš„æŒ‡æ ‡ã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/4f/81/4fbe5c985318c275a0e1d4a6a63efe81.png?wh=1736x1504)

ä½¿ç”¨iostatæ—¶ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨å‡ ç‚¹ï¼š

1. æ¯ç§’IOè¯»å†™æ¬¡æ•°ã€‚
2. IOå“åº”æ—¶é—´ã€‚å“åº”æ—¶é—´å’Œç£ç›˜è®¾å¤‡çš„ç±»å‹ç›¸å…³ã€‚å¦‚æœä½¿ç”¨é«˜æ€§èƒ½çš„SSDæˆ–é—ªå­˜å¡ï¼ŒIOå“åº”æ—¶é—´å¯èƒ½ä¸åˆ°1æ¯«ç§’ã€‚å¦‚æœä½¿ç”¨ä¼ ç»Ÿçš„æœºæ¢°ç£ç›˜ï¼Œæ­£å¸¸çš„å“åº”æ—¶é—´å¤§è‡´åœ¨5-10æ¯«ç§’ã€‚
3. %utilä»…ä»…ç”¨æ¥å‚è€ƒã€‚å®é™…ä¸Šä½¿ç”¨ç‡è¾¾åˆ°100%ä¹Ÿä¸ä¸€å®šæœ‰é—®é¢˜ã€‚

ä¸åŒçš„ç£ç›˜è®¾å¤‡ï¼Œåœ¨æ€§èƒ½ä¸Šä¼šæœ‰å¾ˆå¤§çš„å·®å¼‚ã€‚æˆ‘ä»¬å‰é¢çš„è¿™ä¸ªä¾‹å­ä¸­ï¼ŒIOPSå¾ˆä½ï¼Œä½†æ˜¯å“åº”æ—¶é—´è¾¾åˆ°äº†å‡ ç™¾æ¯«ç§’ï¼Œè¯´æ˜åº•å±‚çš„IOæ€§èƒ½çœŸçš„æ¯”è¾ƒä½ã€‚

æˆ‘ä»¬å»ºè®®åœ¨æ•°æ®åº“æœåŠ¡å™¨ä¸Šçº¿å‰ï¼Œä½¿ç”¨å·¥å…·è¿›è¡Œä¸€äº›åŸºå‡†IOæ€§èƒ½æµ‹è¯•ï¼Œä¹Ÿä¸ºåç»­åˆ†æç³»ç»Ÿæ€§èƒ½æä¾›åŸºå‡†æ•°æ®ã€‚fioæ˜¯ä¸šç•Œä½¿ç”¨æ¯”è¾ƒå¤šçš„ä¸€æ¬¾linux ioæ€§èƒ½æµ‹è¯•å·¥å…·ã€‚

æœ‰æ—¶å€™æˆ‘ä»¬å¯èƒ½éœ€è¦çŸ¥é“åˆ°åº•æ˜¯è°å‘èµ·çš„IOè¯·æ±‚ï¼Œå¯ä»¥ä½¿ç”¨iotopå·¥å…·ï¼Œä¸‹å›¾æ˜¯iotopå‘½ä»¤çš„è¾“å‡ºï¼Œå¯ä»¥çœ‹å‡ºå¤§éƒ¨åˆ†IOè¯·æ±‚æ˜¯mysqldå‘èµ·çš„ã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/23/b0/23410ce489ba9e2c9df4e73f94b40fb0.png?wh=1504x546)

## æ–‡ä»¶ç³»ç»Ÿ

æˆ‘ä»¬éœ€è¦å…³æ³¨æ–‡ä»¶ç³»ç»Ÿçš„ä½¿ç”¨ç‡ã€‚æ–‡ä»¶ç³»ç»Ÿç©ºé—´æˆ–Inodeç”¨æ»¡äº†éƒ½ä¼šå¼•èµ·ä¸€äº›é—®é¢˜ã€‚å¯ä»¥ä½¿ç”¨dfå‘½ä»¤æŸ¥çœ‹ç©ºé—´ä½¿ç”¨ç‡å’ŒInodeçš„ä½¿ç”¨ç‡ã€‚

```go
# df -h /data
Filesystem      Size  Used Avail Use% Mounted on
/dev/vdb1        99G   15G   80G  16% /data


# df -i /data
Filesystem      Inodes IUsed   IFree IUse% Mounted on
/dev/vdb1      6553600  3086 6550514    1% /data
```

MySQLä¸­ï¼Œå¦‚æœæ•°æ®ç›˜æ»¡äº†ï¼Œä¼šå¯¼è‡´å†™å…¥æ“ä½œæŒ‚èµ·ã€‚

```go
mysql> show full processlist\G

*************************** 8. row ***************************
     Id: 158
   User: root
   Host: localhost:51312
     db: rep
Command: Query
   Time: 241
  State: waiting for handler commit
   Info: insert into ty values(10,10,10,10)
```

æ­¤æ—¶å¦‚æœæŸ¥çœ‹MySQLçš„é”™è¯¯æ—¥å¿—ï¼Œå°±èƒ½å‘ç°ç£ç›˜ç©ºé—´å†™æ»¡çš„æ—¥å¿—ä¿¡æ¯ã€‚

```go
2024-06-11T08:00:16.687933Z 158 [ERROR] [MY-000035] [Server] Disk is full writing './binlog.000006' (OS errno 28 - No space left on device). Waiting for someone to free space... Retry in 60 secs. Message reprinted in 600 secs.
2024-06-11T08:10:16.743846Z 158 [ERROR] [MY-000035] [Server] Disk is full writing './binlog.000006' (OS errno 28 - No space left on device). Waiting for someone to free space... Retry in 60 secs. Message reprinted in 600 secs.
```

## ç½‘ç»œ

åº”ç”¨ç¨‹åºä¸€èˆ¬éƒ½é€šè¿‡TCPåè®®å’Œæ•°æ®åº“æœåŠ¡å™¨è¿›è¡Œäº¤äº’ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨sarå‘½ä»¤æŸ¥çœ‹ç½‘ç»œååé‡ã€‚

```go
# sar -n DEV 3
Linux 3.10.0-1160.el7.x86_64 (172-16-121-234) 	06/18/2024 	_x86_64_	(4 CPU)

04:53:08 PM     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s
04:53:11 PM      eth0      4.67      0.00      0.26      0.00      0.00      0.00      0.00
04:53:11 PM        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00

04:53:11 PM     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s
04:53:14 PM      eth0      6.67      0.33      0.37      0.06      0.00      0.00      0.00
04:53:14 PM        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00
```

è¿™é‡Œä¸»è¦å…³æ³¨ç½‘ç»œçš„ååé‡ï¼ŒåŒ…æ‹¬æ¯ç§’ä¼ è¾“çš„å­—èŠ‚æ•°å’ŒåŒ…çš„æ•°é‡ã€‚å½“ç„¶ï¼Œå¦‚æœæ•°æ®åº“æœåŠ¡å™¨ä½¿ç”¨ä¸‡å…†ç½‘ï¼Œä¸€èˆ¬ç½‘ç»œä¸å¤ªä¼šæˆä¸ºç“¶é¢ˆã€‚

æ­¤å¤–ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦æŸ¥çœ‹TCPè¿æ¥ï¼Œlinuxä¸­å¯ä»¥ä½¿ç”¨netstatæˆ–sså‘½ä»¤æŸ¥çœ‹ç½‘ç»œè¿æ¥ã€‚ä¸‹é¢çš„ä¾‹å­ä½¿ç”¨äº†netstatå‘½ä»¤æŸ¥çœ‹æœåŠ¡å™¨ä¸Šçš„ç›‘å¬ç«¯å£ã€‚

```go
# netstat -nltp
```

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/a0/ff/a0e927829fee650e54b44e0ef77ebcff.png?wh=1376x416)

## è¿›ç¨‹èµ„æºé™åˆ¶

Linuxç³»ç»Ÿå¯¹è¿›ç¨‹å…è®¸ä½¿ç”¨çš„èµ„æºä½¿ç”¨åšäº†ä¸€å®šçš„é™åˆ¶ã€‚å¸¸è§çš„èµ„æºé™åˆ¶æœ‰2ç§ã€‚

- Max open filesï¼šå…è®¸è¿›ç¨‹åŒæ—¶æ‰“å¼€çš„æ–‡ä»¶å¥æŸ„æ•°ã€‚Linuxä¸‹ï¼Œæ‰“å¼€æ–‡ä»¶ã€åˆ›å»ºTCPè¿æ¥éƒ½éœ€è¦å ç”¨æ–‡ä»¶å¥æŸ„ã€‚å½“è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶æ•°è¾¾åˆ°é™åˆ¶åï¼Œæ— æ³•å†æ‰“å¼€æ–°çš„æ–‡ä»¶ï¼ŒæŠ¥é”™ä¿¡æ¯ä¸ºToo many open filesã€‚
- Max processesï¼šåŒä¸€ä¸ªç”¨æˆ·å…è®¸è¿è¡Œçš„æœ€å¤§çº¿ç¨‹æ•°ã€‚è¶…è¿‡è¯¥é™åˆ¶åæ— æ³•åˆ›å»ºæ–°çš„è¿›ç¨‹æˆ–çº¿ç¨‹ï¼ŒæŠ¥é”™ä¿¡æ¯ä¸ºfork: Resource temporarily unavailableã€‚

ä¸€èˆ¬åœ¨/etc/security/limits.då’Œ/etc/security/limits.confä¸­è®¾ç½®èµ„æºé™åˆ¶ã€‚å¯¹äºæ•°æ®åº“æœåŠ¡å™¨ï¼Œlinuxç³»ç»Ÿé»˜è®¤çš„è®¾ç½®ä¸å¤Ÿå¤§ï¼Œå»ºè®®å°†æœ€å¤§å¯æ‰“å¼€çš„æ–‡ä»¶æ•°ã€æœ€å¤§çš„è¿›ç¨‹æ•°è®¾ç½®å¾—å¤§ä¸€äº›ã€‚ç»è¿‡æµ‹è¯•ï¼Œæ‰“å¼€çš„æ–‡ä»¶æ•°æœ€å¤§å¯è®¾ç½®ä¸º1048576ã€‚

```go
# limits.conf
mysql       soft    nproc     unlimited
mysql       soft    nofile    65535
```

å½“ç„¶ï¼Œæœ‰æ—¶å€™è¿è¡Œä¸­çš„è¿›ç¨‹ç”Ÿæ•ˆçš„ulimité™åˆ¶å¯èƒ½ä¼šè·Ÿé…ç½®æ–‡ä»¶ä¸­çš„è®¾ç½®ä¸ä¸€è‡´ï¼Œå› ä¸ºé…ç½®æ–‡ä»¶ä¸­çš„è®¾ç½®åªæœ‰å½“ç”¨æˆ·æ–°ç™»å½•ç³»ç»Ÿæ—¶ï¼Œæˆ–è¿›ç¨‹å¯åŠ¨æ—¶æ‰ä¼šå¯ç”¨ã€‚å¦‚æœé‡åˆ°ç¨‹åºæœ‰èµ„æºé™åˆ¶ç›¸å…³çš„æŠ¥é”™ï¼Œä½ å¯ä»¥åˆ°/proc//limitsæ–‡ä»¶ä¸­æ£€æŸ¥è¿›ç¨‹çš„å®é™…èµ„æºé™åˆ¶æ˜¯å¤šå°‘ã€‚

```go
# cat /proc/18646/limits
Limit                     Soft Limit           Hard Limit           Units
Max cpu time              unlimited            unlimited            seconds
Max file size             unlimited            unlimited            bytes
Max data size             unlimited            unlimited            bytes
Max stack size            8388608              unlimited            bytes
Max core file size        0                    unlimited            bytes
Max resident set          unlimited            unlimited            bytes
Max processes             65536                65536                processes
Max open files            20005                20005                files
```

## æ“ä½œç³»ç»Ÿæ—¥å¿—

é™¤äº†åˆ†æå‡ å¤§èµ„æºçš„ä½¿ç”¨æƒ…å†µï¼Œæˆ‘ä»¬è¿˜éœ€è¦å…³æ³¨æ“ä½œç³»ç»Ÿå±‚é¢çš„ä¸€äº›æ—¥å¿—ä¿¡æ¯ã€‚æ“ä½œç³»ç»Ÿçš„å„ç±»æ—¥å¿—ä¸­å¯èƒ½æœ‰ä¸€äº›æŒ‡æ˜é—®é¢˜çš„å…³é”®ä¿¡æ¯ã€‚ä½¿ç”¨dmesgå‘½ä»¤å¯ä»¥æŸ¥çœ‹å†…æ ¸æœ€è¿‘çš„ä¸€äº›æ—¥å¿—ã€‚

```go
# dmesg
[    0.000000] Linux version 5.15.0-107-generic (buildd@lcy02-amd64-012) (gcc (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0, GNU ld (GNU Binutils for Ubuntu) 2.38) #117-Ubuntu SMP Fri Apr 26 12:26:49 UTC 2024 (Ubuntu 5.15.0-107.117-generic 5.15.149)
[    0.000000] Command line: BOOT_IMAGE=/boot/vmlinuz-5.15.0-107-generic root=UUID=18233b60-bbf5-4e7e-a5d7-8044679ada59 ro vga=792 console=tty0 console=ttyS0,115200n8 net.ifnames=0 noibrs iommu=pt crashkernel=0M-1G:0M,1G-4G:192M,4G-128G:384M,128G-:512M nvme_core.io_timeout=4294967295 nvme_core.admin_timeout=4294967295
[    0.000000] KERNEL supported cpus:
[    0.000000]   Intel GenuineIntel
[    0.000000]   AMD AuthenticAMD
[    0.000000]   Hygon HygonGenuine
[    0.000000]   Centaur CentaurHauls
[    0.000000]   zhaoxin   Shanghai
[    0.000000] BIOS-provided physical RAM map:
[    0.000000] BIOS-e820: [mem 0x00000000000000
```

æ—¥å¿—ç®¡ç†å·¥å…·ï¼ˆæ¯”è¾ƒå¸¸ç”¨çš„æœ‰rsyslogdï¼‰ä¼šå°†æ—¥å¿—å­˜å‚¨åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ã€‚ä¸åŒå‘è¡Œç‰ˆæœ¬çš„Linuxå¯èƒ½ä¼šå°†æ—¥å¿—å­˜æ”¾åˆ°ä¸åŒçš„é»˜è®¤æ–‡ä»¶ä¸­ï¼Œä¸è¿‡ä¸€èˆ¬éƒ½ä¼šæ”¾åˆ°/var/logç›®å½•ä¸‹ã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/83/f4/83cdd7511e0878ca1ba68bc677e1ddf4.png?wh=1920x883)

systemdçš„æ—¥å¿—å¯ä»¥ä½¿ç”¨journalctlæŸ¥çœ‹ï¼Œä¸‹é¢æ˜¯ä¸€äº›ä½¿ç”¨åœºæ™¯ã€‚

- ä½¿ç”¨journalctl -kæŸ¥çœ‹å†…æ ¸æ—¥å¿—ã€‚

```go
# journalctl -k
-- Logs begin at Sat 2023-10-14 09:35:01 CST, end at Thu 2024-06-20 10:30:01 CST. --
Oct 26 17:30:37 172-16-121-236 kernel: connection invoked oom-killer: gfp_mask=0x201da, order=0, oom_score
Oct 26 17:30:37 172-16-121-236 kernel: connection cpuset=/ mems_allowed=0
Oct 26 17:30:37 172-16-121-236 kernel: CPU: 1 PID: 27480 Comm: connection Kdump: loaded Not tainted 3.10.0
Oct 26 17:30:37 172-16-121-236 kernel: Hardware name: Red Hat KVM, BIOS 1.11.0-3.el7 04/01/2014
```

- ä½¿ç”¨journalctl -u sshdæŸ¥çœ‹æœåŠ¡å™¨çš„ç”¨æˆ·ç™»å½•æ—¥å¿—ã€‚

```go
# journalctl -u sshd
-- Logs begin at Sat 2023-10-14 09:35:01 CST, end at Thu 2024-06-20 10:35:01 CST. --
Oct 23 14:08:20 172-16-121-236 sshd[17680]: Connection closed by 192.168.112.14 port 63441 [preauth]
Nov 17 10:07:15 172-16-121-236 sshd[6079]: Accepted password for root from 192.168.112.14 port 61077 ssh2
Nov 17 10:10:07 172-16-121-236 sshd[6120]: Accepted password for root from 192.168.112.14 port 62858 ssh2
Nov 17 11:14:13 172-16-121-236 sshd[6438]: Accepted password for root from 192.168.112.14 port 62389 ssh2
Nov 30 10:08:40 172-16-121-236 sshd[18206]: Accepted password for root from 192.168.112.14 port 50524 ssh2
Dec 05 18:08:54 172-16-121-236 sshd[4075]: pam_unix(sshd:auth): authentication failure; logname= uid=0 eui
```

- ä½¿ç”¨journalctl -xeæŸ¥çœ‹systemdæœ€æ–°çš„æ—¥å¿—

å½“ç³»ç»Ÿä¸­æœ‰æŸä¸ªæœåŠ¡å¯åŠ¨å¤±è´¥æ—¶ï¼Œå¯ä»¥ç”¨è¿™ä¸ªå‘½ä»¤æŸ¥çœ‹ç›¸å…³æ—¥å¿—ã€‚

```go
#  journalctl -xe
-- Unit systemd-update-utmp-runlevel.service has finished starting up.
--
-- The start-up result is done.
6æœˆ 20 11:10:32 172-16-121-236 systemd[1]: Startup finished in 906ms (kernel) + 4.374s (initrd) + 47.514s
-- Subject: System start-up is now complete
-- Defined-By: systemd
-- Support: http://lists.freedesktop.org/mailman/listinfo/systemd-devel
```

## æ€»ç»“

Linuxæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„æ“ä½œç³»ç»Ÿï¼Œä¹Ÿæœ‰ä¸€å®šçš„å¤æ‚åº¦ã€‚åœ¨è¿™ä¸€è®²ä¸­ï¼Œæˆ‘ä»¬åˆ†åˆ«ä»‹ç»äº†ç³»ç»Ÿä¸­å‡ å¤§ç±»èµ„æºçš„åŸºæœ¬è¯„ä¼°æ–¹æ³•ã€‚ä¸€èˆ¬åœ¨åˆ†ææ“ä½œç³»ç»Ÿç›¸å…³é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬ä¼šè€ƒè™‘å‡ ä¸ªé—®é¢˜ã€‚

1. æ˜¯å¦æœ‰èµ„æºè¾¾åˆ°äº†ç“¶é¢ˆã€‚æ¯”å¦‚CPUæ˜¯ä¸æ˜¯æ‰“æ»¡äº†ï¼Œç½‘ç»œå¸¦å®½æ˜¯å¦ç”¨æ»¡äº†ï¼Œæ˜¯å¦æœ‰å¤§é‡å†…å­˜é¡µé¢æ¢å…¥æ¢å‡ºï¼Œæ–‡ä»¶ç³»ç»Ÿç©ºé—´æˆ–Inodeæ˜¯å¦ç”¨å®Œäº†ã€‚
2. ç¡¬ä»¶æ˜¯å¦æœ‰æ€§èƒ½é™çº§çš„æƒ…å†µã€‚æ¯”å¦‚CPUæ˜¯å¦è¿è¡Œåœ¨èŠ‚èƒ½æ¨¡å¼ä¸‹ï¼Œç¡¬ç›˜æ˜¯å¦å­˜åœ¨æ•…éšœï¼ŒRAIDå¡ç”µæ± æ˜¯å¦åœ¨å……æ”¾ç”µã€‚è·Ÿè½¯ä»¶æ•…éšœç›¸æ¯”ï¼Œç¡¬ä»¶æ•…éšœçš„æ¦‚ç‡å¯èƒ½æ›´ä½ï¼Œä½†æ˜¯ç¡¬ä»¶ä¸€æ—¦æœ‰æ•…éšœï¼Œå°±å¯èƒ½å¯¹æ€§èƒ½é€ æˆä¸¥é‡çš„å½±å“ã€‚
3. ç³»ç»Ÿä¸­æ˜¯å¦æœ‰ä¸€äº›æŠ¥é”™æ—¥å¿—ä¿¡æ¯ã€‚æ¯”å¦‚å‘ç”ŸOOMæ—¶ï¼Œå†…æ ¸ä¼šè¾“å‡ºç›¸åº”çš„æ—¥å¿—ã€‚

å½“ç„¶å¦‚æœä½ ä½¿ç”¨äº†äº‘æ•°æ®åº“ï¼Œå¯èƒ½æ²¡æœ‰æ“ä½œç³»ç»Ÿçš„æƒé™ã€‚ä½†ä¾ç„¶æœ‰å¿…è¦æ·±å…¥äº†è§£æ“ä½œç³»ç»Ÿçš„ä¸€äº›åŸºæœ¬åŸç†ï¼Œæ¯•ç«Ÿæ•°æ®åº“æ˜¯è¿è¡Œåœ¨æ“ä½œç³»ç»Ÿç¯å¢ƒä¸­çš„ã€‚ä¸€èˆ¬äº‘æ•°æ®åº“å‚å•†ä¼šæä¾›ä¸€äº›æ“ä½œç³»ç»Ÿçš„åŸºç¡€ç›‘æ§æŒ‡æ ‡ï¼Œä½ å¯ä»¥é€šè¿‡è¿™äº›æŒ‡æ ‡æ¥è¿›è¡Œåˆ¤æ–­ã€‚å¦‚æœä½ æ€€ç–‘æ“ä½œç³»ç»Ÿæˆ–åº•å±‚ç¡¬ä»¶æœ‰é—®é¢˜ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å·¥å•æˆ–å”®åæœåŠ¡ç­‰å½¢å¼å¯»æ‰¾å‚å•†çš„å¸®åŠ©ï¼Œå½“ç„¶ä½ æœ€å¥½èƒ½æä¾›ä¸€äº›å…³é”®çš„è¯æ®ã€‚

## æ€è€ƒé¢˜

æœ‰ä¸€ä¸ªç”Ÿäº§ç¯å¢ƒçš„ç³»ç»Ÿï¼Œæœ‰æ—¶å€™ä¼šå‡ºç°æ•°æ®åº“è¿æ¥è¶…æ—¶çš„æŠ¥é”™ã€‚ä»æŠ¥é”™çš„ä¿¡æ¯çœ‹ï¼Œè¶…æ—¶åº”è¯¥å’Œç½‘ç»œæœ‰ç‚¹å…³ç³»ã€‚é‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼Œä½ ä¼šä½¿ç”¨å“ªäº›æ–¹æ³•æ¥å®šä½åŸå› å‘¢ï¼Ÿ

æœŸå¾…ä½ çš„æ€è€ƒï¼Œæ¬¢è¿åœ¨ç•™è¨€åŒºä¸­ä¸æˆ‘äº¤æµã€‚å¦‚æœä»Šå¤©çš„è¯¾ç¨‹è®©ä½ æœ‰æ‰€æ”¶è·ï¼Œä¹Ÿæ¬¢è¿è½¬å‘ç»™æœ‰éœ€è¦çš„æœ‹å‹ã€‚æˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ1ï¼‰</strong></div><ul>
<li><span>ls</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æœ‰æ—¶å€™å‡ºç°è¶…æ—¶ï¼Œè¯´æ˜è¿æ¥æ•°æ®åº“çš„è´¦å·å’Œå¯†ç åŠæœåŠ¡ç«¯ç«¯å£ å‡ºé—®é¢˜çš„æ¦‚ç‡è¾ƒå°‘ã€‚å¯ä»¥å¯¹ç½‘ç»œè¿›è¡ŒæŠ“åŒ…ï¼Œåˆ†æå‡ºé—®é¢˜æ—¶é—´ç‚¹çš„æŠ¥æ–‡æƒ…å†µï¼Œçœ‹æ˜¯æœåŠ¡ç«¯æ”¶å‘é—®é¢˜ï¼Œè¿˜æ˜¯å®¢æˆ·ç«¯æ”¶å‘é—®é¢˜ï¼Œè¿˜æ˜¯ä¸­é—´æœ‰é˜²ç«å¢™ç±»ä¼¼å‘é€resetåŒ…ï¼ŒæŠ“åŒ…åº”è¯¥èƒ½æ‰¾åˆ°ä¸€äº›ä¿¡æ¯ã€‚</p>2024-09-18</li><br/>
</ul>