ä½ å¥½ï¼Œæˆ‘æ˜¯Mikeã€‚ä»Šå¤©æˆ‘ä»¬ä¸€èµ·æ¥å­¦ä¹ Rustä¸­çš„æšä¸¾ï¼ˆenumï¼‰å’Œæ¨¡å¼åŒ¹é…ï¼ˆpattern matchingï¼‰ã€‚

æšä¸¾æ˜¯Rustä¸­éå¸¸é‡è¦çš„å¤åˆç±»å‹ï¼Œä¹Ÿæ˜¯æœ€å¼ºå¤§çš„å¤åˆç±»å‹ä¹‹ä¸€ï¼Œå¹¿æ³›ç”¨äºå±æ€§é…ç½®ã€é”™è¯¯å¤„ç†ã€åˆ†æ”¯æµç¨‹ã€ç±»å‹èšåˆç­‰åœºæ™¯ä¸­ã€‚å­¦ä¹ å®Œè¿™èŠ‚è¯¾åï¼Œä½ ä¼šå¯¹Rustçš„åœ°é“é£æ ¼æœ‰æ–°çš„è®¤è¯†ã€‚

## æšä¸¾ï¼šå¼ºå¤§çš„å¤åˆç±»å‹

æšä¸¾æ˜¯è¿™æ ·ä¸€ç§ç±»å‹ï¼Œå®ƒå®¹çº³é€‰é¡¹çš„å¯èƒ½æ€§ï¼Œæ¯ä¸€ç§å¯èƒ½çš„é€‰é¡¹éƒ½æ˜¯ä¸€ä¸ªå˜ä½“ï¼ˆvariantï¼‰ã€‚Rustä¸­çš„æšä¸¾ä½¿ç”¨å…³é”®å­— **enum**å®šä¹‰ï¼Œè¿™ç‚¹ä¸Javaã€C++éƒ½æ˜¯ä¸€æ ·çš„ã€‚ä¸å®ƒä»¬ä¸åŒçš„æ˜¯ï¼ŒRustä¸­çš„æšä¸¾å…·æœ‰æ›´å¼ºå¤§çš„è¡¨è¾¾èƒ½åŠ›ã€‚

åœ¨Rustä¸­ï¼Œæšä¸¾ä¸­çš„æ‰€æœ‰æ¡ç›®è¢«å«åšè¿™ä¸ªæšä¸¾çš„å˜ä½“ã€‚æ¯”å¦‚ï¼š

```plain
enum Shape {
    Rectangle,
    Triangle,
    Circle,
}
```

å®šä¹‰äº†ä¸€ä¸ªå½¢çŠ¶ï¼ˆShapeï¼‰æšä¸¾ï¼Œå®ƒæœ‰ä¸‰ä¸ªå˜ä½“ï¼šé•¿æ–¹å½¢Rectangleã€ä¸‰è§’å½¢Triangleå’Œåœ†å½¢Circleã€‚

æšä¸¾ä¸ç»“æ„ä½“ä¸åŒï¼Œ**ç»“æ„ä½“çš„å®ä¾‹åŒ–éœ€è¦æ‰€æœ‰å­—æ®µä¸€èµ·èµ·ä½œç”¨ï¼Œè€Œæšä¸¾çš„å®ä¾‹åŒ–åªéœ€è¦ä¸”åªèƒ½æ˜¯å…¶ä¸­ä¸€ä¸ªå˜ä½“èµ·ä½œç”¨**ã€‚

### è´Ÿè½½

Rustä¸­æšä¸¾çš„å¼ºå¤§ä¹‹å¤„åœ¨äºï¼Œenumä¸­çš„å˜ä½“å¯ä»¥æŒ‚è½½å„ç§å½¢å¼çš„ç±»å‹ã€‚æ‰€æœ‰å…¶ä»–ç±»å‹ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²ã€å…ƒç»„ã€ç»“æ„ä½“ç­‰ç­‰ï¼Œéƒ½å¯ä»¥ä½œä¸ºenumçš„è´Ÿè½½ï¼ˆpayloadï¼‰è¢«æŒ‚è½½åˆ°å…¶ä¸­ä¸€ä¸ªå˜ä½“ä¸Šã€‚æ¯”å¦‚ï¼Œæ‰©å±•ä¸€ä¸‹ä¸Šé¢çš„ä»£ç ç¤ºä¾‹ã€‚

```plain
enum Shape {
    Rectangle { width: u32, height: u32},
    Triangle((u32, u32), (u32, u32), (u32, u32)),
    Circle { origin: (u32, u32), radius: u32 },
}
```

æˆ‘ä»¬ç»™Shapeæšä¸¾çš„ä¸‰ä¸ªå˜ä½“éƒ½æŒ‚è½½äº†ä¸åŒçš„è´Ÿè½½ã€‚RectangleæŒ‚è½½äº†ä¸€ä¸ªç»“æ„ä½“è´Ÿè½½è¡¨ç¤ºå®½å’Œé«˜çš„å±æ€§ã€‚

```plain
{width: u32, height: u32}
```

ä¸ºäº†çœ‹å¾—æ›´æ¸…æ¥šï¼Œä½ ä¹Ÿå¯ä»¥å•ç‹¬å®šä¹‰ä¸€ä¸ªç»“æ„ä½“ï¼Œç„¶åæŠŠå®ƒæŒ‚è½½åˆ°Rectangleå˜ä½“ä¸Šã€‚

```plain
struct Rectangle {
  width: u32, 
  height: u32
}

enum Shape {
  Rectangle(Rectangle),
  // ...
}
```

Triangleå˜ä½“æŒ‚è½½äº†ä¸€ä¸ªå…ƒç»„è´Ÿè½½ `((u32, u32), (u32, u32), (u32, u32))`ï¼Œè¡¨ç¤ºä¸‰ä¸ªé¡¶ç‚¹ã€‚

Circleå˜ä½“æŒ‚è½½äº†ä¸€ä¸ªç»“æ„ä½“è´Ÿè½½ `{ origin: (u32, u32), radius: u32 }`ï¼Œè¡¨ç¤ºä¸€ä¸ªåŸç‚¹åŠ åŠå¾„é•¿åº¦ã€‚

æšä¸¾çš„å˜ä½“èƒ½å¤ŸæŒ‚è½½å„ç§ç±»å‹çš„è´Ÿè½½ï¼Œæ˜¯Rustä¸­çš„æšä¸¾è¶…å¼ºèƒ½åŠ›çš„æ¥æºï¼Œä½ å¯ä»¥é€šè¿‡ä¸Šé¢ä¾‹å­æ¥ç»†ç»†å“å‘³Rustçš„è¿™ç§è¡¨è¾¾åŠ›ã€‚enumå°±åƒä¸€ä¸ªç­ï¼Œä»€ä¹ˆéƒ½èƒ½å¾€é‡Œé¢è£…ã€‚

ä¸ºäº†è®©ä½ æ›´ç†Ÿæ‚‰Rustçš„æšä¸¾è¡¨è¾¾å½¢å¼ï¼Œæˆ‘å†ä¸¾ä¸€ä¸ªä¾‹å­ã€‚ä¸‹é¢çš„ç¤ºä¾‹ä¸­WebEventè¡¨ç¤ºæµè§ˆå™¨é‡Œé¢çš„Webäº‹ä»¶ã€‚

```plain
enum WebEvent {
    PageLoad,
    PageUnload,
    KeyPress(char),
    Paste(String),
    Click { x: i64, y: i64 },
}
```

ä½ å¯ä»¥è¡¨è¿°å‡ºä¸åŒå˜ä½“çš„æ„ä¹‰ï¼Œè¿˜æœ‰æ¯ä¸ªå˜ä½“æ‰€æŒ‚è½½çš„è´Ÿè½½ç±»å‹å—ï¼ŸæœŸå¾…çœ‹åˆ°ä½ çš„ç­”æ¡ˆã€‚

### æšä¸¾çš„å®ä¾‹åŒ–

æšä¸¾çš„å®ä¾‹åŒ–å®é™…æ˜¯æšä¸¾å˜ä½“çš„å®ä¾‹åŒ–ã€‚æ¯”å¦‚ï¼š

```plain
let a = WebEvent::PageLoad;
let b = WebEvent::PageUnload;
let c = WebEvent::KeyPress('c');
let d = WebEvent::Paste(String::from("batman"));
let e = WebEvent::Click { x: 320, y: 240 };
```

å¯ä»¥çœ‹åˆ°ï¼Œä¸å¸¦è´Ÿè½½çš„å˜ä½“å®ä¾‹åŒ–å’Œå¸¦è´Ÿè½½çš„å˜ä½“å®ä¾‹åŒ–ä¸ä¸€æ ·ã€‚å¸¦è´Ÿè½½çš„å˜ä½“å®ä¾‹åŒ–è¦æ ¹æ®ä¸åŒå˜ä½“é™„å¸¦çš„ç±»å‹åšç‰¹å®šçš„å®ä¾‹åŒ–ã€‚

### ç±»Cæšä¸¾

Rustä¸­ä¹Ÿå¯ä»¥å®šä¹‰ç±»ä¼¼Cè¯­è¨€ä¸­çš„æšä¸¾ã€‚

ç¤ºä¾‹ï¼š

```plain
// ç»™æšä¸¾å˜ä½“ä¸€ä¸ªèµ·å§‹æ•°å­—å€¼ 
enum Number {
    Zero = 0,
    One,
    Two,
}

// ç»™æšä¸¾æ¯ä¸ªå˜ä½“èµ‹äºˆä¸åŒçš„å€¼
enum Color {
    Red = 0xff0000,
    Green = 0x00ff00,
    Blue = 0x0000ff,
}

fn main() {
    // ä½¿ç”¨ as è¿›è¡Œç±»å‹çš„è½¬åŒ–
    println!("zero is {}", Number::Zero as i32);
    println!("one is {}", Number::One as i32);

    println!("roses are #{:06x}", Color::Red as i32);
    println!("violets are #{:06x}", Color::Blue as i32);
}
// è¾“å‡º 
zero is 0
one is 1
roses are #ff0000
violets are #0000ff
```

å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬èƒ½å¤ŸåƒCè¯­è¨€é‚£æ ·ï¼Œåœ¨å®šä¹‰æšä¸¾å˜ä½“çš„æ—¶å€™ï¼ŒæŒ‡å®šå…·ä½“çš„å€¼ã€‚è¿™åœ¨åº•å±‚ç³»ç»Ÿçº§å¼€å‘ã€åè®®æ ˆå¼€å‘ã€åµŒå…¥å¼å¼€å‘çš„åœºæ™¯ä¼šç»å¸¸ç”¨åˆ°ã€‚

æ‰“å°çš„æ—¶å€™ï¼Œåªéœ€è¦ä½¿ç”¨ as æ“ä½œç¬¦å°†å˜ä½“è½¬æ¢ä¸ºå…·ä½“çš„æ•°å€¼ç±»å‹å³å¯ã€‚

ä»£ç ä¸­çš„ `println!` é‡Œçš„ `{:06x}` æ˜¯æ ¼å¼åŒ–å‚æ•°ï¼Œè¿™é‡Œè¡¨ç¤ºæ‰“å°å‡ºå€¼çš„16è¿›åˆ¶å½¢å¼ï¼Œå ä½6ä¸ªå®½åº¦ï¼Œä¸è¶³çš„ç”¨0è¡¥é½ã€‚ä½ å¯ä»¥é¡ºä¾¿äº†è§£ä¸€ä¸‹ println æ‰“å°è¯­å¥ä¸­[æ ¼å¼åŒ–å‚æ•°](https://doc.rust-lang.org/std/fmt/index.html)çš„è¯¦ç»†å†…å®¹ã€‚æ ¼å¼åŒ–å‚æ•°ç›¸å½“ä¸°å¯Œï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä»¥åä¸æ–­åœ°å®è·µä¸­å»ç†Ÿæ‚‰å’ŒæŒæ¡å®ƒã€‚

### ç©ºæšä¸¾

Rustä¸­ä¹Ÿå¯ä»¥å®šä¹‰ç©ºæšä¸¾ã€‚æ¯”å¦‚ `enum MyEnum {};`ã€‚å®ƒå…¶å®ä¸å•å…ƒç»“æ„ä½“ä¸€æ ·ï¼Œéƒ½è¡¨ç¤ºä¸€ä¸ªç±»å‹ã€‚ä½†æ˜¯å®ƒä¸èƒ½è¢«å®ä¾‹åŒ–ã€‚ç›®å‰çœ‹èµ·æ¥å¥½åƒæ²¡ä»€ä¹ˆä½œç”¨ï¼Œæˆ‘ä»¬åªéœ€è¦äº†è§£è¿™ç§è¡¨ç¤ºå½¢å¼å°±å¯ä»¥äº†ã€‚

```plain
enum Foo {}  

let a = Foo {}; // é”™è¯¯çš„

// æç¤º
expected struct, variant or union type, found enum `Foo`
not a struct, variant or union type
```

### impl æšä¸¾

> Rustæœ‰ä¸ªå…³é”®å­— **impl**å¯ä»¥ç”¨æ¥ç»™ç»“æ„ä½“æˆ–å…¶ä»–ç±»å‹å®ç°æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯å…³è”åœ¨æŸä¸ªç±»å‹ä¸Šçš„å‡½æ•°ã€‚â€”â€”ç¬¬5è®²

æšä¸¾åŒæ ·èƒ½å¤Ÿè¢« implã€‚æ¯”å¦‚ï¼š

```plain
enum MyEnum {
    Add,
    Subtract,
}

impl MyEnum {
    fn run(&self, x: i32, y: i32) -> i32 {
        match self {                  // match è¯­å¥
            Self::Add => x + y,
            Self::Subtract => x - y,
        }
    }
}

fn main() {
    // å®ä¾‹åŒ–æšä¸¾
    let add = MyEnum::Add;
    // å®ä¾‹åŒ–åæ‰§è¡Œæšä¸¾çš„æ–¹æ³•
    add.run(100, 200);
}
```

ä½†æ˜¯ä¸èƒ½å¯¹æšä¸¾çš„å˜ä½“ç›´æ¥ implã€‚

```plain
enum Foo {
  AAA,
  BBB,
  CCC
}

impl Foo::AAA {   // é”™è¯¯çš„
}
```

ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæšä¸¾ä¼šç”¨æ¥åšé…ç½®ï¼Œå¹¶ç»“åˆ match è¯­å¥ä½¿ç”¨æ¥åšåˆ†æ”¯ç®¡ç†ã€‚**å¦‚æœè¦å®šä¹‰ä¸€ä¸ªæ–°ç±»å‹ï¼Œåœ¨Rustä¸­ä¸»è¦è¿˜æ˜¯ä½¿ç”¨ç»“æ„ä½“ã€‚**

## match

æ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹å­¦ä¹ å’Œæšä¸¾æ­é…ä½¿ç”¨çš„matchè¯­å¥ã€‚

### match + æšä¸¾

å…¶å®åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œå°±å·²ç»å‡ºç° match å…³é”®å­—äº†ã€‚å®ƒçš„ä½œç”¨æ˜¯åˆ¤æ–­æˆ–åŒ¹é…å€¼æ˜¯å“ªä¸€ä¸ªæšä¸¾çš„å˜ä½“ã€‚ä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ã€‚

```plain
#[derive(Debug)]
enum Shape {
  Â  Rectangle,
  Â  Triangle,
  Â  Circle,
}

fn main() {
  Â  let shape_a = Shape::Rectangle;  // åˆ›å»ºå®ä¾‹
  Â  match shape_a {                  // åŒ¹é…å®ä¾‹
    Â  Â  Shape::Rectangle => {
    Â  Â  Â    println!("{:?}", Shape::Rectangle);  // è¿›äº†è¿™ä¸ªåˆ†æ”¯
    Â  Â  }
    Â  Â  Shape::Triangle => {
    Â  Â  Â    println!("{:?}", Shape::Triangle);
    Â  Â  }
    Â  Â  Shape::Circle => {
    Â  Â  Â    println!("{:?}", Shape::Circle);
    Â  Â  }
  Â  }Â Â 
}
// è¾“å‡º
Rectangle
```

ä½ å¯ä»¥è¯•ç€æ”¹å˜å®ä¾‹ä¸ºå¦å¤–ä¸¤ç§å˜ä½“ï¼Œçœ‹çœ‹æ‰“å°å‡ºçš„ä¿¡æ¯æœ‰æ²¡æœ‰å˜åŒ–ï¼Œç„¶ååˆ¤æ–­ä¸Šé¢çš„ä»£ç èµ°äº†å“ªä¸ªåˆ†æ”¯ã€‚

### matchå¯è¿”å›å€¼

å°±åƒå¤§å¤šæ•°Rustè¯­æ³•ä¸€æ ·ï¼Œmatch è¯­æ³•ä¹Ÿæ˜¯å¯ä»¥æœ‰è¿”å›å€¼çš„ï¼Œæ‰€ä»¥ä¹Ÿå«åšmatchè¡¨è¾¾å¼ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ç¤ºä¾‹ã€‚

```plain
#[derive(Debug)]
enum Shape {
  Â  Rectangle,
  Â  Triangle,
  Â  Circle,
}

fn main() {
  Â  let shape_a = Shape::Rectangle;  // åˆ›å»ºå®ä¾‹
  Â  let ret = match shape_a {        // åŒ¹é…å®ä¾‹ï¼Œå¹¶è¿”å›ç»“æœç»™ret
    Â  Â  Shape::Rectangle => {
    Â  Â  Â    1
    Â  Â  }
    Â  Â  Shape::Triangle => {
    Â  Â  Â    2
    Â  Â  }
    Â  Â  Shape::Circle => {
    Â  Â  Â    3
    Â  Â  }
  Â  };
    println!("{}", ret);Â Â 
}
// è¾“å‡º
1
```

å› ä¸º `shape_a` è¢«èµ‹å€¼ä¸º `Shape::Rectangle`ï¼Œæ‰€ä»¥ç¨‹åºåŒ¹é…åˆ°ç¬¬ä¸€ä¸ªåˆ†æ”¯å¹¶è¿”å› 1ï¼Œå˜é‡retçš„å€¼ä¸º 1ã€‚

```plain
let ret = match shape_a {   
```

è¿™ç§å†™æ³•å°±æ˜¯æ¯”è¾ƒåœ°é“çš„Rustå†™æ³•ï¼Œå¯ä»¥è®©ä»£ç æ˜¾å¾—æ›´ç´§å‡‘ã€‚

æ³¨æ„ï¼Œ**matchè¡¨è¾¾å¼ä¸­å„ä¸ªåˆ†æ”¯è¿”å›çš„å€¼çš„ç±»å‹å¿…é¡»ç›¸åŒ**ã€‚

### æ‰€æœ‰åˆ†æ”¯éƒ½å¿…é¡»å¤„ç†

matchè¡¨è¾¾å¼é‡Œæ‰€æœ‰çš„åˆ†æ”¯éƒ½å¿…é¡»å¤„ç†ï¼Œä¸ç„¶Rustcå°åŠ©æ‰‹ä¼šæ‹¦ä½ä½ ï¼Œä¸è®©ä½ é€šè¿‡ã€‚è¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿä½ å¯ä»¥çœ‹ä¸€ä¸‹ç¤ºä¾‹ä»£ç ã€‚

```plain
#[derive(Debug)]
enum Shape {
  Â  Rectangle,
  Â  Triangle,
  Â  Circle,
}

fn main() {
  Â  let shape_a = Shape::Rectangle;Â  // åˆ›å»ºå®ä¾‹
  Â  let ret = match shape_a {Â  Â  Â  Â  // åŒ¹é…å®ä¾‹
    Â  Â  Shape::Rectangle => {
    Â  Â  Â    1
    Â  Â  }
    Â  Â  Shape::Triangle => {
    Â  Â  Â    2
    Â  Â  }
    Â  Â  // Shape::Circle => {
    Â  Â  //Â  Â   3
    Â  Â  // }
  Â  };
  Â  println!("{}", ret);Â Â 
}
```

ä¸Šé¢è¿™æ®µä»£ç åœ¨ç¼–è¯‘çš„æ—¶å€™ä¼šå‡ºé”™ã€‚

```plain
error[E0004]: non-exhaustive patterns: `Shape::Circle` not covered
  --> src/main.rs:10:19
   |
10 |   let ret = match shape_a {                  // åŒ¹é…å®ä¾‹
   |                   ^^^^^^^ pattern `Shape::Circle` not covered
   |
note: `Shape` defined here
  --> src/main.rs:5:3
   |
2  | enum Shape {
   |      -----
...
5  |   Circle,
   |   ^^^^^^ not covered
   = note: the matched value is of type `Shape`
help: ensure that all possible cases are being handled by adding a match arm with a wildcard pattern or an explicit pattern as shown
   |
16 ~     },
17 +     Shape::Circle => todo!()
   |
```

å°åŠ©æ‰‹æç¤ºè¯´ï¼Œ`Shape::Circle` åˆ†æ”¯æ²¡æœ‰è¦†ç›–åˆ°ï¼Œä¸å…è®¸é€šè¿‡ï¼Œç„¶åç›´æ¥è´´å¿ƒåœ°ç»™å‡ºäº†ä¿®æ”¹å»ºè®®ï¼Rustcå°åŠ©æ‰‹å¦‚æ­¤è´´å¿ƒï¼Œè¿™ç§ä¿å§†çº§æœåŠ¡æ˜¯ä½ åœ¨Javaã€C++ç­‰å…¶ä»–è¯­è¨€ä¸­æ„Ÿå—ä¸åˆ°çš„ã€‚

### _ å ä½ç¬¦

æœ‰æ—¶ï¼Œä½ ç¡®å®æƒ³æµ‹è¯•ä¸€äº›ä¸œè¥¿ï¼Œæˆ–è€…å°±æ˜¯ä¸æƒ³å¤„ç†ä¸€äº›åˆ†æ”¯ï¼Œå¯ä»¥ç”¨ _ å·æ‡’ã€‚

æ¯”å¦‚ä¸Šé¢ä»£ç å¯ä»¥ä¿®æ”¹æˆè¿™æ ·ï¼š

```plain
#[derive(Debug)]
enum Shape {
  Â  Rectangle,
  Â  Triangle,
  Â  Circle,
}

fn main() {
  Â  let shape_a = Shape::Rectangle;Â  
  Â  let ret = match shape_a {Â  Â  Â  Â  Â  Â  Â  Â  Â  
    Â  Â  Shape::Rectangle => {
    Â  Â  Â    1
    Â  Â  }
    Â  Â  _ => {
    Â  Â  Â    10
    Â  Â  }
  Â  };
  Â  println!("{}", ret);Â Â 
}
```

ç›¸å½“äºé™¤ `Shape::Rectangle` ä¹‹å¤–çš„åˆ†æ”¯æˆ‘ä»¬éƒ½ç»Ÿä¸€ç”¨ _ å ä½ç¬¦è¿›è¡Œå¤„ç†äº†ã€‚

### æ›´å¹¿æ³›çš„åˆ†æ”¯

matché™¤äº†é…åˆæšä¸¾è¿›è¡Œåˆ†æ”¯ç®¡ç†å¤–ï¼Œè¿˜å¯ä»¥ä¸å…¶ä»–åŸºç¡€ç±»å‹ç»“åˆè¿›è¡Œåˆ†æ”¯åˆ†æ´¾ã€‚æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸ª The Booké‡Œçš„ç¤ºä¾‹ã€‚

```plain
fn main() {
    let number = 13;
    // ä½ å¯ä»¥è¯•ç€ä¿®æ”¹ä¸Šé¢çš„æ•°å­—å€¼ï¼Œçœ‹çœ‹ä¸‹é¢èµ°å“ªä¸ªåˆ†æ”¯

    println!("Tell me about {}", number);
    match number {
        // åŒ¹é…å•ä¸ªæ•°å­—
        1 => println!("One!"),
        // åŒ¹é…å‡ ä¸ªæ•°å­—
        2 | 3 | 5 | 7 | 11 => println!("This is a prime"),
        // åŒ¹é…ä¸€ä¸ªèŒƒå›´ï¼Œå·¦é—­å³é—­åŒºé—´
        13..=19 => println!("A teen"),
        // å¤„ç†å‰©ä¸‹çš„æƒ…å†µ
        _ => println!("Ain't special"),
    }
}
```

å¯ä»¥çœ‹åˆ°ï¼Œmatchå¯ä»¥ç”¨æ¥åŒ¹é…ä¸€ä¸ªå…·ä½“çš„æ•°å­—ã€ä¸€ä¸ªæ•°å­—çš„åˆ—è¡¨ï¼Œæˆ–è€…ä¸€ä¸ªæ•°å­—çš„åŒºé—´ç­‰ç­‰ï¼Œéå¸¸çµæ´»ã€‚åœ¨è¿™ç‚¹ä¸Šï¼Œå¯æ¯”Cã€C++ï¼Œæˆ–è€…Java çš„ `switch .. case` çµæ´»å¤šäº†ã€‚

## æ¨¡å¼åŒ¹é…

matchå®é™…æ˜¯æ¨¡å¼åŒ¹é…çš„å…¥å£ï¼Œä»matchè¡¨è¾¾å¼æˆ‘ä»¬å¯å¼•å‡ºæ¨¡å¼åŒ¹é…çš„æ¦‚å¿µã€‚æ¨¡å¼åŒ¹é…å°±æ˜¯**æŒ‰å¯¹è±¡å€¼çš„ç»“æ„**è¿›è¡ŒåŒ¹é…ï¼Œå¹¶ä¸”å¯ä»¥å–å‡ºç¬¦åˆæ¨¡å¼çš„å€¼ã€‚ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸€äº›ç¤ºä¾‹æ¥è§£é‡Šè¿™å¥è¯ã€‚

æ¨¡å¼åŒ¹é…ä¸é™äºåœ¨ match ä¸­ä½¿ç”¨ã€‚é™¤äº†matchå¤–ï¼ŒRustè¿˜ç»™æ¨¡å¼åŒ¹é…æä¾›äº†å…¶ä»–ä¸€äº›è¯­æ³•å±‚é¢çš„è®¾æ–½ã€‚

### if let

å½“è¦åŒ¹é…çš„åˆ†æ”¯åªæœ‰ä¸¤ä¸ªæˆ–è€…åœ¨è¿™ä¸ªä½ç½®åªæƒ³å…ˆå¤„ç†ä¸€ä¸ªåˆ†æ”¯çš„æ—¶å€™ï¼Œå¯ä»¥ç›´æ¥ç”¨ if letã€‚

æ¯”å¦‚ä¸‹é¢è¿™æ®µä»£ç å°±å¯ä»¥ä½¿ç”¨ if letã€‚

```plain
  let shape_a = Shape::Rectangle;  
  match shape_a {                  
    Shape::Rectangle => {
      println!("1");
    }
    _ => {
      println!("10");
    }
  };
```

æ”¹å†™ä¸ºï¼š

```plain
  let shape_a = Shape::Rectangle;  
  if let Shape::Rectangle = shape_a {                  
    println!("1");
  } else {
    println!("10");
  }
```

æ˜¯ä¸æ˜¯ç›¸æ¯”äºmatchï¼Œä½¿ç”¨ if let çš„ä»£ç é‡æœ‰æ‰€ç®€åŒ–ï¼Ÿ

### while let

while åé¢ä¹Ÿå¯ä»¥è·Ÿ letï¼Œå®ç°æ¨¡å¼åŒ¹é…ã€‚æ¯”å¦‚ï¼š

```plain
#[derive(Debug)]
enum Shape {
    Rectangle,
    Triangle,
    Circle,
}

fn main() {
    let mut shape_a = Shape::Rectangle; 
    let mut i = 0;
    while let Shape::Rectangle = shape_a {    // æ³¨æ„è¿™ä¸€å¥
        if i > 9 {
            println!("Greater than 9, quit!");
            shape_a = Shape::Circle;
        } else {
            println!("`i` is `{:?}`. Try again.", i);
            i += 1;
        }
    }
}
// è¾“å‡º
`i` is `0`. Try again.
`i` is `1`. Try again.
`i` is `2`. Try again.
`i` is `3`. Try again.
`i` is `4`. Try again.
`i` is `5`. Try again.
`i` is `6`. Try again.
`i` is `7`. Try again.
`i` is `8`. Try again.
`i` is `9`. Try again.
Greater than 9, quit!
```

ä¸Šé¢ç¤ºä¾‹æ„é€ äº†ä¸€ä¸ªwhileå¾ªç¯ï¼Œæ‰‹åŠ¨ç»´æŠ¤è®¡æ•°å™¨ iï¼Œé€’å¢åˆ°9ä¹‹åï¼Œé€€å‡ºå¾ªç¯ã€‚

çœ‹èµ·æ¥ï¼Œåœ¨æ¡ä»¶åˆ¤æ–­è¯­å¥é‚£é‡Œç”¨ `while Shape::Rectangle == shape_a` ä¹Ÿè¡Œï¼Œå¥½åƒç”¨ while let çš„æ„ä¹‰ä¸å¤§ã€‚æˆ‘ä»¬æ¥è¯•ä¸€ä¸‹ï¼Œç¼–è¯‘ä¹‹åï¼ŒæŠ¥é”™äº†ã€‚

```plain
error[E0369]: binary operation `==` cannot be applied to type `Shape`
```

è¯´ == å·ä¸èƒ½ä½œç”¨åœ¨ç±»å‹ Shape ä¸Šï¼Œä½ å¯ä»¥æ€è€ƒä¸€ä¸‹ä¸ºä»€ä¹ˆã€‚

å¦‚æœä¸€ä¸ªæšä¸¾å˜ä½“å¸¦è´Ÿè½½ï¼Œä½¿ç”¨æ¨¡å¼åŒ¹é…å¯ä»¥æŠŠè¿™ä¸ªè´Ÿè½½å–å‡ºæ¥ï¼Œè¿™ç‚¹å°±æ¯”è¾ƒæ–¹ä¾¿äº†ï¼Œä¸‹é¢æˆ‘ä»¬ä½¿ç”¨å¸¦è´Ÿè½½çš„æšä¸¾æ¥ä¸¾ä¾‹ã€‚

### let

letæœ¬èº«å°±æ”¯æŒæ¨¡å¼åŒ¹é…ã€‚å…¶å®å‰é¢çš„ if letã€while let æœ¬èº«ä½¿ç”¨çš„å°±æ˜¯ let æ¨¡å¼åŒ¹é…çš„èƒ½åŠ›ã€‚

```plain
#[derive(Debug)]
enum Shape {
  Â  Rectangle {width: u32, height: u32},
  Â  Triangle,
  Â  Circle,
}

fn main() {
    // åˆ›å»ºå®ä¾‹
Â  Â  let shape_a = Shape::Rectangle {width: 10, height: 20};Â 
Â  Â  // æ¨¡å¼åŒ¹é…å‡ºè´Ÿè½½å†…å®¹
    let Shape::Rectangle {width, height} = shape_a else {
Â  Â  Â  Â  panic!("Can't extract rectangle.");
Â  Â  };
Â  Â  println!("width: {}, height: {}", width, height);
}

// è¾“å‡º
width: 10, height: 20
```

åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨æ¨¡å¼åŒ¹é…è§£å¼€äº†shape\_a ä¸­å¸¦çš„è´Ÿè½½ï¼ˆç»“æ„ä½“è´Ÿè½½ï¼‰ï¼ŒåŒæ—¶å®šä¹‰äº† width å’Œ height ä¸¤ä¸ªå±€éƒ¨å˜é‡ï¼Œå¹¶åˆå§‹åŒ–ä¸ºæšä¸¾å˜ä½“çš„å®ä¾‹è´Ÿè½½çš„å€¼ã€‚è¿™ä¸¤ä¸ªå±€éƒ¨å˜é‡åœ¨åç»­çš„ä»£ç å—ä¸­å¯ä»¥ä½¿ç”¨ã€‚

æ³¨æ„ç¬¬12è¡Œä»£ç ã€‚

```plain
let Shape::Rectangle {width, height} = shape_a else {
```

è¿™ç§è¯­æ³•æ˜¯åŒ¹é…ç»“æ„ä½“è´Ÿè½½ï¼Œè·å–å­—æ®µå€¼çš„æ–¹å¼ã€‚

### åŒ¹é…å…ƒç»„

å…ƒç»„ä¹Ÿå¯ä»¥è¢«åŒ¹é…ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ã€‚

```plain
fn main() {
    let a = (1,2,'a');
    
    let (b,c,d) = a;
    
    println!("{:?}", a);
    println!("{}", b);
    println!("{}", c);
    println!("{}", d);
}
```

è¿™ç§ç”¨æ³•å«åšå…ƒç»„çš„ææ„ï¼Œå¸¸ç”¨æ¥ä»å‡½æ•°çš„å¤šä¸ªè¿”å›å€¼é‡Œå–å‡ºæ•°æ®ã€‚

```plain
fn foo() -> (u32, u32, char) {
    (1,2,'a')
}

fn main() {
    let (b,c,d) = foo();
    
    println!("{}", b);
    println!("{}", c);
    println!("{}", d);
}
```

### åŒ¹é…æšä¸¾

å‰é¢å·²ç»è®²è¿‡å¦‚ä½•ä½¿ç”¨ let æŠŠæšä¸¾é‡Œå˜ä½“çš„è´Ÿè½½è§£å‡ºæ¥ï¼Œè¿™é‡Œæˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªä¾‹å­ã€‚

```plain
struct Rectangle {
  Â  width: u32,Â 
  Â  height: u32
}

enum Shape {
  Â  Rectangle(Rectangle),
  Â  Triangle((u32, u32), (u32, u32), (u32, u32)),
  Â  Circle { origin: (u32, u32), radius: u32 },
}

fn main() {
  Â  let a_rec = Rectangle {
    Â  Â  width: 10,
    Â  Â  height: 20,
  Â  };
  
    // è¯·æ‰“å¼€ä¸‹é¢è¿™ä¸€è¡Œè¿›è¡Œå®éªŒ
  Â  //let shape_a = Shape::Rectangle(a_rec);
    // è¯·æ‰“å¼€ä¸‹é¢è¿™ä¸€è¡Œè¿›è¡Œå®éªŒ
    //let shape_a = Shape::Triangle((0, 1), (3,4), (3, 0));
    
    let shape_a = Shape::Circle { origin: (0, 0), radius: 5 };
  Â Â 
    // è¿™é‡Œæ¼”ç¤ºäº†åœ¨æ¨¡å¼åŒ¹é…ä¸­å°†æšä¸¾çš„è´Ÿè½½è§£å‡ºæ¥çš„å„ç§å½¢å¼
  Â  match shape_a {
    Â  Â  Shape::Rectangle(a_rec) => {  // è§£å‡ºä¸€ä¸ªç»“æ„ä½“
    Â  Â  Â  Â  println!("Rectangle {}, {}", a_rec.width, a_rec.height);
    Â  Â  }
    Â  Â  Shape::Triangle(x, y, z) => {  // è§£å‡ºä¸€ä¸ªå…ƒç»„
    Â  Â  Â  Â  println!("Triangle {:?}, {:?}, {:?}", x, y, z);
    Â  Â  }
    Â  Â  Shape::Circle {origin, radius} => {  // è§£å‡ºä¸€ä¸ªç»“æ„ä½“çš„å­—æ®µ
    Â  Â  Â  Â  println!("Circle {:?}, {:?}", origin, radius);
    Â  Â  }
  Â  }
}
// è¾“å‡º
Circle (0, 0), 5
```

è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•å°†å˜ä½“ä¸­çš„ç»“æ„ä½“æ•´ä½“ã€å…ƒç»„å„éƒ¨åˆ†ã€ç»“æ„ä½“å„å­—æ®µè§£æå‡ºæ¥çš„æ–¹å¼ã€‚

ç”¨è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åšåˆ†æ”¯å¤„ç†çš„æ—¶å€™ï¼Œé¡ºä¾¿å¤„ç†æºå¸¦çš„ä¿¡æ¯ï¼Œè®©ä»£ç å˜å¾—ç›¸å½“ç´§å‡‘è€Œæœ‰æ„ä¹‰ï¼ˆé«˜å†…èšï¼‰ã€‚ä½ éœ€è¦ç†Ÿæ‚‰å¹¶æŒæ¡è¿™äº›å†™æ³•ï¼Œè¿™æ ·å†™èµ·Rustä»£ç æ¥æ‰ä¼šæ›´åŠ é¡ºæ‰‹ã€‚

### åŒ¹é…ç»“æ„ä½“

ä¸‹é¢æˆ‘ä»¬å†çœ‹ä¸€ä¸ªä¾‹å­ï¼Œäº†è§£ç»“æ„ä½“å­—æ®µåŒ¹é…è¿‡ç¨‹ä¸­çš„ä¸€ä¸ªç»†èŠ‚ã€‚

```plain
#[derive(Debug)]
struct User {
    name: String,
    age: u32,
    student: bool
}

fn main() {
    let a = User {
        name: String::from("mike"),
        age: 20,
        student: false,
    };
    let User {
        name,
        age,
        student,
    } = a;
    
    println!("{}", name);
    println!("{}", age);
    println!("{}", student);
    println!("{:?}", a);
}
```

ç¼–è¯‘è¾“å‡ºï¼š

```plain
error[E0382]: borrow of partially moved value: `a`
  --> src/main.rs:24:22
   |
16 |         name,
   |         ---- value partially moved here
...
24 |     println!("{:?}", a);
   |                      ^ value borrowed here after partial move
   |
   = note: partial move occurs because `a.name` has type `String`, which does not implement the `Copy` trait
   = note: this error originates in the macro `$crate::format_args_nl` which comes from the expansion of the macro `println` (in Nightly builds, run with -Z macro-backtrace for more info)
help: borrow this binding in the pattern to avoid moving the value
   |
16 |         ref name,
   |         +++
```

ç¼–è¯‘æç¤ºå‡ºé”™äº†ï¼Œåœ¨æ¨¡å¼åŒ¹é…çš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†partially movedã€‚å…³äºpartially movedæˆ‘ä»¬åœ¨ä¸ŠèŠ‚è¯¾å·²ç»è®²è¿‡ã€‚æ¨¡å¼åŒ¹é…è¿‡ç¨‹ä¸­æ–°å®šä¹‰çš„ä¸‰ä¸ªå˜é‡ nameã€ageã€student åˆ†åˆ«å¾—åˆ°äº†å¯¹åº”Userå®ä¾‹açš„ä¸‰ä¸ªå­—æ®µå€¼çš„æ‰€æœ‰æƒã€‚

age å’Œ student é‡‡ç”¨äº†å¤åˆ¶æ‰€æœ‰æƒçš„å½¢å¼ï¼ˆå‚è€ƒ[ç¬¬ 2 è®²](https://time.geekbang.org/column/article/718916)ç§»åŠ¨è¿˜æ˜¯å¤åˆ¶éƒ¨åˆ†ï¼‰ï¼Œè€Œ name å­—ç¬¦ä¸²å€¼åˆ™æ˜¯é‡‡ç”¨äº†ç§»åŠ¨æ‰€æœ‰æƒçš„å½¢å¼ã€‚a.nameè¢«éƒ¨åˆ†ç§»åŠ¨åˆ°äº†æ–°çš„å˜é‡ name ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥ a.name å°±æ— æ³•ç›´æ¥ä½¿ç”¨äº†ã€‚

è¿™ä¸ªç¤ºä¾‹è¯´æ˜**Rustä¸­çš„æ¨¡å¼åŒ¹é…æ˜¯ä¸€ç§é‡Šæ”¾åŸå¯¹è±¡çš„æ‰€æœ‰æƒçš„æ–¹å¼**ã€‚

ä»Rustå°åŠ©æ‰‹çš„å»ºè®®é‡Œæˆ‘ä»¬çœ‹åˆ°äº†ä¸€ä¸ªå…³é”®å­—ï¼šrefã€‚

### ref å…³é”®å­—

Rustc AIå°åŠ©æ‰‹å»ºè®®æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªå…³é”®å­—refï¼Œæˆ‘ä»¬æŒ‰å®ƒè¯´çš„æ”¹æ”¹ã€‚

```plain
#[derive(Debug)]
struct User {
    name: String,
    age: u32,
    student: bool
}

fn main() {
    let a = User {
        name: String::from("mike"),
        age: 20,
        student: false,
    };
    let User {
        ref name,    // è¿™é‡ŒåŠ äº†ä¸€ä¸ªref
        age,
        student,
    } = a;
    
    println!("{}", name);
    println!("{}", age);
    println!("{}", student);
    println!("{:?}", a);
}
// è¾“å‡º 
mike
20
false
User { name: "mike", age: 20, student: false }
```

å¯ä»¥çœ‹åˆ°ï¼Œæ‰“å°å‡ºäº†æ­£ç¡®çš„å€¼ã€‚

æœ‰äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªæ˜¯éœ€è¦è¯»å–ä¸€ä¸‹å­—æ®µçš„å€¼è€Œå·²ï¼Œä¸éœ€è¦è·å¾—å®ƒçš„æ‰€æœ‰æƒï¼Œè¿™æ—¶å°±å¯ä»¥é€šè¿‡ ref è¿™ä¸ªå…³é”®å­—ä¿®é¥°ç¬¦å‘Šè¯‰Rustç¼–è¯‘å™¨ï¼Œæˆ‘ç°åœ¨åªéœ€è¦è·å¾—é‚£ä¸ªå­—æ®µçš„å¼•ç”¨ï¼Œä¸è¦ç»™æˆ‘æ‰€æœ‰æƒã€‚è¿™å°±æ˜¯ ref å‡ºç°çš„åŸå› ï¼Œç”¨æ¥**åœ¨æ¨¡å¼åŒ¹é…è¿‡ç¨‹ä¸­æä¾›ä¸€ä¸ªé¢å¤–çš„ä¿¡æ¯**ã€‚

ä½¿ç”¨äº†refåï¼Œæ–°å®šä¹‰çš„ name å˜é‡çš„å€¼å…¶å®æ˜¯ &amp;a.name ï¼Œè€Œä¸æ˜¯ a.nameï¼ŒRustå°±ä¸ä¼šå†æŠŠæ‰€æœ‰æƒç»™moveå‡ºæ¥äº†ï¼Œå› æ­¤ä¹Ÿä¸ä¼šå‘ç”Ÿpartially movedè¿™ç§äº‹æƒ…ï¼ŒåŸæ¥çš„Userå®ä¾‹aè¿˜æœ‰æ•ˆï¼Œå› æ­¤å°±èƒ½è¢«æ‰“å°å‡ºæ¥äº†ã€‚ä½ å¯ä»¥ä½“ä¼šä¸€ä¸‹å…¶ä¸­çš„åŒºåˆ«ã€‚

ç›¸åº”çš„ï¼Œè¿˜æœ‰ ref mut çš„å½¢å¼ã€‚å®ƒæ˜¯ç”¨äºåœ¨æ¨¡å¼åŒ¹é…ä¸­è·å¾—ç›®æ ‡çš„å¯å˜å¼•ç”¨ã€‚

```plain
let User {
    ref mut name,    // è¿™é‡ŒåŠ äº†ä¸€ä¸ªref mut
    age,
    student,
} = a;
```

ä½ å¯ä»¥åšåšå®éªŒä½“ä¼šä¸€ä¸‹ã€‚

Rustä¸­å¼ºå¤§çš„æ¨¡å¼åŒ¹é…è¿™ä¸ªæ¦‚å¿µå¹¶ä¸æ˜¯RuståŸåˆ›çš„ï¼Œå®ƒæ¥è‡ªäºå‡½æ•°å¼è¯­è¨€ã€‚ä½ å¦‚æœæ„Ÿå…´è¶£çš„è¯ï¼Œå¯ä»¥äº†è§£ä¸€ä¸‹Ocamlã€Haskellæˆ–Scalaä¸­æ¨¡å¼åŒ¹é…çš„ç›¸å…³æ¦‚å¿µã€‚

### å‡½æ•°å‚æ•°ä¸­çš„æ¨¡å¼åŒ¹é…

å‡½æ•°å‚æ•°å…¶å®å°±æ˜¯å®šä¹‰å±€éƒ¨å˜é‡ï¼Œå› æ­¤æ¨¡å¼åŒ¹é…çš„èƒ½åŠ›åœ¨è¿™é‡Œä¹Ÿèƒ½å¾—åˆ°ä½“ç°ã€‚

ç¤ºä¾‹1ï¼š

```plain
fn foo((a, b, c): (u32, u32, char)) {  // æ³¨æ„è¿™é‡Œçš„å®šä¹‰
    println!("{}", a);
    println!("{}", b);
    println!("{}", c);  
}

fn main() {
    let a = (1,2, 'a');
    foo(a); 
}
```

ä¸Šä¾‹ï¼Œæˆ‘ä»¬æŠŠå…ƒç»„aä¼ å…¥äº†å‡½æ•° `foo()`ï¼Œ`foo()` çš„å‚æ•°ç›´æ¥å®šä¹‰æˆæ¨¡å¼åŒ¹é…ï¼Œè§£æå‡ºäº† aã€bã€c ä¸‰ä¸ªå…ƒç»„å…ƒç´ çš„å†…å®¹ï¼Œå¹¶åœ¨å‡½æ•°ä¸­ä½¿ç”¨ã€‚

ç¤ºä¾‹2ï¼š

```plain
#[derive(Debug)]
struct User {
    name: String,
    age: u32,
    student: bool
}

fn foo(User {        // æ³¨æ„è¿™é‡Œçš„å®šä¹‰
    name,
    age,
    student
}: User) {
    println!("{}", name);
    println!("{}", age);
    println!("{}", student);  
}

fn main() {
    let a = User {
        name: String::from("mike"),
        age: 20,
        student: false,
    };
    foo(a);
}
```

ä¸Šä¾‹ï¼Œæˆ‘ä»¬æŠŠç»“æ„ä½“aä¼ å…¥äº†å‡½æ•° `foo()`ï¼Œ`foo()` çš„å‚æ•°ç›´æ¥å®šä¹‰æˆå¯¹ç»“æ„ä½“çš„æ¨¡å¼åŒ¹é…ï¼Œè§£æå‡ºäº† nameã€ageã€student ä¸‰ä¸ªå­—æ®µçš„å†…å®¹ï¼Œå¹¶åœ¨å‡½æ•°ä¸­ä½¿ç”¨ã€‚

## å°ç»“

æšä¸¾æ˜¯Rustä¸­çš„é‡è¦æ¦‚å¿µï¼Œå¹¿æ³›ç”¨äºå±æ€§é…ç½®ã€é”™è¯¯å¤„ç†ã€åˆ†æ”¯æµç¨‹ã€ç±»å‹èšåˆç­‰ã€‚åœ¨å®é™…åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬æŠŠç»“æ„ä½“ä½œä¸ºæ¨¡å‹çš„ä¸»ä½“æ‰¿è½½ï¼ŒæŠŠæšä¸¾ä½œä¸ºå‘¨è¾¹çš„è¾…åŠ©é…ç½®å’Œé€»è¾‘åˆ†ç±»ã€‚å®ƒä»¬ç»å¸¸ä¼šæ­é…ä½¿ç”¨ã€‚

æ¨¡å¼åŒ¹é…æ˜¯Rusté‡Œéå¸¸æœ‰ç‰¹è‰²çš„è¯­è¨€ç‰¹æ€§ï¼Œæˆ‘ä»¬åœ¨åšåˆ†æ”¯é€»è¾‘å¤„ç†çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡æ¨¡å¼åŒ¹é…å¸¦ä¸Šè¦å¤„ç†çš„ç›¸å…³ä¿¡æ¯ï¼Œè¿˜å¯ä»¥æŠŠè¿™äº›ä¿¡æ¯è§£æå‡ºæ¥ï¼Œè®©ä»£ç çš„é€»è¾‘å’Œæ•°æ®å†…èšå¾—æ›´åŠ ç´§å¯†ï¼Œè®©ç¨‹åºçœ‹èµ·æ¥æ›´åŠ èµå¿ƒæ‚¦ç›®ã€‚

![](https://static001.geekbang.org/resource/image/ab/9b/ab7b1637e9f52a7dc4327db56f99e29b.jpg?wh=1458x1670)

## æ€è€ƒé¢˜

matchè¡¨è¾¾å¼çš„å„ä¸ªåˆ†æ”¯ä¸­ï¼Œå¦‚æœæœ‰ä¸åŒçš„è¿”å›ç±»å‹çš„æƒ…å†µï¼Œåº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿæ¬¢è¿ä½ åœ¨è¯„è®ºåŒºç•™ä¸‹è‡ªå·±çš„ç­”æ¡ˆï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾çš„å†…å®¹åˆ†äº«ç»™å…¶ä»–æœ‹å‹ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼

## å‚è€ƒèµ„æ–™

- æ ¼å¼åŒ–å‚æ•°ï¼š[https://shimo.im/outlink/gray?url=https%3A%2F%2Fdoc.rust-lang.org%2Fstd%2Ffmt%2Findex.html](https://shimo.im/outlink/gray?url=https%3A%2F%2Fdoc.rust-lang.org%2Fstd%2Ffmt%2Findex.html)
- matchçš„è¯­æ³•è§„åˆ™ï¼š[https://doc.rust-lang.org/reference/expressions/match-expr.html](https://doc.rust-lang.org/reference/expressions/match-expr.html)
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ15ï¼‰</strong></div><ul>
<li><span>å¤æ˜åœ°è§‰</span> ğŸ‘ï¼ˆ12ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>è€å¸ˆï¼Œçœ‹åˆ°é‡Œé¢çš„ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘äº§ç”Ÿäº†ä¸€äº›ç–‘é—®ã€‚æˆ‘å…ˆä¸¾ä¸ªä¾‹å­ï¼š
```
fn main() {
    let s = String::from(&quot;Hello&quot;);
    let p = &amp;s;
    let s2 = *p;
}
```
å¦‚æœç›´æ¥å°† s èµ‹å€¼ç»™ s2ï¼Œé‚£ä¹ˆæ¯«æ— ç–‘é—®ä¼šå‘ç”Ÿç§»åŠ¨ï¼Œs ä¸å†æœ‰æ•ˆã€‚ä½†å¦‚æœæ˜¯å¯¹ s çš„å¼•ç”¨è¿›è¡Œè§£å¼•ç”¨ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¼šæç¤ºæ— æ³•ç§»åŠ¨ï¼Œè¿™æ˜¯å•¥åŸå› å‘€ã€‚æˆ‘è‡ªå·±æœ‰ä¸€ä¸ªçŒœæµ‹ï¼Œå› ä¸º Rust é»˜è®¤ä¸ä¼šæ·±åº¦æ‹·è´æ•°æ®ï¼Œæ‰€ä»¥å¦‚æœ let s2 = *p è¿™æ¡è¯­å¥æˆç«‹ï¼Œå°±æ„å‘³ç€è¦å¤ºèµ° s çš„æ‰€æœ‰æƒã€‚ä½†æˆ‘ä»¬ä¹‹æ‰€ä»¥è¦è·å–å¼•ç”¨ï¼Œå°±æ˜¯ä¸ºäº†ä¸å¤ºèµ°åŸæœ‰å˜é‡ï¼ˆsï¼‰çš„æ‰€æœ‰æƒï¼Œäºæ˜¯åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒRust å¹²è„†æç¤ºä¸å…è®¸æˆ‘ä»¬ç§»åŠ¨ï¼Œé™¤éå®ƒå®ç°äº† Copy traitï¼Œæ•°æ®å…¨éƒ¨åœ¨æ ˆä¸Šï¼Œæµ…æ‹·è´ä¹‹åæ•°æ®å½¼æ­¤ç‹¬ç«‹ã€‚
è¿™æ ·ç†è§£æ˜¯æ­£ç¡®çš„å—ï¼ŸRust çš„ä¸€äº›æ¦‚å¿µæ¯”è¾ƒç›¸ä¼¼ï¼Œå®¹æ˜“å‡ºç°æ··ä¹±ï¼Œæ‰€ä»¥æƒ³é—®é—®è€å¸ˆã€‚

åŸºäºä¸Šé¢è¿™ä¸ªä¾‹å­ï¼Œå†æ¥çœ‹çœ‹æ–‡ä¸­çš„ä¸€ä¸ªä¾‹å­ã€‚
```
enum MyEnum {
    Add,
    Subtract,
}

impl MyEnum {
    fn run(&amp;self, x: i32, y: i32) -&gt; i32 {
        &#47;&#47; è¿™é‡Œçš„ self æ˜¾ç„¶æ˜¯æšä¸¾çš„æŸä¸ªå˜ä½“çš„å¼•ç”¨
        &#47;&#47; å› ä¸º MyEnum æ²¡æœ‰å®ç° Copy traitï¼Œæ‰€ä»¥å®ƒå’Œå­—ç¬¦ä¸²ä¸€æ ·ï¼Œä¸èƒ½é€šè¿‡è§£å¼•ç”¨èµ‹å€¼
        &#47;&#47; let obj = *self; è¿™é‡Œæ˜¯ä¸åˆæ³•çš„ï¼Œç”±äºä¸æ˜¯å¯ Copy çš„ï¼Œå› æ­¤æ— æ³•ç§»åŠ¨
        &#47;&#47; ä½†é—®é¢˜æ¥äº†ï¼Œä¸ºå•¥ä¸‹é¢çš„ä»£ç æ˜¯åˆæ³•çš„ï¼ŒåŸæ–‡æ˜¯ match selfï¼Œä½†æ”¹æˆ match *self ä¹Ÿå¯ä»¥
        match *self {
            Self::Add =&gt; x + y,
            Self::Subtract =&gt; x - y,
        }
    }
}
```
å› æ­¤è¿™æ˜¯æˆ‘çš„ç¬¬äºŒä¸ªç–‘é—®ï¼Œä¸ºå•¥ let obj = *self ä¸åˆæ³•ï¼Œä½† match *self å°±æ˜¯åˆæ³•çš„ã€‚

è¿˜æœ‰ç¬¬ä¸‰ä¸ªç–‘é—®ï¼Œå¯èƒ½æ˜¯å—åˆ° C çš„å½±å“ï¼Œå› ä¸ºå˜é‡å’ŒæŒ‡é’ˆæ˜¯æ— æ³•æ¯”è¾ƒçš„ã€‚æ‰€ä»¥åœ¨çœ‹åˆ° match self çš„ä¸€ç¬é—´ï¼Œå°±å¿ä¸ä½è¯•äº†ä¸€ä¸‹ match *selfï¼Œå› ä¸ºå‚æ•°æ˜¯ &amp;selfï¼Œæ‰€ä»¥ self æ˜¯æšä¸¾å˜ä½“çš„å¼•ç”¨ã€‚è€Œ Self::Add å’Œ Self::Subtract æ˜¯å…·ä½“çš„æšä¸¾å˜ä½“ï¼Œå®ƒä»¬ä¹‹é—´æ¯”è¾ƒæ€»è§‰å¾—æœ‰äº›åˆ«æ‰­ï¼Œè¿˜æ˜¯ match *self çœ‹ç€é¡ºçœ¼ã€‚æ‰€ä»¥æƒ³é—®ä¸€ä¸‹è€å¸ˆï¼Œä¸ºå•¥è¿™ä¸¤è€…èƒ½å¤Ÿæ¯”è¾ƒã€‚

ä»¥ä¸Šå°±æ˜¯æˆ‘çš„ä¸€äº›ç–‘é—®ï¼Œè¿˜éº»çƒ¦å”è€å¸ˆæŒ‡å¯¼ä¸€ä¸‹ï¼ŒRust çš„ä¸€äº›æ¦‚å¿µæœ‰ç‚¹è®©äººå¤´æ™•ã€‚</p>2023-11-02</li><br/><li><span>ä¸€ä¸ªäººæ—…è¡Œ</span> ğŸ‘ï¼ˆ5ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>1.  é»˜è®¤æƒ…å†µä¸‹ï¼Œstructä¸èƒ½è¿›è¡Œæ¯”è¾ƒï¼Œéœ€è¦ä¸ºShapeç±»å‹å®ç°PartialEq traitç‰¹å¾ã€‚
2.  æ–¹å¼ä¸€ï¼šä½¿ç”¨æšä¸¾ï¼Œè¯¥æšä¸¾ç±»å‹çš„æšä¸¾å€¼è¡¨ç¤ºä¸€ä¸ªç±»å‹ã€‚
     æ–¹å¼äºŒï¼šä½¿ç”¨ç‰¹å¾ï¼Œæ‰€æœ‰çš„ç±»å‹éƒ½éœ€è¦å®ç°è¯¥ç‰¹å¾
</p>2023-11-01</li><br/><li><span>-HedonğŸ­</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>ä½œä¸ºé™æ€ç±»å‹è¯­è¨€ï¼Œmatch è¿”å›çš„ç±»å‹å¿…é¡»åœ¨ç¼–è¯‘æœŸå°±è¢«ç¡®å®šï¼Œä¹Ÿå°±æ„å‘³ç€ match å¿…é¡»è¿”å›ç›¸åŒçš„ç±»å‹ã€‚åœ¨è¿™ä¸ªå‰æä¸‹ï¼Œå¦‚æœè¦è¿”å›çš„ç±»å‹ï¼Œé‚£ä¹ˆåˆ‡å…¥ç‚¹å°±åªèƒ½æ˜¯ï¼šâ€œè¿”å›åŒä¸€ä¸ªç±»å‹ï¼Œä½†æ˜¯è¿™ä¸ªç±»å‹èƒ½è¡¨ç¤ºï¼ˆæ‰¿è½½ï¼‰ä¸åŒçš„ç±»å‹â€ï¼Œé‚£å°±åªèƒ½æ˜¯æœ¬èŠ‚è¯¾å°†çš„æšä¸¾ enum äº†ã€‚
```rust
enum Number {
    Int(i32),
    Float(f64),
    None
}

fn get_number(condition: i32) -&gt; Number {
    match condition {
        1 =&gt; Number::Int(10),
        2 =&gt; Number::Float(3.14),
        _ =&gt; Number::None
    }
}

fn main() {
    let value = get_number(1);
    match value {
        Number::Int(i) =&gt; println!(&quot;int {}&quot;, i),
        Number::Float(f) =&gt; println!(&quot;float {}&quot;, f),
        Number::None =&gt; println!(&quot;not number&quot;),
    }

    let value = get_number(2);
    match value {
        Number::Int(i) =&gt; println!(&quot;int {}&quot;, i),
        Number::Float(f) =&gt; println!(&quot;float {}&quot;, f),
        Number::None =&gt; println!(&quot;not number&quot;),
    }

    let value = get_number(3);
    match value {
        Number::Int(i) =&gt; println!(&quot;int {}&quot;, i),
        Number::Float(f) =&gt; println!(&quot;float {}&quot;, f),
        Number::None =&gt; println!(&quot;not number&quot;),
    }
}

```</p>2023-11-07</li><br/><li><span>ä¸‹é›¨å¤©</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>æ€è€ƒé¢˜ï¼š
pub enum Result&lt;T1,T2&gt;{
    V1(T1),
    V2(T2)
}

fn get_diff_value(number:i32) -&gt; Result&lt;i32,i32&gt;{
   let r = match number {
       1 =&gt; Result::V1(1),
       _ =&gt; Result::V2(2)
   };
   r
}

fn main(){
    let r  = get_diff_value(0);
    match r {
        Result::V1(x) =&gt; println!(&quot;V1={x}&quot;),
        Result::V2(x) =&gt; println!(&quot;V2={x}&quot;)
    }
}

èšåˆçš„ä»£ä»·æ˜¯ä¸æ˜¯éœ€è¦è§£èšåˆã€‚ã€‚ã€‚ã€‚</p>2023-11-01</li><br/><li><span>æ°´ä¸è¦é±¼</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼Œæˆ‘æœ‰ä¸ªé—®é¢˜ï¼Œé‚£ä¸ª ref name é‚£é‡Œæ˜¯ä¸æ˜¯ç­‰äº &amp;nameï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œé‚£ä¸æ˜¯ç›¸å½“äºæŠŠä¸€ä¸ª &amp;String èµ‹å€¼ç»™äº† String ä¹ˆï¼Œè¿˜æ˜¯è¯´ rust ä¼šè‡ªåŠ¨ç”¨ &amp;String å†å»åˆ›å»ºä¸€ä¸ª String ç„¶åç»™ name</p>2023-11-06</li><br/><li><span>Michael</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>ä¸Šé¢çš„ ref ç« èŠ‚ä¸­ï¼ŒUser.name æ˜¯ String ç±»å‹ï¼Œä¸ºä»€ä¹ˆå¯ä»¥é€šè¿‡refç»™å®ƒèµ‹å€¼ a.name çš„å¼•ç”¨</p>2023-11-02</li><br/><li><span>plh</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è¿™ä¸€èŠ‚ å°±å€¼å›ç¥¨ä»·äº†.   
æ–‡ä¸­: [Rustc å°åŠ©æ‰‹å¦‚æ­¤è´´å¿ƒï¼Œè¿™ç§ä¿å§†çº§æœåŠ¡æ˜¯ä½ åœ¨ Javaã€C++ ç­‰å…¶ä»–è¯­è¨€ä¸­æ„Ÿå—ä¸åˆ°çš„ã€‚] 
ä¸ªäººæ„Ÿè§‰, Rustc ä¹Ÿåƒ å¤§å¸ˆæ ·çš„,åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™, åœ¨äººèº«è¾¹ä¸åŒå…¶çƒ¦çš„æŒ‡å‡ºæ½œåœ¨çš„é—®é¢˜,ç›´åˆ° ç¼–è¯‘æˆåŠŸ.</p>2023-11-01</li><br/><li><span>Taozi</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>1. enumå˜ä½“å¯ä»¥æŒ‚è½½çš„ç±»å‹æ˜¯å¦å°±æ˜¯å¯¹åº”äº†ç»“æ„ä½“çš„ä¸‰ç§å½¢æ€ï¼šå•å…ƒç»“æ„ä½“ã€å…ƒç»„ç»“æ„ä½“å’Œå‘½åç»“æ„ä½“ã€‚
2. matchè¡¨è¾¾å¼ä¸åŒçš„è¿”å›ç±»å‹å¯ä»¥ä½¿ç”¨enumè¿›è¡Œèšåˆã€‚</p>2023-11-01</li><br/><li><span>ä»˜ä½³ä¼Ÿ</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æ€è€ƒé¢˜ï¼šmatchå„ä¸ªåˆ†æ”¯è¿”å›å€¼ç±»å‹ä¸åŒæ—¶ï¼Œå¯ä»¥å°†å„ä¸ªç±»å‹å®ç°åŒä¸€ä¸ªtrait ï¼Œç„¶åç”¨Boxå°†è¿”å›å€¼åŒ…è£¹ï¼Œè¿”å›å€¼ç±»å‹å®šä¹‰Box&lt;dyn trait&gt;ã€‚ä¸çŸ¥é“è¿˜æœ‰æ²¡æœ‰å…¶ä»–åŠæ³•</p>2023-11-01</li><br/><li><span>fandream</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼Œ å…³äºmatchåŒ¹é…æœ‰ä¸ªç–‘é—®ï¼Ÿ
```
#[derive(Debug)]
enum MyEnum {
    Add,
    Subtract,
}
fn main() {
    let a = MyEnum::Add;

    match a {
        MyEnum::Add =&gt; println!(&quot;a&quot;),
        MyEnum::Subtract =&gt; println!(&quot;b&quot;),
    };
    println!(&quot;a = {:?}&quot;, a);
}
```
ä¸Šé¢è¿™ç§æƒ…å†µæ—¶ï¼Œæ²¡æœ‰å‘ç”Ÿmoveï¼Œaè¿˜æ˜¯å¯ä»¥ä½¿ç”¨
ä½†æ˜¯å¦‚æœç»™æšä¸¾æ·»åŠ äº†å¸¦æœ‰ä¼šç§»åŠ¨çš„è´Ÿè½½æ—¶ï¼Œæƒ…å†µå°±ä¸ä¸€æ ·äº†ï¼Œ
```
fn main() {
    let a = MyEnum::Add;

    match a {
        MyEnum::Add =&gt; println!(&quot;a&quot;),
        MyEnum::Subtract =&gt; println!(&quot;b&quot;),
        MyEnum::Mix(val) =&gt; println!(&quot;val = {val}&quot;),
    };
    println!(&quot;a = {:?}&quot;, a);
}

#[derive(Debug)]
enum MyEnum {
    Add,
    Subtract,
    Mix(String),
}
```
è¿™ä¸ªå¸¦æœ‰è´Ÿè½½çš„æšä¸¾å‘ç”Ÿäº†éƒ¨åˆ†ç§»åŠ¨ã€‚
è¿™ä¸ªæ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ</p>2024-03-01</li><br/><li><span>RobinH</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>#[derive(Debug)]
enum Type&lt;T&gt; {
    A(T),
    B(T),
}

fn match_type&lt;T&gt;(t1: Type&lt;T&gt;) -&gt; T {
    let temp = match t1 {
        Type::A(a) =&gt; {
            a
        }
        Type::B(b) =&gt; {
            b
        }
    };
    return temp;
}

æ€è€ƒé¢˜ æˆ‘å°è¯•ç†è§£ä¸‹äº†ä¸‹ ï¼Œæ˜¯æƒ³è€ƒ æ³›å‹ä¹ˆï¼Ÿ</p>2024-01-24</li><br/><li><span>HdUIprince</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆå‚è€ƒèµ„æ–™ä¸­çš„æ ¼å¼åŒ–å‚æ•°çš„é“¾æ¥ä¸å¤ªå¯¹ï¼Ÿ</p>2024-01-01</li><br/><li><span>tan</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æ¯”javaçš„æšä¸¾å¼ºå¤§å¤ªå¤šäº†</p>2023-12-20</li><br/><li><span>superggn</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<p>æ²¡å¤ªæ˜ç™½æ€è€ƒé¢˜ï¼Œ è¿”å›ç±»å‹ä¸åŒæ‰§è¡Œä¸åŒé€»è¾‘å‘—</p>2023-12-13</li><br/><li><span>Joe Black</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>Rustæšä¸¾å…¶å®æ›´åƒC++ booståº“ä¸­çš„variant</p>2023-12-10</li><br/>
</ul>