ä½ å¥½ï¼Œæˆ‘æ˜¯ä½•è¾‰ã€‚ä»Šå¤©æˆ‘ä»¬æ¢ç´¢Dubboæ¡†æ¶çš„ç¬¬åé“ç‰¹è‰²é£å‘³ï¼Œé…ç½®åŠ è½½é¡ºåºã€‚

å¦‚ä½•å‡çº§é¡¹ç›®å·¥ç¨‹ pom æ–‡ä»¶ä¸­æŸäº› dependency å…ƒç´ çš„ç‰ˆæœ¬å·ï¼Œæƒ³å¿…ä½ æ˜¯è½»è½¦ç†Ÿè·¯äº†ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å‡çº§çš„ç‰ˆæœ¬éƒ½æ˜¯å‘ä¸‹å…¼å®¹çš„ï¼ŒåŸºæœ¬æ²¡é—®é¢˜ï¼Œä½†å¦‚æœè·¨è¶Šå¤§ç‰ˆæœ¬å‡çº§ï¼Œè¿˜æ˜¯å¾—å¤šå…³æ³¨å¤šéªŒè¯ä¸€ä¸‹ï¼Œä»Šå¤©è¦è§£å†³çš„é—®é¢˜å°±æ˜¯ç‰ˆæœ¬å‡çº§åå‡ºç°çš„ã€‚

æˆ‘ä»¬æœ‰è¿™æ ·ä¸€ä¸ªæ•æ„Ÿä¿¡æ¯ç³»ç»Ÿç¾¤ï¼Œéƒ¨åˆ†ç³»ç»Ÿæ‹“æ‰‘å›¾å¦‚ä¸‹ï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/47/a6/472351157b114cfb04815f6db4d402a6.png?wh=1920x1054)

å›¾ä¸­æœ‰æä¾›æ–¹å’Œæ¶ˆè´¹æ–¹åº”ç”¨ï¼Œéƒ½ä» dubbo2 å‡çº§åˆ°äº† dubbo3 ç‰ˆæœ¬ï¼Œå‡çº§åæ”¾åˆ°æµ‹è¯•ç¯å¢ƒéªŒè¯äº†ä¸€åœˆéƒ½æŒºæ­£å¸¸çš„ï¼Œç„¶è€Œåœ¨å‘å¸ƒæ—¥å½“æ™šï¼ŒåˆšæŠŠç³»ç»Ÿå‘å¸ƒåˆ°é¢„å‘ç¯å¢ƒï¼Œå°±å¼€å§‹å‡ºç°äº†ä¸€äº›æ¶ˆè´¹æ–¹è°ƒç”¨è¶…æ—¶çš„ç°è±¡ï¼Œæˆªå–äº†ä¸€æ®µå¼‚å¸¸æ—¥å¿—ï¼š

```java
Caused by: org.apache.dubbo.remoting.TimeoutException: Waiting server-side response timeout by scan timer. start time: 2022-11-24 21:36:57.228, end time: 2022-11-24 21:36:58.246, client elapsed: 2 ms, server elapsed: 1016 ms, timeout: 1000 ms, request: Request [id=3, version=2.0.2, twoway=true, event=false, broken=false, data=RpcInvocation [methodName=decrypt, parameterTypes=[class java.lang.String], arguments=[Geek], attachments={path=com.hmilyylimh.cloud.facade.crypto.CryptoFacade, remote.application=dubbo-11-loadcfg-consumer, interface=com.hmilyylimh.cloud.facade.crypto.CryptoFacade, version=0.0.0, timeout=1000}]], channel: /192.168.100.183:49527 -> /192.168.100.183:28110
	at org.apache.dubbo.remoting.exchange.support.DefaultFuture.doReceived(DefaultFuture.java:212)
	at org.apache.dubbo.remoting.exchange.support.DefaultFuture.received(DefaultFuture.java:176)
	at org.apache.dubbo.remoting.exchange.support.DefaultFuture$TimeoutCheckTask.notifyTimeout(DefaultFuture.java:295)
	at org.apache.dubbo.remoting.exchange.support.DefaultFuture$TimeoutCheckTask.lambda$run$0(DefaultFuture.java:282)
	at org.apache.dubbo.common.threadpool.ThreadlessExecutor$RunnableWrapper.run(ThreadlessExecutor.java:184)
	at org.apache.dubbo.common.threadpool.ThreadlessExecutor.waitAndDrain(ThreadlessExecutor.java:103)
	at org.apache.dubbo.rpc.AsyncRpcResult.get(AsyncRpcResult.java:193)
	... 29 more
```

å¼‚å¸¸ä¿¡æ¯ä¸­ç«Ÿç„¶æ˜¯ `timeout: 1000 ms`ï¼Œç®€ç›´ä¸å¯æ€è®®ï¼Œæ˜æ˜è§£å¯†ç³»ç»Ÿåœ¨æš´éœ²æ¥å£çš„æ—¶å€™æŒ‡å®šäº†è¶…æ—¶æ—¶é—´ï¼Œä¸ºä»€ä¹ˆå°±æ²¡ç”Ÿæ•ˆå‘¢ï¼Ÿ

æˆ‘ä»¬å»æ‰’ä¸€ä¸‹æä¾›æ–¹å’Œæ¶ˆè´¹æ–¹çš„ä»£ç ï¼Œçœ‹çœ‹è®¾ç½®çš„è¶…æ—¶æ—¶é—´ï¼š

```java
///////////////////////////////////////////////////
// æä¾›æ–¹ï¼šåº”ç”¨é…ç½®ç±»ï¼Œç”¨ Java ä»£ç çš„ç¼–å†™æ–¹å¼ä»£æ›¿äº†ä»¥å‰ XML ç¼–å†™é…ç½®
///////////////////////////////////////////////////
@Configuration
public class LoadCfgProviderConfig {
    // æä¾›è€…çš„åº”ç”¨æœåŠ¡åç§°
    @Bean
    public ApplicationConfig applicationConfig() {
        return new ApplicationConfig("dubbo-11-loadcfg-provider");
    }
    // æ³¨å†Œä¸­å¿ƒçš„åœ°å€ï¼Œé€šè¿‡ address å¡«å†™çš„åœ°å€æä¾›æ–¹å°±å¯ä»¥è”ç³»ä¸Š zk æœåŠ¡
    @Bean
    public RegistryConfig registryConfig() {
        return new RegistryConfig("zookeeper://127.0.0.1:2181");
    }
    // æä¾›è€…éœ€è¦æš´éœ²æœåŠ¡çš„åè®®ï¼Œæä¾›è€…éœ€è¦æš´éœ²æœåŠ¡çš„ç«¯å£
    @Bean
    public ProtocolConfig protocolConfig(){
        return new ProtocolConfig("dubbo", 28110);
    }
    // æä¾›è€…æš´éœ²æ¥å£çš„å…¨è·¯å¾„ä¸º com.hmilyylimh.cloud.facade.crypto.CryptoFacade çš„æœåŠ¡è¿‡ç¨‹
    @Bean
    public ServiceConfig<CryptoFacade> serviceConfigCryptoFacade(CryptoFacade cryptoFacade,
                                                                ApplicationConfig applicationConfig,
                                                                RegistryConfig registryConfig) {
        // åˆ›å»ºæœåŠ¡å‘å¸ƒçš„é…ç½®å¯¹è±¡ï¼Œç±»æ¯”äº <dubbo:service/> æ ‡ç­¾çš„æ•ˆæœ
        ServiceConfig<CryptoFacade> serviceConfig = new ServiceConfig<>();
        // è®¾ç½®éœ€è¦æš´éœ²æ¥å£çš„å…¨è·¯å¾„ï¼Œç±»æ¯”äº <dubbo:service interface="com.hmilyylimh.cloud.facade.crypto.CryptoFacade"></dubbo:service> æ ‡ç­¾ä¸­ interface å±æ€§çš„æ•ˆæœ
        serviceConfig.setInterface(CryptoFacade.class);
        // è®¾ç½®éœ€è¦æš´éœ²<dubbo:service ref="cryptoFacade"></dubbo:service> æ ‡ç­¾ä¸­ ref å±æ€§çš„æ•ˆæœ        
        serviceConfig.setRef(cryptoFacade);
        // è®¾ç½®åº”ç”¨åç§°ï¼Œç±»æ¯”äº <dubbo:application name="dubbo-11-loadcfg-provider"></dubbo:application> æ ‡ç­¾çš„æ•ˆæœ
        serviceConfig.setApplication(applicationConfig);
        // è®¾ç½®æ³¨<dubbo:registry address="zookeeper://127.0.0.1:2181"></dubbo:registry> æ ‡ç­¾çš„æ•ˆæœ        
        serviceConfig.setRegistry(registryConfig);
        // è®¾ç½®è¯¥ CryptoFacade æ¥å£çš„é»˜è®¤è¶…æ—¶æ—¶é—´ä¸º 5000 æ¯«ç§’
        serviceConfig.setTimeout(5000);
        
        // ä¸“é—¨æŒ‡å®š CryptoFacade ä¸­çš„ decrypt æ–¹æ³•è¶…æ—¶æ—¶é—´ä¸º 3000 æ¯«ç§’
        List<MethodConfig> methods = new ArrayList<>();
        MethodConfig methodConfig = new MethodConfig();
        methodConfig.setName("decrypt");
        methodConfig.setTimeout(3000);
        methods.add(methodConfig);
        serviceConfig.setMethods(methods);
        
        // æœ€ç»ˆå°† serviceConfig å¯¹è±¡å¯¼å‡ºæœåŠ¡ï¼ˆæš´éœ²æœåŠ¡è¿‡ç¨‹ï¼‰
        serviceConfig.export();
        return serviceConfig;
    }
}

///////////////////////////////////////////////////
// æä¾›æ–¹ï¼šåŠ è§£å¯†æœåŠ¡ï¼Œç›®å‰åªæ˜¯å®ç°äº†è§£å¯†æ–¹æ³•çš„å®ç°é€»è¾‘
///////////////////////////////////////////////////
@Component
@DubboService
public class CryptoFacadeImpl implements CryptoFacade {
    @Override
    public String decrypt(String encryptContent) {
        // ç¡çœ  5000 æ¯«ç§’ï¼Œæ¨¡æ‹Ÿè§£å¯†è€—æ—¶æƒ…å†µ
        TimeUtils.sleep(5 * 1000);
        // è±¡å¾æ€§çš„ç»„è£…ä¸€ä¸‹è¿”å›çš„æ˜æ–‡ç»“æœ
        String result = String.format("å¯†æ–‡ä¸º: %s, è§£å¯†åçš„æ˜æ–‡ä¸º: %s", encryptContent, "PLAIN-" + encryptContent);
        // é¡ºä¾¿åœ¨æä¾›æ–¹æ‰“å°ä¸€ä¸‹è¿”å›çš„ç»“æœ
        System.out.println(result);
        return result;
    }
}

///////////////////////////////////////////////////
// æä¾›æ–¹ï¼šåº”ç”¨å¯åŠ¨ç±»
///////////////////////////////////////////////////
@EnableDubbo
@SpringBootApplication
public class Dubbo11LoadcfgProviderApplication {
    public static void main(String[] args) {
        // ä¸€è¡Œä»£ç æå®š SpringBoot åº”ç”¨çš„å¯åŠ¨
        SpringApplication.run(Dubbo11LoadcfgProviderApplication.class, args);
        // å¯åŠ¨æˆåŠŸåï¼Œæ‰“å°ä¸€ä¸‹æ—¥å¿—ï¼Œæ–¹ä¾¿è‚‰çœ¼å¯ä»¥ç›´è§‚çš„çœ‹åˆ°å¯åŠ¨æˆåŠŸäº†
        System.out.println("ã€ã€ã€ã€ã€ã€ Dubbo11LoadcfgProviderApplication ã€‘ã€‘ã€‘ã€‘ã€‘ã€‘å·²å¯åŠ¨.");
    }
}

///////////////////////////////////////////////////
// æ¶ˆè´¹æ–¹ï¼šåº”ç”¨å¯åŠ¨ç±»
///////////////////////////////////////////////////
@ImportResource("classpath:dubbo-11-loadcfg-consumer.xml")
@SpringBootApplication
public class Dubbo11LoadcfgConsumerApplication {
    public static void main(String[] args) {
        // ä¸€è¡Œä»£ç æå®š SpringBoot åº”ç”¨çš„å¯åŠ¨
        ConfigurableApplicationContext ctx =
                SpringApplication.run(Dubbo11LoadcfgConsumerApplication.class, args);
        // å¯åŠ¨æˆåŠŸåï¼Œæ‰“å°ä¸€ä¸‹æ—¥å¿—ï¼Œæ–¹ä¾¿è‚‰çœ¼å¯ä»¥ç›´è§‚çš„çœ‹åˆ°å¯åŠ¨æˆåŠŸäº†
        System.out.println("ã€ã€ã€ã€ã€ã€ Dubbo11LoadcfgConsumerApplication ã€‘ã€‘ã€‘ã€‘ã€‘ã€‘å·²å¯åŠ¨.");
        // ç„¶åæ¨¡æ‹Ÿè§¦å‘è°ƒç”¨ä¸€ä¸‹æä¾›æ–¹çš„åŠ è§£å¯†æœåŠ¡
        CryptoFacade cryptoFacade = ctx.getBean(CryptoFacade.class);
        // æ‰“å°è§£å¯†ç»“æœ
        System.out.println(cryptoFacade.decrypt("Geek"));
    }
}

///////////////////////////////////////////////////
// æ¶ˆè´¹æ–¹ï¼šåº”ç”¨å¯åŠ¨ç±»çš„ @ImportResource æ³¨è§£åŠ è½½çš„
// dubbo-11-loadcfg-consumer.xml é…ç½®æ–‡ä»¶å†…å®¹
///////////////////////////////////////////////////
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:dubbo="http://dubbo.apache.org/schema/dubbo"
       xsi:schemaLocation="http://www.springframework.org/schema/beans        http://www.springframework.org/schema/beans/spring-beans-4.3.xsd        http://dubbo.apache.org/schema/dubbo        http://dubbo.apache.org/schema/dubbo/dubbo.xsd">
    <!-- æ¶ˆè´¹è€…çš„åº”ç”¨æœåŠ¡åç§° -->
    <dubbo:application name="dubbo-11-loadcfg-consumer"></dubbo:application>
    <!-- æ³¨å†Œä¸­å¿ƒçš„åœ°å€ï¼Œé€šè¿‡ address å¡«å†™çš„åœ°å€æä¾›æ–¹å°±å¯ä»¥è”ç³»ä¸Š zk æœåŠ¡ -->
    <dubbo:registry address="zookeeper://127.0.0.1:2181"></dubbo:registry>
    <!-- å¼•ç”¨åŠ è§£å¯†æœåŠ¡ -->
    <dubbo:reference id="cryptoFacade"
            interface="com.hmilyylimh.cloud.facade.crypto.CryptoFacade"></dubbo:reference>
</beans>
```

ä»æä¾›æ–¹çš„æš´éœ²æ¥å£çš„ä»£ç æ¥çœ‹ï¼ŒåŠ è§£å¯†æœåŠ¡çš„é»˜è®¤è¶…æ—¶æ—¶é—´æ˜¯ 5000 æ¯«ç§’ï¼ˆç¬¬37è¡Œï¼‰ï¼ŒåŠ è§£å¯†æœåŠ¡ä¸­çš„è§£å¯†æ–¹æ³•è®¾ç½®çš„æ˜¯ 3000 æ¯«ç§’ï¼ˆç¬¬43è¡Œï¼‰ï¼Œä»£ç å·²ç»ç»†åŒ–åˆ°æ–¹æ³•çº§åˆ«æ¥è®¾ç½®è¶…æ—¶æ—¶é—´äº†ï¼Œä½•å†µæ¶ˆè´¹æ–¹ä¹Ÿåªæ˜¯å‡çº§äº† pom æ–‡ä»¶çš„ç‰ˆæœ¬å·ï¼Œä¸ºä»€ä¹ˆå‘å¸ƒåˆ°é¢„å‘ç¯å¢ƒå°±è¶…æ—¶äº†ï¼Ÿå¤ªå¥‡æ€ªäº†ã€‚

è¿™ç§ç°è±¡ï¼Œä½ ä¼šå¦‚ä½•è§£å†³å‘¢ï¼Ÿ

## Debug è°ƒè¯•

ç°è±¡æ‘†åœ¨è¿™äº†ï¼Œåœ¨å¯»æ‰¾è§£å†³æ–¹æ¡ˆä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥æ¢³ç†ä¸‹ç›®å‰ä»£ç çš„ç°çŠ¶ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰çªç ´å£ï¼š

- æä¾›æ–¹å’Œæ¶ˆè´¹æ–¹éƒ½å‡çº§äº† Dubbo ç‰ˆæœ¬å·ã€‚
- æä¾›æ–¹ä¸ºåŠ è§£å¯†æœåŠ¡æ˜ç¡®æŒ‡å®šäº†è¶…æ—¶æ—¶é—´ï¼Œæ¶ˆè´¹æ–¹ä»£ç ä¹Ÿæ²¡æœ‰æŒ‡å®šè¶…æ—¶æ—¶é—´ã€‚
- æ¶ˆè´¹æ–¹å’Œæä¾›æ–¹éƒ½æŒ‰ç…§æœªå‡çº§ä¹‹å‰çš„è€æ ·å­è¿›è¡Œè°ƒç”¨ã€‚

åˆ°è¿™é‡Œè¿˜æ˜¯æ²¡æœ‰å¤´ç»ªï¼Œåˆ°åº•æ˜¯æä¾›æ–¹æ²¡æœ‰è¯»å–åˆ°3000æ¯«ç§’ï¼Ÿæˆ–æ˜¯æ¶ˆè´¹æ–¹æ²¡æœ‰è·å–åˆ°3000æ¯«ç§’ï¼Ÿè¿˜æ˜¯æ¶ˆè´¹æ–¹è·å–åˆ°äº†3000æ¯«ç§’ä½†ä¸ä½¿ç”¨å‘¢ï¼Ÿ

è¿™é‡Œæˆ‘æ•™ä½ ä¸€ä¸ªå°æŠ€å·§ï¼Œå¯¹äºä¸€äº›ä¸çŸ¥å¦‚ä½•åˆ†æçš„é—®é¢˜ï¼Œå¯ä»¥å°½é‡å°è¯• Debug è°ƒè¯•ä¸€ä¸‹ï¼Œè°ƒè¯•çš„è¿‡ç¨‹ï¼Œ**ä¸ä½†æœ‰åŠ©äºä½ è§£å†³å½“ä¸‹é—®é¢˜ï¼Œè¿˜æœ‰åŠ©ä½ æ›´å¥½åœ°ç†è§£åŠŸèƒ½çš„è°ƒç”¨æµç¨‹ã€‚**

æ—¢ç„¶æ¶ˆè´¹æ–¹å‘ç”Ÿäº†è¶…æ—¶å¼‚å¸¸ï¼Œé‚£æˆ‘ä»¬å°±ä»åˆšæ‰è¿™æ®µè¶…æ—¶å¼‚å¸¸å¼€å§‹å§ã€‚ç»†çœ‹è¶…æ—¶å¼‚å¸¸çš„è°ƒç”¨å †æ ˆï¼š

```java
Caused by: org.apache.dubbo.remoting.TimeoutException: Waiting server-side response timeout by scan timer. start time: 2022-11-24 21:36:57.228, end time: 2022-11-24 21:36:58.246, client elapsed: 2 ms, server elapsed: 1016 ms, timeout: 1000 ms, request: Request [id=3, version=2.0.2, twoway=true, event=false, broken=false, data=RpcInvocation [methodName=decrypt, parameterTypes=[class java.lang.String], arguments=[Geek], attachments={path=com.hmilyylimh.cloud.facade.crypto.CryptoFacade, remote.application=dubbo-11-loadcfg-consumer, interface=com.hmilyylimh.cloud.facade.crypto.CryptoFacade, version=0.0.0, timeout=1000}]], channel: /192.168.100.183:49527 -> /192.168.100.183:28110
	at org.apache.dubbo.remoting.exchange.support.DefaultFuture.doReceived(DefaultFuture.java:212)
	at org.apache.dubbo.remoting.exchange.support.DefaultFuture.received(DefaultFuture.java:176)
	at org.apache.dubbo.remoting.exchange.support.DefaultFuture$TimeoutCheckTask.notifyTimeout(DefaultFuture.java:295)
	at org.apache.dubbo.remoting.exchange.support.DefaultFuture$TimeoutCheckTask.lambda$run$0(DefaultFuture.java:282)
	at org.apache.dubbo.common.threadpool.ThreadlessExecutor$RunnableWrapper.run(ThreadlessExecutor.java:184)
	at org.apache.dubbo.common.threadpool.ThreadlessExecutor.waitAndDrain(ThreadlessExecutor.java:103)
	at org.apache.dubbo.rpc.AsyncRpcResult.get(AsyncRpcResult.java:193)
	... 29 more
```

å…ˆæ˜¯æ‰§è¡Œä¸€ä¸ªçº¿ç¨‹çš„ run æ–¹æ³•ï¼ˆRunnableWrapper.runï¼‰ï¼Œç´§æ¥ç€æ‰§è¡Œè¶…æ—¶æ£€æµ‹ä»»åŠ¡çš„é€šçŸ¥è¶…æ—¶æ–¹æ³•ï¼ˆTimeoutCheckTask.notifyTimeoutï¼‰ï¼Œæœ€åæ‰§è¡Œäº†æ¥æ”¶æ•°æ®çš„æ ¸å¿ƒæ–¹æ³•ï¼ˆDefaultFuture.doReceivedï¼‰ã€‚

ä¹ä¸€çœ‹ï¼Œæ ¸å¿ƒé€»è¾‘æ˜¯åœ¨ DefaultFuture ä¸­å‡ºç°äº†å¼‚å¸¸ï¼Œçœ‹åˆ° Future å­—æ ·ï¼Œç›¸ä¿¡ä½ ä¹Ÿæƒ³åˆ°äº†ï¼Œåœ¨â€œ[å¼‚æ­¥åŒ–å®è·µ](https://time.geekbang.org/column/article/611392)â€ä¸­å­¦è¿‡ï¼ŒFuture åœ¨è·å–ç»“æœæ—¶æ˜¯æ”¯æŒä¼ å…¥è¶…æ—¶æ—¶é—´çš„ï¼Œé‚£æˆ‘ä»¬ä¹Ÿæ¥ç ”ç©¶ä¸‹ DefaultFuture æœ‰æ²¡æœ‰è¶…æ—¶å‚æ•°ã€‚

çœ‹ DefaultFuture çš„æˆå‘˜å˜é‡å’Œä¸€äº›æ–¹æ³•çš„å…¥å‚ï¼Œåœ¨ DefaultFuture çš„æ„é€ æ–¹æ³•ä¸­å‘ç°äº†æˆå‘˜å˜é‡ timeout çš„èµ‹å€¼é€»è¾‘ï¼š

```java
// DefaultFuture æ„é€ æ–¹æ³•
private DefaultFuture(Channel channel, Request request, int timeout) {
    // å‘å¤–å‘é€æ•°æ®çš„é€šé“ï¼Œæ¯”å¦‚å¯ä»¥æ˜¯ NettyClient æ“ä½œ netty æ¥å‘é€æ•°æ®
    this.channel = channel;
    // è¯¥å¯¹è±¡åŒ…å«å‘é€è‡³æä¾›æ–¹çš„æ‰€æœ‰æ•°æ®
    this.request = request;
    // èƒ½å¤Ÿè¡¨ç¤ºè¯·æ±‚å¯¹è±¡çš„å”¯ä¸€ID
    this.id = request.getId();
    // æ¥æ”¶æ„é€ æ–¹æ³•ä¸­ä¼ å…¥çš„ timeout å‚æ•°å€¼
    // å¦‚æœå¤§äº0åˆ™ç›´æ¥ä½¿ç”¨ï¼Œå¦åˆ™ç›´æ¥ä»channelçš„urlä¸­è·å–
    this.timeout = timeout > 0 ? timeout : 
          channel.getUrl().getPositiveParameter("timeout", 1000);
    // æ„å»ºå”¯ä¸€IDä¸å½“å‰å¯¹è±¡çš„å…³ç³»ï¼Œå”¯ä¸€IDä¸å‘é€æ•°æ®é€šé“çš„å…³ç³»
    // put into waiting map.
    FUTURES.put(id, this);
    CHANNELS.put(id, channel);
}
```

æ„é€ æ–¹æ³•æ”¯æŒ 3 ä¸ªå‚æ•°çš„ä¼ å…¥ï¼Œå…¶ä¸­ä¸€ä¸ªå°±æ˜¯ timeout è¶…æ—¶å‚æ•°ï¼Œå¦‚æœ timeout å¤§äº 0 ï¼Œç›´æ¥ä½¿ç”¨ï¼Œå¦åˆ™å°±ä» channel çš„ url è·å–è¶…æ—¶æ—¶é—´ã€‚

æ‰€ä»¥ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦å¼„æ¸…æ¥š DefaultFuture æ„é€ æ–¹æ³•å…¥å‚ä¸­çš„ timeout æ˜¯æ€ä¹ˆè®¡ç®—å‡ºæ¥çš„ï¼Ÿ

åœ¨åˆšåˆšæ‰¾åˆ°çš„æ„é€ æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬æ‰“ä¸Šå¸¦æ¡ä»¶çš„æ–­ç‚¹ï¼Œæ¥æŸ¥çœ‹èµ‹å€¼ timeout å‚æ•°çš„æºå¤´åœ¨å“ªé‡Œï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/cc/6e/ccd002cd86078ffa186e8424b909686e.jpg?wh=4191x1722)

æ¥ç€ Debug è¿è¡Œä¸€ä¸‹æ¶ˆè´¹æ–¹ï¼Œå½“æ¥åˆ°æ–­ç‚¹çš„æ—¶å€™ï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/b9/3b/b9136e8c23b8b3c987087420eb92ae3b.png?wh=5334x1920)

æ‰¾åˆ°å›¾ä¸­æ–­ç‚¹æ‰€åœ¨çš„è°ƒç”¨å †æ ˆï¼Œä¸€è·¯å‘ä¸‹ç‚¹å‡»æŸ¥çœ‹ timeout ä¼ å‚çš„æºå¤´ï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/71/b6/71e2a7c5de96691e705262798ba2f2b6.png?wh=5128x2777)

æœ€ç»ˆåœ¨ DubboInvoker çš„ doInvoke æ–¹æ³•ä¸­ï¼Œä½ ä¼šæ‰¾åˆ° timeout å‚æ•°çš„å±€éƒ¨å˜é‡ï¼Œçœ‹å›¾ä¸­çº¢æ¡†çš„ä½ç½®ï¼Œå¯ä»¥çœ‹åˆ°è¯¥å±€éƒ¨å˜é‡çš„å€¼æ˜¯é€šè¿‡ä¸€ä¸ª calculateTimeout æ–¹æ³•è®¡ç®—å¾—åˆ°çš„ã€‚

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰æ‰¾åˆ°å¯èƒ½é€ æˆè¶…æ—¶å¼‚å¸¸é—®é¢˜çš„ç–‘ç‚¹ï¼Œä¸è¿‡ä¹Ÿåˆ«ç€æ€¥ï¼Œæ¯•ç«Ÿè®¡ç®— timeout çš„æºå¤´åœ¨æ–¹æ³•calculateTimeouté‡Œé¢ï¼Œè¯´æ˜å®ƒè¿˜æ˜¯æŒºå…³é”®çš„ï¼Œæˆ‘ä»¬ä¸å¦¨å¤§è‡´æµè§ˆä¸‹è¿™ä¸ªç±»çš„å˜é‡å’Œæ–¹æ³•ï¼Œæ··ä¸ªçœ¼ç†Ÿã€‚

æ¥çœ‹ä¸‹ DubboInvoker çš„æˆå‘˜å˜é‡å’Œä¸€äº›æ–¹æ³•çš„å…¥å‚ï¼Œå‘ç°æœ‰ä¸ª Invoker æ¥å£çš„é›†åˆ invokers æˆå‘˜å˜é‡ï¼Œè€Œå½“å‰çš„ DubboInvoker ä¹Ÿæ˜¯ Invoker æ¥å£çš„å­ç±»ï¼Œå®ƒä»¬ä¹‹é—´æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿæˆ‘ä»¬å†æ¥æŸ¥çœ‹ä¸€ä¸‹ invokers å†…å®¹ï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/2e/be/2ecacdaec2626ed58b06cb8d0f5f9bbe.jpg?wh=4680x1818)

å¥‡æ€ªçš„æ˜¯ï¼Œçœ‹çº¢æ¡†å¯ä»¥å‘ç°å½“å‰ DubboInvoker çš„ this å¼•ç”¨åœ¨ invokers å½“ä¸­ï¼Œè€Œä¸” invokers ä¸­çš„å¦å¤–ä¸¤ä¸ªå…ƒç´ ä¹Ÿæ˜¯ DubboInvoker ç±»å‹çš„ï¼Œæˆ‘ä»¬æ ¹æœ¬çœ‹ä¸å‡ºè¿™3ä¸ªå…ƒç´ æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œéš¾é“ Dubbo æ¡†æ¶éšæœºé€‰æ‹©äº† invokers ä¸­çš„ä¸€ä¸ªå…ƒç´ è¿›è¡Œè°ƒç”¨çš„ä¹ˆï¼Ÿ

æˆ‘ä»¬ä¸å¦¨ç»§ç»­å±•å¼€ invokers ä¸­çš„æ¯ä¸ªå…ƒç´ çš„æˆå‘˜å˜é‡ï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/3d/19/3d8ecc1534747e35bc543a5b39ab4119.jpg?wh=4464x2004)

å¯ä»¥å¾ˆæ¸…æ¥šåœ°çœ‹åˆ°å½“å‰çš„ Invoker å¼•ç”¨ï¼Œå’Œå…¶ä»–å‡ ä¸ªå¼•ç”¨ä¸­çš„ url å˜é‡ç»“æ„æ˜¯ä¸ä¸€æ ·ï¼Œä¸ºä»€ä¹ˆä¸ä¸€æ ·å‘¢ï¼Ÿç›®å‰è¿˜æ˜¯çœ‹ä¸å‡ºä»€ä¹ˆç«¯å€ªã€‚

ä¸è¿‡ï¼Œå¯ä»¥å‘ç° url å˜é‡æ˜¯ä» DubboInvoker çš„æ„é€ æ–¹æ³•ä¼ å…¥è¿›æ¥çš„ï¼Œé‚£æˆ‘ä»¬ç»§ç»­åœ¨ DubboInvoker çš„æ„é€ æ–¹æ³•ä¸­æ‰“ä¸Šæ¡ä»¶æ–­ç‚¹ï¼Œçœ‹çœ‹èµ‹å€¼ url çš„æºå¤´åˆ°åº•æ˜¯è°ï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/a1/be/a145868480de3d3fa9e4760d192ca4be.jpg?wh=1920x729)

å†æ¬¡ debug è¿è¡Œä¸€ä¸‹æ¶ˆè´¹æ–¹ï¼Œå…³æ³¨è°ƒç”¨å †æ ˆï¼Œçœ‹çœ‹æœ‰ä»€ä¹ˆä¸ä¸€æ ·çš„åœ°æ–¹ï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/0d/9f/0d9fd4935a62a7dd68e80b6395dccd9f.jpg?wh=5190x2415)

å‘ç°æ–­ç‚¹è¿›å…¥äº†å¤šæ¬¡ï¼Œæ¯æ¬¡ invokers éƒ½ä¼šå¢åŠ ä¸€ä¸ªï¼Œå¥‡æ€ªçš„æ˜¯ï¼Œæœ‰ 1 æ¬¡è°ƒç”¨å †æ ˆæ˜¾ç¤ºäº† ServiceDiscoveryRegistryDirectory è¿™ä¹ˆä¸€ä¸ªç±»ï¼Œè¿™ä¸å°±æ˜¯ Dubbo æ–°ç‰ˆæœ¬çš„æœåŠ¡å‘ç°åº”ç”¨çº§è®¢é˜…ï¼Ÿè€Œä¸”å½“å‰ DubboInvoker çš„ this å¼•ç”¨æ­£å¥½æ˜¯è¿™ä¸ªæœåŠ¡å‘ç°çš„å¼•ç”¨ï¼Œéš¾é“ Dubbo æ¡†æ¶ä» invokers ä¸­é€‰æ‹©äº†æ–°ç‰ˆæœ¬çš„æœåŠ¡å‘ç°å®ä¾‹ä¹ˆï¼Ÿ

## ä¸¤ä¸ªå¯ç–‘ç‚¹

é€šè¿‡å‡ æ¬¡æ–­ç‚¹åˆ†æï¼Œæˆ‘ä»¬ä» DubboInvoker ä¸­æ‰¾åˆ°äº†ä¸¤ä¸ªå¼•èµ· timeout ä¸èƒ½æ­£ç¡®èµ‹å€¼çš„å¯ç–‘ç‚¹ï¼š

1. calculateTimeout ä¸ºä»€ä¹ˆæ²¡æœ‰å¾—åˆ°æ­£ç¡®çš„å€¼ï¼Ÿå¯ä»¥æ€æ ·å¾—åˆ°æ­£ç¡®çš„å€¼å‘¢ï¼Ÿ
2. ä¸ºä»€ä¹ˆä½¿ç”¨çš„æ˜¯æ–°ç‰ˆæœ¬çš„æœåŠ¡å‘ç°ç±»è¿›è¡Œè¿œç¨‹è°ƒç”¨å‘¢ï¼Ÿ

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç€é‡åˆ†æä¸‹è¿™ä¸¤ä¸ªå¯ç–‘ç‚¹ã€‚

### å¯ç–‘ç‚¹ä¸€

å…ˆåˆ†æå¯ç–‘ç‚¹ä¸€ï¼Œé¦–å…ˆè¦è¿›å…¥ calculateTimeout æ–¹æ³•çœ‹ä¸‹å…·ä½“é€»è¾‘ï¼Œè¿™é‡Œçš„é€»è¾‘æ¯”è¾ƒæ·±ï¼Œä¸è¿‡æ²¡å…³ç³»ï¼Œæˆ‘æ€»ç»“è¿™ä¸ªæ–¹æ³•å†…éƒ¨å¤§è‡´çš„ä»£ç è°ƒç”¨æµç¨‹ï¼Œä½ å¯ä»¥å‚è€ƒï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/86/27/865814e4cd1db440e6c9147a6e3yy627.png?wh=1920x840)

è°ƒç”¨æµç¨‹æ•´ä½“åˆ†ä¸ºä¸‰å¤§å—ï¼Œ**å…ˆå–æ–¹æ³•çº§åˆ«çš„å‚æ•°ï¼Œå†å–æœåŠ¡çº§åˆ«çš„å‚æ•°ï¼Œæœ€åå–å®ä¾‹çº§åˆ«çš„å‚æ•°**ï¼›åœ¨æ¯ä¸€å—çš„å†…éƒ¨**æŒ‰ç…§å…ˆå–æ¶ˆè´¹æ–¹ï¼Œå†æä¾›æ–¹çš„é¡ºåºè¯»å–å‚æ•°**ã€‚

ç”±äºç›®å‰ Debug è¿è¡Œæ—¶ä½¿ç”¨çš„ DubboInvoker æ˜¯æ–°ç‰ˆæœ¬çš„æœåŠ¡å‘ç°å®ä¾‹ï¼Œè€Œä¸”æä¾›æ–¹åŠ è§£å¯†æœåŠ¡çš„ @DubboService æ³¨è§£ä¸­æ²¡æœ‰é…ç½®ä»»ä½•è¶…æ—¶æ—¶é—´ï¼Œæ¶ˆè´¹æ–¹çš„ XML é…ç½®æ–‡ä»¶ä¸­ä¹Ÿæ²¡æœ‰é…ç½®ä»»ä½•è¶…æ—¶æ—¶é—´ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæ­£å¥½ç¬¦åˆå›¾ä¸­æ‹¿ä¸åˆ°ä»»ä½• timeout å‚æ•°å€¼çš„ç°è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ‹¿åˆ°çš„æ˜¯ä¸€ä¸ª null ã€‚

å¦‚æœä½ å¯¹è¿™ä¸ªç»“è®ºæŠ±ç€æ€€ç–‘çš„æ€åº¦ï¼Œå¤§å¯ä»¥æ”¾å¿ƒå»æœåŠ¡æ–¹åŠ è§£å¯†æœåŠ¡çš„ @DubboService æ³¨è§£ä¸­ä¿®æ”¹ä¸‹ï¼š

```java
@DubboService(timeout = 2800, methods = {@Method(
        name = "decrypt",
        timeout = 2400,
        parameters = {
                "timeout", "2000"
        })}
)
```

åœ¨ @DubboService æ³¨è§£ä¸­ï¼Œä¸º decrypt è¿›è¡ŒæœåŠ¡çº§åˆ«é…ç½® timeout = 2800ï¼Œæ–¹æ³•çº§åˆ«é…ç½® timeout = 2400ï¼Œæ–¹æ³•çº§åˆ«çš„å‚æ•°é…ç½® timeout = 2000ã€‚

æœ€ç»ˆï¼Œå†å¯åŠ¨æä¾›æ–¹å’Œæ¶ˆè´¹æ–¹ï¼Œä½ ä¼šçœ‹åˆ°æ¶ˆè´¹æ–¹çš„è¶…æ—¶å¼‚å¸¸æ—¥å¿—ä¸­æç¤ºç›®å‰çš„è¶…æ—¶æ—¶é—´ timeout = 2000ã€‚

```java
// åœ¨æä¾›æ–¹æ·»åŠ  timeout = 2800ã€timeout = 2400ã€timeout = 2000 é‡Œä¸‰ä¸ªè¶…æ—¶æ—¶é—´
// å†æ¬¡è¿è¡Œæ¶ˆè´¹æ–¹åï¼Œçœ‹åˆ°çš„å¼‚å¸¸ä¿¡æ¯å¦‚ä¸‹ï¼š
Caused by: org.apache.dubbo.remoting.TimeoutException: Waiting server-side response timeout by scan timer. start time: 2022-11-25 23:20:46.834, end time: 2022-11-25 23:20:49.053, client elapsed: 1 ms, server elapsed: 2218 ms, timeout: 2200 ms, request: Request [id=3, version=2.0.2, twoway=true, event=false, broken=false, data=RpcInvocation [methodName=decrypt, parameterTypes=[class java.lang.String], arguments=[Geek], attachments={path=com.hmilyylimh.cloud.facade.crypto.CryptoFacade, remote.application=dubbo-11-loadcfg-consumer, interface=com.hmilyylimh.cloud.facade.crypto.CryptoFacade, version=0.0.0, timeout=2200}]], channel: /192.168.100.183:64923 -> /192.168.100.183:28110
	at org.apache.dubbo.remoting.exchange.support.DefaultFuture.doReceived(DefaultFuture.java:212)
	at org.apache.dubbo.remoting.exchange.support.DefaultFuture.received(DefaultFuture.java:176)
	at org.apache.dubbo.remoting.exchange.support.DefaultFuture$TimeoutCheckTask.notifyTimeout(DefaultFuture.java:295)
	at org.apache.dubbo.remoting.exchange.support.DefaultFuture$TimeoutCheckTask.lambda$run$0(DefaultFuture.java:282)
	at org.apache.dubbo.common.threadpool.ThreadlessExecutor$RunnableWrapper.run(ThreadlessExecutor.java:184)
	at org.apache.dubbo.common.threadpool.ThreadlessExecutor.waitAndDrain(ThreadlessExecutor.java:103)
	at org.apache.dubbo.rpc.AsyncRpcResult.get(AsyncRpcResult.java:193)
	... 29 more
```

å¯¹äºè¿™æ ·çš„æµç¨‹ï¼Œå›æƒ³ä½ å†™ä»£ç é…ç½®æœåŠ¡çº§åˆ«æˆ–æ–¹æ³•çº§åˆ«çš„å‚æ•°æ—¶ï¼Œæœ‰æ²¡æœ‰ä¸€ç§ä¼¼æ›¾ç›¸è¯†çš„æ„Ÿè§‰ï¼Œæ²¡é”™ï¼Œéƒ½æ˜¯éµå¾ªç€â€œç²’åº¦è¶Šç»†ï¼Œä¼˜å…ˆçº§è¶Šé«˜â€çš„æ–¹å¼æ¥å¤„ç†çš„ã€‚

ä¸¥è°¨çš„ä½ å¯èƒ½ç–‘æƒ‘ï¼Œ@DubboService ä¸­æœ‰ä¸‰ä¸ªåœ°æ–¹ï¼ˆæœåŠ¡çº§åˆ«ã€æ–¹æ³•çº§åˆ«ã€æ–¹æ³•å‚æ•°ï¼‰å¯ä»¥æ·»åŠ è¶…æ—¶æ—¶é—´ï¼Œæ¶ˆè´¹æ–¹ @DubboReference æ³¨è§£ä¹Ÿæœ‰ä¸‰ä¸ªåœ°æ–¹å¯ä»¥é…ç½®ï¼Œè¿˜æœ‰ dubbo.propertiesã€å¯åŠ¨å‘½ä»¤-Då‚æ•°è¿™äº›åœ°æ–¹éƒ½å¯ä»¥é…ç½®ï¼Œé‚£ï¼Œ**åˆ°åº•è¯¥ä»¥è°çš„é…ç½®ä¸ºå‡†å‘¢**ï¼Ÿ

è¿™ä¸ª calculateTimeout è®¡ç®—è¶…æ—¶æ—¶é—´çš„é€»è¾‘é—®é¢˜ï¼Œå…¶å® Dubbo æ¡†æ¶æ—©å°±åŸ‹å¥½äº†ä¼ç¬”ï¼Œåœ¨ Dubbo 3.0 å¼€å‘æ‰‹å†Œ [Java -&gt; å‚è€ƒæ‰‹å†Œ -&gt; é…ç½®è¯´æ˜ -&gt; é…ç½®å·¥ä½œåŸç† -&gt; å±æ€§è¦†ç›–](https://dubbo.apache.org/zh/docs3-v2/java-sdk/reference-manual/config/principle/#32-%E5%B1%9E%E6%80%A7%E8%A6%86%E7%9B%96)ä¸ºæˆ‘ä»¬è¯¦ç»†æè¿°äº†ä¸åŒå±‚çº§é…ç½®ä¹‹é—´çš„å±æ€§è¦†ç›–å…³ç³»ï¼Œä¸ç®¡æ˜¯åœ¨æ¶ˆè´¹æ–¹ï¼Œè¿˜æ˜¯åœ¨æä¾›æ–¹ï¼Œå„è‡ªéƒ½æŒ‰ç…§è¿™æ ·çš„å±‚çº§è¦†ç›–å…³ç³»ï¼Œç„¶ååœ¨ calculateTimeout æ–¹æ³•ä¸­å°±èƒ½ä»æ¶ˆè´¹æ–¹ã€æä¾›æ–¹å–åˆ°ç²¾å‡†çš„è¶…æ—¶æ—¶é—´ã€‚

åœ¨[å®˜ç½‘è¦†ç›–å…³ç³»å›¾](https://dubbo.apache.org/imgs/blog/configuration.jpg)çš„åŸºç¡€ä¹‹ä¸Šï¼Œæˆ‘ä»¬çœ‹çœ‹å¸¸ç”¨çš„é…ç½®å†™æ³•ï¼Œå¦‚å›¾ï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/e4/1c/e47919148139eb4c4c17925yy808721c.png?wh=4716x2134)

ä¸»è¦æœ‰å››ä¸ªå±‚çº§å…³ç³»ï¼š

- System Propertiesï¼Œæœ€é«˜ä¼˜å…ˆçº§ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šåœ¨å¯åŠ¨å‘½ä»¤ä¸­é€šè¿‡ JVM çš„ -D å‚æ•°è¿›è¡ŒæŒ‡å®šï¼Œå›¾ä¸­é€šè¿‡ -D å‚æ•°ä»æŒ‡å®šçš„ç£ç›˜è·¯å¾„åŠ è½½é…ç½®ï¼Œä¹Ÿå¯ä»¥ä»å…¬å…±çš„ NAS è·¯å¾„åŠ è½½é…ç½®ã€‚
- Externalized Configurationï¼Œä¼˜å…ˆçº§æ¬¡ä¹‹ï¼Œå¤–éƒ¨åŒ–é…ç½®ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä»ç»Ÿä¸€çš„é…ç½®ä¸­å¿ƒåŠ è½½é…ç½®ï¼Œå›¾ä¸­å°±æ˜¯ä» Nacos é…ç½®ä¸­å¿ƒåŠ è½½é…ç½®ã€‚
- API / XML / æ³¨è§£ï¼Œä¼˜å…ˆçº§å†æ¬¡é™ä½ï¼Œè¿™ä¸‰ç§åº”è¯¥æ˜¯æˆ‘ä»¬å¼€å‘äººå‘˜æœ€ç†Ÿæ‚‰ä¸è¿‡çš„é…ç½®æ–¹å¼äº†ã€‚
- Local Fileï¼Œä¼˜å…ˆçº§æœ€ä½ï¼Œä¸€èˆ¬æ˜¯é¡¹ç›®ä¸­é»˜è®¤çš„ä¸€ä»½åŸºç¡€é…ç½®ï¼Œå½“ä»€ä¹ˆéƒ½ä¸é…ç½®çš„æ—¶å€™ä¼šè¯»å–ã€‚

çœ‹å®Œå››å±‚è¦†ç›–å…³ç³»ï¼Œæƒ³å¿…ä½ å·²ç»çŸ¥é“å¦‚ä½•è§£å†³è¶…æ—¶ä¸ç”Ÿæ•ˆçš„é—®é¢˜äº†ã€‚

å‚è€ƒä»Šå¤©é—®é¢˜ä¸­çš„å…·ä½“æƒ…å†µï¼Œå› ä¸ºå‡çº§äº† Dubbo ç‰ˆæœ¬ï¼Œæ¶ˆè´¹æ–¹è‡ªå·±æ²¡é…ç½®ä»»ä½•è¶…æ—¶æ—¶é—´ï¼Œæä¾›æ–¹ä½¿ç”¨äº† API æ–¹å¼è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œä½†æ˜¯æ¶ˆè´¹æ–¹å¹¶ä¸æ„ŸçŸ¥ï¼Œåè€Œæ¶ˆè´¹æ–¹æ„ŸçŸ¥çš„æ˜¯æä¾›æ–¹ @DubboService ä¸­é…ç½®çš„å†…å®¹ï¼Œé‚£å°±æ„å‘³ç€**åªè¦æä¾›æ–¹æœ‰è‡ªå·±ä¸€å¥—é»˜è®¤çš„è¶…æ—¶æ—¶é—´ï¼Œé‚£æ¶ˆè´¹æ–¹å°±ä¼šç›´æ¥ä½¿ç”¨æä¾›æ–¹çš„è¶…æ—¶æ—¶é—´è¿›è¡Œè¿œç¨‹è°ƒç”¨äº†**ã€‚

æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•åœ¨æä¾›æ–¹çš„ resources èµ„æºç›®å½•ä¸‹æ–°å¢ä¸€ä¸ª dubbo.properties æ–‡ä»¶ï¼Œé…ä¸Šé»˜è®¤çš„è¶…æ—¶æ—¶é—´ä¸º 5000 æ¯«ç§’ï¼š

```java
# åœ¨æä¾›æ–¹å·¥ç¨‹ä¸­çš„ resources/dubbo.properties å¢åŠ é»˜è®¤è¶…æ—¶æ—¶é—´
dubbo.provider.timeout=5000
```

è¿™æ ·ä¸€æ¥æä¾›æ–¹å°±æœ‰äº†è‡ªå·±é»˜è®¤çš„ä¸€å¥—è¶…æ—¶æ—¶é—´äº†ï¼Œæ¶ˆè´¹æ–¹ä¹Ÿä¸ä¼šèµ°é»˜è®¤çš„ 1000 æ¯«ç§’è¶…æ—¶é€»è¾‘äº†ã€‚

å½“ç„¶åˆšåˆšé‡‡ç”¨çš„æ˜¯ Local File ä¼˜å…ˆçº§æœ€ä½çš„æ–¹å¼è¿›è¡Œé…ç½®çš„ï¼Œä½ è¿˜å¯ä»¥é€šè¿‡å…¶ä»–ä¸‰ç§æ–¹å¼è¿›è¡Œé…ç½®ï¼Œæ€»ä¹‹ï¼Œå“ªç§ä½ ä½¿ç”¨èµ·æ¥æœ€æ–¹ä¾¿ï¼Œåˆæœ€é€‚åˆä½ ä»¬ç›®å‰é¡¹ç›®çš„ç´§æ€¥è¯‰æ±‚ï¼Œé…ç½®å“ªç§å°±è¡Œäº†ã€‚

### å¯ç–‘ç‚¹äºŒ

è™½ç„¶è¿™ä¸ªé—®é¢˜æš‚æ—¶è§£å†³äº†ï¼Œä½†å¯ç–‘ç‚¹äºŒæˆ‘ä»¬è¿˜ä¸çŸ¥é“åŸå› ï¼Œä¸ºä»€ä¹ˆä½¿ç”¨çš„æ˜¯æ–°ç‰ˆæœ¬çš„æœåŠ¡å‘ç°ç±»è¿›è¡Œè¿œç¨‹è°ƒç”¨å‘¢ï¼Ÿ

è¿˜è®°å¾—æˆ‘ä»¬åœ¨â€œ[æ¸©æ•…çŸ¥æ–°](https://time.geekbang.org/column/article/611355)â€ä¸­åœ¨æä¾›æ–¹å’Œæ¶ˆè´¹æ–¹ä¸­éƒ½æåˆ°è¿‡ä¸€ä¸ªæ¦‚å¿µå—ï¼Œåº”ç”¨çº§æ³¨å†Œå’Œæ¥å£çº§æ³¨å†Œã€‚æä¾›æ–¹è¿™è¾¹é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸ä½†ä¼šè¿›è¡Œåº”ç”¨çº§æ³¨å†Œï¼Œè¿˜ä¼šè¿›è¡Œæ¥å£çº§æ³¨å†Œï¼›è€Œåœ¨æ¶ˆè´¹æ–¹è¿™è¾¹ï¼Œæœ‰ä¸ªæ™ºèƒ½å†³ç­–çš„å…¼å®¹è¿‡åº¦æ–¹æ¡ˆï¼Œä¼˜å…ˆä½¿ç”¨åº”ç”¨çº§æ³¨å†Œä¿¡æ¯ã€‚

æ‰€ä»¥ï¼Œå¯ç–‘ç‚¹äºŒè¿™ä¸ªé—®é¢˜ï¼Œä¼°è®¡å°±æ˜¯å› ä¸ºæä¾›æ–¹èµ°è¿›äº†é»˜è®¤çš„æ³¨å†ŒæœåŠ¡ç­–ç•¥ï¼Œæ¶ˆè´¹æ–¹é‚£è¾¹åˆæ°å¥½é‡‡ç”¨çš„æ˜¯æ™ºèƒ½å†³ç­–ç­–ç•¥ï¼Œå°±å˜æˆä½¿ç”¨æ–°ç‰ˆæœ¬æœåŠ¡å‘ç°ç±»è¿›è¡Œè¿œç¨‹è°ƒç”¨äº†ã€‚

è¯´åˆ°è¿™ï¼Œæƒ³å¿…ä½ å·²ç»æƒ³åˆ°å¦‚ä½•åº”å¯¹äº†ã€‚æˆ‘ä»¬å¯ä»¥åœ¨æ¶ˆè´¹æ–¹è®¾ç½®åªè®¢é˜…æ¥å£çº§æ³¨å†Œï¼š

```java
# åœ¨æ¶ˆè´¹æ–¹å·¥ç¨‹ä¸­çš„ resources/dubbo.properties å¢åŠ åªè®¢é˜…æ¥å£çº§æ³¨å†Œ
dubbo.application.service-discovery.migration=FORCE_INTERFACE
```

ä¹Ÿå¯ä»¥åœ¨æä¾›æ–¹è®¾ç½®åªè¿›è¡Œæ¥å£çº§æ³¨å†Œï¼š

```java
# åœ¨æä¾›æ–¹å·¥ç¨‹ä¸­çš„ resources/dubbo.properties å¢åŠ åªè¿›è¡Œæ¥å£çº§æ³¨å†Œ
dubbo.application.register-mode=interface
```

è¿™æ ·ä¸€æ¥ï¼Œè™½ç„¶å‡çº§åˆ°äº† Dubbo3 ç‰ˆæœ¬ï¼Œä½†å…¶å®è¿˜æ˜¯èµ°ç€ Dubbo2 æ—§çš„åˆ†æ”¯é€»è¾‘ï¼Œè¿™ä¹Ÿä¾§é¢ä½è¯äº† Dubbo3 å¯¹ Dubbo2 çš„å‘ä¸‹å…¼å®¹å‹å¥½ç‰¹æ€§ã€‚

## ä¸åŒå±‚çº§é…ç½®çš„é€‚ç”¨åœºæ™¯

ä» Dubbo æ¡†æ¶çš„å››å±‚å±æ€§è¦†ç›–å…³ç³»å¯ä»¥çœ‹å‡ºï¼Œä¸€ä¸ªç®€å•çš„é…ç½®å±…ç„¶æœ‰å¦‚æ­¤ä¹‹å¤šçš„é…ç½®æ¥æºï¼Œé‚£å®ƒä»¬çš„åº”ç”¨åœºæ™¯æœ‰ä»€ä¹ˆåŒºåˆ«ä¹ˆï¼Ÿ

System Propertiesï¼Œä¸€èˆ¬æ˜¯å›ºå®šä¸èƒ½è¢«è¦†ç›–çš„å‚æ•°ï¼Œè¿™äº›å‚æ•°åŸºæœ¬ä¸Šä¸ä¼šå˜åŒ–ï¼Œç”±è¿ç»´äººå‘˜æŒ‰ç…§å…¬å¸çš„æ ‡å‡†åŒ– JVM å¯åŠ¨å‚æ•°ç»Ÿä¸€æ§åˆ¶åº”ç”¨ã€‚

Externalized Configurationï¼Œä¸€èˆ¬æ˜¯ååº”ç”¨ç³»ç»Ÿå±‚é¢çš„å…¬å…±å‚æ•°ï¼Œå¯ä»¥ä»å…¬å…±çš„é…ç½®ä¸­å¿ƒè¯»å–ï¼Œè¿™äº›å‚æ•°å¾ˆå¤§ç¨‹åº¦ä¸Šä¹Ÿä¸ä¼šç»å¸¸å˜åŒ–ï¼Œä¸€æ—¦é‡åˆ°çªå‘æƒ…å†µæˆ–æƒ³ç»Ÿä¸€ä¿®æ”¹å…¬å…±å‚æ•°ï¼Œå¯ä»¥åœ¨ä¸æ”¹ä»£ç çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡é‡å¯æˆ–åŠ¨æ€åŠ è½½æœ€æ–°é…ç½®ã€‚

API / XML / æ³¨è§£ï¼Œè¿™ç§å±äºå¼€å‘å±‚é¢æ¯”è¾ƒä¸ªæ€§åŒ–çš„é…ç½®æ–¹å¼äº†ï¼Œä¸»è¦æ˜¯å› ä¸ºå®é™…å¼€å‘çš„é¡¹ç›®ä¸­ï¼Œä¸åŒçš„åŠŸèƒ½ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µåˆç†é…ç½®ä¸åŒçš„å‚æ•°ã€‚

Local Fileï¼Œè¿™ç§å±äºå…œåº•çº§åˆ«äº†ï¼Œå¦‚æœå…¶ä»–å±‚çº§éƒ½æ²¡æœ‰é…ç½®çš„è¯ï¼Œè‡³å°‘è¿˜æœ‰ä¸ªå½“å‰ç³»ç»Ÿå…¨å±€é»˜è®¤çš„å…œåº•é…ç½®ã€‚

## æ€»ç»“

ä»Šå¤©ï¼Œä»ç³»ç»Ÿè·¨è¶Šç‰ˆæœ¬å‡çº§è€Œå¼•å‘çš„è¶…æ—¶æ—¶é—´å¤±æ•ˆçš„é—®é¢˜å¼€å§‹ï¼Œæˆ‘ä»¬é’ˆå¯¹ä»£ç çš„ä¸‰ä¸ªç°çŠ¶ï¼Œå¼€å¯äº† Debug è°ƒè¯•åˆ†æä¹‹æ—…ï¼Œç®€å•å‡ æ­¥è°ƒè¯•ä¹‹åï¼Œæ‰¾åˆ°äº† timeout æ— æ³•è·å–é¢„æœŸå€¼çš„æºå¤´ï¼ŒåŒæ—¶ä¹Ÿå‘ç°äº†ç ´è§£é—®é¢˜çš„ä¸¤ä¸ªå…³é”®å¯ç–‘ç‚¹ï¼š

- ä»å¯ç–‘ç‚¹ä¸€ä¸­ï¼Œä»”ç»†ç ”è¯»è®¡ç®—è¶…æ—¶æ—¶é—´çš„æ–¹æ³•ï¼ŒæŒ–æ˜å‡ºäº† Dubbo é…ç½®çš„å››å±‚è¦†ç›–å…³ç³»ï¼Œæœ€ç»ˆæˆ‘ä»¬å·§å¦™åˆ©ç”¨ä¸åŒå±‚çº§çš„ç‰¹æ€§ï¼Œè§£å†³äº†è¶…æ—¶æ—¶é—´å¤±æ•ˆçš„é—®é¢˜ã€‚
- ä»å¯ç–‘ç‚¹äºŒä¸­ï¼Œå‘ç°ç±»åä½¿ç”¨äº†æ–°ç‰ˆæœ¬çš„æœåŠ¡å‘ç°ç±»è¿›è¡Œè¿œç¨‹è°ƒç”¨ï¼Œè”æƒ³åˆ°äº†åº”ç”¨çº§æ³¨å†Œå’Œæ¥å£çº§æ³¨å†Œçš„å› ç´ ï¼Œæœ€ç»ˆä¹Ÿæ‰¾åˆ°äº†è§£å†³è¶…æ—¶æ—¶é—´å¤±æ•ˆçš„æ–¹æ¡ˆã€‚

æ¶ˆè´¹æ–¹åœ¨å‘èµ·è¿œç¨‹è°ƒç”¨æ—¶ï¼Œè¶…æ—¶æ—¶é—´çš„å–å€¼é€»è¾‘è¦è®°ç‰¢ï¼š

- é¦–å…ˆï¼Œæ•´ä½“åˆ†ä¸ºä¸‰å¤§å—ï¼Œåˆ†åˆ«ä¸ºæ–¹æ³•çº§åˆ«ã€æœåŠ¡çº§åˆ«ã€å®ä¾‹çº§åˆ«ã€‚
- ç„¶åï¼Œåœ¨æ¯ä¸€å—çš„å†…éƒ¨ï¼ŒæŒ‰ç…§å…ˆæ¶ˆè´¹æ–¹åæä¾›æ–¹çš„çš„é¡ºåºè¿›è¡Œå–å€¼ã€‚  
  Dubbo é…ç½®çš„å››å±‚è¦†ç›–å…³ç³»ï¼Œä¼˜å…ˆçº§ä»é«˜åˆ°ä½ä¾æ¬¡ä¸ºï¼šSystem Propertiesã€Externalized Configurationã€API / XML / æ³¨è§£ã€Local Fileã€‚

æœ€åå¦‚æœæä¾›æ–¹å’Œæ¶ˆè´¹æ–¹æŒ‰ç…§æ¥å£çº§æ³¨å†Œä½¿ç”¨ï¼Œæä¾›æ–¹æŒ‡å®šæ³¨å†Œæ¨¡å¼ï¼ˆdubbo.application.register-modeï¼‰ä¸ºæ¥å£çº§ï¼ˆinterfaceï¼‰ï¼Œæ¶ˆè´¹æ–¹æœåŠ¡å‘ç°è¿ç§»æ¨¡å¼ï¼ˆdubbo.application.service-discovery.migrationï¼‰ä¸ºæ¥å£çº§ï¼ˆFORCE\_INTERFACEï¼‰ã€‚

### æ€è€ƒé¢˜

ç•™ä¸ªä½œä¸šç»™ä½ ï¼Œåœ¨å·¥ä½œä¸­ï¼Œä½ ä¼šéœ€è¦ä½¿ç”¨å¤–éƒ¨é…ç½®ä¸­å¿ƒæ¥å­˜å‚¨é…ç½®ï¼Œåœ¨ Nacos ä¸­å¾ˆå¯èƒ½ä¼šå‡ºç°è¿™æ ·çš„æŠ¥é”™åœºæ™¯ï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/79/8f/791ffd5a0532106f2f3fde33f137e48f.jpg?wh=1920x930)

å†æ¬¡æ–°å»ºä¸€æ¡è®°å½•ï¼Œå†…å®¹ä¸º dataId = dubbo.propertiesï¼Œgroup = dubboï¼Œæ·»åŠ å®Œå†ç‚¹å‡»æäº¤å°±æŠ¥é”™äº†ï¼Œä½ çŸ¥é“è¿™æ˜¯ä¸ºä»€ä¹ˆå—ï¼Ÿ

å…¬å¸é‡Œé¢é‚£ä¹ˆå¤šåº”ç”¨ç³»ç»Ÿï¼Œå¦‚æœæŒ‰ç…§å›¾ä¸­è¿™æ ·é…ç½®æ‰€æœ‰åº”ç”¨éƒ½ä½¿ç”¨åŒä¸€ä»½ dubbo.properties å±æ€§å†…å®¹ï¼Œæœªå…æœ‰ç‚¹ç³Ÿç³•ï¼Œè¯¥æ€ä¹ˆéµå¾ª Nacos çš„è§„èŒƒæ­£ç¡®å¡«å†™ &lt;dubbo:config-center/&gt; æ ‡ç­¾é‡Œé¢çš„å†…å®¹å‘¢ï¼Ÿ

æ¬¢è¿åœ¨ç•™è¨€åŒºåˆ†äº«ä½ çš„æ€è€ƒå’Œå­¦ä¹ å¿ƒå¾—ã€‚æˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ã€‚

### 10æ€è€ƒé¢˜å‚è€ƒ

ä¸Šä¸€æœŸç•™äº†ä¸€ä¸ªä½œä¸šï¼ŒTokenFilterã€ConsumerSignFilterã€ProviderAuthFilter è¿™ä¸‰ä¸ªè¿‡æ»¤å™¨æ˜¯å¹²ä»€ä¹ˆç”¨çš„ï¼Œä»¥åŠå¦‚ä½•åº”ç”¨ï¼Ÿ

é¦–å…ˆè¿›å…¥ TokenFilter çš„æºç åº•å±‚çœ‹çœ‹ï¼š

```java
/**
 * Perform check whether given provider token is matching with remote token or not. If it does not match
 * it will not allow invoking remote method.
 *
 * @see Filter
 */
@Activate(group = CommonConstants.PROVIDER, value = TOKEN_KEY)
public class TokenFilter implements Filter {
    @Override
    public Result invoke(Invoker<?> invoker, Invocation inv)
            throws RpcException {
        // å‚æ•°ä¸€ï¼šå¯ä»¥è®¾ç½® token å‚æ•°
        String token = invoker.getUrl().getParameter("token");
        // å¦‚æœè®¾ç½®æœ‰å€¼ï¼Œé‚£ä¹ˆå°±ç›´æ¥å’Œæ¥æ”¶çš„ token ä¸¤ä¸¤åšæ¯”è¾ƒ
        if (ConfigUtils.isNotEmpty(token)) {
            Class<?> serviceType = invoker.getInterface();
            Map<String, Object> attachments = inv.getObjectAttachments();            
            // ä»æ¥æ”¶çš„å‚æ•°ä¸­è·å–æ¶ˆè´¹æ–¹å‘æ¥çš„ token å€¼
            String remoteToken = (attachments == null ? null : (String) attachments.get("token"));
            if (!token.equals(remoteToken)) {
                // å¦‚æœæ¯”å¯¹ä¸ä¸€è‡´çš„è¯ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸
                throw new RpcException("Invalid token! Forbid invoke remote service " + serviceType + " method " + inv.getMethodName() +
                        "() from consumer " + RpcContext.getServiceContext().getRemoteHost() + " to provider " +
                        RpcContext.getServiceContext().getLocalHost()+ ", consumer incorrect token is " + remoteToken);
            }
        }
        return invoker.invoke(inv);
    }
}
```

é˜…è¯» TokenFilter æºç ï¼Œå¯ä»¥å¾—å‡º 2 ç‚¹ä¿¡æ¯ï¼š

1. TokenFilter åªä½œç”¨åœ¨æä¾›æ–¹ã€‚
2. æä¾›æ–¹å¯ä»¥é€šè¿‡å‚æ•° token æ¥é…ç½®å€¼ï¼Œå¦‚æœæ¶ˆè´¹æ–¹æ²¡ä¼  tokenï¼Œæˆ–è€…æ¶ˆè´¹æ–¹ä¼ é”™äº† tokenï¼Œæœ€ç»ˆéƒ½ä¼šå¯¼è‡´æä¾›æ–¹è¿™è¾¹æ ¡éªŒä¸é€šè¿‡ï¼Œä¸€æ—¦ä¸é€šè¿‡å°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚

ä¸éš¾çœ‹å‡ºï¼Œå…¶å® TokenFilter å°±æ˜¯æ¥åšé‰´å®šçœŸå‡çš„ï¼Œå’Œæˆ‘ä»¬ä¹‹å‰å†™çš„ ProviderTokenFilter æ€è·¯éå¸¸ç›¸ä¼¼ã€‚

ç„¶åè¿›å…¥ ConsumerSignFilter çš„æºç åº•å±‚çœ‹çœ‹ï¼š

```java
@Activate(group = CommonConstants.CONSUMER, value = Constants.SERVICE_AUTH, order = -10000)
public class ConsumerSignFilter implements Filter {
    private ApplicationModel applicationModel;
    public ConsumerSignFilter(ApplicationModel applicationModel) {
        this.applicationModel = applicationModel;
    }
    @Override
    public Result invoke(Invoker<?> invoker, Invocation invocation) throws RpcException {
        URL url = invoker.getUrl();
        // å‚æ•°ä¸€ï¼šå¯ä»¥è®¾ç½® auth å‚æ•°ï¼Œçœ‹çœ‹è¦ä¸è¦å¼€å¯è®¤è¯åŠŸèƒ½
        boolean shouldAuth = url.getParameter("auth", false);
        if (shouldAuth) {
            // å¦‚æœå¼€å¯äº†è®¤è¯åŠŸèƒ½çš„è¯ï¼Œé‚£ä¹ˆå°±ç›´æ¥å°†è¯·æ±‚å‚æ•°è¿›è¡ŒåŠ ç­¾
            // ç„¶åæ”¾åˆ° invocation ä¸­çš„ attachments ä¸­ï¼Œé¡ºè·¯ä¼ åˆ°æä¾›æ–¹å»
            Authenticator authenticator = applicationModel.getExtensionLoader(Authenticator.class)
              .getExtension(url.getParameter("authenticator", "accesskey"));
            // é€šè¿‡ url è·å–çš„é»˜è®¤æ‰©å±•ç‚¹è¿›è¡ŒåŠ ç­¾æ“ä½œ
            // å½“ç„¶æ—¢ç„¶æ˜¯ä» url è·å–çš„æ‰©å±•ç‚¹ï¼Œé‚£ä¹ˆå°±æä¾›äº†è‡ªå®šä¹‰çš„æ‰©å±•å£å­
            authenticator.sign(invocation, url);
        }
        return invoker.invoke(invocation);
    }
}
```

å¯ä»¥å¾—å‡º 3 ç‚¹ä¿¡æ¯ï¼š

1. ConsumerSignFilter åªä½œç”¨åœ¨æ¶ˆè´¹æ–¹ã€‚
2. æœ‰ä¸ª auth å‚æ•°æ¥å†³å®šæ˜¯å¦å¼€å¯åŠ ç­¾æ“ä½œï¼Œå¦‚æœå¼€å¯äº†é‚£å°±è¿›è¡ŒåŠ ç­¾ï¼Œå¹¶æŠŠåŠ ç­¾åçš„å€¼é¡ºé“ä¼ ç»™æä¾›æ–¹ã€‚
3. åŠ ç­¾çš„æ ¸å¿ƒé€»è¾‘æ˜¯å¯ä»¥æ‰©å±•çš„ï¼Œé€šè¿‡è®¾ç½® authenticator = xxx å°±å¯ä»¥å®ç°è‡ªå®šä¹‰åŠ ç­¾é€»è¾‘ã€‚

ConsumerSignFilter å°±æ˜¯æ¥åšåŠ ç­¾æ“ä½œçš„ï¼Œå’Œæˆ‘ä»¬ä¹‹å‰å†™çš„ ConsumerAddSignFilter æ€è·¯éå¸¸ç›¸ä¼¼ã€‚

æœ€åè¿›å…¥ ProviderAuthFilter çš„æºç åº•å±‚çœ‹çœ‹ï¼š

```java
@Activate(group = CommonConstants.PROVIDER, order = -10000)
public class ProviderAuthFilter implements Filter {
    private ApplicationModel applicationModel;
    public ProviderAuthFilter(ApplicationModel applicationModel) {
        this.applicationModel = applicationModel;
    }
    @Override
    public Result invoke(Invoker<?> invoker, Invocation invocation) throws RpcException {
        URL url = invoker.getUrl();
        // å‚æ•°ä¸€ï¼šå¯ä»¥è®¾ç½® auth å‚æ•°ï¼Œçœ‹çœ‹è¦ä¸è¦å¼€å¯è®¤è¯åŠŸèƒ½
        boolean shouldAuth = url.getParameter("auth", false);
        if (shouldAuth) {
            // å¦‚æœå¼€å¯äº†è®¤è¯åŠŸèƒ½çš„è¯ï¼Œé‚£ä¹ˆå°±ç›´æ¥è¿›è¡ŒéªŒç­¾æ“ä½œ
            Authenticator authenticator = applicationModel.getExtensionLoader(Authenticator.class)
              .getExtension(url.getParameter("authenticator", "accesskey"));
            try {
                // é€šè¿‡ url è·å–çš„é»˜è®¤æ‰©å±•ç‚¹è¿›è¡ŒéªŒç­¾æ“ä½œ
                // å½“ç„¶æ—¢ç„¶æ˜¯ä» url è·å–çš„æ‰©å±•ç‚¹ï¼Œé‚£ä¹ˆå°±æä¾›äº†è‡ªå®šä¹‰çš„æ‰©å±•å£å­
                authenticator.authenticate(invocation, url);
            } catch (Exception e) {
                return AsyncRpcResult.newDefaultAsyncResult(e, invocation);
            }
        }
        return invoker.invoke(invocation);
    }
}
```

å¯ä»¥å¾—å‡º 3 ç‚¹ä¿¡æ¯ï¼š

1. ProviderAuthFilter åªä½œç”¨åœ¨æä¾›æ–¹ã€‚
2. ä¹Ÿæœ‰ä¸ª auth å‚æ•°æ¥å†³å®šè¦ä¸è¦å¼€å¯éªŒç­¾æ“ä½œï¼Œå¦‚æœå¼€å¯äº†é‚£ä¹ˆè¿›è¡ŒéªŒç­¾ï¼ŒéªŒç­¾ä¸é€šè¿‡çš„è¯åˆ™ä¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚
3. éªŒç­¾æ ¸å¿ƒé€»è¾‘ä¹Ÿæ˜¯å¯ä»¥æ”¯æŒæ‰©å±•çš„ï¼Œé€šè¿‡è®¾ç½® authenticator = xxx å°±å¯ä»¥å®ç°è‡ªå®šä¹‰éªŒç­¾é€»è¾‘ã€‚

æˆ‘ä»¬ä¹Ÿä¸éš¾å¾—å‡ºï¼ŒConsumerSignFilterã€ProviderAuthFilter ä¸¤ä¸ªæ˜¯æˆå¯¹å­˜åœ¨çš„ï¼Œå‰è€…è´Ÿè´£åŠ ç­¾ï¼Œåè€…è´Ÿè´£éªŒç­¾ï¼Œå’Œæˆ‘ä»¬ä¹‹å‰å†™çš„ ConsumerAddSignFilterã€ProviderVerifySignFilter æ€è·¯ä¹Ÿéå¸¸ç›¸ä¼¼ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ11ï¼‰</strong></div><ul>
<li><span>javaxu</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æƒ³é—®ä¸‹å¦‚ä½•ç»“åˆnacos åŠ¨æ€ä¿®æ”¹è¶…æ—¶æ—¶é—´å‘¢ï¼Ÿ</p>2023-06-09</li><br/><li><span>é£é£</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼Œæ¯”å¦‚å®¢æˆ·ç«¯ï¼ŒæœåŠ¡ç«¯ éƒ½é…ç½®äº† timeout è¿™ä¸ªå±æ€§ï¼Œé‚£è¿™ä¸ªä»¥å“ªä¸ªä¸ºå‡†ï¼Œèƒ½å±•å¼€è®²è®²è¿™ç±»åœ¨å®¢æˆ·ç«¯ã€æœåŠ¡ç«¯éƒ½é…ç½®äº†å±æ€§çš„è¦†ç›–è§„åˆ™å—ï¼Ÿ</p>2023-05-26</li><br/><li><span>å¼ ä¸‰ä¸°</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼Œä¸‹è¾¹è¿™å¥è¯å¯¹æ„æ€å°±æ˜¯dubbo3.0åªèƒ½è¯†åˆ«æ³¨è§£ä¸Šçš„é…ç½®ï¼Ÿ ä¸è¯†åˆ«apiçš„é…ç½®ï¼Ÿ


å‚è€ƒä»Šå¤©é—®é¢˜ä¸­çš„å…·ä½“æƒ…å†µï¼Œå› ä¸ºå‡çº§äº† Dubbo ç‰ˆæœ¬ï¼Œæ¶ˆè´¹æ–¹è‡ªå·±æ²¡é…ç½®ä»»ä½•è¶…æ—¶æ—¶é—´ï¼Œæä¾›æ–¹ä½¿ç”¨äº† API æ–¹å¼è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œä½†æ˜¯æ¶ˆè´¹æ–¹å¹¶ä¸æ„ŸçŸ¥ï¼Œåè€Œæ¶ˆè´¹æ–¹æ„ŸçŸ¥çš„æ˜¯æä¾›æ–¹ @DubboService ä¸­é…ç½®çš„å†…å®¹ã€‚</p>2023-03-21</li><br/><li><span>å¤å¸†</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æƒ³é—®ä¸€ä¸‹ä½œè€…ï¼ŒåŠ å…¥æˆ‘å¸Œæœ›åœ¨dubboçš„æ‰©å±•ç‚¹filteré‡Œé¢å»åŠ¨æ€çš„ä¿®æ”¹å½“å‰è¯·æ±‚æœåŠ¡çš„è¶…æ—¶æ—¶é—´åº”è¯¥æ€ä¹ˆåšå‘¢</p>2023-03-20</li><br/><li><span>å¾æœ‰é±¼</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ä¸ºä»€ä¹ˆæä¾›æ–¹Local Fileæ–¹å¼çš„é…ç½®èƒ½è¢«æ¶ˆè´¹æ–¹æ‹¿åˆ°ï¼Œè€Œæä¾›æ–¹APIæ–¹å¼è®¾ç½®çš„è¶…æ—¶æ—¶é—´æ¶ˆè´¹æ–¹å¹¶ä¸æ„ŸçŸ¥ï¼Ÿä¼˜å…ˆçº§ä¸ä¹Ÿæ˜¯APIæ–¹å¼å¤§äºLocal Fileæ–¹å¼å—ï¼Ÿ</p>2023-03-13</li><br/><li><span>æ¨è€å¸ˆ</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼Œæ¶ˆè´¹æ–¹ä¸ºä»€ä¹ˆæ„ŸçŸ¥ä¸åˆ°æä¾›æ–¹ä»¥ API æ–¹å¼è®¾ç½®çš„è¶…æ—¶æ—¶é—´ï¼Œæä¾›æ–¹å°†è¿™äº›ä¿¡æ¯ä¹Ÿå†™åˆ°æ³¨å†Œä¸­å¿ƒäº†å‘€ã€‚

å¸Œæœ›è€å¸ˆå¸®å¿™è§£ç­”ä¸‹</p>2023-03-03</li><br/><li><span>Geek_5a425f</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>å¦‚æœåŒæ–¹éƒ½ä¸é…ï¼Œé‚£é»˜è®¤æ˜¯ä½¿ç”¨æ¶ˆè´¹æ–¹çš„é»˜è®¤è¶…æ—¶æ—¶é—´1000msï¼Œä¹Ÿå°±æ˜¯case ä¸­1S è¶…æ—¶ã€‚</p>2023-02-10</li><br/><li><span>Geek_5a425f</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ã€éƒ½æ˜¯éµå¾ªç€â€œç²’åº¦è¶Šç»†ï¼Œä¼˜å…ˆçº§è¶Šé«˜â€çš„æ–¹å¼æ¥å¤„ç†çš„ã€‚ã€
ã€å…ˆå–æ–¹æ³•çº§åˆ«çš„å‚æ•°ï¼Œå†å–æœåŠ¡çº§åˆ«çš„å‚æ•°ï¼Œæœ€åå–å®ä¾‹çº§åˆ«çš„å‚æ•°ã€‘
è€æ˜¯ï¼Œæˆ‘ç†è§£åº”è¯¥å®ä¾‹çº§åˆ«çš„å‚æ•°ä¼˜å…ˆçº§æœ€é«˜ï¼Œè¿™ä¸ªç†è§£æœ‰é—®é¢˜å—ï¼Ÿ</p>2023-02-10</li><br/><li><span>é˜¿æ˜•</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æ€è€ƒé¢˜ï¼Œnacosçš„é…ç½®çº§åˆ«ä¾æ¬¡ä¸ºï¼šnamespace-&gt;data group-&gt;data idï¼ŒåŒä¸€ä¸ªnamespaceä¸‹çš„group+dataIdä¸èƒ½é‡å¤ï¼›dubboçš„é…ç½®ä»namspaceã€groupä¸¤ä¸ªç»´åº¦è¿›è¡Œæ‹†åˆ†ï¼Œåœ¨ä½¿ç”¨ä¸Šæ›´ç¬¦åˆæœåŠ¡é…ç½®çš„é¢„æœŸ</p>2023-01-28</li><br/><li><span>y</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼Œæ¶ˆè´¹æ–¹å¹¶ä¸æ„ŸçŸ¥æä¾›æ–¹ä»¥ API æ–¹å¼è®¾ç½®çš„è¶…æ—¶æ—¶é—´ï¼Œè¿™ä¸ªæ˜¯ dubbo æœ¬èº«çš„é™åˆ¶ä¹ˆï¼Œå¯¹ dubbo ä¸æ˜¯å¾ˆç†Ÿæ‚‰ã€‚</p>2023-01-14</li><br/><li><span>ç†Šæ‚Ÿç©ºçš„å‡¶</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>å…ˆä¸ç®¡nacosï¼Œè·Ÿä»£ç åˆ°config-center é‡Œé¢ï¼Œgroupã€namespaceã€cluster  åº”è¯¥å¯ä»¥æ‹¿è¿™äº›åŒºåˆ†ï¼›
nacos ä¹Ÿåº”è¯¥æ‹¿dataId,groupç­‰åšäº†é…ç½®ä¸­å¿ƒå”¯ä¸€æ€§æ ¡éªŒã€‚å¯¼è‡´é‡å¤çš„é…ç½®</p>2023-01-11</li><br/>
</ul>