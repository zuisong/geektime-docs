ä½ å¥½ï¼Œæˆ‘æ˜¯é»„ç”³ã€‚

å‰ä¸¤èŠ‚ï¼Œæˆ‘è®²äº†å‘é‡ç©ºé—´æ¨¡å‹ï¼Œä»¥åŠå¦‚ä½•åœ¨ä¿¡æ¯æ£€ç´¢é¢†åŸŸä¸­è¿ç”¨å‘é‡ç©ºé—´æ¨¡å‹ã€‚å‘é‡ç©ºé—´æ¨¡å‹æä¾›äº†è¡¡é‡å‘é‡ä¹‹é—´çš„è·ç¦»æˆ–è€…ç›¸ä¼¼åº¦çš„æœºåˆ¶ï¼Œè€Œè¿™ç§æœºåˆ¶å¯ä»¥è¡¡é‡æŸ¥è¯¢å’Œè¢«æŸ¥è¯¢æ•°æ®ä¹‹é—´çš„ç›¸ä¼¼ç¨‹åº¦ï¼Œè€Œå¯¹äºæ–‡æœ¬æ£€ç´¢æ¥è¯´ï¼ŒæŸ¥è¯¢å’Œæ–‡æ¡£ä¹‹é—´çš„ç›¸ä¼¼ç¨‹åº¦å¯ä½œä¸ºæ–‡æ¡£çš„ç›¸å…³æ€§ã€‚

å®é™…ä¸Šï¼Œé™¤äº†æ–‡æ¡£çš„ç›¸å…³æ€§ï¼Œè·ç¦»æˆ–è€…ç›¸ä¼¼åº¦è¿˜å¯ä»¥ç”¨åœ¨æœºå™¨å­¦ä¹ çš„ç®—æ³•ä¸­ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥èŠèŠå¦‚ä½•åœ¨èšç±»ç®—æ³•ä¸­ä½¿ç”¨å‘é‡ç©ºé—´æ¨¡å‹ï¼Œå¹¶æœ€ç»ˆå®ç°è¿‡æ»¤é‡å¤æ–‡ç« ã€‚

## èšç±»ç®—æ³•

åœ¨æ¦‚ç‡ç»Ÿè®¡æ¨¡å—ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†åˆ†ç±»ï¼ˆClassification/Categorizationï¼‰å’Œå›å½’ï¼ˆRegressionï¼‰è¿™ä¸¤ç§ç›‘ç£å¼å­¦ä¹ ï¼ˆSupervised Learningï¼‰ã€‚ç›‘ç£å¼å­¦ä¹ é€šè¿‡è®­ç»ƒèµ„æ–™å­¦ä¹ å¹¶å»ºç«‹ä¸€ä¸ªæ¨¡å‹ï¼Œå¹¶ä¾æ­¤æ¨¡å‹å¯¹æ–°çš„å®ä¾‹è¿›è¡Œé¢„æµ‹ã€‚

ä¸è¿‡ï¼Œåœ¨å®é™…åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸ä¼šé‡åˆ°å¦ä¸€ç§æ›´ä¸ºå¤æ‚çš„æƒ…å†µã€‚è¿™æ—¶å€™ä¸å­˜åœ¨ä»»ä½•å…³äºæ ·æœ¬çš„å…ˆéªŒçŸ¥è¯†ï¼Œè€Œæ˜¯éœ€è¦æœºå™¨åœ¨æ²¡äººæŒ‡å¯¼çš„æƒ…å½¢ä¸‹ï¼Œå»å°†å¾ˆå¤šä¸œè¥¿è¿›è¡Œå½’ç±»ã€‚ç”±äºç¼ºä¹è®­ç»ƒæ ·æœ¬ï¼Œè¿™ç§å­¦ä¹ è¢«ç§°ä¸ºâ€œéç›‘ç£å­¦ä¹ â€ï¼ˆUnsupervised Learningï¼‰ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„èšç±»ï¼ˆClusteringï¼‰ã€‚åœ¨è¿™ç§å­¦ä¹ ä½“ç³»ä¸­ï¼Œç³»ç»Ÿå¿…é¡»é€šè¿‡ä¸€ç§æœ‰æ•ˆçš„æ–¹æ³•å‘ç°æ ·æœ¬çš„å†…åœ¨ç›¸ä¼¼æ€§ï¼Œå¹¶æŠŠæ•°æ®å¯¹è±¡ä»¥ç¾¤ç»„ï¼ˆClusterï¼‰çš„å½¢å¼è¿›è¡Œåˆ’åˆ†ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ13ï¼‰</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg" width="30px"><span>mickey</span> ğŸ‘ï¼ˆ7ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div># encoding=utf-8
from sklearn.feature_extraction.text import CountVectorizer

#æ¨¡æ‹Ÿæ–‡æ¡£é›†åˆ
corpus = [&#39;I like great basketball game&#39;,
          &#39;This video game is the best action game I have ever played&#39;,
          &#39;I really really like basketball&#39;,
          &#39;How about this movie? Is the plot great?&#39;,
          &#39;Do you like RPG game?&#39;,
          &#39;You can try this FPS game&#39;,
          &#39;The movie is really great, so great! I enjoy the plot&#39;]

#æŠŠæ–‡æœ¬ä¸­çš„è¯è¯­è½¬æ¢ä¸ºè¯å…¸å’Œç›¸åº”çš„å‘é‡
vectorizer = CountVectorizer()
vectors = vectorizer.fit_transform(corpus)

from sklearn.feature_extraction.text import TfidfTransformer

#æ„å»ºtfidfçš„å€¼
transformer = TfidfTransformer()
tfidf = transformer.fit_transform(vectorizer.fit_transform(corpus))

# è¾“å‡ºæ¯ä¸ªæ–‡æ¡£çš„å‘é‡
tfidf_array = tfidf.toarray()
words = vectorizer.get_feature_names()

from Bio.Cluster import kcluster

#è¿›è¡Œèšç±»ï¼Œä½¿ç”¨å‘é‡é—´çš„å¤¹è§’ä½™å¼¦ä½œä¸ºç›¸ä¼¼åº¦çš„åº¦é‡
clusterid, error, nfound  = kcluster(tfidf_array, nclusters=3, dist=&#39;u&#39;)
print(clusterid)
&#39;&#39;&#39;
Kmeans çš„æ¬§å¼è·ç¦»:[0 2 0 1 2 2 1]
Bio çš„å¤¹è§’ä½™å¼¦:[2 0 0 2 0 2 1]
&#39;&#39;&#39;</div>2019-03-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/4e/c7/8c2d0a3d.jpg" width="30px"><span>ä½™æ³½é”‹</span> ğŸ‘ï¼ˆ6ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>è¯·é—®ä¸€ä¸‹è€å¸ˆï¼Œä½™å¼¦å¤¹è§’æœ¬è´¨ä¸Šå¯ä»¥è¯´æ˜¯å½’ä¸€åŒ–çš„æ¬§å¼è·ç¦»ä¹ˆï¼Ÿ</div>2019-04-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/91/00/2007d2f3.jpg" width="30px"><span>zhengfan</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>é»„è€å¸ˆæ‚¨å¥½ã€‚
æ‚¨åœ¨kå‡å€¼ç®—æ³•ä»‹ç»åé™„çš„å›¾ç¤ºï¼Œä¼¼ä¹å‘ˆç°å‡ºâ€œæ°å·§æŠŠåˆé€‰è´¨å¿ƒç‚¹é€‰åœ¨äº†ä¸åŒç¾¤ç»„ä¸­â€çš„æ•ˆæœã€‚è€Œä½œä¸ºkå‡å€¼ç®—æ³•çš„ç¬¬ä¸€æ­¥ï¼Œæœ€åˆè´¨å¿ƒçš„é€‰æ‹©æ˜¯å®Œå…¨éšæœºçš„ã€‚ä¹Ÿå°±æ˜¯å¾ˆæœ‰å¯èƒ½è¿™äº›åˆé€‰è´¨å¿ƒæ˜¯åœ¨åŒä¸€ä¸ªç¾¤ç»„ä¸­ã€‚è¯·é—®è¿™ç§æƒ…å†µå¦‚ä½•å¤„ç†ï¼Ÿ</div>2020-06-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/6a/8e/7b6ea886.jpg" width="30px"><span>Joe</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>è€å¸ˆï¼Œç°åœ¨å¾ˆå¤šæœºå™¨å­¦ä¹ çš„ç®—æ³•éƒ½æœ‰ç°æˆçš„åº“äº†ï¼Œå¦‚sklearnç­‰ã€‚ä½†æ˜¯ç›´æ¥è°ƒåº“ï¼Œæ€»è§‰å¾—åœç•™åœ¨è¡¨é¢ã€‚è¯·é—®æœ‰æ²¡æœ‰å¿…è¦è‡ªå·±æ‰‹åŠ¨å»å®ç°ä¸€äº›ç»å…¸çš„æœºå™¨å­¦ä¹ ç®—æ³•å‘¢ï¼Ÿ</div>2019-03-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/ba/c5/bf9b71a9.jpg" width="30px"><span>BindyğŸŒ²</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆï¼Œè¿™é‡Œå¦‚æœæ˜¯ä¸­æ–‡ï¼Œæ˜¯ä¸æ˜¯è¦åšåˆ†è¯å‘¢</div>2019-04-10</li><br/><li><img src="" width="30px"><span>Paul Shan</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>kmeansæ–¹æ³•ç”¨çš„æ˜¯åˆ©ç”¨å‡ ä½•ä¿¡æ¯å°†ç©ºé—´ç‚¹å½’ç±»çš„æ–¹æ³•ï¼Œæœ€ç»ˆçš„ç»“æœæ˜¯å½’å¥½ç±»çš„ç‚¹é›†è´¨å¿ƒä¹‹é—´çš„è·ç¦»è¿œï¼Œä½†æ˜¯é›†åˆå†…ç‚¹ä¹‹é—´è·ç¦»è¿‘çš„æ•ˆæœï¼Œå¯ä»¥ç±»æ¯”äºè½¯ä»¶å¼€å‘ä¸­çš„é«˜å†…èšä½è€¦åˆåŸåˆ™æ¥è®°å¿†ã€‚</div>2019-09-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/51/86/b5fd8dd8.jpg" width="30px"><span>å»ºå¼º</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>æˆ‘è‡ªå·±å†™äº†ä¸€ä¸ªç”¨å‘é‡å¤¹è§’çš„ä½™å¼¦åšèšç±»çš„ç®—æ³•ï¼Œä½†ä¸è®ºæ€ä¹ˆè°ƒæ•´ï¼Œèšç±»ç»“æœå’Œæ¬§æ°è·ç¦»ç®—æ³•éƒ½ä¸ä¸€æ ·ï¼Œæ˜¯ä¸æ˜¯å’Œåˆå§‹è´¨å¿ƒé€‰æ‹©æœ‰å…³ï¼Œè¿˜æ˜¯ç¨‹åºä¸­çš„ç®—æ³•æœ‰é—®é¢˜ï¼Œéœ€è¦è¯·æ•™è€å¸ˆï¼Œç¯‡å¹…æœ‰é™ï¼Œéƒ¨åˆ†ç¨‹åºä»£ç å¦‚ä¸‹ï¼š

    # ç”¨æ ·æœ¬æ‹Ÿåˆèšç±»ç®—æ³•æ¨¡å‹
    def fit(self, sample_matrix):
        #æ£€æŸ¥åˆ†ç±»ä¸ªæ•°æ˜¯å¦å¤§äºå¾…åˆ†ç±»çš„æ ·æœ¬æ•°
        if self.n_clusters &gt; len(sample_matrix):
            raise ValueError(&#39;cluster numbers must less than or equal to sample numbers&#39;)
        
        # åˆå§‹åŒ–è´¨å¿ƒï¼Œå–å‰nä¸ªæ ·æœ¬çš„å‘é‡ä½œä¸ºè´¨å¿ƒ
        self.cluster_centers_ = np.array([sample_matrix[0]])
        for j in range(1, self.n_clusters):
            self.cluster_centers_ = np.r_[self.cluster_centers_, [sample_matrix[j]]]
        # è¿­ä»£è®¡ç®—å„æ ·æœ¬ä¸è´¨å¿ƒçš„å¤¹è§’ï¼Œå¹¶æ›´æ–°åˆ†ç»„ï¼Œç›´åˆ°æ–°è´¨å¿ƒä¸æ—§è´¨å¿ƒä¹‹é—´çš„å·®è·å°äºæŒ‡å®šç²¾åº¦
        k = 0
        cluster = {}
        while True:
            cluster.clear()
            for i in range(len(sample_matrix)):
                max_cos = 0
                nearest_label = None
                for j in range(self.n_clusters):
                    cos = self.__cos(sample_matrix[i],self.cluster_centers_[j])
                    if max_cos &lt; cos:
                        max_cos = cos
                        nearest_label = j
                cluster.setdefault(nearest_label,[])
                cluster[nearest_label].append(i)
            
            #ä¿å­˜è€çš„è´¨å¿ƒï¼Œè®¡ç®—æ–°çš„è´¨å¿ƒ
            old_cluster_centers = self.cluster_centers_.copy()
            for j in range(self.n_clusters):
                self.cluster_centers_[j] = 0
                for i in cluster[j]:
                    self.cluster_centers_[j] += sample_matrix[i]
                self.cluster_centers_[j] = self.cluster_centers_[j] &#47; len(cluster[j])
            # ç”¨æ–¹å·®æ¯”è¾ƒæ–°è€è´¨å¿ƒä¹‹é—´çš„å·®è·
            if self.__variance(self.cluster_centers_, old_cluster_centers) &lt;= self.precision:
                break;
            k+=1
        # æ ¹æ®è®¡ç®—ç»“æœç»™æ ·æœ¬å½’ç±»
        self.labels_ = list(&#39;0&#39; * len(sample_matrix))
        for j in range(self.n_clusters):
            for i in cluster[j]:
                self.labels_[i] = j
        self.labels_ = np.array(self.labels_)
 =================èšç±»ç»“æœ==========
æ¯ä¸ªæ–‡æ¡£æ‰€å±çš„åˆ†ç»„
[0 1 2 1 0 1 0]</div>2020-09-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/d4/44/0ec958f4.jpg" width="30px"><span>Eleven</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>çœ‹åˆ°è¿™é‡Œå°±æœ‰ç‚¹åƒåŠ›äº†ï¼Œå·¥ä½œä¸­æ²¡æœ‰æ¶‰åŠåˆ°è¿™å—ä¸œè¥¿...</div>2020-06-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/7e/a6/4e331ef4.jpg" width="30px"><span>éª‘è¡Œçš„æŒæŸœJ</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æˆ‘è¿™é‡Œå‘é‡é—´ä½¿ç”¨æ¬§å¼è·ç¦»å¾—åˆ°çš„æ˜¯ï¼š[1 0 1 2 1 0 2]
è€Œå‘é‡é—´ç”¨å¤¹è§’ä½™å¼¦å¾—åˆ°çš„æ˜¯ï¼š[2 1 2 1 0 0 1]
scikit-learnæ²¡æœ‰ç›¸åº”çš„å¤¹è§’ä½™å¼¦åŒ…ï¼Œæ‰€ä»¥è¦ç”¨åé¢è¿™ä¸ªBiopythonã€‚
å»ºè®®å¤§å®¶å¯ä»¥å»Biopythonå®˜ç½‘çœ‹çœ‹ç›¸å…³ç”¨æ³•ï¼Œç”¨anacondaå®‰è£…Biopythonçš„æŒ‡ä»¤æ˜¯ ï¼š
conda install -c conda-forge biopython 
è¿™æ˜¯ä¸­æ–‡æ–‡æ¡£åœ°å€ï¼šhttps:&#47;&#47;biopython-cn.readthedocs.io&#47;zh_CN&#47;latest&#47;cn&#47;chr15.html
è¿™æ˜¯è‹±æ–‡çš„ï¼šhttps:&#47;&#47;biopython.org&#47;wiki&#47;Download</div>2020-06-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/6a/8e/7b6ea886.jpg" width="30px"><span>Joe</span> ğŸ‘ï¼ˆ8ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>def customKmeans(vec_array, n_clusters=3, epochs=50):
    &#39;&#39;&#39;
    @description: æ‰‹åŠ¨å®ç°kmeansï¼Œä»¥å‘é‡é—´çš„å¤¹è§’ä½™å¼¦ä½œä¸ºç›¸ä¼¼åº¦
                 æ ¹æ®ä¸Šè¿°tf-idfå¾—åˆ°çš„7æ¡æ–‡æœ¬å‘é‡tfidf_arrayï¼Œè¿›è¡Œèšç±»ç®—æ³•
    @param {type} vec_array- å‘é‡ç»„, n_clusters-èšç±»æ•°ç›®, epochs- è®­ç»ƒæ¬¡æ•°
    @return: cluster_labels- åˆ†ç±»æ ‡ç­¾
    &#39;&#39;&#39;

    # åˆå§‹åŒ–è´¨å¿ƒçš„ä½ç½®
    cluster_centers = []
    cluster_centers_indx = []
    while (len(cluster_centers_indx) &lt; n_clusters):
        indx = random.randint(0, len(vec_array)-1)
        if indx not in cluster_centers_indx:
            cluster_centers_indx.append(indx)
            cluster_centers.append(vec_array[indx])

    # åˆå§‹åŒ–å‘é‡ç±»åˆ«
    cluster_labels = [0] * len(vec_array)
    max_similarity = [-1] * len(vec_array)
    epoch = 0
    while(epoch &lt; epochs):
        # è®¡ç®—æ¯ä¸ªå‘é‡ä¸è´¨å¿ƒçš„ç›¸ä¼¼æ€§ï¼Œå¹¶å°†å…¶å½’çº³åˆ°æœ€è¿‘çš„è´¨å¿ƒé›†ç¾¤ä¸­
        for i in range(0, len(vec_array)):
            max_similarity[i] = computeCosine(vec_array[i], cluster_centers[0])
            for j in range(1, n_clusters):
                temp = computeCosine(vec_array[i], cluster_centers[j])
                if (temp &gt; max_similarity[i]):
                    max_similarity[i] = temp
                    cluster_labels[i] = j

        # æ›´æ–°è´¨å¿ƒä½ç½®
        for i in range(0, n_clusters):
            # æ‰¾åˆ°é›†ç¾¤å¯¹åº”åŸå‘é‡çš„ä¸‹æ ‡
            indxs = [indx for indx, cluster in enumerate(
                cluster_labels) if cluster == i]
            # æ ¹æ®é›†ç¾¤å‘é‡çš„å¹³å‡å€¼æ›´æ–°è´¨ç‚¹ä½ç½®
            cluster_centers[i] = np.average(
                [vec_array[indx] for indx in indxs], axis=0)

        # å½“æ»¡è¶³è¿­ä»£æ¬¡æ•°æˆ–å¹³å‡æœ€å¤§ç›¸ä¼¼æ€§æ—¶é€€å‡ºç®—æ³•
        epoch += 1
        if (np.average(max_similarity) &gt; 0.9):
            break
    return cluster_labels


def computeCosine(vec1, vec2):
    # è®¡ç®—å‘é‡é—´çš„ä½™å¼¦å€¼
    vecCosine = np.dot(vec1, vec2) &#47; \
        (np.linalg.norm(vec1) * np.linalg.norm(vec2))
    return vecCosine


# åº”ç”¨customkmeans
labels = customKmeans(tfidf_array, n_clusters=3, epochs=1000)
print(labels)

è¾“å‡ºç»“æœï¼š
[0 2 0 1 2 2 1]</div>2019-03-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/42/df/a034455d.jpg" width="30px"><span>ç½—è€€é¾™@åå¿˜</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>èŒ¶è‰ºå¸ˆå­¦ç¼–ç¨‹

Kâ€”Meansç®—æ³•ï¼Œç»™æˆ‘çš„æ„Ÿè§‰ï¼Œå°±åƒæ˜¯åœ¨é“ºæ»¡é“å±‘çš„çº¸ä¸Šæ”¾å‡ ä¸ªç£é“ï¼Œé™„è¿‘çš„é“å±‘ä¼šå¸è¿‡æ¥ã€‚

å‘é‡ç©ºé—´æ¨¡å‹åˆ™æ˜¯æ¢ä¸Šæ›´å¼ºåŠ›çš„â€œç£é“â€ã€‚

â€¦â€¦

â€œä»€ä¹ˆè¿˜æœ‰æ²¡æœ‰å¸è¿‡æ¥çš„é“å±‘ï¼Œé‚£å°±ä¸ç”¨ç®¡äº†â€</div>2020-04-28</li><br/><li><img src="" width="30px"><span>013923</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>Keep fitï¼›Study wellï¼Œand Work hardï¼</div>2022-09-14</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/PBMtVAjHwoMWWrqzTPia9lJd2TKb9TlAmRJ5Zxib6TDcia4nAhDvqVauPh3hHEvySraFaOpfUMMDa9ZHGxWtV8alg/132" width="30px"><span>Geek_62f62c</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>è¯·é—®è€å¸ˆ arg(j=1,n) avg (xij)å…¬å¼ä¸­çš„argä»£ç ä»€ä¹ˆå«ä¹‰ï¼Ÿ
</div>2025-01-31</li><br/>
</ul>