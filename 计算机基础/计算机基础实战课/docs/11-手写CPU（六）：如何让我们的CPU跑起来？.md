ä½ å¥½ï¼Œæˆ‘æ˜¯LMOSã€‚

é€šè¿‡å‰é¢å‡ èŠ‚è¯¾çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†MiniCPUäº”çº§æµæ°´çº¿çš„æ¨¡å—è®¾è®¡ï¼Œç°åœ¨è·ç¦»å®ç°ä¸€ä¸ªå®Œæ•´çš„MiniCPUä¹Ÿå°±ä¸€æ­¥ä¹‹é¥ã€‚

è¿˜å·®å“ªäº›å·¥ä½œæ²¡å®Œæˆå‘¢ï¼Ÿè¿˜è®°å¾—æˆ‘ä»¬åœ¨ç¬¬å…­èŠ‚è¯¾è®¾è®¡çš„MiniCPUæ¶æ„å›¾å—ï¼Ÿå›æƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬å·²ç»è®¾è®¡å®Œæˆçš„äº”çº§æµæ°´çº¿ï¼Œéƒ½åŒ…å«ä¸‹å›¾çš„å“ªäº›æ¨¡å—ï¼Ÿ

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/31/dd/31b586c344cd7d0127775e7ff63711dd.jpg?wh=1920x1289)

ä¸Šå›¾çš„CPUæ ¸å¿ƒæ¨¡å—ï¼Œä¹Ÿå°±æ˜¯CPU CoreåŒ…å«çš„æ¨¡å—çš„è®¾è®¡ï¼Œè¿™äº›æˆ‘ä»¬å·²ç»åœ¨å‰é¢å‡ èŠ‚è¯¾é‡Œå®Œæˆäº†ã€‚é™¤äº†äº”çº§æµæ°´çº¿çš„æ¨¡å—ï¼Œæˆ‘ä»¬è¿˜è®¾è®¡äº†ç”¨äºä¿å­˜æ“ä½œæ•°å’Œè¿ç®—ç»“æœçš„é€šç”¨å¯„å­˜å™¨ç»„ï¼Œè®¾è®¡äº†è§£å†³æ•°æ®å†’é™©é—®é¢˜çš„forwardingæ¨¡å—ï¼Œä»¥åŠè§£å†³æ§åˆ¶å†’é™©é—®é¢˜çš„hazardæ¨¡å—ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æå®šä¸€äº›å¤–å›´ç»„ä»¶ï¼Œä¹Ÿå°±æ˜¯å›¾é‡Œè™šçº¿æ¡†å¤–çš„ç³»ç»Ÿæ€»çº¿ã€ROMã€RAMã€è¾“å…¥è¾“å‡ºç«¯å£GPIOï¼ˆGPIOæ¯”è¾ƒç®€å•ï¼Œè¯¾ç¨‹é‡Œæ²¡ä¸“é—¨è®²ï¼‰å’ŒUARTæ¨¡å—ã€‚

å­¦å®Œè¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠè¿™ä¸ªCPUè¿è¡Œèµ·æ¥äº†ï¼Œæœ€ç»ˆæˆ‘è¿˜ä¼šå¸¦ä½ åœ¨è¿™ä¸ªCPUä¸Šè·‘ä¸€ä¸ªRISC-Vç‰ˆæœ¬çš„Hello Worldç¨‹åºï¼ˆè¯¾ç¨‹ä»£ç ä»[è¿™é‡Œ](https://gitee.com/lmos/Geek-time-computer-foundation)ä¸‹è½½ï¼‰ï¼Œæ˜¯ä¸æ˜¯å¾ˆæœŸå¾…ï¼Ÿè¯ä¸å¤šè¯´ï¼Œæˆ‘ä»¬è¿™å°±å¼€å§‹ï¼

## ç³»ç»Ÿæ€»çº¿è®¾è®¡

é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹çœ‹CPUçš„ç³»ç»Ÿæ€»çº¿ã€‚

æ€»çº¿æ˜¯è¿æ¥å¤šä¸ªéƒ¨ä»¶çš„ä¿¡æ¯ä¼ è¾“çº¿ï¼Œå®ƒæ˜¯å„éƒ¨ä»¶å…±äº«çš„ä¼ è¾“ä»‹è´¨ã€‚åœ¨æŸä¸€æ—¶åˆ»ï¼Œåªå…è®¸æœ‰ä¸€ä¸ªéƒ¨ä»¶å‘æ€»çº¿å‘é€ä¿¡æ¯ï¼Œè€Œå¤šä¸ªéƒ¨ä»¶å¯ä»¥åŒæ—¶ä»æ€»çº¿ä¸Šæ¥æ”¶ç›¸åŒçš„ä¿¡æ¯ã€‚MiniCPUçš„ç³»ç»Ÿæ€»çº¿ç”¨æ¥è¿æ¥CPUå†…æ ¸ä¸å¤–è®¾ï¼Œå®Œæˆä¿¡æ¯ä¼ è¾“çš„åŠŸèƒ½ã€‚

ç³»ç»Ÿæ€»çº¿åœ¨æ•´ä¸ªMiniCPUä¸­æ˜¯ä¸€ä¸ªå¾ˆå…³é”®çš„æ¨¡å—ã€‚ä½ å¯ä»¥è¿™æ ·ç†è§£ï¼Œæ€»çº¿å°±æ˜¯CPUå†…æ ¸è·Ÿå…¶ä»–å¤–è®¾éƒ¨ä»¶çš„â€œè”ç»œå‘˜â€ã€‚ä¸¾å‡ ä¸ªä¾‹å­ï¼Œæ€»çº¿å¯ä»¥ä»ROMä¸­è¯»å–æŒ‡ä»¤ï¼Œå†äº¤ç»™CPUå»æ‰§è¡Œï¼›CPUè¿è¡Œç¨‹åºæ—¶çš„å˜é‡ï¼Œä¹Ÿä¼šäº¤ç”±æ€»çº¿ä¿å­˜åˆ°RAMä¸­ï¼›ç”¨æ¥å®ç°èŠ¯ç‰‡ä¸å¤–éƒ¨é€šä¿¡çš„UARTæ¨¡å—ï¼Œä¹Ÿéœ€è¦é€šè¿‡æ€»çº¿è·ŸCPUè¿›è¡Œä¿¡æ¯äº¤æ¢â€¦â€¦

é‚£æ€»çº¿çš„ä»£ç å…·ä½“è¦æ€ä¹ˆè®¾è®¡å‘¢ï¼Ÿæˆ‘å…ˆå±•ç¤ºä¸€ä¸‹å†™å¥½çš„æ•´ä½“ä»£ç ï¼Œå†å¸¦ä½ å…·ä½“åˆ†æã€‚

```verilog
module sys_bus (
    // cpu -> imem
    input  [31:0] cpu_imem_addr,
    output [31:0] cpu_imem_data,
    output [31:0] imem_addr,            	
    input  [31:0] imem_data, 
  
    // cpu -> bus
    input  [31:0] cpu_dmem_addr,        
    input  [31:0] cpu_dmem_data_in,     
    input         cpu_dmem_wen,        
    output reg [31:0] cpu_dmem_data_out,
  
    // bus -> ram 
    input  [31:0] dmem_read_data,     
    output [31:0] dmem_write_data,    
    output [31:0] dmem_addr,           
    output reg    dmem_wen,
  
    // bus -> rom 
    input  [31:0] dmem_rom_read_data,
    output [31:0] dmem_rom_addr, 
  
    // bus -> uart
    input  [31:0] uart_read_data,   
    output [31:0] uart_write_data,   
    output [31:0] uart_addr,         
    output reg    uart_wen
);
    assign imem_addr = cpu_imem_addr;
    assign cpu_imem_data = imem_data;
    assign dmem_addr = cpu_dmem_addr;
    assign dmem_write_data = cpu_dmem_data_in;
    assign dmem_rom_addr = cpu_dmem_addr;
    assign uart_addr = cpu_dmem_addr;
    assign uart_write_data = cpu_dmem_data_in;

    always @(*) begin
        case (cpu_dmem_addr[31:28])
            4'h0: begin								//ROM
                cpu_dmem_data_out <= dmem_rom_read_data;
                dmem_wen <= 0;
                uart_wen <= 0;
            end
            4'h1: begin     					// RAM
                dmem_wen <= cpu_dmem_wen;
                cpu_dmem_data_out <= dmem_read_data;
                uart_wen <= 0;
            end
            4'h2: begin     					// uart io
                uart_wen <= cpu_dmem_wen;
                cpu_dmem_data_out <= uart_read_data;
                dmem_wen <= 0;
            end
            default:   begin
                dmem_wen <= 0;
                uart_wen <= 0;
                cpu_dmem_data_out <= 0;
            end
        endcase
    end
endmodule
```

è¿™é‡Œæˆ‘ä»¬è®¾è®¡çš„ç³»ç»Ÿæ€»çº¿å…¶å®æ˜¯ä¸€ä¸ª**â€œä¸€å¯¹å¤šâ€**çš„ç»“æ„ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯â€œä¸€ä¸»å¤šä»â€ç»“æ„ï¼Œå°±æ˜¯ä¸€ä¸ªCPUå†…æ ¸ä½œä¸ºä¸»è®¾å¤‡ï¼ˆMasterï¼‰ï¼Œå¤šä¸ªå¤–è®¾ä½œä¸ºä»è®¾å¤‡ï¼ˆSlaveï¼‰ã€‚  
![å›¾ç‰‡](https://static001.geekbang.org/resource/image/ac/0e/ac1d4cf173d140225fff21f2c9fedb0e.jpg?wh=1920x1166)

CPUå†…æ ¸å…·æœ‰ç³»ç»Ÿæ€»çº¿çš„æ§åˆ¶æƒï¼Œå®ƒå¯ä»¥é€šè¿‡ç³»ç»Ÿæ€»çº¿ï¼Œå‘èµ·å¯¹å¤–è®¾çš„è®¿é—®ï¼Œè€Œå¤–è®¾åªèƒ½å“åº”ä»CPUå†…æ ¸å‘æ¥çš„å„ç§æ€»çº¿å‘½ä»¤ã€‚å› æ­¤ï¼Œæ¯ä¸ªå¤–è®¾éƒ½éœ€è¦æœ‰ä¸€ä¸ªå›ºå®šçš„åœ°å€ï¼Œä½œä¸ºCPUè®¿é—®ç‰¹å®šå¤–è®¾çš„æ ‡è¯†ã€‚

ä»¥ä¸‹å°±æ˜¯ç»™ä»è®¾å¤‡åˆ†é…çš„åœ°å€ç©ºé—´ï¼š

> // è®¾å¤‡åœ°å€ç©ºé—´  
> // 0x0000\_0000 -ROM (word to byte )  
> // 0x1000\_0000 -RAM (word to byte )  
> // 0x2000\_0000 -uart (word to byte )  
> // 0x3000\_0000 -other(word to byte )

ä»ä»£ç çš„ç¬¬39ï½60è¡Œä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œæ€»çº¿æ ¹æ®åœ°å€çš„**é«˜4 bitçš„å€¼**ï¼Œå°±å¯ä»¥åˆ¤æ–­å‡ºCPUè®¿é—®çš„æ˜¯å“ªä¸ªä»è®¾å¤‡ã€‚

å½“ï¼ˆcpu\_dmem\_addr\[31:28] = 4â€™h0 ï¼‰æ—¶ï¼ŒCPUè®¿é—®çš„æ˜¯ROMï¼ŒæŠŠä»ROMè¿”å›çš„æ•°æ®èµ‹ç»™æ€»çº¿ï¼›å½“ï¼ˆcpu\_dmem\_addr\[31:28] = 4â€™h1 ï¼‰æ—¶ï¼ŒCPUè®¿é—®çš„æ˜¯RAMï¼ŒæŠŠCPUçš„å†™ä½¿èƒ½cpu\_dmem\_wenèµ‹ç»™RAMçš„å†™ä½¿èƒ½ä¿¡å·dmem\_wenï¼ŒåŒæ—¶æŠŠä»RAMè¿”å›çš„æ•°æ®èµ‹ç»™æ€»çº¿ï¼›å½“ï¼ˆcpu\_dmem\_addr\[31:28] = 4â€™h2 ï¼‰æ—¶ï¼ŒCPUè®¿é—®çš„æ˜¯ä¸²è¡Œé€šä¿¡æ¨¡å—UARTï¼ŒæŠŠCPUçš„å†™ä½¿èƒ½cpu\_dmem\_wenèµ‹ç»™uartçš„å†™ä½¿èƒ½ä¿¡å·uart\_wenï¼ŒåŒæ—¶æŠŠä»UARTè¿”å›çš„æ•°æ®èµ‹ç»™æ€»çº¿ã€‚è¿™å°±æ˜¯MiniCPUæ€»çº¿çš„å·¥ä½œè¿‡ç¨‹ã€‚

## åªè¯»å­˜å‚¨å™¨ROMçš„å®ç°

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹è¿æ¥åœ¨æ€»çº¿ä¸Šçš„å­˜å‚¨å™¨è¦å¦‚ä½•å®ç°ã€‚

ROMæ˜¯ä¸ªç¼©å†™ï¼Œå®ƒè¡¨ç¤ºåªè¯»å­˜å‚¨å™¨ï¼ˆRead Only Memoryï¼‰ã€‚ROMå…·æœ‰éæ˜“å¤±æ€§çš„ç‰¹ç‚¹ã€‚ä»€ä¹ˆæ˜¯éæ˜“å¤±æ€§å‘¢ï¼Ÿè¯´ç™½äº†å°±æ˜¯åœ¨ç³»ç»Ÿæ–­ç”µçš„æƒ…å†µä¸‹ï¼Œä»ç„¶å¯ä»¥ä¿å­˜æ•°æ®ã€‚

æ­£æ˜¯å› ä¸ºè¿™ä¸€ç‰¹ç‚¹ï¼ŒROMå¾ˆé€‚åˆç”¨æ¥å­˜æ”¾è®¡ç®—æœºçš„ç¨‹åºã€‚ç”±äºå†å²åŸå› ï¼Œè™½ç„¶ç°åœ¨ä½¿ç”¨çš„ROMä¸­ï¼Œæœ‰äº›ç±»å‹ä¸ä»…æ˜¯å¯ä»¥è¯»ï¼Œè¿˜å¯ä»¥å†™ï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯ä¹ æƒ¯æ€§åœ°æŠŠå®ƒä»¬ç§°ä½œåªè¯»å­˜å‚¨å™¨ã€‚æ¯”å¦‚ï¼Œç°åœ¨ç”µå­ç³»ç»Ÿä¸­å¸¸ç”¨çš„EEPROMã€NOR flash ã€Nand flashç­‰ï¼Œéƒ½å¯ä»¥å½’ç±»ä¸ºROMã€‚

åœ¨æˆ‘ä»¬çš„MiniCPUä¸­ï¼Œç›®å‰æ²¡æœ‰çœŸæ­£ä½¿ç”¨ä¸Šè¿°çš„ROMä½œä¸ºæŒ‡ä»¤å­˜å‚¨å™¨ã€‚è®©æˆ‘ä»¬çœ‹çœ‹MiniCPUä¸­å®ç°ROMåŠŸèƒ½çš„ä»£ç ï¼Œå†ç›¸åº”åˆ†ææˆ‘ä»¬çš„è®¾è®¡æ€è·¯ã€‚

```verilog
module imem (
    input  [11:0] addr1,
    output [31:0] imem_o1,
    input  [11:0] addr2,
    output [31:0] imem_o2
);
    reg [31:0] imem_reg[0:4096];

    assign imem_o1 = imem_reg[addr1];
    assign imem_o2 = imem_reg[addr2];

endmodule
```

ä¸ºäº†æ–¹ä¾¿å­¦ä¹ å’Œä»¿çœŸï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å¯„å­˜å™¨ï¼ˆregï¼‰ä¸´æ—¶å®šä¹‰äº†ä¸€ä¸ªæŒ‡ä»¤å­˜å‚¨å™¨imemï¼Œå¹¶åœ¨ä»¿çœŸçš„é¡¶å±‚ï¼ˆtb\_top.vï¼‰ä½¿ç”¨äº†$readmemhï¼ˆï¼‰å‡½æ•°ï¼ŒæŠŠç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æŒ‡ä»¤è¯»å…¥åˆ°imemä¸­ï¼Œä»¥ä¾¿CPUå†…éƒ¨è¯»å–å¹¶æ‰§è¡Œè¿™äº›æŒ‡ä»¤ã€‚è¿™é‡Œæˆ‘ä»¬è®¾ç½®çš„å­˜å‚¨å™¨åœ¨åŠŸèƒ½ä¸Šæ˜¯åªè¯»çš„ã€‚

ä»¥ä¸‹å°±æ˜¯ä»¿çœŸçš„é¡¶å±‚ï¼ˆtb\_top.vï¼‰è°ƒç”¨$readmemhï¼ˆï¼‰å‡½æ•°çš„è¯­å¥ã€‚

```verilog
$readmemh(`HEXFILE, MiniCPU.u_imem.imem_reg);
```

å‡½æ•°é‡Œé¢æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯å­˜æ”¾äºŒè¿›åˆ¶æŒ‡ä»¤çš„æ–‡ä»¶ï¼ˆHEXFILEï¼‰ï¼Œå¦ä¸€ä¸ªå°±æ˜¯å®ç°ROMåŠŸèƒ½çš„å¯„å­˜å™¨ï¼ˆimem\_regï¼‰ã€‚è¿™æ¡è¯­å¥å¯ä»¥åœ¨æˆ‘ä»¬å¯åŠ¨CPUä»¿çœŸæ—¶ï¼ŒæŠŠäºŒè¿›åˆ¶çš„æŒ‡ä»¤ä¸€æ¬¡æ€§è¯»å…¥åˆ°imemä¸­ï¼Œè¿™æ ·CPUè¿è¡Œçš„è¿‡ç¨‹ä¸­å°±å¯ä»¥å–imemä¸­çš„æŒ‡ä»¤å»æ‰§è¡Œäº†ã€‚

## éšæœºè®¿é—®å­˜å‚¨å™¨RAM

é™¤äº†å­˜æ”¾æŒ‡ä»¤çš„ROMï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªå­˜æ”¾å˜é‡å’Œæ•°æ®çš„RAMï¼ˆRandom Access Memoryï¼‰ã€‚

RAMå’Œç‰¹ç‚¹è·ŸROMæ­£å¥½ç›¸åï¼Œå®ƒæ˜¯æ˜“å¤±æ€§å­˜å‚¨å™¨ï¼Œé€šå¸¸éƒ½æ˜¯åœ¨æ‰ç”µä¹‹åå°±ä¼šä¸¢å¤±æ•°æ®ã€‚ä½†æ˜¯å®ƒå…·æœ‰è¯»å†™é€Ÿåº¦å¿«çš„ä¼˜åŠ¿ï¼Œæ‰€ä»¥é€šå¸¸ç”¨ä½œCPUçš„é«˜é€Ÿç¼“å­˜ã€‚

RAMä¹‹æ‰€ä»¥å«åšéšæœºè®¿é—®å­˜å‚¨å™¨ï¼Œæ˜¯å› ä¸ºä¸åŒçš„åœ°å€å¯ä»¥åœ¨ç›¸åŒçš„æ—¶é—´å†…éšæœºè¯»å†™ã€‚è¿™æ˜¯ç”±RAMçš„ç»“æ„å†³å®šçš„ï¼ŒRAMä½¿ç”¨å­˜å‚¨é˜µåˆ—æ¥å­˜å‚¨æ•°æ®ï¼Œåªè¦ç»™å‡ºè¡Œåœ°å€å’Œåˆ—åœ°å€ï¼Œå°±èƒ½ç¡®å®šç›®æ ‡æ•°æ®ï¼Œè€Œä¸”è¿™ä¸€è¿‡ç¨‹å’Œç›®æ ‡æ•°æ®æ‰€å¤„çš„ç‰©ç†ä½ç½®æ— å…³ã€‚

å’ŒROMä¸€æ ·ï¼Œä¸ºäº†æ–¹ä¾¿å¯¹è®¾è®¡çš„MiniCPUè¿›è¡Œä»¿çœŸéªŒè¯ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç”¨å¯„å­˜å™¨ï¼ˆregï¼‰ä¸´æ—¶æ„å»ºäº†ä¸€ä¸ªæ•°æ®å­˜å‚¨å™¨dmemï¼Œä½œä¸ºMiniCPUä¸­çš„RAMä½¿ç”¨ã€‚è™½ç„¶ä¸´æ—¶æ„å»ºçš„å­˜å‚¨å™¨å’Œå®é™…çš„ROMæœ‰ç‚¹å·®åˆ«ï¼Œä½†æˆ‘ä»¬è¿˜åœ¨åˆæœŸå­¦ä¹ é˜¶æ®µï¼Œè¿™å·²ç»è¶³å¤Ÿäº†ã€‚

ä¸‹é¢å°±æ˜¯å®ç°RAMåŠŸèƒ½çš„æ•°æ®å­˜å‚¨å™¨dmemçš„ä»£ç ï¼š

```verilog
module dmem(
    input [11:0] addr,
    input we,
    input [31:0] din,
    input clk,

    output reg [31:0] dout
);
    reg [31:0] dmem_reg[0:4095];
    
    always @(posedge clk) begin
        if(we) begin
            dmem_reg[addr] <= din;
        end
            dout <= dmem_reg[addr];
    end
endmodule
```

ä»£ç çš„ç¬¬11~16è¡Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†æ—¶é’Ÿä¿¡å·clkï¼Œè¯´æ˜è¿™é‡Œçš„dmemå®ç°çš„æ˜¯ä¸€ä¸ªæ—¶é’ŸåŒæ­¥RAMã€‚è€Œä¸”å½“å†™ä½¿èƒ½ä¿¡å·ï¼ˆweï¼‰ä¸ºâ€œ1â€æ—¶ï¼Œæ‰èƒ½å¾€RAMé‡Œå†™æ•°æ®ï¼Œå¦åˆ™åªèƒ½è¯»å–æ•°æ®ã€‚

## å¤–è®¾UARTè®¾è®¡

ä¸ºäº†è®©MiniCPUèƒ½å’Œå…¶ä»–ç”µå­è®¾å¤‡è¿›è¡Œé€šä¿¡ï¼Œæˆ‘ä»¬è¿˜è¦è®¾è®¡UARTæ¨¡å—ã€‚

åŒæ ·åœ°ï¼Œè®¾è®¡ä»£ç ä¹‹å‰æˆ‘å…ˆå¸¦ä½ å¿«é€Ÿäº†è§£ä¸€ä¸‹UARTæ˜¯ä»€ä¹ˆï¼Œå®ƒçš„å·¥ä½œåŸç†æ˜¯æ€æ ·çš„ã€‚

UARTçš„å…¨ç§°å«é€šç”¨å¼‚æ­¥æ”¶å‘ä¼ è¾“å™¨ï¼ˆUniversal Asynchronous Receiver/Transmitterï¼‰ï¼Œå®ƒæ˜¯ä¸€ç§ä¸²è¡Œã€å¼‚æ­¥ã€å…¨åŒå·¥çš„é€šä¿¡åè®®ï¼Œæ˜¯ç”µå­è®¾å¤‡é—´è¿›è¡Œå¼‚æ­¥é€šä¿¡çš„å¸¸ç”¨æ¨¡å—ã€‚

UARTè´Ÿè´£å¯¹ç³»ç»Ÿæ€»çº¿çš„å¹¶è¡Œæ•°æ®å’Œä¸²è¡Œå£ä¸Šçš„ä¸²è¡Œæ•°æ®è¿›è¡Œè½¬æ¢ï¼Œé€šä¿¡åŒæ–¹é‡‡ç”¨ç›¸åŒçš„æ³¢ç‰¹ç‡ã€‚åœ¨ä¸ä½¿ç”¨æ—¶é’Ÿä¿¡å·çº¿çš„æƒ…å†µä¸‹ï¼Œä»…ç”¨ä¸€æ ¹æ•°æ®å‘é€ä¿¡å·çº¿å’Œä¸€æ ¹æ•°æ®æ¥æ”¶ä¿¡å·çº¿ï¼ˆRxå’ŒTxï¼‰å°±å¯ä»¥å®Œæˆä¸¤ä¸ªè®¾å¤‡é—´çš„é€šä¿¡ï¼Œå› æ­¤æˆ‘ä»¬ä¹ŸæŠŠUARTç§°ä¸ºå¼‚æ­¥ä¸²è¡Œé€šä¿¡ã€‚

ä¸²è¡Œé€šä¿¡æ˜¯æŒ‡ï¼Œåˆ©ç”¨ä¸€æ¡ä¼ è¾“çº¿å°†æ•°æ®æŒ‰é¡ºåºä¸€ä½ä½ä¼ é€çš„è¿‡ç¨‹ã€‚UARTçš„å‘é€æ¨¡å—ä¼šæŠŠæ¥è‡ªCPUæ€»çº¿çš„å¹¶è¡Œæ•°æ®è½¬æ¢ä¸ºä¸²è¡Œæ•°æ®ï¼Œå†ä»¥ä¸²è¡Œæ–¹å¼å°†å…¶å‘é€åˆ°å¦ä¸€ä¸ªè®¾å¤‡çš„UARTæ¥æ”¶ç«¯ã€‚ç„¶åç”±UARTçš„æ¥æ”¶æ¨¡å—æŠŠä¸²è¡Œæ•°æ®è½¬æ¢ä¸ºå¹¶è¡Œæ•°æ®ï¼Œä»¥ä¾¿æ¥æ”¶è®¾å¤‡å­˜å‚¨å’Œä½¿ç”¨è¿™äº›æ•°æ®ã€‚

UARTçš„æ•°æ®ä¼ è¾“æ ¼å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/e7/c2/e7308850a0d185b3ccdde6b7ef4806c2.jpg?wh=1920x872)

ä»å›¾é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒUARTä¼ è¾“æ•°æ®åŒ…æ‹¬èµ·å§‹ä½ã€æ•°æ®ä½ã€å¥‡å¶æ ¡éªŒä½ã€åœæ­¢ä½å’Œç©ºé—²ä½ã€‚UARTæ•°æ®ä¼ è¾“çº¿é€šå¸¸åœ¨ä¸ä¼ è¾“æ•°æ®æ—¶ä¿æŒåœ¨é«˜ç”µå¹³ã€‚

è¿™ä¹ˆå¤šåè¯æ˜¯ä¸æ˜¯æœ‰ç‚¹åº”æ¥ä¸æš‡ï¼Ÿæˆ‘æŒ¨ä¸ªè§£é‡Šä¸€ä¸‹ï¼Œä½ å°±æ¸…æ¥šäº†ã€‚

- **èµ·å§‹ä½**æ˜¯åœ¨æ•°æ®çº¿ä¸Šå…ˆå‘å‡ºä¸€ä¸ªé€»è¾‘ä½ç”µå¹³â€œ0â€ä¿¡å·ï¼Œè¡¨ç¤ºæ•°æ®ä¼ è¾“çš„å¼€å§‹ã€‚
- **æ•°æ®ä½**æ˜¯ç”±5~8ä½é€»è¾‘é«˜ä½ç”µå¹³è¡¨ç¤ºçš„â€œ1â€æˆ–â€œ0â€ä¿¡å·ã€‚
- **æ ¡éªŒä½**åœ¨ä¼ è¾“çš„æ•°æ®ä½çš„åé¢åŠ 1bitï¼Œè¡¨ç¤ºâ€œ1â€çš„ä½æ•°åº”ä¸ºå¶æ•°ï¼ˆå¶æ ¡éªŒï¼‰æˆ–å¥‡æ•°ï¼ˆå¥‡æ ¡éªŒï¼‰ã€‚
- **åœæ­¢ä½**æ˜¯ä¸€ä¸ªæ•°æ®ä½å®½çš„1å€ã€1.5å€ã€æˆ–è€…2å€çš„é«˜ç”µå¹³ä¿¡å·ï¼Œå®ƒæ˜¯ä¸€æ¬¡æ•°æ®ä¼ è¾“çš„ç»“æŸæ ‡å¿—ã€‚
- **ç©ºé—²ä½**æ˜¯æ•°æ®ä¼ è¾“çº¿å¤„äºé€»è¾‘é«˜ç”µå¹³çŠ¶æ€ï¼Œè¡¨ç¤ºå½“å‰çº¿è·¯ä¸Šå¤„äºç©ºé—²çŠ¶æ€ï¼Œæ²¡æœ‰æ•°æ®ä¼ é€ã€‚

è·Ÿæ•°æ®å‘é€ä¿¡å·çº¿TXã€æ•°æ®æ¥æ”¶ä¿¡å·çº¿RXç›¸å¯¹åº”ï¼Œæˆ‘ä»¬çš„UARTä¹Ÿåˆ†åˆ«è®¾è®¡äº†å‘é€æ¨¡å—ï¼ˆuart\_txï¼‰å’Œæ¥æ”¶æ¨¡å—ï¼ˆuart\_rxï¼‰ã€‚å¦‚æœä½ æƒ³äº†è§£å…·ä½“çš„åŠŸèƒ½å®ç°ï¼Œå¯ä»¥è¯¾åæŸ¥çœ‹æˆ‘ä»¬çš„MiniCPUçš„[é¡¹ç›®ä»£ç ](https://gitee.com/lmos/Geek-time-computer-foundation/tree/master/lesson06~11/mini_cpu)ã€‚

è¿™é‡Œåªæ”¾å‡ºæ¥å‘é€æ¨¡å—çš„ç«¯å£ä¿¡å·ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```verilog
module uart_tx(
input           clk         , // Top level system clock input.
input           resetn      , // Asynchronous active low reset.
output          uart_txd    , // UART transmit pin.
output          uart_tx_busy, // Module busy sending previous item.
input           uart_tx_en  , // Send the data on uart_tx_data
input   [7:0]   uart_tx_data  // The data to be sent
);
```

UARTæ¥æ”¶æ¨¡å—çš„ç«¯å£ä¿¡å·å¦‚ä¸‹ï¼š

```verilog
module uart_rx(
input         clk          , // Top level system clock input.
input         resetn       , // Asynchronous active low reset.
input         uart_rxd     , // UART Recieve pin.
input         uart_rx_en   , // Recieve enable
output        uart_rx_break, // Did we get a BREAK message?
output        uart_rx_valid, // Valid data recieved and available.
output reg  [7:0] uart_rx_data   // The recieved data.
);
```

ç«¯å£ä¿¡å·çš„ä»£ç ä½ ç»“åˆä¸Šé¢çš„æ³¨é‡Šå¾ˆå®¹æ˜“å°±èƒ½ç†è§£ï¼Œåé¢CPUè·‘ç¨‹åºçš„æ—¶å€™å°±ä¼šç”¨åˆ°è¿™éƒ¨åˆ†çš„åŠŸèƒ½ã€‚

## åœ¨CPUä¸Šè·‘ä¸ªHello World

å¥½ï¼Œç°åœ¨æ¥åˆ°æˆ‘ä»¬çš„æœ€åä¸€ä¸ªç¯èŠ‚ï¼Œç¼–å†™ç¨‹åºï¼Œå¹¶æŠŠå®ƒæ”¾åˆ°æˆ‘ä»¬çš„MiniCPUä¸Šè·‘èµ·æ¥ã€‚

ä¸ºäº†èƒ½æ›´ç›´è§‚çœ‹åˆ°CPUçš„è¿è¡Œæ•ˆæœï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨RISC-Væ±‡ç¼–æŒ‡ä»¤ï¼Œè®¾è®¡äº†ä¸€æ®µç”¨UARTå‘é€â€œHello MiniCPU!â€å­—ç¬¦ä¸²çš„ä»£ç ï¼Œç„¶åè®©ä¸²å£æ¥æ”¶ç«¯æŠŠå‘é€çš„å­—ç¬¦ä¸²åœ¨ç”µè„‘ä¸Šæ‰“å°å‡ºæ¥ã€‚

å…·ä½“çš„ä»£ç å¦‚ä¸‹ï¼š

```plain
#		AssemblyÂ  Â  Â  Â  Â  Â  Â  Â  Description
main:Â  Â 
Â  Â  Â  Â  liÂ  Â  Â  x2, 0x20000000Â  Â  Â  Â  Â  # uart address
Â  Â  Â  Â  liÂ  Â  Â  x6,Â  0x1500Â  Â  Â  Â  Â  Â  Â #x6 <== 0x1500, delay 1ms
Â  Â  Â  Â  addiÂ  Â  x7, x0, 0Â  Â  Â  Â  Â  Â  Â  Â #x7 <== 0

Â  Â  Â  Â  addiÂ  Â  x5, x0, 0x48Â  Â  Â  Â  Â  Â  #x5 <== "H"
Â  Â  Â  Â  swÂ  Â  Â  x5, 0(x2)Â Â 

delay1: addiÂ  Â  x7, x7, 1Â  Â  Â  Â  Â  Â  Â  Â #x7 <== x7 + 1
Â  Â  Â  Â  bneÂ  Â  Â x7, x6, delay1Â  Â  Â  Â  Â  #x6 != x7Â 
Â  Â  Â  Â  addiÂ  Â  x7, x0, 0Â  Â  Â  Â  Â  Â  Â  Â #x7 <== 0
Â  Â  Â  Â  addiÂ  Â  x5, x0, 0x65Â  Â  Â  Â  Â  Â  #x5 <== "e"
Â  Â  Â  Â  swÂ  Â  Â  x5, 0(x2)Â Â 

delay2: addiÂ  Â  x7, x7, 1Â  Â  Â  Â  Â  Â  Â  Â #x7 <== x7 + 1
Â  Â  Â  Â  bneÂ  Â  Â x7, x6, delay2Â  Â  Â  Â  Â  Â #x6 != x7
Â  Â  Â  Â  addiÂ  Â  x7, x0, 0Â  Â  Â  Â  Â  Â  Â  Â #x7 <== 0
Â  Â  Â  Â  addiÂ  Â  x5, x0, 0x6cÂ  Â  Â  Â  Â  Â  #x5 <== "l"
Â  Â  Â  Â  swÂ  Â  Â  x5, 0(x2)Â 

delay3: addiÂ  Â  x7, x7, 1Â  Â  Â  Â  Â  Â  Â  Â #x7 <== x7 + 1
Â  Â  Â  Â  bneÂ  Â  Â x7, x6, delay3Â  Â  Â  Â  Â  Â #x6 != x7
Â  Â  Â  Â  addiÂ  Â  x7, x0, 0Â  Â  Â  Â  Â  Â  Â  Â #x7 <== 0
Â  Â  Â  Â  addiÂ  Â  x5, x0, 0x6cÂ  Â  Â  Â  Â  Â  #x5 <== "l"
Â  Â  Â  Â  swÂ  Â  Â  x5, 0(x2)Â Â 

  â€¦â€¦â€¦â€¦  //ç”±äºä»£ç è¾ƒé•¿ï¼Œç»“æ„ç›¸ä¼¼ï¼Œè¿™é‡Œçœç•¥äº†ä¸€éƒ¨åˆ†ï¼Œå®Œæ•´ä»£ç ä½ å¯ä»¥ä»Giteeä¸Šè·å–

delay13: addiÂ  Â  x7, x7, 1Â  Â  Â  Â  Â  Â  Â  Â #x7 <== x7 + 1
Â  Â  Â  Â  bneÂ  Â  Â x7, x6, delay13Â  Â  Â  Â  Â  Â #x6 != x7
Â  Â  Â  Â  addiÂ  Â  x7, x0, 0Â  Â  Â  Â  Â  Â  Â  Â #x7 <== 0
Â  Â  Â  Â  addiÂ  Â  x5, x0, 0x21Â  Â  Â  Â  Â  Â  #x5 <== "!"
Â  Â  Â  Â  swÂ  Â  Â  x5, 0(x2)Â 

end:Â  Â  jÂ  Â  Â  Â end

Â  Â  Â  Â  ret
```

æœ‰äº†ä»£ç ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æŠŠå®ƒç¼–è¯‘æˆèƒ½åœ¨CPUä¸Šè¿è¡Œçš„æœºå™¨ç ï¼Œæ‰èƒ½æŠŠå®ƒæ”¾åœ¨CPUä¸Šè·‘ã€‚

ä¸‹é¢çš„ä»£ç å°±æ˜¯æ”¾åœ¨è¯¾ç¨‹ä»£ç ä¸­çš„Makefileï¼Œä½œç”¨æ˜¯ç¼–è¯‘æ±‡ç¼–ä»£ç ï¼Œè¿˜æœ‰å®šä¹‰å¥½CPUä»¿çœŸéœ€è¦ç”¨åˆ°çš„ä¸€äº›å‘½åè§„åˆ™ã€‚

```makefile
SOURCE_TB := ./tb/tb_top.v
TMP_DIR := ./tmp
SOURCE := ./rtl.f
TARGET := ${TMP_DIR}/tb_top.o

TEST_HEX := ./sim/asm/build/test.dat

# ç¼–è¯‘æ±‡ç¼–ç¨‹åºï¼Œè¾“å‡ºäºŒè¿›åˆ¶æŒ‡ä»¤
asm:
	make -C ./sim/asm 
	python ./sim/asm/word2byte.py

# å¯¹CPUè¿›è¡Œä»¿çœŸ
cpu:
	rm -f ${TMP_DIR}/*
	cp ${SOURCE_TB} ${TMP_DIR}
	sed -i 's#.hex#${TEST_HEX}#' ${TMP_DIR}/tb_top.v
	iverilog -f ${SOURCE} -o ${TARGET}
	vvp ${TARGET}

# æŸ¥çœ‹æ³¢å½¢
wave:
	gtkwave ${TMP_DIR}/tb_top.vcd &

# æ¸…é™¤ä¸´æ—¶æ–‡ä»¶
clean:
	make -C ./sim/asm clean
	rm ./tmp/* -rf
```

ä»Makefileçš„ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä¸€å…±å®šä¹‰äº†4ä¸ªç›®æ ‡å‘½ä»¤ï¼Œå®ƒä»¬çš„ä½œç”¨åˆ†åˆ«æ˜¯å®Œæˆæ±‡ç¼–ç¨‹åºç¼–è¯‘çš„ï¼ˆasmï¼‰å‘½ä»¤ã€æ‰§è¡ŒMiniCPUä»¿çœŸçš„ï¼ˆcpuï¼‰å‘½ä»¤ã€ç”¨è½¯ä»¶GTKwaveæ‰“å¼€ä»¿çœŸåçš„æ³¢å½¢ï¼ˆwaveï¼‰å‘½ä»¤ï¼Œä»¥åŠæ¸…é™¤ä»¿çœŸè¿‡ç¨‹ä¸­äº§ç”Ÿçš„ä¸´æ—¶æ–‡ä»¶çš„ï¼ˆcleanï¼‰å‘½ä»¤ã€‚

é€šè¿‡åœ¨ç»ˆç«¯ä¸Šæ‰§è¡Œâ€œmake asmâ€å‘½ä»¤ï¼Œä¾¿å¯ä»¥æŠŠä¸Šé¢è®¾è®¡çš„æ±‡ç¼–ç¨‹åºç¼–è¯‘æˆäºŒè¿›åˆ¶æŒ‡ä»¤test.datã€‚ç„¶åæˆ‘ä»¬å†è¾“å…¥â€œmake cpuâ€å‘½ä»¤å°±å¯åŠ¨MiniCPUçš„ä»¿çœŸäº†ï¼Œè¿è¡Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/93/77/93a1c6c0c1e71cb4cc6f5bffbc86f577.jpg?wh=1920x1043)

åˆ°æ­¤ï¼Œæˆ‘ä»¬çš„MiniCPUå°±è®¾è®¡å®Œæˆå•¦ï¼ç¥è´ºä½ ä¸€è·¯è¿›è¡Œåˆ°è¿™é‡Œã€‚çœ‹åˆ°é¡µé¢ä¸Šè¾“å‡ºHello MiniCPUçš„æ—¶å€™ï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰è¿˜æŒºå¥½ç©çš„ï¼Ÿ

å¦‚æœä½ è§‰å¾—æ„çŠ¹æœªå°½ï¼Œè¿˜å¯ä»¥åœ¨é¡¹ç›®æ–‡ä»¶å¤¹é‡Œçš„â€œ./mini\_cpu/sim/asm/src/miniCPU\_sim.asmâ€è¿™ä¸ªæ–‡ä»¶ä¸­ç¼–å†™ä½ è‡ªå·±çš„RISC-Væ±‡ç¼–ç¨‹åºï¼Œç„¶åå°±å¯ä»¥åœ¨æˆ‘ä»¬çš„MiniCPUä¸Šç©å‡ºæ›´å¤šèŠ±æ ·äº†ã€‚

## é‡ç‚¹å›é¡¾

è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬æŠŠMiniCPUçš„å‡ ä¸ªå¤–éƒ¨æ¨¡å—è®¾è®¡å®Œæˆï¼Œè¿™å‡ ä¸ªæ¨¡å—æ˜¯è®©CPUâ€œè·‘èµ·æ¥â€çš„å¿…è¦ç»„ä»¶ã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/31/dd/31b586c344cd7d0127775e7ff63711dd.jpg?wh=1920x1289)

æˆ‘ä»¬é¦–å…ˆè®¾è®¡äº†MiniCPUçš„ç³»ç»Ÿæ€»çº¿ã€‚æœ‰äº†å®ƒï¼Œå°±èƒ½è¿æ¥CPUå†…æ ¸ä¸å¤–è®¾ï¼Œå®Œæˆä¿¡æ¯ä¼ è¾“çš„åŠŸèƒ½ï¼Œç›¸å½“äºCPUå†…æ ¸ä¸å¤–éƒ¨è®¾å¤‡çš„ä¸€åº§æ¡¥æ¢ã€‚

æ¥ä¸‹æ¥çš„æ¨¡å—å°±æ˜¯ROMå’ŒRAMã€‚ROMæ˜¯å­˜æ”¾CPUæŒ‡ä»¤çš„åªè¯»å­˜å‚¨å™¨ã€‚ä¸ºäº†æ–¹ä¾¿å­¦ä¹ å’Œä»¿çœŸï¼Œæˆ‘ä»¬é€šè¿‡å¯„å­˜å™¨ä¸´æ—¶å®šä¹‰äº†ä¸€ä¸ªæŒ‡ä»¤å­˜å‚¨å™¨ï¼Œç„¶ååœ¨ä»¿çœŸçš„é¡¶å±‚ä½¿ç”¨äº†$readmemhå‡½æ•°ï¼ŒæŠŠç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æŒ‡ä»¤è¯»å…¥åˆ°æŒ‡ä»¤å­˜å‚¨å™¨ä¸­ï¼Œè¿™æ ·CPUè¿è¡Œæ—¶å°±å¯ä»¥è¯»å–å’Œæ‰§è¡Œè¿™äº›æŒ‡ä»¤äº†ã€‚

RAMç”¨æ¥å­˜æ”¾æ•°æ®ï¼Œå®ƒåœ¨æ‰ç”µä¹‹åä¼šä¸¢å¤±æ•°æ®ï¼Œä½†æ˜¯è¯»å†™é€Ÿåº¦å¿«ï¼Œé€šå¸¸ç”¨æ¥ä½œä¸ºCPUçš„é«˜é€Ÿç¼“å­˜ã€‚è·ŸROMçš„å®ç°æ€è·¯ä¸€æ ·ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç”¨å¯„å­˜å™¨ä¸´æ—¶æ„å»ºäº†ä¸€ä¸ªæ•°æ®å­˜å‚¨å™¨dmemï¼Œä½œä¸ºMiniCPUä¸­çš„RAMä½¿ç”¨ã€‚

ä¸ºäº†è®©MiniCPUèƒ½å’Œå…¶ä»–è®¾å¤‡é€šä¿¡ï¼Œæˆ‘ä»¬è¿˜è®¾è®¡äº†å¼‚æ­¥ä¸²è¡Œé€šä¿¡æ¨¡å—UARTï¼Œå®ƒç”¨ä¸€æ ¹æ•°æ®å‘é€ä¿¡å·çº¿å’Œä¸€æ ¹æ•°æ®æ¥æ”¶ä¿¡å·çº¿å°±å¯ä»¥å®Œæˆä¸¤ä¸ªè®¾å¤‡é—´çš„é€šä¿¡ã€‚

MiniCPUè®¾è®¡å¥½äº†ä¹‹åï¼Œæˆ‘ä»¬è¿›å…¥è¿è¡Œè°ƒè¯•ç¯èŠ‚ï¼Œç”¨RISC-VæŒ‡ä»¤ç¼–å†™äº†ä¸€æ®µç”¨UARTå‘é€â€œHello MiniCPU!â€å­—ç¬¦ä¸²çš„æ±‡ç¼–ç¨‹åºï¼Œç„¶åè®©ä¸²å£æ¥æ”¶ç«¯æŠŠå‘é€çš„å­—ç¬¦ä¸²åœ¨ç”µè„‘ä¸Šæ‰“å°å‡ºæ¥ã€‚å¦‚æœå­—ç¬¦ä¸²æ˜¾ç¤ºæ­£å¸¸ï¼Œè¯´æ˜æˆ‘ä»¬çš„miniCPUå·²ç»å¯ä»¥æ­£å¸¸è¿è¡Œäº†ã€‚

åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬RISC-Vå¤„ç†å™¨çš„å®ç°å°±å…¨éƒ¨å®Œæˆäº†ã€‚è¿™èŠ‚è¯¾è¦ç‚¹ï¼Œä½ å¯ä»¥å‚è€ƒä¸‹é¢çš„å¯¼å›¾ã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/54/83/54b5250d3992644cf27ebe953fb44283.jpg?wh=1920x2109)

ä½ æœ‰å…´è¶£çš„è¯ï¼Œè¿˜å¯ä»¥è¯¾ååšæ›´å¤šçš„æ¢ç´¢ï¼Œæ¯”å¦‚ç»™å®ƒæ·»åŠ æ›´å¤šçš„RISCVæŒ‡ä»¤åŠŸèƒ½ï¼Œåœ¨CPUæ€»çº¿ä¸ŠæŒ‚è½½æ›´å¤šçš„å¤–è®¾â€¦â€¦åé¢çš„è¯¾ç¨‹é‡Œï¼Œæˆ‘ä¼šå¸¦ä½ å­¦ä¹ æ›´å¤šçš„RISC-VæŒ‡ä»¤ï¼Œæ•¬è¯·æœŸå¾…ï¼

## æ€è€ƒé¢˜

è®¡ç®—æœºä¸¤å¤§ä½“ç³»ç»“æ„åˆ†åˆ«æ˜¯å†¯è¯ºä¾æ›¼ä½“ç³»ç»“æ„å’Œå“ˆå¼—ä½“ç³»ç»“æ„ï¼Œè¯·é—®æˆ‘ä»¬çš„MiniCPUå±äºå“ªä¸€ç§ä½“ç³»ç»“æ„å‘¢ï¼Ÿ

æœŸå¾…ä½ åœ¨ç•™è¨€åŒºè·Ÿæˆ‘äº¤æµäº’åŠ¨ï¼Œè¯´è¯´è¿™ä¸ªæ¨¡å—å­¦ä¹ ä¸‹æ¥çš„æ„Ÿå—ï¼Œå¦‚æœè§‰å¾—æ‰‹å†™CPUå¾ˆé…·ï¼Œåˆ«å¿˜äº†åˆ†äº«ç»™èº«è¾¹æ›´å¤šçš„æœ‹å‹ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ12ï¼‰</strong></div><ul>
<li><span>mantra</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è¯¢é—®å°ç¼–ä¸€ä¸ªå°é—®é¢˜ï¼šå­¦åˆ°æ­¤å¤„ mini_cpu å°ç»“äº†ï¼Œè¿˜æœ‰åç»­çš„æ‰©å±•å—ï¼Ÿåç»­ â€œRISC-V æŒ‡ä»¤ç²¾è®²ï¼ˆXï¼‰â€ ç³»åˆ—æ˜¯åœ¨ GCC + QEMU ç¯å¢ƒå®ç°å—ï¼Ÿä¼šå’Œ min_cpu æœ‰å…³è”å—ï¼Ÿè°¢è°¢ï¼</p>2022-08-19</li><br/><li><span>Liu Zheng</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>éœ€è¦æŒ‡å‡ºä¸€ä¸‹ï¼Œå¦‚æœåŒå­¦ç”¨13è®²é‡Œçš„æ–¹æ³•å®‰è£…toolchainçš„è¯ï¼Œéœ€è¦ä½œä»¥ä¸‹ä¿®æ”¹æ‰èƒ½è·‘å‡ºhello worldæ¥ï¼š
1. åœ¨`sim&#47;asm&#47;Makefile`ä¸­ï¼Œéœ€è¦æŠŠæ‰€æœ‰çš„`riscv32`éƒ½æ›¿æ¢æˆ`riscv64`ã€‚è¯¦æƒ…è§12è®²é‡Œé¢çš„multilibéƒ¨åˆ†ã€‚
2. å¦‚æœä½ å’Œæˆ‘ä¸€æ ·ç”¨çš„æ˜¯ubuntu 20.04ï¼Œé‚£ä¹ˆéœ€è¦`mini_cpu&#47;Makefile`é‡Œé¢ï¼ŒæŠŠ`python`æ¢æˆ`python3`ã€‚å› ä¸ºé»˜è®¤ubuntu20.04å¼€å§‹å·²ç»æ²¡æœ‰`python`äº†ã€‚</p>2022-08-24</li><br/><li><span>likejjj</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<p>å¯ä»¥åœ¨fpgaä¸Šé¢è·‘è¿™ä¸ªcpuä¸ï¼Ÿ</p>2022-08-22</li><br/><li><span>é’ç‰ç™½éœ²</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æ‰“ç®—å†™ä¸ªæ±‡ç¼–æä¸€ä¸‹ï¼</p>2022-08-19</li><br/><li><span>ğŸ˜‡</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æ€»çº¿ä½ çš„cpu--&gt;imemçš„imemæ˜¯å•¥æ„æ€å•Š</p>2022-09-26</li><br/><li><span>ğŸ˜‡</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>è€å¸ˆä½ å¥½ï¼Œæˆ‘çš„è¿è¡Œmake asmåæ˜¾ç¤º
make -C .&#47;sim&#47;asm 
make[1]: è¿›å…¥ç›®å½•â€œ&#47;home&#47;qianq&#47;mini_cpu&#47;sim&#47;asmâ€
+ AS src&#47;miniCPU_sim.asm build&#47;miniCPU_sim.o
make[1]: riscv32-unknown-elf-as: Command not found
Makefile:27: recipe for target &#39;build&#47;miniCPU_sim.o&#39; failed
make[1]: *** [build&#47;miniCPU_sim.o] Error 127
make[1]: ç¦»å¼€ç›®å½•â€œ&#47;home&#47;qianq&#47;mini_cpu&#47;sim&#47;asmâ€
Makefile:11: recipe for target &#39;asm&#39; failed
make: *** [asm] Error 2
è¯·é—®è¿™ä¸ªå‡ºé”™æ˜¯ä»€ä¹ˆåŸå› å‘¢</p>2022-08-28</li><br/><li><span>Liu Zheng</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>è€å¸ˆï¼Œæƒ³é—®ä¸€ä¸‹ï¼Œè¿™é‡Œæ±‡ç¼–ä»£ç é‡Œé¢æ²¡å‘é€ä¸€ä¸ªå­—ç¬¦å»¶æ—¶1msæ˜¯ä¸ºäº†åŒ¹é…uartçš„æ³¢ç‰¹ç‡å—ï¼Ÿè¯·é—®è¿™ä¸ªmini cpuçš„ä¸²å£çš„æ³¢ç‰¹ç‡æ˜¯åœ¨å“ªé‡ŒæŒ‡æ˜çš„å•Šï¼Ÿæ˜¯å›ºå®šåœ¨uartçš„verilogä»£ç çš„æŸä¸ªåœ°æ–¹äº†å—ï¼Ÿ</p>2022-08-22</li><br/><li><span>äº‘æµ·</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ä¸ºä»€ä¹ˆæˆ‘è¿è¡Œ make asm çš„æ—¶å€™å‡ºç°è¿™æ ·çš„errorï¼Ÿè°¢è°¢

make -C .&#47;sim&#47;asm 
make[1]: Entering directory &#39;&#47;home&#47;yh&#47;ws&#47;riscv&#47;Geek-time-computer-foundation&#47;lesson06~11&#47;mini_cpu&#47;sim&#47;asm&#39;
+ AS src&#47;miniCPU_sim.asm build&#47;miniCPU_sim.o
make[1]: riscv32-unknown-elf-as: Command not found
Makefile:27: recipe for target &#39;build&#47;miniCPU_sim.o&#39; failed
make[1]: *** [build&#47;miniCPU_sim.o] Error 127
make[1]: Leaving directory &#39;&#47;home&#47;yh&#47;ws&#47;riscv&#47;Geek-time-computer-foundation&#47;lesson06~11&#47;mini_cpu&#47;sim&#47;asm&#39;
Makefile:11: recipe for target &#39;asm&#39; failed
make: *** [asm] Error 2
</p>2022-08-20</li><br/><li><span>TableBear</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>å¥½éš¾o(â•¥ï¹â•¥)o</p>2022-08-19</li><br/><li><span>è‹æµéƒå®“</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>å“ˆä½›ç»“æ„ï¼Ÿ</p>2022-08-19</li><br/><li><span>èŒƒå»·ä¸œ</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<p>è·‘é€šè¿™ä¸ªæ¡ˆä¾‹ï¼Œéœ€è¦ç”¨ubuntuæˆ–centosçš„è™šæ‹Ÿæœºï¼Ÿéœ€è¦å®‰è£…ä»€ä¹ˆå·¥å…·ï¼Ÿ

è¿™äº›èƒ½ä¸èƒ½è¡¥å……è¯´ä¸€ä¸‹ï¼›</p>2024-02-23</li><br/><li><span>æ°¢åŸå­</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<p>è®¡ç®—æœºä¸¤å¤§ä½“ç³»ç»“æ„åˆ†åˆ«æ˜¯å†¯è¯ºä¾æ›¼ä½“ç³»ç»“æ„å’Œå“ˆå¼—ä½“ç³»ç»“æ„ï¼Œå¯ä»¥è‡ªå·±è®¾è®¡ç¬¬ä¸‰ä¸ªä½“ç³»ç»“æ„å—ï¼Ÿ</p>2023-09-13</li><br/>
</ul>