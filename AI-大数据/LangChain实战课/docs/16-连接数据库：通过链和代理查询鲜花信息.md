ä½ å¥½ï¼Œæˆ‘æ˜¯é»„ä½³ï¼Œæ¬¢è¿æ¥åˆ° LangChain å®æˆ˜è¯¾ï¼

ä¸€ç›´ä»¥æ¥ï¼Œåœ¨è®¡ç®—æœºç¼–ç¨‹å’Œæ•°æ®åº“ç®¡ç†é¢†åŸŸï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½éœ€è¦é€šè¿‡ä¸¥æ ¼ã€ä¸“ä¸šä¸”ç»“æ„åŒ–çš„è¯­æ³•æ¥å®Œæˆã€‚è¿™å°±æ˜¯ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ï¼ˆSQLï¼‰ã€‚å½“ä½ æƒ³ä»ä¸€ä¸ªæ•°æ®åº“ä¸­æå–ä¿¡æ¯æˆ–è¿›è¡ŒæŸç§æ“ä½œæ—¶ï¼Œä½ éœ€è¦ä½¿ç”¨è¿™ç§ç‰¹å®šçš„è¯­è¨€æ˜ç¡®åœ°å‘Šè¯‰è®¡ç®—æœºä½ çš„è¦æ±‚ã€‚è¿™ä¸ä»…éœ€è¦æˆ‘ä»¬æ·±å…¥äº†è§£æ­£åœ¨ä½¿ç”¨çš„æŠ€æœ¯ï¼Œè¿˜éœ€è¦å¯¹æ‰€æ“ä½œçš„æ•°æ®æœ‰å……åˆ†çš„äº†è§£ã€‚

![](https://static001.geekbang.org/resource/image/82/0d/829798a55a330518c7c95dcac948890d.png?wh=497x454 "å›¾ç‰‡æ¥æºç½‘ç»œ")

ä½ éœ€è¦æ‹¥æœ‰ä¸€ä¸ªç¨‹åºå‘˜åŸºæœ¬çš„æŠ€èƒ½å’ŒçŸ¥è¯†æ‰èƒ½æœ‰æ•ˆåœ°ä¸è®¡ç®—æœºäº¤äº’ã€‚ä¸è¿‡ï¼Œéšç€äººå·¥æ™ºèƒ½çš„å…´èµ·å’Œå¤§è¯­è¨€æ¨¡å‹çš„å‘å±•ï¼Œæƒ…å†µå¼€å§‹å‘ç”Ÿå˜åŒ–ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬æ­£è¿›å…¥ä¸€ä¸ª**å…¨æ–°çš„ç¼–ç¨‹èŒƒå¼**ï¼Œå…¶ä¸­æœºå™¨å­¦ä¹ å’Œè‡ªç„¶è¯­è¨€å¤„ç†æŠ€æœ¯ä½¿å¾—ä¸è®¡ç®—æœºçš„äº¤äº’å˜å¾—æ›´åŠ è‡ªç„¶ã€‚è¿™æ„å‘³ç€ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ›´åŠ æ¥è¿‘æˆ‘ä»¬æ—¥å¸¸è¯è¯­çš„è‡ªç„¶è¯­è¨€æ¥ä¸è®¡ç®—æœºäº¤æµã€‚ä¾‹å¦‚ï¼Œä¸ç”¨å¤æ‚çš„SQLè¯­å¥æŸ¥è¯¢æ•°æ®åº“ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°é—®ï¼šâ€œè¯·å‘Šè¯‰æˆ‘å»å¹´çš„é”€å”®é¢æ˜¯å¤šå°‘ï¼Ÿâ€ è®¡ç®—æœºèƒ½å¤Ÿç†è§£è¿™ä¸ªé—®é¢˜ï¼Œå¹¶ç»™å‡ºç›¸åº”çš„ç­”æ¡ˆã€‚

è¿™ç§è½¬å˜ä¸ä»…ä½¿å¾—éæŠ€æœ¯äººå‘˜æ›´å®¹æ˜“ä¸è®¡ç®—æœºäº¤äº’ï¼Œè¿˜ä¸ºå¼€å‘è€…æä¾›äº†æ›´å¤§çš„ä¾¿åˆ©æ€§ã€‚ç®€è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬ä»â€œ**å‘Šè¯‰è®¡ç®—æœºæ¯ä¸€æ­¥æ€ä¹ˆåš**â€ï¼Œè½¬å˜ä¸ºâ€œ**å‘Šè¯‰è®¡ç®—æœºæˆ‘ä»¬æƒ³è¦ä»€ä¹ˆ**â€ï¼Œæ•´ä¸ªè¿‡ç¨‹å˜å¾—æ›´åŠ äººæ€§åŒ–å’Œé«˜æ•ˆã€‚

## æ–°çš„æ•°æ®åº“æŸ¥è¯¢èŒƒå¼

ä¸‹é¢è¿™ä¸ªå›¾ï¼Œéå¸¸æ¸…æ™°åœ°è§£é‡Šäº†è¿™ä¸ªä»¥LLMä¸ºé©±åŠ¨å¼•æ“ï¼Œä»è‡ªç„¶è¯­è¨€çš„ï¼ˆæ¨¡ç³Šï¼‰è¯¢é—®ï¼Œåˆ°è‡ªç„¶è¯­è¨€çš„æŸ¥è¯¢ç»“æœè¾“å‡ºçš„æµç¨‹ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ19ï¼‰</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/20/18/1a/5f36bb6e.jpg" width="30px"><span>è¿œæ¸¸</span> ğŸ‘ï¼ˆ5ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>Chain å’Œ Agent æ¥æŸ¥è¯¢æ•°æ®åº“ï¼Œè¿™ä¸¤ç§æ–¹å¼æœ‰ä»€ä¹ˆå¼‚åŒï¼Ÿ
é«˜é“ä¸Šï¼Œæ²¡æœ‰ç¯å¢ƒè¿è¡ŒæŸ¥çœ‹Promptï¼Œä»¥ä¸‹é çŒœå“ˆ
1ã€Chainé‡‡ç”¨ä¸€è½®å¯¹è¯å¾—åˆ°ç»“æœï¼Œæ„å‘³ç€å¦‚æœè¡¨å¤šæ—¶ï¼Œä¼šå‘é€å¾ˆå¤šè¡¨çš„schemaåˆ°llmï¼Œä¸€ä¸ªæ˜¯æµªè´¹tokenï¼Œä¸€ä¸ªæ˜¯å¯èƒ½è¶…é•¿ã€‚
2ã€Agenté‡‡ç”¨ReActæ–¹å¼é€æ­¥æ¨ç†æ‰§è¡Œï¼Œå¤šè½®å¯¹è¯å¾—åˆ°ç»“æœï¼Œä¸€ä¸ªæ˜¯å‡†ç¡®æ€§é«˜ï¼Œä¸€ä¸ªæ˜¯åªéœ€å°†ä¸Šè½®å¯¹è¯æ¨ç†å‡ºæ¥çš„éœ€è¦çš„è¡¨çš„schemaå‘é€åˆ°æœåŠ¡ç«¯ï¼ŒèŠ‚çœtokençš„åŒæ—¶é¿å…tokenè¶…å‡ºã€‚
è¿™å¼•èµ·äº†å¦å¤–ä¸€ä¸ªæç«¯åœºæ™¯çš„æ€è€ƒï¼Œå¦‚æœéœ€è¦3è¡¨ç”šè‡³æ›´å¤šè¡¨è”æŸ¥ï¼Œä¸”è¿™3è¡¨éƒ½æœ‰ä¸Šç™¾ä¸ªå­—æ®µï¼ˆåœ¨å¤§å‹ä¸šåŠ¡ç³»ç»Ÿå¦‚ERPè¿™å¹¶ä¸å¤¸å¼ ï¼‰ï¼Œå¯èƒ½è¿˜æ˜¯ä¼šå¯¼è‡´tokenè¶…é•¿ã€‚

ç­‰æœ‰ç¯å¢ƒè·‘ä¸€ä¸‹çœ‹çœ‹Promptå’Œå¯¹è¯è½®æ¬¡éªŒè¯ä¸€ä¸‹çŒœæƒ³~</div>2023-10-29</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIfCY2mvbZ2Po4efYBhMJPacb9mlOicNI6Us4ph3ianrkGlUcop8ZlzN6QiaDrnvFcNeaAfwP7XAv5fw/132" width="30px"><span>even</span> ğŸ‘ï¼ˆ5ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>è€å¸ˆï¼Œä½ å¥½ã€‚è¯·é—®å¦‚ä½•å¯¹å¤šæ•°æ®åº“çš„å¤šè¡¨è¿›è¡ŒæŸ¥è¯¢ï¼Œè¿™å—çš„å·¥ä½œæ–¹ä¾¿è¯¦ç»†ä»‹ç»ä¸‹å—ï¼Ÿ</div>2023-10-19</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKhuGLVRYZibOTfMumk53Wn8Q0Rkg0o6DzTicbibCq42lWQoZ8lFeQvicaXuZa7dYsr9URMrtpXMVDDww/132" width="30px"><span>hello</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆï¼Œè¯·æ•™ä¸€ä¸ªé—®é¢˜ï¼Œä¸€èˆ¬çš„åŸºç¡€æ¨¡å‹éƒ½å…·å¤‡ä¸€å®šçš„SQLèƒ½åŠ›ï¼Œæ„Ÿè§‰ç”¨SQLDatabaseChain&#47;SQL Agentå¹¶æ²¡æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Œè€å¸ˆèƒ½å¦å¸®å¿™è§£ç­”ä¸‹ï¼Œä¸ºå•¥è¿˜ä¼šå‡ºç°ç±»SQLDatabaseChain&#47;SQL Agentç­‰å·¥å…·æ¥è§£å†³æ–‡æœ¬è½¬SQLçš„èƒ½åŠ›ï¼Ÿ</div>2023-10-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/21/67/fe/5d17661a.jpg" width="30px"><span>æ‚Ÿå°˜</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆï¼Œå¦‚ä½•ä½¿LLMç†è§£æˆ‘å½“å‰çš„è¡¨çš„å­—æ®µä»¥åŠè¡¨å…³ç³»å‘¢ï¼Ÿç”¨ä»€ä¹ˆæ–¹å¼å‘Šè¯‰LLMï¼Œä»è€Œä½¿å®ƒèƒ½å¤Ÿç†è§£æˆ‘çš„ä¸šåŠ¡èƒŒæ™¯ï¼Ÿ</div>2023-11-12</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIfCY2mvbZ2Po4efYBhMJPacb9mlOicNI6Us4ph3ianrkGlUcop8ZlzN6QiaDrnvFcNeaAfwP7XAv5fw/132" width="30px"><span>even</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆï¼Œè¯·é—®å¤šæ•°æ®åº“ï¼Œå¤šè¡¨å¦‚ä½•å»åšï¼Œæœ‰æ²¡æœ‰ç›¸å…³çš„æœ€ä½³å®è·µå’Œå‚è€ƒèµ„æ–™</div>2023-10-19</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Ge7uhlEVxicQT73YuomDPrVKI8UmhqxKWrhtO5GMNlFjrHWfd3HAjgaSribR4Pzorw8yalYGYqJI4VPvUyPzicSKg/132" width="30px"><span>é™ˆä¸œ</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆå¥½ã€‚å¦‚ä½•æœ¬åœ°åŒ–éƒ¨ç½²langchainå’Œagentï¼Œå¯ä»¥éšæ—¶äº¤äº’å‘¢ï¼Ÿè¯¾ç¨‹ä¸­éƒ½æ˜¯åœ¨ä¸€ä¸ªå›åˆçš„å¯¹è¯ï¼Œå¦‚ä½•å±•å¼€æŒç»­çš„å¤šä¸ªå¯¹è¯ï¼Ÿè°¢è°¢è€å¸ˆçš„æŒ‡å¼•å’Œè§£ç­”ã€‚</div>2023-10-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/21/67/fe/5d17661a.jpg" width="30px"><span>æ‚Ÿå°˜</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆï¼Œæˆ‘æƒ³ä½¿ç”¨ä¸Šè¿°èŒƒå¼ï¼Œä½¿ç”¨LangChainæ¡†æ¶è®©ESå’ŒLLMç»“åˆï¼Œç„¶åå®ç°æœç´¢ï¼ˆæ ¹æ®æŒ‡å®šæ¡ä»¶ï¼‰ã€æ¨èï¼ˆæ ¹æ®æŒ‡å®šå…³é”®è¯ï¼‰ã€æ’åºçš„åŠŸèƒ½ï¼Œè¯¥åˆ†å“ªå‡ ä¸ªæ­¥éª¤å®ç°ï¼Ÿ</div>2023-11-12</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/270T9KAFd4oCxXXB1giaMDaJuTQVib8gPt77VkM5dbS3hW60kwTNnxMYpVibwWVdnASCrymBbwT7HI77URia0KUylw/132" width="30px"><span>Geek_7ee455</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆè¿™ç§sqlæŸ¥è¯¢çš„é—®ç­”å’Œæ–‡æ¡£é—®ç­”æ€ä¹ˆç»“åˆèµ·æ¥ç”¨å‘¢</div>2023-11-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2f/fb/37/791d0f5e.jpg" width="30px"><span>Monin</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ4ï¼‰<div>è€å¸ˆ  å’¨è¯¢ä¸‹ å¯¹äºä¸€äº›ä¸šåŠ¡è¡¨å¦‚mysqlç­‰å«æœ‰ç›¸ä¼¼ä¸šåŠ¡è¯­ä¹‰çš„è¡¨å¾ˆå¤š  åœ¨LLMæ‰§è¡Œä¸šåŠ¡SQLæ—¶æœ‰æ—¶ä¼šå®šä½åˆ°é”™è¯¯çš„è¡¨  æœ‰ä»€ä¹ˆå¥½çš„è§£æ³•è®©agentæ—¢è¿”å›æœ€ç»ˆçš„ç»“æœ åŒæ—¶ä¹ŸæŠŠæ‰§è¡Œçš„SQLè¯­å¥ä¹Ÿè¿”å›ï¼Ÿ</div>2023-10-25</li><br/><li><img src="" width="30px"><span>yanyu-xin</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>æˆ‘ç”¨é€šä¹‰åƒé—®æ¨¡å‹ qwen-turbo ä»£æ›¿ OpenAI ã€‚ä»£ç è¿è¡ŒåŸºæœ¬å¯ä»¥ã€‚åªæ˜¯åœ¨è¿è¡Œ response = db_chain.run(&quot;æœ‰å¤šå°‘ç§çš„é²œèŠ±ï¼Ÿ&quot;) æ—¶:

 #1.  OpenAI èƒ½å°†â€œå¤šå°‘ç§â€è§£ç­”ä¸ºä¸åŒ Name çš„èŠ±ï¼Œæ˜¯&quot; SQLQuery:SELECT COUNT(DISTINCT Name) FROM Flowers &quot;ï¼ŒæŸ¥è¯¢æ˜¯æœ‰5ç§ä¸åŒçš„é²œèŠ±ã€‚

#2.  è€Œåƒé—®æ¨¡å‹å°† â€œå¤šå°‘ç§â€è§£ç­”ä¸ºä¸åŒ Type  çš„èŠ±ã€‚å¯¼è‡´çš„æŸ¥è¯¢ç»“æœæ˜¯ ï¼š

&gt; Entering new SQLDatabaseChain chain...
æœ‰å¤šå°‘ç§ä¸åŒçš„é²œèŠ±ï¼Ÿ
SQLQuery:SELECT COUNT(DISTINCT Type) FROM Flowers;
SQLResult: [(1,)]
Answer:æœ‰1ç§ä¸åŒçš„é²œèŠ±ã€‚
&gt; Finished chain.
æœ‰1ç§ä¸åŒçš„é²œèŠ±ã€‚

#3.  è¿™å°±æ˜¯è¯¾ç¨‹é‡Œè€å¸ˆè¯´çš„â€œæ¨¡ç³Šæ€§çš„é—®é¢˜ï¼šè‡ªç„¶è¯­è¨€æœ¬èº«æ˜¯æ¨¡ç³Šçš„ï¼Œæœºå™¨å¿…é¡»èƒ½å¤Ÿå‡†ç¡®åœ°è§£é‡Šè¿™ç§æ¨¡ç³Šæ€§ï¼Œå¹¶åœ¨å¿…è¦æ—¶å¯»æ±‚æ¾„æ¸…â€ã€‚ç”¨äºæœºå™¨åªæ˜¯ç›´æ¥ä½¿ç”¨â€œç§â€å¯¹åº”çš„è‹±è¯­â€œTypeâ€ï¼Œè€Œæ²¡æœ‰ç†è§£è¯­è¨€ä¸­â€œç§â€çš„å®é™…å«ä¹‰è¿˜åŒ…æ‹¬äº†ä¸åŒ Name çš„ã€‚
#4.  è¿™å°±æ˜¯è€å¸ˆè¯´çš„â€œè¿‡åº¦ä¾èµ–ï¼šå¦‚æœè¿‡äºä¾èµ–æœºå™¨ä¸ºæˆ‘ä»¬åšå†³ç­–ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯èƒ½ä¼šå¤±å»å¯¹æ•°æ®çš„æ·±å…¥äº†è§£å’Œå¯¹ç»“æœçš„è´¨ç–‘â€ã€‚å¦‚æœæˆ‘æ²¡æœ‰æ ¡å¯¹æ•°æ®ï¼Œç®€å•å¥—ç”¨äº†æœºå™¨ç»“æœï¼Œæ²¡æœ‰æ·±å…¥æ€è€ƒå°±ä¼šå‡ºç°é”™è¯¯ã€‚</div>2024-08-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/27/94/f620a3a9.jpg" width="30px"><span>å†¬ç“œ</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>å¤§æ¨¡å‹æ€ä¹ˆç”Ÿæˆè¿™ä¸ªsqlè¯­å¥çš„å‘¢ã€‚å…·ä½“çš„è¯´ï¼Œå¤§æ¨¡å‹æ€ä¹ˆçŸ¥é“è¦è®¿é—®æ•°æ®åº“ä¸­çš„å“ªå¼ è¡¨ï¼Œä½¿ç”¨å“ªä¸ªå­—æ®µå‘¢ã€‚</div>2024-04-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg" width="30px"><span>é»„ä½³</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>ä»£ç å·²ç»æ›´æ–°ï¼Œhttps:&#47;&#47;github.com&#47;huangjia2019&#47;langchain
ç¥åŒå­¦ä»¬å­¦ä¹ æ„‰å¿«ï¼Œå¤šå¤šåˆ†äº«LangChainå­¦ä¹ å¿ƒå¾—æ„Ÿæ‚Ÿã€‚ä¼—äººæ‹¾æç«ç„°é«˜ï¼
</div>2023-10-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/bd/91/80398dcc.jpg" width="30px"><span>é‡‘è‰²æ—­å…‰</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>Agent æç¤ºè¯ ï¼ˆéƒ¨åˆ†æˆªæ–­ï¼Œè¶…é•¿é™åˆ¶ï¼‰ï¼š
You are an agent designed to interact with a SQL database.
Given an input question, create a syntactically correct sqlite query to run, then look at the results of the query and return the answer.
Unless the user specifies a specific number of examples they wish to obtain, always limit your query to at most 10 results.You can order the results by a relevant column to return the most interesting examples in the database.
Never query for all the columns from a specific table, only ask for the relevant columns given the question.
You have access to tools for interacting with the database.


sql_db_query - Input to this tool is a detailed and correct SQL query, output is a result from the database. 
sql_db_schema - Input to this tool is a comma-separated list of tables, output is the schema and sample rows for those tables. 
sql_db_list_tables - Input is an empty string, output is a comma-separated list of tables in the database.
sql_db_query_checker - Use this tool to double check if your query is correct before executing it. 

Use the following format:

Question: the input question you must answer
Thought: you should always think about what to do
Action: the action to take, should be one of [sql_db_query, sql_db_schema, sql_db_list_tables, sql_db_query_checker]
Action Input: the input to the action
Observation: the result of the action
... (this Thought&#47;Action&#47;Action Input&#47;Observation can repeat N times)
Thought: I now know the final answer
Final Answer: the final answer to the original input question

Begin!

Question: å“ªç§é²œèŠ±çš„å­˜è´§æ•°é‡æœ€å°‘ï¼Ÿ
Thought: I should look at t the database to see what I can query.  Then I should query the schema of the most relevant tables.&quot;</div>2024-10-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/bd/91/80398dcc.jpg" width="30px"><span>é‡‘è‰²æ—­å…‰</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>Chain æç¤ºè¯ï¼š
&quot;You are a SQLite expert. Given an input question, first create a syntactically correct SQLite query to run, then look at the results of the query and return the answer to the input question.
Unless the user specifies in the question a specific number of examples to obtain, query for at most 5 results using the LIMIT clause as per SQLite. You can order the results to return the most informative data in the database.
Never query for all columns from a table. You must query only the columns that are needed to answer the question. Wrap each column name in double quotes (\&quot;) to denote them as delimited identifiers.
Pay attention to use only the column names you can see in the tables below. Be careful to not query for columns that do not exist. Also, pay attention to which column is in which table.
Pay attention to use date(&#39;now&#39;) function to get the current date, if the question involves \&quot;today\&quot;.

Use the following format:

Question: Question here
SQLQuery: SQL Query to run
SQLResult: Result of the SQLQuery
Answer: Final answer here
Only use the following tables:

CREATE TABLE \&quot;Flowers\&quot; (
\t\&quot;ID\&quot; INTEGER, \t\&quot;Name\&quot; TEXT NOT NULL, 
\t\&quot;Type\&quot; TEXT NOT NULL, 
\t\&quot;Source\&quot; TEXT NOT NULL, 
\t\&quot;PurchasePrice\&quot; REAL, 
\t\&quot;SalePrice\&quot; REAL, 
\t\&quot;StockQuantity\&quot; INTEGER, 
\t\&quot;SoldQuantity\&quot; INTEGER, 
\t\&quot;ExpiryDate\&quot; DATE,
\t\&quot;Description\&quot; TEXT, 
\t\&quot;EntryDate\&quot; DATE DEFAULT CURRENT_DATE, 
\tPRIMARY KEY (\&quot;ID\&quot;)
)

&#47;*
3 rows from Flowers table:
ID\tName\tType\tSource\tPurchasePrice\tSalePrice\tStockQuantity\tSoldQuantity\tExpiryDate\tDescription\tEntryDate
1\tRose\tFlower\tFrance\t1.2\t2.5\t100\t10\t2023-12-31\tA beautiful red rose\t2024-10-28
2\tTulip\tFlower\tNetherlands\t0.8\t2.0\t150\t25\t2023-12-31\tA colorful tulip\t2024-10-28
3\tLily\tFlower\tChina\t1.5\t3.0\t80\t5\t2023-12-31\tAn elegant white lily\t2024-10-28
*&#47;

Question: æœ‰å¤šå°‘ç§ä¸åŒçš„é²œèŠ±

SQLQuery:&quot;
</div>2024-10-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/bd/91/80398dcc.jpg" width="30px"><span>é‡‘è‰²æ—­å…‰</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>Chain å’Œ Agent æç¤ºè¯çš„ä¸»è¦åŒºåˆ«åœ¨äºï¼š
1. Chain é»˜è®¤çš„è¡Œä¸ºå°±æ˜¯å°†è¡¨ç»“æ„æ’å…¥æç¤ºè¯
2. Agent é€šè¿‡ReActçš„æ€è€ƒè¿‡ç¨‹è·å–è¡¨ç»“æ„æ’å…¥æç¤ºè¯
</div>2024-10-29</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKr3ZPRg8ECLpOkfpN1ny8HGV8DIkQ0fo4blKFSQgK0x76C5WiaxFXQpoIqTHWEV3bia603bBmtwZcg/132" width="30px"><span>å‹¤å°ç </span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>ä½³å“¥å¥½ã€‚ä½¿ç”¨ chain å’Œ agent æŸ¥è¯¢ DB æ—¶å‘ç°LLMè¾“å‡ºçš„å†…å®¹ä¸ç¨³å®šæˆ–æœ‰SQLé”™è¯¯ï¼Œä¼šé€ æˆæ•´ä¸ªæµç¨‹çš„å¼‚å¸¸ã€‚è¿™ç§æƒ…å†µä¸‹é€šå¸¸åº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿå¦‚æœæ˜¯ç”Ÿäº§ç¯å¢ƒä¸­å­˜åœ¨è¿™æ ·çš„é—®é¢˜ï¼Œå°±ä¸èƒ½ç¨³å®šå¯¹å¤–æä¾›æœåŠ¡ï¼Œé‚£ä¹ˆæ­¤åŠŸèƒ½å°±å¤±å»æ„ä¹‰äº†ã€‚

æœ¬åœ°ç¯å¢ƒï¼š
langchain == 0.2.12
Ollama éƒ¨ç½² llama3.1:8b å’Œ qwen2:7b

äº§ç”Ÿçš„é”™è¯¯å¦‚ï¼š
# è¯·æ±‚å¹³å‡ä»·æ ¼æ—¶
&gt; Entering new SQLDatabaseChain chain...
å¹³å‡é”€å”®ä»·æ ¼æ˜¯å¤šå°‘ï¼Ÿ
SQLQuery:SELECT AVG(&quot;SalePrice&quot;) FROM &quot;Flowers

# æ±‚æ³•å›½è¿›å£é²œèŠ±ç§ç±»æ•°æ—¶
&gt; Entering new SQLDatabaseChain chain...
ä»æ³•å›½è¿›å£çš„é²œèŠ±æœ‰å¤šå°‘ç§ï¼Ÿ
SQLQuery:SELECT COUNT(&quot;ID&quot;) FROM Flowers WHERE &quot;Source&quot; = &#39;France

# å¹³å‡é”€å”®ä»·æ ¼æ˜¯å¤šå°‘ï¼Ÿ
ValueError: An output parsing error occurred. In order to pass this error back to the agent and have it try again, pass `handle_parsing_errors=True` to the AgentExecutor. This is the error: Parsing LLM output produced both a final answer and a parse-able action:: I know the final answer by looking at the schema of Flowers table and relevant columns.

Final Answer: The average sale price is calculated as follows:

Average Sale Price = Sum(SalePrice) &#47; Count(ID)

To get this value, I can query the &#39;SalePrice&#39; column in the &#39;Flowers&#39; table:

Action: sql_db_query_checker
Action Input: 
```
SELECT AVG(SalePrice)
FROM Flowers;
``
</div>2024-08-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg" width="30px"><span>å¼ ç”³å‚²</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>ç¬¬16è®²æ‰“å¡~
ç‰¹åˆ«è®¤åŒè€å¸ˆçš„è§‚ç‚¹ï¼šè‡ªç„¶è¯­è¨€å’Œç¼–ç¨‹è¯­è¨€ä¹‹é—´çš„ç•Œé™æ­£åœ¨æ¶ˆå¤±ï¼Œæœªæ¥ä¹Ÿè®¸ä¸å†éœ€è¦ç¨‹åºå‘˜è¿™ä¸ªèŒä¸šï¼Œæˆ–è€…è¯´æ¯ä¸ªäººéƒ½å¯ä»¥æ˜¯ç¨‹åºå‘˜~</div>2024-07-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/d6/59/6b7ce4f0.jpg" width="30px"><span>å­™å¿—æƒ </span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>è€å¸ˆï¼Œæˆ‘çœ‹sqlDatabaseç›®å‰ä¸æ”¯æŒDorisï¼Œå¦‚æœè¦ä½¿ç”¨æŸ¥è¯¢Dorisçš„è¯ï¼Œéœ€è¦è‡ªå·±å¦‚ä½•æ“ä½œå‘¢</div>2024-07-12</li><br/><li><img src="" width="30px"><span>Geek_db658d</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>è€å¸ˆ æˆ‘ä»¬æ˜¯å¦å¯ä»¥åˆ†åˆ«ç”¨ä¸¤ä¸ªå¤§æ¨¡å‹ï¼Œä¸€ä¸ªå¾®è°ƒåä¸“é—¨ç”Ÿæˆsqlï¼Œä¸€ä¸ªè‡ªç„¶å¯¹è¯æ¨¡å‹å°†sqlæŸ¥è¯¢ç»“æœè¿”å›ã€‚ç”¨transformé“¾åŒ…è£¹SQLDatabaseChain.from_llmæˆ–è€…agentï¼Œå†ç”¨sequencialé“¾é¡ºåºè°ƒç”¨åç»­çš„è¿”å›è‡ªç„¶è¯­è¨€</div>2024-04-13</li><br/>
</ul>