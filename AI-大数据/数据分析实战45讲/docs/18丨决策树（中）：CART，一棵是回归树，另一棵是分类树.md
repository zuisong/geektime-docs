ä¸ŠèŠ‚è¯¾æˆ‘ä»¬è®²äº†å†³ç­–æ ‘ï¼ŒåŸºäºä¿¡æ¯åº¦é‡çš„ä¸åŒæ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå†³ç­–æ ‘åˆ†ä¸ºID3ç®—æ³•ã€C4.5ç®—æ³•å’ŒCARTç®—æ³•ã€‚ä»Šå¤©æˆ‘æ¥å¸¦ä½ å­¦ä¹ CARTç®—æ³•ã€‚CARTç®—æ³•ï¼Œè‹±æ–‡å…¨ç§°å«åšClassification And Regression Treeï¼Œä¸­æ–‡å«åšåˆ†ç±»å›å½’æ ‘ã€‚ID3å’ŒC4.5ç®—æ³•å¯ä»¥ç”ŸæˆäºŒå‰æ ‘æˆ–å¤šå‰æ ‘ï¼Œè€ŒCARTåªæ”¯æŒäºŒå‰æ ‘ã€‚åŒæ—¶CARTå†³ç­–æ ‘æ¯”è¾ƒç‰¹æ®Šï¼Œæ—¢å¯ä»¥ä½œåˆ†ç±»æ ‘ï¼Œåˆå¯ä»¥ä½œå›å½’æ ‘ã€‚

é‚£ä¹ˆä½ é¦–å…ˆéœ€è¦äº†è§£çš„æ˜¯ï¼Œä»€ä¹ˆæ˜¯åˆ†ç±»æ ‘ï¼Œä»€ä¹ˆæ˜¯å›å½’æ ‘å‘¢ï¼Ÿ

æˆ‘ç”¨ä¸‹é¢çš„è®­ç»ƒæ•°æ®ä¸¾ä¸ªä¾‹å­ï¼Œä½ èƒ½çœ‹åˆ°ä¸åŒèŒä¸šçš„äººï¼Œä»–ä»¬çš„å¹´é¾„ä¸åŒï¼Œå­¦ä¹ æ—¶é—´ä¹Ÿä¸åŒã€‚å¦‚æœæˆ‘æ„é€ äº†ä¸€æ£µå†³ç­–æ ‘ï¼Œæƒ³è¦åŸºäºæ•°æ®åˆ¤æ–­è¿™ä¸ªäººçš„èŒä¸šèº«ä»½ï¼Œè¿™ä¸ªå°±å±äºåˆ†ç±»æ ‘ï¼Œå› ä¸ºæ˜¯ä»å‡ ä¸ªåˆ†ç±»ä¸­æ¥åšé€‰æ‹©ã€‚å¦‚æœæ˜¯ç»™å®šäº†æ•°æ®ï¼Œæƒ³è¦é¢„æµ‹è¿™ä¸ªäººçš„å¹´é¾„ï¼Œé‚£å°±å±äºå›å½’æ ‘ã€‚

![](https://static001.geekbang.org/resource/image/af/cf/af89317aa55ac3b9f068b0f370fcb9cf.png?wh=624%2A259)  
åˆ†ç±»æ ‘å¯ä»¥å¤„ç†ç¦»æ•£æ•°æ®ï¼Œä¹Ÿå°±æ˜¯æ•°æ®ç§ç±»æœ‰é™çš„æ•°æ®ï¼Œå®ƒè¾“å‡ºçš„æ˜¯æ ·æœ¬çš„ç±»åˆ«ï¼Œè€Œå›å½’æ ‘å¯ä»¥å¯¹è¿ç»­å‹çš„æ•°å€¼è¿›è¡Œé¢„æµ‹ï¼Œä¹Ÿå°±æ˜¯æ•°æ®åœ¨æŸä¸ªåŒºé—´å†…éƒ½æœ‰å–å€¼çš„å¯èƒ½ï¼Œå®ƒè¾“å‡ºçš„æ˜¯ä¸€ä¸ªæ•°å€¼ã€‚

## CARTåˆ†ç±»æ ‘çš„å·¥ä½œæµç¨‹

é€šè¿‡ä¸Šä¸€è®²ï¼Œæˆ‘ä»¬çŸ¥é“å†³ç­–æ ‘çš„æ ¸å¿ƒå°±æ˜¯å¯»æ‰¾çº¯å‡€çš„åˆ’åˆ†ï¼Œå› æ­¤å¼•å…¥äº†çº¯åº¦çš„æ¦‚å¿µã€‚åœ¨å±æ€§é€‰æ‹©ä¸Šï¼Œæˆ‘ä»¬æ˜¯é€šè¿‡ç»Ÿè®¡â€œä¸çº¯åº¦â€æ¥åšåˆ¤æ–­çš„ï¼ŒID3æ˜¯åŸºäºä¿¡æ¯å¢ç›Šåšåˆ¤æ–­ï¼ŒC4.5åœ¨ID3çš„åŸºç¡€ä¸Šåšäº†æ”¹è¿›ï¼Œæå‡ºäº†ä¿¡æ¯å¢ç›Šç‡çš„æ¦‚å¿µã€‚å®é™…ä¸ŠCARTåˆ†ç±»æ ‘ä¸C4.5ç®—æ³•ç±»ä¼¼ï¼Œåªæ˜¯å±æ€§é€‰æ‹©çš„æŒ‡æ ‡é‡‡ç”¨çš„æ˜¯åŸºå°¼ç³»æ•°ã€‚

ä½ å¯èƒ½åœ¨ç»æµå­¦ä¸­å¬è¿‡è¯´åŸºå°¼ç³»æ•°ï¼Œå®ƒæ˜¯ç”¨æ¥è¡¡é‡ä¸€ä¸ªå›½å®¶æ”¶å…¥å·®è·çš„å¸¸ç”¨æŒ‡æ ‡ã€‚å½“åŸºå°¼ç³»æ•°å¤§äº0.4çš„æ—¶å€™ï¼Œè¯´æ˜è´¢å¯Œå·®å¼‚æ‚¬æ®Šã€‚åŸºå°¼ç³»æ•°åœ¨0.2-0.4ä¹‹é—´è¯´æ˜åˆ†é…åˆç†ï¼Œè´¢å¯Œå·®è·ä¸å¤§ã€‚

åŸºå°¼ç³»æ•°æœ¬èº«ååº”äº†æ ·æœ¬çš„ä¸ç¡®å®šåº¦ã€‚å½“åŸºå°¼ç³»æ•°è¶Šå°çš„æ—¶å€™ï¼Œè¯´æ˜æ ·æœ¬ä¹‹é—´çš„å·®å¼‚æ€§å°ï¼Œä¸ç¡®å®šç¨‹åº¦ä½ã€‚åˆ†ç±»çš„è¿‡ç¨‹æœ¬èº«æ˜¯ä¸€ä¸ªä¸ç¡®å®šåº¦é™ä½çš„è¿‡ç¨‹ï¼Œå³çº¯åº¦çš„æå‡è¿‡ç¨‹ã€‚æ‰€ä»¥CARTç®—æ³•åœ¨æ„é€ åˆ†ç±»æ ‘çš„æ—¶å€™ï¼Œä¼šé€‰æ‹©åŸºå°¼ç³»æ•°æœ€å°çš„å±æ€§ä½œä¸ºå±æ€§çš„åˆ’åˆ†ã€‚

æˆ‘ä»¬æ¥ä¸‹æ¥è¯¦è§£äº†è§£ä¸€ä¸‹åŸºå°¼ç³»æ•°ã€‚åŸºå°¼ç³»æ•°ä¸å¥½æ‡‚ï¼Œä½ æœ€å¥½è·Ÿç€ä¾‹å­ä¸€èµ·æ‰‹åŠ¨è®¡ç®—ä¸‹ã€‚

å‡è®¾tä¸ºèŠ‚ç‚¹ï¼Œé‚£ä¹ˆè¯¥èŠ‚ç‚¹çš„GINIç³»æ•°çš„è®¡ç®—å…¬å¼ä¸ºï¼š

![](https://static001.geekbang.org/resource/image/f9/89/f9bb4cce5b895499cabc714eb372b089.png?wh=463%2A94)  
è¿™é‡Œp(Ck|t)è¡¨ç¤ºèŠ‚ç‚¹tå±äºç±»åˆ«Ckçš„æ¦‚ç‡ï¼ŒèŠ‚ç‚¹tçš„åŸºå°¼ç³»æ•°ä¸º1å‡å»å„ç±»åˆ«Ckæ¦‚ç‡å¹³æ–¹å’Œã€‚

é€šè¿‡ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬è®¡ç®—ä¸€ä¸‹ä¸¤ä¸ªé›†åˆçš„åŸºå°¼ç³»æ•°åˆ†åˆ«ä¸ºå¤šå°‘ï¼š

é›†åˆ1ï¼š6ä¸ªéƒ½å»æ‰“ç¯®çƒï¼›

é›†åˆ2ï¼š3ä¸ªå»æ‰“ç¯®çƒï¼Œ3ä¸ªä¸å»æ‰“ç¯®çƒã€‚

é’ˆå¯¹é›†åˆ1ï¼Œæ‰€æœ‰äººéƒ½å»æ‰“ç¯®çƒï¼Œæ‰€ä»¥p(Ck|t)=1ï¼Œå› æ­¤GINI(t)=1-1=0ã€‚

é’ˆå¯¹é›†åˆ2ï¼Œæœ‰ä¸€åŠäººå»æ‰“ç¯®çƒï¼Œè€Œå¦ä¸€åŠä¸å»æ‰“ç¯®çƒï¼Œæ‰€ä»¥ï¼Œp(C1|t)=0.5ï¼Œp(C2|t)=0.5ï¼ŒGINI(t)=1-ï¼ˆ0.5\*0.5+0.5\*0.5ï¼‰=0.5ã€‚

é€šè¿‡ä¸¤ä¸ªåŸºå°¼ç³»æ•°ä½ å¯ä»¥çœ‹å‡ºï¼Œé›†åˆ1çš„åŸºå°¼ç³»æ•°æœ€å°ï¼Œä¹Ÿè¯æ˜æ ·æœ¬æœ€ç¨³å®šï¼Œè€Œé›†åˆ2çš„æ ·æœ¬ä¸ç¨³å®šæ€§æ›´å¤§ã€‚

åœ¨CARTç®—æ³•ä¸­ï¼ŒåŸºäºåŸºå°¼ç³»æ•°å¯¹ç‰¹å¾å±æ€§è¿›è¡ŒäºŒå…ƒåˆ†è£‚ï¼Œå‡è®¾å±æ€§Aå°†èŠ‚ç‚¹Dåˆ’åˆ†æˆäº†D1å’ŒD2ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://static001.geekbang.org/resource/image/69/9a/69a90a43146898150a0de0811c6fef9a.jpg?wh=1854%2A887)  
èŠ‚ç‚¹Dçš„åŸºå°¼ç³»æ•°ç­‰äºå­èŠ‚ç‚¹D1å’ŒD2çš„å½’ä¸€åŒ–åŸºå°¼ç³»æ•°ä¹‹å’Œï¼Œç”¨å…¬å¼è¡¨ç¤ºä¸ºï¼š

![](https://static001.geekbang.org/resource/image/10/1e/107fed838cb75df62eb149499db20c1e.png?wh=571%2A88)  
å½’ä¸€åŒ–åŸºå°¼ç³»æ•°ä»£è¡¨çš„æ˜¯æ¯ä¸ªå­èŠ‚ç‚¹çš„åŸºå°¼ç³»æ•°ä¹˜ä»¥è¯¥èŠ‚ç‚¹å æ•´ä½“çˆ¶äº²èŠ‚ç‚¹Dä¸­çš„æ¯”ä¾‹ã€‚

ä¸Šé¢æˆ‘ä»¬å·²ç»è®¡ç®—äº†é›†åˆD1å’Œé›†åˆD2çš„GINIç³»æ•°ï¼Œå¾—åˆ°ï¼š  
![](https://static001.geekbang.org/resource/image/aa/0c/aa423c65b32bded13212b7e20fb65a0c.png?wh=354%2A91)  
![](https://static001.geekbang.org/resource/image/09/77/092a0ea87aabc5da482ff8a992691b77.png?wh=366%2A80)

æ‰€ä»¥åœ¨å±æ€§Açš„åˆ’åˆ†ä¸‹ï¼ŒèŠ‚ç‚¹Dçš„åŸºå°¼ç³»æ•°ä¸ºï¼š

![](https://static001.geekbang.org/resource/image/3c/f8/3c08d5cd66a8ea098c397e14f1469ff8.png?wh=635%2A83)

èŠ‚ç‚¹Dè¢«å±æ€§Aåˆ’åˆ†åçš„åŸºå°¼ç³»æ•°è¶Šå¤§ï¼Œæ ·æœ¬é›†åˆçš„ä¸ç¡®å®šæ€§è¶Šå¤§ï¼Œä¹Ÿå°±æ˜¯ä¸çº¯åº¦è¶Šé«˜ã€‚

## å¦‚ä½•ä½¿ç”¨CARTç®—æ³•æ¥åˆ›å»ºåˆ†ç±»æ ‘

é€šè¿‡ä¸Šé¢çš„è®²è§£ä½ å¯ä»¥çŸ¥é“ï¼ŒCARTåˆ†ç±»æ ‘å®é™…ä¸Šæ˜¯åŸºäºåŸºå°¼ç³»æ•°æ¥åšå±æ€§åˆ’åˆ†çš„ã€‚åœ¨Pythonçš„sklearnä¸­ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦åˆ›å»ºCARTåˆ†ç±»æ ‘ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨DecisionTreeClassifierè¿™ä¸ªç±»ã€‚åˆ›å»ºè¿™ä¸ªç±»çš„æ—¶å€™ï¼Œé»˜è®¤æƒ…å†µä¸‹criterionè¿™ä¸ªå‚æ•°ç­‰äºginiï¼Œä¹Ÿå°±æ˜¯æŒ‰ç…§åŸºå°¼ç³»æ•°æ¥é€‰æ‹©å±æ€§åˆ’åˆ†ï¼Œå³é»˜è®¤é‡‡ç”¨çš„æ˜¯CARTåˆ†ç±»æ ‘ã€‚

ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥ç”¨CARTåˆ†ç±»æ ‘ï¼Œç»™irisæ•°æ®é›†æ„é€ ä¸€æ£µåˆ†ç±»å†³ç­–æ ‘ã€‚irisè¿™ä¸ªæ•°æ®é›†ï¼Œæˆ‘åœ¨Pythonå¯è§†åŒ–ä¸­è®²åˆ°è¿‡ï¼Œå®é™…ä¸Šåœ¨sklearnä¸­ä¹Ÿè‡ªå¸¦äº†è¿™ä¸ªæ•°æ®é›†ã€‚åŸºäºirisæ•°æ®é›†ï¼Œæ„é€ CARTåˆ†ç±»æ ‘çš„ä»£ç å¦‚ä¸‹ï¼š

```
# encoding=utf-8
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score
from sklearn.tree import DecisionTreeClassifier
from sklearn.datasets import load_iris
# å‡†å¤‡æ•°æ®é›†
iris=load_iris()
# è·å–ç‰¹å¾é›†å’Œåˆ†ç±»æ ‡è¯†
features = iris.data
labels = iris.target
# éšæœºæŠ½å–33%çš„æ•°æ®ä½œä¸ºæµ‹è¯•é›†ï¼Œå…¶ä½™ä¸ºè®­ç»ƒé›†
train_features, test_features, train_labels, test_labels = train_test_split(features, labels, test_size=0.33, random_state=0)
# åˆ›å»ºCARTåˆ†ç±»æ ‘
clf = DecisionTreeClassifier(criterion='gini')
# æ‹Ÿåˆæ„é€ CARTåˆ†ç±»æ ‘
clf = clf.fit(train_features, train_labels)
# ç”¨CARTåˆ†ç±»æ ‘åšé¢„æµ‹
test_predict = clf.predict(test_features)
# é¢„æµ‹ç»“æœä¸æµ‹è¯•é›†ç»“æœä½œæ¯”å¯¹
score = accuracy_score(test_labels, test_predict)
print("CARTåˆ†ç±»æ ‘å‡†ç¡®ç‡ %.4lf" % score)
```

è¿è¡Œç»“æœï¼š

```
CARTåˆ†ç±»æ ‘å‡†ç¡®ç‡ 0.9600
```

å¦‚æœæˆ‘ä»¬æŠŠå†³ç­–æ ‘ç”»å‡ºæ¥ï¼Œå¯ä»¥å¾—åˆ°ä¸‹é¢çš„å›¾ç¤ºï¼š

![](https://static001.geekbang.org/resource/image/c1/40/c1e2f9e4a299789bb6cc23afc6fd3140.png?wh=736%2A755)  
é¦–å…ˆtrain\_test\_splitå¯ä»¥å¸®åŠ©æˆ‘ä»¬æŠŠæ•°æ®é›†æŠ½å–ä¸€éƒ¨åˆ†ä½œä¸ºæµ‹è¯•é›†ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°è®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€‚

ä½¿ç”¨clf = DecisionTreeClassifier(criterion=â€˜giniâ€™)åˆå§‹åŒ–ä¸€æ£µCARTåˆ†ç±»æ ‘ã€‚è¿™æ ·ä½ å°±å¯ä»¥å¯¹CARTåˆ†ç±»æ ‘è¿›è¡Œè®­ç»ƒã€‚

ä½¿ç”¨clf.fit(train\_features, train\_labels)å‡½æ•°ï¼Œå°†è®­ç»ƒé›†çš„ç‰¹å¾å€¼å’Œåˆ†ç±»æ ‡è¯†ä½œä¸ºå‚æ•°è¿›è¡Œæ‹Ÿåˆï¼Œå¾—åˆ°CARTåˆ†ç±»æ ‘ã€‚

ä½¿ç”¨clf.predict(test\_features)å‡½æ•°è¿›è¡Œé¢„æµ‹ï¼Œä¼ å…¥æµ‹è¯•é›†çš„ç‰¹å¾å€¼ï¼Œå¯ä»¥å¾—åˆ°æµ‹è¯•ç»“æœtest\_predictã€‚

æœ€åä½¿ç”¨accuracy\_score(test\_labels, test\_predict)å‡½æ•°ï¼Œä¼ å…¥æµ‹è¯•é›†çš„é¢„æµ‹ç»“æœä¸å®é™…çš„ç»“æœä½œä¸ºå‚æ•°ï¼Œå¾—åˆ°å‡†ç¡®ç‡scoreã€‚

æˆ‘ä»¬èƒ½çœ‹åˆ°sklearnå¸®æˆ‘ä»¬åšäº†CARTåˆ†ç±»æ ‘çš„ä½¿ç”¨å°è£…ï¼Œä½¿ç”¨èµ·æ¥è¿˜æ˜¯å¾ˆæ–¹ä¾¿çš„ã€‚

**CARTå›å½’æ ‘çš„å·¥ä½œæµç¨‹**

CARTå›å½’æ ‘åˆ’åˆ†æ•°æ®é›†çš„è¿‡ç¨‹å’Œåˆ†ç±»æ ‘çš„è¿‡ç¨‹æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯å›å½’æ ‘å¾—åˆ°çš„é¢„æµ‹ç»“æœæ˜¯è¿ç»­å€¼ï¼Œè€Œä¸”è¯„åˆ¤â€œä¸çº¯åº¦â€çš„æŒ‡æ ‡ä¸åŒã€‚åœ¨CARTåˆ†ç±»æ ‘ä¸­é‡‡ç”¨çš„æ˜¯åŸºå°¼ç³»æ•°ä½œä¸ºæ ‡å‡†ï¼Œé‚£ä¹ˆåœ¨CARTå›å½’æ ‘ä¸­ï¼Œå¦‚ä½•è¯„ä»·â€œä¸çº¯åº¦â€å‘¢ï¼Ÿå®é™…ä¸Šæˆ‘ä»¬è¦æ ¹æ®æ ·æœ¬çš„æ··ä¹±ç¨‹åº¦ï¼Œä¹Ÿå°±æ˜¯æ ·æœ¬çš„ç¦»æ•£ç¨‹åº¦æ¥è¯„ä»·â€œä¸çº¯åº¦â€ã€‚

æ ·æœ¬çš„ç¦»æ•£ç¨‹åº¦å…·ä½“çš„è®¡ç®—æ–¹å¼æ˜¯ï¼Œå…ˆè®¡ç®—æ‰€æœ‰æ ·æœ¬çš„å‡å€¼ï¼Œç„¶åè®¡ç®—æ¯ä¸ªæ ·æœ¬å€¼åˆ°å‡å€¼çš„å·®å€¼ã€‚æˆ‘ä»¬å‡è®¾xä¸ºæ ·æœ¬çš„ä¸ªä½“ï¼Œå‡å€¼ä¸ºuã€‚ä¸ºäº†ç»Ÿè®¡æ ·æœ¬çš„ç¦»æ•£ç¨‹åº¦ï¼Œæˆ‘ä»¬å¯ä»¥å–å·®å€¼çš„ç»å¯¹å€¼ï¼Œæˆ–è€…æ–¹å·®ã€‚

å…¶ä¸­å·®å€¼çš„ç»å¯¹å€¼ä¸ºæ ·æœ¬å€¼å‡å»æ ·æœ¬å‡å€¼çš„ç»å¯¹å€¼ï¼š

![](https://static001.geekbang.org/resource/image/6f/97/6f9677a70b1edff85e9e467f3e52bd97.png?wh=208%2A125)  
æ–¹å·®ä¸ºæ¯ä¸ªæ ·æœ¬å€¼å‡å»æ ·æœ¬å‡å€¼çš„å¹³æ–¹å’Œé™¤ä»¥æ ·æœ¬ä¸ªæ•°ï¼š

![](https://static001.geekbang.org/resource/image/04/c1/045fd5afb7b53f17a8accd6f337f63c1.png?wh=245%2A87)  
æ‰€ä»¥è¿™ä¸¤ç§èŠ‚ç‚¹åˆ’åˆ†çš„æ ‡å‡†ï¼Œåˆ†åˆ«å¯¹åº”ç€ä¸¤ç§ç›®æ ‡å‡½æ•°æœ€ä¼˜åŒ–çš„æ ‡å‡†ï¼Œå³ç”¨æœ€å°ç»å¯¹åå·®ï¼ˆLADï¼‰ï¼Œæˆ–è€…ä½¿ç”¨æœ€å°äºŒä¹˜åå·®ï¼ˆLSDï¼‰ã€‚è¿™ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥è®©æˆ‘ä»¬æ‰¾åˆ°èŠ‚ç‚¹åˆ’åˆ†çš„æ–¹æ³•ï¼Œé€šå¸¸ä½¿ç”¨æœ€å°äºŒä¹˜åå·®çš„æƒ…å†µæ›´å¸¸è§ä¸€äº›ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥çœ‹ä¸‹å¦‚ä½•åˆ›å»ºä¸€æ£µCARTå›å½’æ ‘æ¥åšé¢„æµ‹ã€‚

## å¦‚ä½•ä½¿ç”¨CARTå›å½’æ ‘åšé¢„æµ‹

è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨åˆ°sklearnè‡ªå¸¦çš„æ³¢å£«é¡¿æˆ¿ä»·æ•°æ®é›†ï¼Œè¯¥æ•°æ®é›†ç»™å‡ºäº†å½±å“æˆ¿ä»·çš„ä¸€äº›æŒ‡æ ‡ï¼Œæ¯”å¦‚çŠ¯ç½ªç‡ï¼Œæˆ¿äº§ç¨ç­‰ï¼Œæœ€åç»™å‡ºäº†æˆ¿ä»·ã€‚

æ ¹æ®è¿™äº›æŒ‡æ ‡ï¼Œæˆ‘ä»¬ä½¿ç”¨CARTå›å½’æ ‘å¯¹æ³¢å£«é¡¿æˆ¿ä»·è¿›è¡Œé¢„æµ‹ï¼Œä»£ç å¦‚ä¸‹ï¼š

```
# encoding=utf-8
from sklearn.metrics import mean_squared_error
from sklearn.model_selection import train_test_split
from sklearn.datasets import load_boston
from sklearn.metrics import r2_score,mean_absolute_error,mean_squared_error
from sklearn.tree import DecisionTreeRegressor
# å‡†å¤‡æ•°æ®é›†
boston=load_boston()
# æ¢ç´¢æ•°æ®
print(boston.feature_names)
# è·å–ç‰¹å¾é›†å’Œæˆ¿ä»·
features = boston.data
prices = boston.target
# éšæœºæŠ½å–33%çš„æ•°æ®ä½œä¸ºæµ‹è¯•é›†ï¼Œå…¶ä½™ä¸ºè®­ç»ƒé›†
train_features, test_features, train_price, test_price = train_test_split(features, prices, test_size=0.33)
# åˆ›å»ºCARTå›å½’æ ‘
dtr=DecisionTreeRegressor()
# æ‹Ÿåˆæ„é€ CARTå›å½’æ ‘
dtr.fit(train_features, train_price)
# é¢„æµ‹æµ‹è¯•é›†ä¸­çš„æˆ¿ä»·
predict_price = dtr.predict(test_features)
# æµ‹è¯•é›†çš„ç»“æœè¯„ä»·
print('å›å½’æ ‘äºŒä¹˜åå·®å‡å€¼:', mean_squared_error(test_price, predict_price))
print('å›å½’æ ‘ç»å¯¹å€¼åå·®å‡å€¼:', mean_absolute_error(test_price, predict_price)) 
```

è¿è¡Œç»“æœï¼ˆæ¯æ¬¡è¿è¡Œç»“æœå¯èƒ½ä¼šæœ‰ä¸åŒï¼‰ï¼š

```
['CRIM' 'ZN' 'INDUS' 'CHAS' 'NOX' 'RM' 'AGE' 'DIS' 'RAD' 'TAX' 'PTRATIO' 'B' 'LSTAT']
å›å½’æ ‘äºŒä¹˜åå·®å‡å€¼: 23.80784431137724
å›å½’æ ‘ç»å¯¹å€¼åå·®å‡å€¼: 3.040119760479042
```

å¦‚æœæŠŠå›å½’æ ‘ç”»å‡ºæ¥ï¼Œå¯ä»¥å¾—åˆ°ä¸‹é¢çš„å›¾ç¤ºï¼ˆæ³¢å£«é¡¿æˆ¿ä»·æ•°æ®é›†çš„æŒ‡æ ‡æœ‰äº›å¤šï¼Œæ‰€ä»¥æ ‘æ¯”è¾ƒå¤§ï¼‰ï¼š

![](https://static001.geekbang.org/resource/image/65/61/65a3855aed648b32994b808296a40b61.png?wh=1861%2A368)

ä½ å¯ä»¥åœ¨[è¿™é‡Œ](https://pan.baidu.com/s/1RKD6-IwAzL--cL0jt4GPiQ)ä¸‹è½½å®Œæ•´PDFæ–‡ä»¶ã€‚

æˆ‘ä»¬æ¥çœ‹ä¸‹è¿™ä¸ªä¾‹å­ï¼Œé¦–å…ˆåŠ è½½äº†æ³¢å£«é¡¿æˆ¿ä»·æ•°æ®é›†ï¼Œå¾—åˆ°ç‰¹å¾é›†å’Œæˆ¿ä»·ã€‚ç„¶åé€šè¿‡train\_test\_splitå¸®åŠ©æˆ‘ä»¬æŠŠæ•°æ®é›†æŠ½å–ä¸€éƒ¨åˆ†ä½œä¸ºæµ‹è¯•é›†ï¼Œå…¶ä½™ä½œä¸ºè®­ç»ƒé›†ã€‚

ä½¿ç”¨dtr=DecisionTreeRegressor()åˆå§‹åŒ–ä¸€æ£µCARTå›å½’æ ‘ã€‚

ä½¿ç”¨dtr.fit(train\_features, train\_price)å‡½æ•°ï¼Œå°†è®­ç»ƒé›†çš„ç‰¹å¾å€¼å’Œç»“æœä½œä¸ºå‚æ•°è¿›è¡Œæ‹Ÿåˆï¼Œå¾—åˆ°CARTå›å½’æ ‘ã€‚

ä½¿ç”¨dtr.predict(test\_features)å‡½æ•°è¿›è¡Œé¢„æµ‹ï¼Œä¼ å…¥æµ‹è¯•é›†çš„ç‰¹å¾å€¼ï¼Œå¯ä»¥å¾—åˆ°é¢„æµ‹ç»“æœpredict\_priceã€‚

æœ€åæˆ‘ä»¬å¯ä»¥æ±‚å¾—è¿™æ£µå›å½’æ ‘çš„äºŒä¹˜åå·®å‡å€¼ï¼Œä»¥åŠç»å¯¹å€¼åå·®å‡å€¼ã€‚

æˆ‘ä»¬èƒ½çœ‹åˆ°CARTå›å½’æ ‘çš„ä½¿ç”¨å’Œåˆ†ç±»æ ‘ç±»ä¼¼ï¼Œåªæ˜¯æœ€åæ±‚å¾—çš„é¢„æµ‹å€¼æ˜¯ä¸ªè¿ç»­å€¼ã€‚

## CARTå†³ç­–æ ‘çš„å‰ªæ

CARTå†³ç­–æ ‘çš„å‰ªæä¸»è¦é‡‡ç”¨çš„æ˜¯CCPæ–¹æ³•ï¼Œå®ƒæ˜¯ä¸€ç§åå‰ªæçš„æ–¹æ³•ï¼Œè‹±æ–‡å…¨ç§°å«åšcost-complexity pruneï¼Œä¸­æ–‡å«åšä»£ä»·å¤æ‚åº¦ã€‚è¿™ç§å‰ªææ–¹å¼ç”¨åˆ°ä¸€ä¸ªæŒ‡æ ‡å«åšèŠ‚ç‚¹çš„è¡¨é¢è¯¯å·®ç‡å¢ç›Šå€¼ï¼Œä»¥æ­¤ä½œä¸ºå‰ªæå‰åè¯¯å·®çš„å®šä¹‰ã€‚ç”¨å…¬å¼è¡¨ç¤ºåˆ™æ˜¯ï¼š

![](https://static001.geekbang.org/resource/image/6b/95/6b9735123d45e58f0b0afc7c3f68cd95.png?wh=327%2A140)  
å…¶ä¸­Ttä»£è¡¨ä»¥tä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘ï¼ŒC(Tt)è¡¨ç¤ºèŠ‚ç‚¹tçš„å­æ ‘æ²¡è¢«è£å‰ªæ—¶å­æ ‘Ttçš„è¯¯å·®ï¼ŒC(t)è¡¨ç¤ºèŠ‚ç‚¹tçš„å­æ ‘è¢«å‰ªæåèŠ‚ç‚¹tçš„è¯¯å·®ï¼Œ|Tt|ä»£å­æ ‘Ttçš„å¶å­æ•°ï¼Œå‰ªæåï¼ŒTçš„å¶å­æ•°å‡å°‘äº†|Tt|-1ã€‚

æ‰€ä»¥èŠ‚ç‚¹çš„è¡¨é¢è¯¯å·®ç‡å¢ç›Šå€¼ç­‰äºèŠ‚ç‚¹tçš„å­æ ‘è¢«å‰ªæåçš„è¯¯å·®å˜åŒ–é™¤ä»¥å‰ªæ‰çš„å¶å­æ•°é‡ã€‚

å› ä¸ºæˆ‘ä»¬å¸Œæœ›å‰ªæå‰åè¯¯å·®æœ€å°ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å¯»æ‰¾çš„å°±æ˜¯æœ€å°Î±å€¼å¯¹åº”çš„èŠ‚ç‚¹ï¼ŒæŠŠå®ƒå‰ªæ‰ã€‚è¿™æ—¶å€™ç”Ÿæˆäº†ç¬¬ä¸€ä¸ªå­æ ‘ã€‚é‡å¤ä¸Šé¢çš„è¿‡ç¨‹ï¼Œç»§ç»­å‰ªæï¼Œç›´åˆ°æœ€ååªå‰©ä¸‹æ ¹èŠ‚ç‚¹ï¼Œå³ä¸ºæœ€åä¸€ä¸ªå­æ ‘ã€‚

å¾—åˆ°äº†å‰ªæåçš„å­æ ‘é›†åˆåï¼Œæˆ‘ä»¬éœ€è¦ç”¨éªŒè¯é›†å¯¹æ‰€æœ‰å­æ ‘çš„è¯¯å·®è®¡ç®—ä¸€éã€‚å¯ä»¥é€šè¿‡è®¡ç®—æ¯ä¸ªå­æ ‘çš„åŸºå°¼æŒ‡æ•°æˆ–è€…å¹³æ–¹è¯¯å·®ï¼Œå–è¯¯å·®æœ€å°çš„é‚£ä¸ªæ ‘ï¼Œå¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚

## æ€»ç»“

ä»Šå¤©æˆ‘ç»™ä½ è®²äº†CARTå†³ç­–æ ‘ï¼Œå®ƒæ˜¯ä¸€æ£µå†³ç­–äºŒå‰æ ‘ï¼Œæ—¢å¯ä»¥åšåˆ†ç±»æ ‘ï¼Œä¹Ÿå¯ä»¥åšå›å½’æ ‘ã€‚ä½ éœ€è¦è®°ä½çš„æ˜¯ï¼Œä½œä¸ºåˆ†ç±»æ ‘ï¼ŒCARTé‡‡ç”¨åŸºå°¼ç³»æ•°ä½œä¸ºèŠ‚ç‚¹åˆ’åˆ†çš„ä¾æ®ï¼Œå¾—åˆ°çš„æ˜¯ç¦»æ•£çš„ç»“æœï¼Œä¹Ÿå°±æ˜¯åˆ†ç±»ç»“æœï¼›ä½œä¸ºå›å½’æ ‘ï¼ŒCARTå¯ä»¥é‡‡ç”¨æœ€å°ç»å¯¹åå·®ï¼ˆLADï¼‰ï¼Œæˆ–è€…æœ€å°äºŒä¹˜åå·®ï¼ˆLSDï¼‰ä½œä¸ºèŠ‚ç‚¹åˆ’åˆ†çš„ä¾æ®ï¼Œå¾—åˆ°çš„æ˜¯è¿ç»­å€¼ï¼Œå³å›å½’é¢„æµ‹ç»“æœã€‚

æœ€åæˆ‘ä»¬æ¥æ•´ç†ä¸‹ä¸‰ç§å†³ç­–æ ‘ä¹‹é—´åœ¨å±æ€§é€‰æ‹©æ ‡å‡†ä¸Šçš„å·®å¼‚ï¼š

- ID3ç®—æ³•ï¼ŒåŸºäºä¿¡æ¯å¢ç›Šåšåˆ¤æ–­ï¼›
- C4.5ç®—æ³•ï¼ŒåŸºäºä¿¡æ¯å¢ç›Šç‡åšåˆ¤æ–­ï¼›
- CARTç®—æ³•ï¼Œåˆ†ç±»æ ‘æ˜¯åŸºäºåŸºå°¼ç³»æ•°åšåˆ¤æ–­ã€‚å›å½’æ ‘æ˜¯åŸºäºåå·®åšåˆ¤æ–­ã€‚

å®é™…ä¸Šè¿™ä¸‰ä¸ªæŒ‡æ ‡ä¹Ÿæ˜¯è®¡ç®—â€œä¸çº¯åº¦â€çš„ä¸‰ç§è®¡ç®—æ–¹å¼ã€‚

åœ¨å·¥å…·ä½¿ç”¨ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨sklearnä¸­çš„DecisionTreeClassifieråˆ›å»ºCARTåˆ†ç±»æ ‘ï¼Œé€šè¿‡DecisionTreeRegressoråˆ›å»ºCARTå›å½’æ ‘ã€‚

ä½ å¯ä»¥ç”¨ä»£ç è‡ªå·±è·‘ä¸€éæˆ‘åœ¨æ–‡ç¨¿ä¸­ä¸¾åˆ°çš„ä¾‹å­ã€‚

![](https://static001.geekbang.org/resource/image/5c/84/5cfe1151f88befc1178eca3252890f84.png?wh=820%2A472)  
æœ€åç»™ä½ ç•™ä¸¤é“æ€è€ƒé¢˜å§ï¼Œä½ èƒ½è¯´ä¸‹ID3ï¼ŒC4.5ï¼Œä»¥åŠCARTåˆ†ç±»æ ‘åœ¨åšèŠ‚ç‚¹åˆ’åˆ†æ—¶çš„åŒºåˆ«å—ï¼Ÿç¬¬äºŒä¸ªé—®é¢˜æ˜¯ï¼Œsklearnä¸­æœ‰ä¸ªæ‰‹å†™æ•°å­—æ•°æ®é›†ï¼Œè°ƒç”¨çš„æ–¹æ³•æ˜¯load\_digits()ï¼Œä½ èƒ½å¦åˆ›å»ºä¸€ä¸ªCARTåˆ†ç±»æ ‘ï¼Œå¯¹æ‰‹å†™æ•°å­—æ•°æ®é›†åšåˆ†ç±»ï¼Ÿå¦å¤–é€‰å–ä¸€éƒ¨åˆ†æµ‹è¯•é›†ï¼Œç»Ÿè®¡ä¸‹åˆ†ç±»æ ‘çš„å‡†ç¡®ç‡ï¼Ÿ

æ¬¢è¿ä½ åœ¨è¯„è®ºä¸‹é¢ç•™è¨€ï¼Œä¸æˆ‘åˆ†äº«ä½ çš„ç­”æ¡ˆã€‚ä¹Ÿæ¬¢è¿ç‚¹å‡»â€œè¯·æœ‹å‹è¯»â€ï¼ŒæŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–è€…åŒäº‹ï¼Œä¸€èµ·äº¤æµã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ15ï¼‰</strong></div><ul>
<li><span>rainman</span> ğŸ‘ï¼ˆ39ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>å¯¹äº CART å›å½’æ ‘çš„å¯è§†åŒ–ï¼Œå¯ä»¥å…ˆåœ¨ç”µè„‘ä¸Šå®‰è£… graphvizï¼›ç„¶å pip install graphvizï¼Œè¿™æ˜¯å®‰è£…pythonçš„åº“ï¼Œéœ€è¦ä¾èµ–å‰é¢å®‰è£…çš„ graphvizã€‚å¯è§†åŒ–ä»£ç å¦‚ä¸‹ï¼š

----
from sklearn.tree import export_graphviz
import graphviz

# å‚æ•°æ˜¯å›å½’æ ‘æ¨¡å‹åç§°ï¼Œä¸è¾“å‡ºæ–‡ä»¶ã€‚
dot_data = export_graphviz(dtr, out_file=None)
graph = graphviz.Source(dot_data)
# render æ–¹æ³•ä¼šåœ¨åŒçº§ç›®å½•ä¸‹ç”Ÿæˆ Boston PDFæ–‡ä»¶ï¼Œå†…å®¹å°±æ˜¯å›å½’æ ‘ã€‚
graph.render(&#39;Boston&#39;)
----

å…·ä½“å†…å®¹å¯ä»¥å» sklearn(https:&#47;&#47;scikit-learn.org&#47;stable&#47;modules&#47;generated&#47;sklearn.tree.export_graphviz.html)
å’Œ graphviz(https:&#47;&#47;graphviz.readthedocs.io&#47;en&#47;stable&#47;) çœ‹çœ‹ã€‚</p>2019-02-15</li><br/><li><span>å°ç†ŠçŒ«</span> ğŸ‘ï¼ˆ16ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ID3ï¼šä»¥ä¿¡æ¯å¢ç›Šä½œä¸ºåˆ¤æ–­æ ‡å‡†ï¼Œè®¡ç®—æ¯ä¸ªç‰¹å¾çš„ä¿¡æ¯å¢ç›Šï¼Œé€‰å–ä¿¡æ¯å¢ç›Šæœ€å¤§çš„ç‰¹å¾ï¼Œä½†æ˜¯å®¹æ˜“é€‰å–åˆ°å–å€¼è¾ƒå¤šçš„ç‰¹å¾
C4.5ï¼šä»¥ä¿¡æ¯å¢ç›Šæ¯”ä½œä¸ºåˆ¤æ–­æ ‡å‡†ï¼Œè®¡ç®—æ¯ä¸ªç‰¹å¾çš„ä¿¡æ¯å¢ç›Šæ¯”ï¼Œé€‰å–ä¿¡æ¯å¢ç›Šæ¯”æœ€å¤§çš„ç‰¹å¾
CARTï¼šåˆ†ç±»æ ‘ä»¥åŸºå°¼ç³»æ•°ä¸ºæ ‡å‡†ï¼Œé€‰å–åŸºå°¼ç³»æ•°å°çš„çš„ç‰¹å¾
            å›å½’æ ‘ä»¥å‡æ–¹è¯¯å·®æˆ–ç»å¯¹å€¼è¯¯å·®ä¸ºæ ‡å‡†ï¼Œé€‰å–å‡æ–¹è¯¯å·®æˆ–ç»å¯¹å€¼è¯¯å·®æœ€å°çš„ç‰¹å¾

ç»ƒä¹ é¢˜ï¼š
from sklearn import datasets
from sklearn.model_selection import train_test_split
from sklearn import tree
from sklearn.metrics import accuracy_score
import graphviz 

# å‡†å¤‡æ‰‹å†™æ•°å­—æ•°æ®é›†
digits = datasets.load_digits()
# è·å–ç‰¹å¾å’Œæ ‡è¯†
features = digits.data
labels = digits.target
# é€‰å–æ•°æ®é›†çš„33%ä¸ºæµ‹è¯•é›†ï¼Œå…¶ä½™ä¸ºè®­ç»ƒé›†
train_features, test_features, train_labels, test_labels = train_test_split(features, labels, test_size=0.33)
# åˆ›å»ºCARTåˆ†ç±»æ ‘
clf = tree.DecisionTreeClassifier()
# æ‹Ÿåˆæ„é€ CARTåˆ†ç±»æ ‘
clf.fit(train_features, train_labels)
# é¢„æµ‹æµ‹è¯•é›†ç»“æœ
test_predict = clf.predict(test_features)
# æµ‹è¯•é›†ç»“æœè¯„ä»·
print(&#39;CARTåˆ†ç±»æ ‘å‡†ç¡®ç‡:&#39;, accuracy_score(test_labels, test_predict))
# ç”»å†³ç­–æ ‘
dot_data = tree.export_graphviz(clf, out_file=None)
graph = graphviz.Source(dot_data)
graph.render(&#39;CART&#47;&#47;CART_practice_digits&#39;)

CARTåˆ†ç±»æ ‘å‡†ç¡®ç‡: 0.8636363636363636</p>2019-02-15</li><br/><li><span>jake</span> ğŸ‘ï¼ˆ7ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>
é¦–å…ˆæƒ³é—®ä¸€ä¸ªé—®é¢˜ å°±æ˜¯åœ¨è®²åˆ°åŸºå°¼ç³»æ•°é‚£é‡Œ æœ‰ä¸€ä¸ªå›¾é‚£é‡Œçš„ä¾‹å­ ä»€ä¹ˆD: 9ä¸ªæ‰“ç¯®çƒ 3ä¸ªä¸æ‰“ç¯®çƒé‚£é‡Œ
é‚£é‡Œçš„Dçš„åŸºå°¼ç³»æ•°ç”¨åˆ°äº†å­èŠ‚ç‚¹å½’ä¸€åŒ–åŸºå°¼ç³»æ•°ä¹‹å’Œè¿™ä¸ªæ–¹æ³•æ±‚ è¯·é—®Dçš„åŸºå°¼ç³»æ•°ä¸èƒ½ç›´æ¥ç”¨ ä¸Šé¢é‚£ä¸ªå…¬å¼ ä¹Ÿå°±æ˜¯&quot;1 - [p(ck|t)]^2&quot;é‚£ä¸ªå…¬å¼è®¡ç®—å— æˆ‘ç”¨è¿™ä¸ªå…¬å¼è®¡ç®—å‡ºDçš„åŸºå°¼ç³»æ•°ä¸º 1 - (9&#47;12 * 9&#47;12 + 3&#47;12 * 3&#47;12) = 6&#47;16ã€‚ æˆ‘ä¹Ÿæƒ³é—®ä¸€ä¸‹ä¸Šé¢é‚£ä¸ªåŒå­¦æçš„è¿™ä¸ªé—®é¢˜</p>2019-02-24</li><br/><li><span>xfoolin</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ID3 æ˜¯é€šè¿‡ä¿¡æ¯å¢ç›Šï¼Œé€‰å–ä¿¡æ¯å¢ç›Šæœ€å¤§çš„ç‰¹å¾ï¼›C4.5 æ˜¯é€šè¿‡ä¿¡æ¯å¢ç›Šç‡ï¼Œé€‰å–ï¼ŒCART æ˜¯é€šè¿‡åŸºå°¼ç³»æ•°ï¼Œé€‰å–åŸºå°¼ç³»æ•°æœ€å°çš„ç‰¹å¾ã€‚


from sklearn.model_selection import train_test_split#è®­ç»ƒé›†å’Œæµ‹è¯•é›†
from sklearn.metrics import mean_squared_error#äºŒä¹˜åå·®å‡å€¼
from sklearn.metrics import mean_absolute_error#ç»å¯¹å€¼åå·®å‡å€¼
from sklearn.datasets import load_digits#å¼•å…¥ digits æ•°æ®é›†
from sklearn.metrics import accuracy_score#æµ‹è¯•ç»“æœçš„å‡†ç¡®æ€§
from sklearn import tree
import graphviz
#å‡†å¤‡æ•°æ®é›†
digits = load_digits()
#è·å–æ•°æ®é›†çš„ç‰¹å¾é›†å’Œåˆ†ç±»æ ‡è¯†
features = digits.data
labels = digits.target
#éšæœºæŠ½å– 33% çš„æ•°æ®ä½œä¸ºæµ‹è¯•é›†ï¼Œå…¶ä½™ä¸ºè®­ç»ƒé›†
train_features,test_features,train_labels,test_labels = \
train_test_split(features,labels,test_size = 0.33,random_state = 0)
#åˆ›å»º CART åˆ†ç±»æ ‘
clf = tree.DecisionTreeClassifier(criterion = &#39;gini&#39;)
#æ‹Ÿåˆæ„é€ åˆ†ç±»æ ‘
clf = clf.fit(train_features,train_labels)
#ç”¨ CART åˆ†ç±»æ ‘åšé¢„æµ‹
test_predict = clf.predict(test_features)
#é¢„æµ‹ç»“æœä¸æµ‹è¯•é›†ä½œå¯¹æ¯”
score = accuracy_score(test_labels,test_predict)
#è¾“å‡ºå‡†ç¡®ç‡
print(&#39;å‡†ç¡®ç‡ %.4f&#39;%score)
dot_data = tree.export_graphviz(clf,out_file = None)
graph = graphviz.Source(dot_data)
#è¾“å‡ºåˆ†ç±»æ ‘å›¾ç¤º
graph.view()
</p>2019-02-19</li><br/><li><span>Lee</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p># encoding=utf-8
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score
from sklearn.tree import DecisionTreeClassifier
from sklearn.datasets import load_digits

# å‡†å¤‡æ•°æ®é›†
digits=load_digits()
# è·å–ç‰¹å¾é›†å’Œåˆ†ç±»æ ‡è¯†
features = digits.data
labels = digits.target
# éšæœºæŠ½å– 33% çš„æ•°æ®ä½œä¸ºæµ‹è¯•é›†ï¼Œå…¶ä½™ä¸ºè®­ç»ƒé›†
train_features, test_features, train_labels, test_labels = train_test_split(features, labels, test_size=0.33, random_state=0)
# åˆ›å»º CART åˆ†ç±»æ ‘
clf = DecisionTreeClassifier(criterion=&#39;gini&#39;)
# æ‹Ÿåˆæ„é€  CART åˆ†ç±»æ ‘
clf = clf.fit(train_features, train_labels)
# ç”¨ CART åˆ†ç±»æ ‘åšé¢„æµ‹
test_predict = clf.predict(test_features)
# é¢„æµ‹ç»“æœä¸æµ‹è¯•é›†ç»“æœä½œæ¯”å¯¹
score = accuracy_score(test_labels, test_predict)
print(&quot;CART åˆ†ç±»æ ‘å‡†ç¡®ç‡ %.4lf&quot; % score)

CART åˆ†ç±»æ ‘å‡†ç¡®ç‡ 0.8620</p>2019-01-24</li><br/><li><span>é›¨å…ˆç”Ÿçš„æ™´å¤©</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>scikit learn package ç¡®å®éå¸¸å¥½ç”¨ï¼Œå¾ˆç®€æ´ã€‚æ¨èå¤§å®¶ä¹Ÿå»å®˜ç½‘çœ‹ä¸€çœ‹ï¼Œè¯·é—®ä¸€ä¸‹æ€æ ·å¯ä»¥æŠŠdecision tree å¯è§†åŒ–å‘€ï¼Ÿ </p>2019-01-27</li><br/><li><span>Mi compaero de armas</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆæ‚¨å¥½ï¼Œè¯·é—®é‡‡ç”¨CARTç®—æ³•æ—¶ï¼Œå¦‚æœç¦»æ•£å‹å±æ€§çš„å€¼ä¸æ­¢ä¸¤ç§è¿˜èƒ½ä½¿ç”¨CARTç®—æ³•å—</p>2019-11-19</li><br/><li><span>Ronnyz</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ç¬¬äºŒé—®
```
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score
from sklearn.tree import DecisionTreeClassifier
from sklearn.datasets import load_digits

digits = load_digits()

# print(digits)

features=digits.data
labels = digits.target

train_features,test_features,train_labels,test_labels=train_test_split(features,labels,test_size =0.33,random_state=0)

clf = DecisionTreeClassifier(criterion=&#39;gini&#39;)
clf=clf.fit(train_features,train_labels)

predict_labels=clf.predict(test_features)

print(&#39;åˆ†ç±»å‡†ç¡®åº¦ï¼š&#39;,accuracy_score(test_labels,predict_labels))
```
åˆ†ç±»å‡†ç¡®åº¦ï¼š 0.8619528619528619</p>2019-11-11</li><br/><li><span>è®¸å®‡å®</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼Œçœ‹äº†ä¸¤éè¿˜æ˜¯ä¸æ˜ç™½åˆ†ç±»çš„è¿™ä¸ªå†³ç­–æ ‘æ˜¯ä¾æ®ä»€ä¹ˆç”»å‡ºæ¥çš„ï¼Ÿ</p>2019-07-18</li><br/><li><span>ç¾Šå°çœ‹</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>1ã€ä¸ºä»€ä¹ˆCRATçš„åŸºå°¼ç³»æ•°æ¯”C4.5çš„ä¿¡æ¯å¢ç›Šç‡å¥½å‘¢ï¼Ÿæ—¢ç„¶sklearnåº“é»˜è®¤ç”¨çš„åŸºå°¼ç³»æ•°ï¼Œåº”è¯¥æ˜¯è¿™ä¸ªå¥½ä¸€äº›å§ï¼Ÿ
2ã€from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score
from sklearn.tree import DecisionTreeClassifier
#from sklearn.datasets import load_iris
from sklearn.datasets import load_digits

# å‡†å¤‡æ•°æ®é›†
#iris=load_iris()
digits=load_digits()
# è·å–ç‰¹å¾é›†å’Œåˆ†ç±»æ ‡è¯†
#features = iris.data
#labels = iris.target
features = digits.data
labels = digits.target
# éšæœºæŠ½å– 33% çš„æ•°æ®ä½œä¸ºæµ‹è¯•é›†ï¼Œå…¶ä½™ä¸ºè®­ç»ƒé›†
train_features, test_features, train_labels, test_labels = train_test_split(features, labels, test_size=0.33, random_state=0)
# åˆ›å»º CART åˆ†ç±»æ ‘
clf = DecisionTreeClassifier(criterion=&#39;gini&#39;)
# æ‹Ÿåˆæ„é€  CART åˆ†ç±»æ ‘
clf = clf.fit(train_features, train_labels)
# ç”¨ CART åˆ†ç±»æ ‘åšé¢„æµ‹
test_predict = clf.predict(test_features)
# é¢„æµ‹ç»“æœä¸æµ‹è¯•é›†ç»“æœä½œæ¯”å¯¹
score = accuracy_score(test_labels, test_predict)
print(&quot;CART åˆ†ç±»æ ‘å‡†ç¡®ç‡ %.4lf&quot; % score)

CART åˆ†ç±»æ ‘å‡†ç¡®ç‡ 0.8636</p>2019-05-10</li><br/><li><span>åœ†åœ†çš„å¤§é£Ÿå®¢</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score
from sklearn.tree import DecisionTreeClassifier
from sklearn.datasets import load_digits
#å‡†å¤‡æ•°æ®é›†
digits=load_digits()
#è·å–ç‰¹å¾é›†å’Œåˆ†ç±»æ ‡è¯†
features = digits.data
labels = digits.target
#éšæœºæŠ½å–33%çš„æ•°æ®ä½œä¸ºæµ‹è¯•é›†ï¼Œå…¶ä½™ä¸ºè®­ç»ƒé›†
train_features, test_features, train_labels, test_labels = train_test_split(features, labels, test_size=0.33, random_state=0)
#åˆ›å»ºCARTåˆ†ç±»æ ‘
clf = DecisionTreeClassifier(criterion=&#39;gini&#39;)
#æ‹Ÿåˆæ„é€ CARTåˆ†ç±»æ ‘
clf = clf.fit(train_features, train_labels)
#ç”¨CARTåˆ†ç±»æ ‘åšé¢„æµ‹
test_predict = clf.predict(test_features)
#é¢„æµ‹ç»“æœä¸æµ‹è¯•é›†ç»“æœä½œå¯¹æ¯” 
score = accuracy_score(test_labels, test_predict)
print (&quot;CARTåˆ†ç±»æ ‘å‡†ç¡®ç‡%.4lf&quot;% score)</p>2019-02-02</li><br/><li><span>Chino</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>é¦–å…ˆæƒ³é—®ä¸€ä¸ªé—®é¢˜ å°±æ˜¯åœ¨è®²åˆ°åŸºå°¼ç³»æ•°é‚£é‡Œ æœ‰ä¸€ä¸ªå›¾é‚£é‡Œçš„ä¾‹å­ ä»€ä¹ˆD: 9ä¸ªæ‰“ç¯®çƒ 3ä¸ªä¸æ‰“ç¯®çƒé‚£é‡Œ
é‚£é‡Œçš„Dçš„åŸºå°¼ç³»æ•°ç”¨åˆ°äº†å­èŠ‚ç‚¹å½’ä¸€åŒ–åŸºå°¼ç³»æ•°ä¹‹å’Œè¿™ä¸ªæ–¹æ³•æ±‚ è¯·é—®Dçš„åŸºå°¼ç³»æ•°ä¸èƒ½ç›´æ¥ç”¨ ä¸Šé¢é‚£ä¸ªå…¬å¼ ä¹Ÿå°±æ˜¯&quot;1 - [p(ck|t)]^2&quot;é‚£ä¸ªå…¬å¼è®¡ç®—å—  æˆ‘ç”¨è¿™ä¸ªå…¬å¼è®¡ç®—å‡ºDçš„åŸºå°¼ç³»æ•°ä¸º 1 - (9&#47;12 * 9&#47;12 + 3&#47;12 * 3&#47;12) = 6&#47;16

# ID3,C4.5,CARTåœ¨åšèŠ‚ç‚¹åˆ’åˆ†çš„åŒºåˆ«
# æˆ‘è®¤ä¸ºæ˜¯ä¸‰è€…çš„å…±åŒä¹‹å¤„å°±æ˜¯å¾—å‡ºæ¯ä¸ªç±»åˆ«çš„æŸä¸ªå±æ€§å€¼ ç„¶åæ ¹æ®è¿™ä¸ªå±æ€§å€¼
# æ¥é€‰å–å“ªä¸ªç±»å‹å½“èŠ‚ç‚¹ å› æ­¤ä¸åŒä¹‹å¤„å°±æ˜¯è¿™ä¸ªå±æ€§å€¼.
# ID3 æ ¹æ® ä¿¡æ¯å¢ç›Š åˆ¤æ–­ å“ªä¸ªèŠ‚ç‚¹çš„ä¿¡æ¯å¢ç›Šæœ€å¤§å°±å½“èŠ‚ç‚¹
# C4.5 æ ¹æ® ä¿¡æ¯å¢ç›Šç‡ åˆ¤æ–­ è·ŸID3ç›¸ä¼¼
# CARTåˆ†ç±»æ ‘ æ ¹æ® åŸºå°¼ç³»æ•° åˆ¤æ–­ è¶Šå°ä»£è¡¨è¶Šç¨³å®š

from sklearn.datasets import load_digits
from sklearn.tree import DecisionTreeClassifier
from sklearn.metrics import accuracy_score
from sklearn.model_selection import train_test_split


digit = load_digits()

# æŠŠæ•°æ®é›†ä¸­çš„æ•°æ®å’Œç»“æœæ‹¿å‡ºæ¥
features = digit.data
target = digit.target

# æŠŠæ•°æ®é›†ä¸­çš„æ•°æ®åˆ†33%å½“ä½œæµ‹è¯•æ•°æ® å…¶ä»–ç”¨æ¥è®­ç»ƒ
train_features,test_features,train_target,test_target = train_test_split(features,target,test_size=0.33)

# å®šä¹‰CARTåˆ†ç±»æ ‘
clf = DecisionTreeClassifier()

# æŠŠè®­ç»ƒæ•°æ®å¼„åˆ°åˆ†ç±»æ•°ä¸­ æ„é€ æ ‘
clf = clf.fit(train_features,train_target)

# æŠŠæµ‹è¯•æ•°æ®æ”¾è¿›æ ‘ä¸­å¾—å‡ºé¢„æµ‹ç»“æœ
predict_target = clf.predict(test_features)

# å¯¹æ¯”é¢„æµ‹å‡ºæ¥çš„æ•°æ®å’Œå®é™…ç»“æœ
score = accuracy_score(predict_target,test_target)

print(score)

</p>2019-02-01</li><br/><li><span>Melons</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>å¦‚æœæŒ‰ç…§ç¬¬ä¸€ä¸ªå…¬å¼ï¼Œæ•°æ®é›†Dçš„åŸºå°¼ç³»æ•°è®¡ç®—æ–¹æ³•ä¸º1-ï¼ˆ9&#47;12 * 9&#47;12 + 3&#47;12 * 3&#47;12ï¼‰=3&#47;8ï¼›è¯·é—®ä¸ºä»€ä¹ˆä¸èƒ½è¿™æ ·ç®—å‘¢ï¼Ÿ</p>2021-01-14</li><br/><li><span>lemonlxn</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ä½¿ç”¨CARTæ ‘ï¼Œåšå›å½’æˆ–è€…åˆ†ç±»ï¼Œæ ·æœ¬æ•°æ®ç±»å‹ æœ‰æ— è§„å®šï¼Œåªèƒ½æ˜¯ åˆ†ç±» æˆ– æ•°å€¼ æ•°æ®ç±»å‹ï¼Œè¿˜æ˜¯ä¸¤è€…éƒ½å¯ä»¥å­˜åœ¨ï¼Ÿ</p>2020-09-21</li><br/><li><span>freedomwl</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<p>è€å¸ˆï¼Œæ³¢å£«é¡¿æˆ¿ä»·ä»£ç æ¯æ¬¡è¿è¡Œç»“æœä¸ä¸€æ ·æ˜¯å› ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†æ¯è¿è¡Œä¸€æ¬¡éƒ½ä¼šé‡æ–°éšæœºé€‰å–çš„åŸå› å—ï¼Ÿ</p>2020-07-11</li><br/>
</ul>