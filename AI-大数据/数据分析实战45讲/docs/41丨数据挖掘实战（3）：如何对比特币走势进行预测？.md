ä»Šå¤©æˆ‘å¸¦ä½ ç”¨æ•°æ®æŒ–æ˜å¯¹æ¯”ç‰¹å¸çš„èµ°åŠ¿è¿›è¡Œé¢„æµ‹å’Œåˆ†æã€‚

æˆ‘ä»¬ä¹‹å‰ä»‹ç»äº†æ•°æ®æŒ–æ˜ç®—æ³•ä¸­çš„åˆ†ç±»ã€èšç±»ã€å›å½’å’Œå…³è”åˆ†æç®—æ³•ï¼Œé‚£ä¹ˆå¯¹äºæ¯”ç‰¹å¸èµ°åŠ¿çš„é¢„æµ‹ï¼Œé‡‡ç”¨å“ªç§æ–¹æ³•æ¯”è¾ƒå¥½å‘¢ï¼Ÿ

å¯èƒ½æœ‰äº›äººä¼šè®¤ä¸ºé‡‡ç”¨å›å½’åˆ†æä¼šå¥½ä¸€äº›ï¼Œå› ä¸ºé¢„æµ‹çš„ç»“æœæ˜¯è¿ç»­çš„æ•°å€¼ç±»å‹ã€‚å®é™…ä¸Šï¼Œæ•°æ®æŒ–æ˜ç®—æ³•è¿˜æœ‰ä¸€ç§å«æ—¶é—´åºåˆ—åˆ†æçš„ç®—æ³•ï¼Œæ—¶é—´åºåˆ—åˆ†ææ¨¡å‹å»ºç«‹äº†è§‚å¯Ÿç»“æœä¸æ—¶é—´å˜åŒ–çš„å…³ç³»ï¼Œèƒ½å¸®æˆ‘ä»¬é¢„æµ‹æœªæ¥ä¸€æ®µæ—¶é—´å†…çš„ç»“æœå˜åŒ–æƒ…å†µã€‚

é‚£ä¹ˆæ—¶é—´åºåˆ—åˆ†æå’Œå›å½’åˆ†ææœ‰å“ªäº›åŒºåˆ«å‘¢ï¼Ÿ

é¦–å…ˆï¼Œåœ¨é€‰æ‹©æ¨¡å‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç¡®å®šç»“æœä¸å˜é‡ä¹‹é—´çš„å…³ç³»ã€‚å›å½’åˆ†æè®­ç»ƒå¾—åˆ°çš„æ˜¯ç›®æ ‡å˜é‡yä¸è‡ªå˜é‡xï¼ˆä¸€ä¸ªæˆ–å¤šä¸ªï¼‰çš„ç›¸å…³æ€§ï¼Œç„¶åé€šè¿‡æ–°çš„è‡ªå˜é‡xæ¥é¢„æµ‹ç›®æ ‡å˜é‡yã€‚è€Œæ—¶é—´åºåˆ—åˆ†æå¾—åˆ°çš„æ˜¯ç›®æ ‡å˜é‡yä¸æ—¶é—´çš„ç›¸å…³æ€§ã€‚

å¦å¤–ï¼Œå›å½’åˆ†ææ“…é•¿çš„æ˜¯å¤šå˜é‡ä¸ç›®æ ‡ç»“æœä¹‹é—´çš„åˆ†æï¼Œå³ä¾¿æ˜¯å•ä¸€å˜é‡ï¼Œä¹Ÿå¾€å¾€ä¸æ—¶é—´æ— å…³ã€‚è€Œæ—¶é—´åºåˆ—åˆ†æå»ºç«‹åœ¨æ—¶é—´å˜åŒ–çš„åŸºç¡€ä¸Šï¼Œå®ƒä¼šåˆ†æç›®æ ‡å˜é‡çš„è¶‹åŠ¿ã€å‘¨æœŸã€æ—¶æœŸå’Œä¸ç¨³å®šå› ç´ ç­‰ã€‚è¿™äº›è¶‹åŠ¿å’Œå‘¨æœŸéƒ½æ˜¯åœ¨æ—¶é—´ç»´åº¦çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬è¦è§‚å¯Ÿçš„é‡è¦ç‰¹å¾ã€‚

é‚£ä¹ˆé’ˆå¯¹ä»Šå¤©è¦è¿›è¡Œçš„é¢„æµ‹æ¯”ç‰¹å¸èµ°åŠ¿çš„é¡¹ç›®ï¼Œæˆ‘ä»¬éƒ½éœ€è¦æŒæ¡å“ªäº›ç›®æ ‡å‘¢ï¼Ÿ

1. äº†è§£æ—¶é—´åºåˆ—é¢„æµ‹çš„æ¦‚å¿µï¼Œä»¥åŠå¸¸ç”¨çš„æ¨¡å‹ç®—æ³•ï¼ŒåŒ…æ‹¬ARã€MAã€ARMAã€ARIMAæ¨¡å‹ç­‰ï¼›
2. æŒæ¡å¹¶ä½¿ç”¨ARMAæ¨¡å‹å·¥å…·ï¼Œå¯¹ä¸€ä¸ªæ—¶é—´åºåˆ—æ•°æ®è¿›è¡Œå»ºæ¨¡å’Œé¢„æµ‹ï¼›
3. å¯¹æ¯”ç‰¹å¸çš„å†å²æ•°æ®è¿›è¡Œæ—¶é—´åºåˆ—å»ºæ¨¡ï¼Œå¹¶é¢„æµ‹æœªæ¥6ä¸ªæœˆçš„èµ°åŠ¿ã€‚

## æ—¶é—´åºåˆ—é¢„æµ‹

å…³äºæ—¶é—´åºåˆ—ï¼Œä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸ºæŒ‰ç…§æ—¶é—´é¡ºåºç»„æˆçš„æ•°å­—åºåˆ—ã€‚å®é™…ä¸Šåœ¨ä¸­å›½å¤ä»£çš„å†œä¸šç¤¾ä¼šä¸­ï¼Œäººä»¬å°±å°†ä¸€å¹´ä¸­ä¸åŒæ—¶é—´èŠ‚ç‚¹å’Œå¤©æ°”çš„è§„å¾‹æ€»ç»“äº†ä¸‹æ¥ï¼Œå½¢æˆäº†äºŒåå››èŠ‚æ°”ï¼Œä¹Ÿå°±æ˜¯ä»æ—¶é—´åºåˆ—ä¸­è§‚å¯Ÿå¤©æ°”å’Œå¤ªé˜³çš„è§„å¾‹ï¼ˆåªæ˜¯å½“æ—¶æ²¡æœ‰æ—¶é—´åºåˆ—æ¨¡å‹å’Œç›¸åº”å·¥å…·ï¼‰ï¼Œä»è€Œä½¿å¾—å†œä¸šå¾—åˆ°è¿…é€Ÿå‘å±•ã€‚åœ¨ç°ä»£ç¤¾ä¼šï¼Œæ—¶é—´åºåˆ—åœ¨é‡‘èã€ç»æµã€å•†ä¸šé¢†åŸŸæ‹¥æœ‰å¹¿æ³›çš„åº”ç”¨ã€‚

åœ¨æ—¶é—´åºåˆ—é¢„æµ‹æ¨¡å‹ä¸­ï¼Œæœ‰ä¸€äº›ç»å…¸çš„æ¨¡å‹ï¼ŒåŒ…æ‹¬ARã€MAã€ARMAã€ARIMAã€‚æˆ‘æ¥ç»™ä½ ç®€å•ä»‹ç»ä¸€ä¸‹ã€‚

ARçš„è‹±æ–‡å…¨ç§°å«åšAuto Regressiveï¼Œä¸­æ–‡å«è‡ªå›å½’æ¨¡å‹ã€‚è¿™ä¸ªç®—æ³•çš„æ€æƒ³æ¯”è¾ƒç®€å•ï¼Œå®ƒè®¤ä¸ºè¿‡å»è‹¥å¹²æ—¶åˆ»çš„ç‚¹é€šè¿‡çº¿æ€§ç»„åˆï¼Œå†åŠ ä¸Šç™½å™ªå£°å°±å¯ä»¥é¢„æµ‹æœªæ¥æŸä¸ªæ—¶åˆ»çš„ç‚¹ã€‚

åœ¨æˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ç¯å¢ƒä¸­å°±å­˜åœ¨ç™½å™ªå£°ï¼Œåœ¨æ•°æ®æŒ–æ˜çš„è¿‡ç¨‹ä¸­ï¼Œä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸ºä¸€ä¸ªæœŸæœ›ä¸º0ï¼Œæ–¹å·®ä¸ºå¸¸æ•°çš„çº¯éšæœºè¿‡ç¨‹ã€‚ARæ¨¡å‹è¿˜å­˜åœ¨ä¸€ä¸ªé˜¶æ•°ï¼Œç§°ä¸ºARï¼ˆpï¼‰æ¨¡å‹ï¼Œä¹Ÿå«ä½œpé˜¶è‡ªå›å½’æ¨¡å‹ã€‚å®ƒæŒ‡çš„æ˜¯é€šè¿‡è¿™ä¸ªæ—¶åˆ»ç‚¹çš„å‰pä¸ªç‚¹ï¼Œé€šè¿‡çº¿æ€§ç»„åˆå†åŠ ä¸Šç™½å™ªå£°æ¥é¢„æµ‹å½“å‰æ—¶åˆ»ç‚¹çš„å€¼ã€‚

MAçš„è‹±æ–‡å…¨ç§°å«åš Moving Averageï¼Œä¸­æ–‡å«åšæ»‘åŠ¨å¹³å‡æ¨¡å‹ã€‚å®ƒä¸ARæ¨¡å‹å¤§åŒå°å¼‚ï¼ŒARæ¨¡å‹æ˜¯å†å²æ—¶åºå€¼çš„çº¿æ€§ç»„åˆï¼ŒMAæ˜¯é€šè¿‡å†å²ç™½å™ªå£°è¿›è¡Œçº¿æ€§ç»„åˆæ¥å½±å“å½“å‰æ—¶åˆ»ç‚¹ã€‚ARæ¨¡å‹ä¸­çš„å†å²ç™½å™ªå£°æ˜¯é€šè¿‡å½±å“å†å²æ—¶åºå€¼ï¼Œä»è€Œé—´æ¥å½±å“åˆ°å½“å‰æ—¶åˆ»ç‚¹çš„é¢„æµ‹å€¼ã€‚åŒæ ·MAæ¨¡å‹ä¹Ÿå­˜åœ¨ä¸€ä¸ªé˜¶æ•°ï¼Œç§°ä¸ºMA(q)æ¨¡å‹ï¼Œä¹Ÿå«ä½œqé˜¶ç§»åŠ¨å¹³å‡æ¨¡å‹ã€‚æˆ‘ä»¬èƒ½çœ‹åˆ°ARå’ŒMAæ¨¡å‹éƒ½å­˜åœ¨é˜¶æ•°ï¼Œåœ¨ARæ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬ç”¨pè¡¨ç¤ºï¼Œåœ¨MAæ¨¡å‹ä¸­æˆ‘ä»¬ç”¨qè¡¨ç¤ºï¼Œè¿™ä¸¤ä¸ªæ¨¡å‹å¤§åŒå°å¼‚ï¼Œä¸ARæ¨¡å‹ä¸åŒçš„æ˜¯MAæ¨¡å‹æ˜¯å†å²ç™½å™ªå£°çš„çº¿æ€§ç»„åˆã€‚

ARMAçš„è‹±æ–‡å…¨ç§°æ˜¯Auto Regressive Moving Averageï¼Œä¸­æ–‡å«åšè‡ªå›å½’æ»‘åŠ¨å¹³å‡æ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯ARæ¨¡å‹å’ŒMAæ¨¡å‹çš„æ··åˆã€‚ç›¸æ¯”ARæ¨¡å‹å’ŒMAæ¨¡å‹ï¼Œå®ƒæœ‰æ›´å‡†ç¡®çš„ä¼°è®¡ã€‚åŒæ ·ARMAæ¨¡å‹å­˜åœ¨på’Œqä¸¤ä¸ªé˜¶æ•°ï¼Œç§°ä¸ºARMA(p,q)æ¨¡å‹ã€‚

ARIMAçš„è‹±æ–‡å…¨ç§°æ˜¯Auto Regressive Integrated Moving Averageæ¨¡å‹ï¼Œä¸­æ–‡å«å·®åˆ†è‡ªå›å½’æ»‘åŠ¨å¹³å‡æ¨¡å‹ï¼Œä¹Ÿå«æ±‚åˆè‡ªå›å½’æ»‘åŠ¨å¹³å‡æ¨¡å‹ã€‚ç›¸æ¯”äºARMAï¼ŒARIMAå¤šäº†ä¸€ä¸ªå·®åˆ†çš„è¿‡ç¨‹ï¼Œä½œç”¨æ˜¯å¯¹ä¸å¹³ç¨³æ•°æ®è¿›è¡Œå·®åˆ†å¹³ç¨³ï¼Œåœ¨å·®åˆ†å¹³ç¨³åå†è¿›è¡Œå»ºæ¨¡ã€‚ARIMAçš„åŸç†å’ŒARMAæ¨¡å‹ä¸€æ ·ã€‚ç›¸æ¯”äºARMA(p,q)çš„ä¸¤ä¸ªé˜¶æ•°ï¼ŒARIMAæ˜¯ä¸€ä¸ªä¸‰å…ƒç»„çš„é˜¶æ•°(p,d,q)ï¼Œç§°ä¸ºARIMA(p,d,q)æ¨¡å‹ã€‚å…¶ä¸­dæ˜¯å·®åˆ†é˜¶æ•°ã€‚

## ARMAæ¨¡å‹å·¥å…·

ä¸Šé¢ä»‹ç»çš„ARï¼ŒMAï¼ŒARMAï¼ŒARIMAå››ç§æ¨¡å‹ï¼Œä½ åªéœ€è¦äº†è§£åŸºç¡€æ¦‚å¿µå³å¯ï¼Œä¸­é—´æ¶‰åŠåˆ°çš„ä¸€äº›æ•°å­¦å…¬å¼è¿™é‡Œä¸è¿›è¡Œå±•å¼€ã€‚

åœ¨å®é™…å·¥ä½œä¸­ï¼Œæˆ‘ä»¬æ›´å¤šçš„æ˜¯ä½¿ç”¨å·¥å…·ï¼Œæˆ‘åœ¨è¿™é‡Œä¸»è¦è®²è§£ä¸‹å¦‚ä½•ä½¿ç”¨ARMAæ¨¡å‹å·¥å…·ã€‚

åœ¨ä½¿ç”¨ARMAå·¥å…·å‰ï¼Œä½ éœ€è¦å…ˆå¼•ç”¨ç›¸å…³å·¥å…·åŒ…ï¼š

```
from statsmodels.tsa.arima_model import ARMA
```

ç„¶åé€šè¿‡ARMA(endog,order,exog=None)åˆ›å»ºARMAç±»ï¼Œè¿™é‡Œæœ‰ä¸€äº›ä¸»è¦çš„å‚æ•°ç®€å•è¯´æ˜ä¸‹ï¼š

endogï¼šè‹±æ–‡æ˜¯endogenous variableï¼Œä»£è¡¨å†…ç”Ÿå˜é‡ï¼Œåˆå«éæ”¿ç­–æ€§å˜é‡ï¼Œå®ƒæ˜¯ç”±æ¨¡å‹å†³å®šçš„ï¼Œä¸è¢«æ”¿ç­–å·¦å³ï¼Œå¯ä»¥è¯´æ˜¯æˆ‘ä»¬æƒ³è¦åˆ†æçš„å˜é‡ï¼Œæˆ–è€…è¯´æ˜¯æˆ‘ä»¬è¿™æ¬¡é¡¹ç›®ä¸­éœ€è¦ç”¨åˆ°çš„å˜é‡ã€‚

orderï¼šä»£è¡¨æ˜¯på’Œqçš„å€¼ï¼Œä¹Ÿå°±æ˜¯ARMAä¸­çš„é˜¶æ•°ã€‚

exogï¼šè‹±æ–‡æ˜¯exogenous variablesï¼Œä»£è¡¨å¤–ç”Ÿå˜é‡ã€‚å¤–ç”Ÿå˜é‡å’Œå†…ç”Ÿå˜é‡ä¸€æ ·æ˜¯ç»æµæ¨¡å‹ä¸­çš„ä¸¤ä¸ªé‡è¦å˜é‡ã€‚ç›¸å¯¹äºå†…ç”Ÿå˜é‡è€Œè¨€ï¼Œå¤–ç”Ÿå˜é‡åˆç§°ä½œä¸ºæ”¿ç­–æ€§å˜é‡ï¼Œåœ¨ç»æµæœºåˆ¶å†…å—å¤–éƒ¨å› ç´ çš„å½±å“ï¼Œä¸æ˜¯æˆ‘ä»¬æ¨¡å‹è¦ç ”ç©¶çš„å˜é‡ã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦åˆ›å»ºARMA(7,0)æ¨¡å‹ï¼Œå¯ä»¥å†™æˆï¼šARMA(data,(7,0))ï¼Œå…¶ä¸­dataæ˜¯æˆ‘ä»¬æƒ³è¦è§‚å¯Ÿçš„å˜é‡ï¼Œ(7,0)ä»£è¡¨(p,q)çš„é˜¶æ•°ã€‚

åˆ›å»ºå¥½ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡fitå‡½æ•°è¿›è¡Œæ‹Ÿåˆï¼Œé€šè¿‡predict(start, end)å‡½æ•°è¿›è¡Œé¢„æµ‹ï¼Œå…¶ä¸­startä¸ºé¢„æµ‹çš„èµ·å§‹æ—¶é—´ï¼Œendä¸ºé¢„æµ‹çš„ç»ˆæ­¢æ—¶é—´ã€‚

ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨ARMAæ¨¡å‹å¯¹ä¸€ç»„æ—¶é—´åºåˆ—åšå»ºæ¨¡ï¼Œä»£ç å¦‚ä¸‹ï¼š

```
# coding:utf-8
# ç”¨ARMAè¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹
import pandas as pd
import matplotlib.pyplot as plt
import statsmodels.api as sm
from statsmodels.tsa.arima_model import ARMA
from statsmodels.graphics.api import qqplot
# åˆ›å»ºæ•°æ®
data = [5922, 5308, 5546, 5975, 2704, 1767, 4111, 5542, 4726, 5866, 6183, 3199, 1471, 1325, 6618, 6644, 5337, 7064, 2912, 1456, 4705, 4579, 4990, 4331, 4481, 1813, 1258, 4383, 5451, 5169, 5362, 6259, 3743, 2268, 5397, 5821, 6115, 6631, 6474, 4134, 2728, 5753, 7130, 7860, 6991, 7499, 5301, 2808, 6755, 6658, 7644, 6472, 8680, 6366, 5252, 8223, 8181, 10548, 11823, 14640, 9873, 6613, 14415, 13204, 14982, 9690, 10693, 8276, 4519, 7865, 8137, 10022, 7646, 8749, 5246, 4736, 9705, 7501, 9587, 10078, 9732, 6986, 4385, 8451, 9815, 10894, 10287, 9666, 6072, 5418]
data=pd.Series(data)
data_index = sm.tsa.datetools.dates_from_range('1901','1990')
# ç»˜åˆ¶æ•°æ®å›¾
data.index = pd.Index(data_index)
data.plot(figsize=(12,8))
plt.show()
# åˆ›å»ºARMAæ¨¡å‹# åˆ›å»ºARMAæ¨¡å‹
arma = ARMA(data,(7,0)).fit()
print('AIC: %0.4lf' %arma.aic)
# æ¨¡å‹é¢„æµ‹
predict_y = arma.predict('1990', '2000')
# é¢„æµ‹ç»“æœç»˜åˆ¶
fig, ax = plt.subplots(figsize=(12, 8))
ax = data.loc['1901':].plot(ax=ax)
predict_y.plot(ax=ax)
plt.show()
```

è¿è¡Œç»“æœï¼š

```
AIC: 1619.6323
```

![](https://static001.geekbang.org/resource/image/71/6a/71c5fe77926ba65e4b4aca48c337c66a.png?wh=1726%2A1153)

![](https://static001.geekbang.org/resource/image/08/fc/082ff6d7e85e176b8fd5c38f528314fc.png?wh=1727%2A1131)  
æˆ‘åˆ›å»ºäº†1901å¹´-1990å¹´ä¹‹é—´çš„æ—¶é—´åºåˆ—æ•°æ®dataï¼Œç„¶ååˆ›å»ºARMA(7,0)æ¨¡å‹ï¼Œå¹¶ä¼ å…¥æ—¶é—´åºåˆ—æ•°æ®dataï¼Œä½¿ç”¨fitå‡½æ•°æ‹Ÿåˆï¼Œç„¶åå¯¹1990å¹´-2000å¹´ä¹‹é—´çš„æ•°æ®è¿›è¡Œé¢„æµ‹ï¼Œæœ€åç»˜åˆ¶é¢„æµ‹ç»“æœã€‚

ä½ èƒ½çœ‹åˆ°ARMAå·¥å…·çš„ä½¿ç”¨è¿˜æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œåªæ˜¯æˆ‘ä»¬éœ€è¦på’Œqçš„å–å€¼ã€‚å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç»™på’ŒqæŒ‡å®šä¸€ä¸ªèŒƒå›´ï¼Œè®©ARMAéƒ½è¿è¡Œä¸€ä¸‹ï¼Œç„¶åé€‰æ‹©æœ€é€‚åˆçš„æ¨¡å‹ã€‚

ä½ å¯èƒ½ä¼šé—®ï¼Œæ€ä¹ˆåˆ¤æ–­ä¸€ä¸ªæ¨¡å‹æ˜¯å¦é€‚åˆï¼Ÿ

æˆ‘ä»¬éœ€è¦å¼•å…¥AICå‡†åˆ™ï¼Œä¹Ÿå«ä½œèµ¤æ± æ¶ˆæ¯å‡†åˆ™ï¼Œå®ƒæ˜¯è¡¡é‡ç»Ÿè®¡æ¨¡å‹æ‹Ÿåˆå¥½åçš„ä¸€ä¸ªæ ‡å‡†ï¼Œæ•°å€¼è¶Šå°ä»£è¡¨æ¨¡å‹æ‹Ÿåˆå¾—è¶Šå¥½ã€‚

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½ èƒ½çœ‹åˆ°ARMA(7,0)è¿™ä¸ªæ¨¡å‹æ‹Ÿåˆå‡ºæ¥çš„AICæ˜¯1619.6323ï¼ˆå¹¶ä¸ä¸€å®šæ˜¯æœ€ä¼˜ï¼‰ã€‚

## å¯¹æ¯”ç‰¹å¸èµ°åŠ¿è¿›è¡Œé¢„æµ‹

æˆ‘ä»¬éƒ½çŸ¥é“æ¯”ç‰¹å¸çš„èµ°åŠ¿é™¤äº†å’Œå†å²æ•°æ®ä»¥å¤–ï¼Œè¿˜å’Œå¾ˆå¤šå¤–ç•Œå› ç´ ç›¸å…³ï¼Œæ¯”å¦‚ç”¨æˆ·çš„å…³æ³¨åº¦ï¼Œå„å›½çš„æ”¿ç­–ï¼Œå¸åœˆä¹‹é—´æ˜¯å¦æ‰“æ¶ç­‰ç­‰ã€‚å½“ç„¶è¿™äº›å¤–ç•Œçš„å› ç´ ä¸æ˜¯æˆ‘ä»¬è¿™èŠ‚è¯¾éœ€è¦è€ƒè™‘çš„å¯¹è±¡ã€‚

å‡è®¾æˆ‘ä»¬åªè€ƒè™‘æ¯”ç‰¹å¸ä»¥å¾€çš„å†å²æ•°æ®ï¼Œç”¨ARMAè¿™ä¸ªæ—¶é—´åºåˆ—æ¨¡å‹é¢„æµ‹æ¯”ç‰¹å¸çš„èµ°åŠ¿ã€‚

æ¯”ç‰¹å¸å†å²æ•°æ®ï¼ˆä»2012-01-01åˆ°2018-10-31ï¼‰å¯ä»¥ä»GitHubä¸Šä¸‹è½½ï¼š[https://github.com/cystanford/bitcoin](https://github.com/cystanford/bitcoin)ã€‚

ä½ èƒ½çœ‹åˆ°æ•°æ®ä¸€å…±åŒ…æ‹¬äº†8ä¸ªå­—æ®µï¼Œä»£è¡¨çš„å«ä¹‰å¦‚ä¸‹ï¼š

![](https://static001.geekbang.org/resource/image/b0/36/b0db4047723ec5e649240e2a87196a36.png?wh=468%2A288)  
æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ„é€ ARMAæ—¶é—´åºåˆ—æ¨¡å‹ï¼Œé¢„æµ‹æ¯”ç‰¹å¸ï¼ˆå¹³å‡ï¼‰ä»·æ ¼èµ°åŠ¿ã€‚på’Œqå‚æ•°å…·ä½“é€‰æ‹©å¤šå°‘å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªåŒºé—´èŒƒå›´ï¼Œç„¶åé€‰æ‹©AICæœ€ä½çš„ARMAæ¨¡å‹ã€‚

æˆ‘ä»¬æ¢³ç†ä¸‹æ•´ä¸ªé¡¹ç›®çš„æµç¨‹ï¼š

![](https://static001.geekbang.org/resource/image/95/1e/95f8294c1f4805b86f9947178499181e.jpg?wh=2358%2A1091)  
é¦–å…ˆæˆ‘ä»¬éœ€è¦åŠ è½½æ•°æ®ã€‚

åœ¨å‡†å¤‡é˜¶æ®µï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ¢ç´¢æ•°æ®ï¼Œé‡‡ç”¨æ•°æ®å¯è§†åŒ–æ–¹å¼æŸ¥çœ‹æ¯”ç‰¹å¸çš„å†å²èµ°åŠ¿ã€‚æŒ‰ç…§ä¸åŒçš„æ—¶é—´å°ºåº¦ï¼ˆå¤©ï¼Œæœˆï¼Œå­£åº¦ï¼Œå¹´ï¼‰å¯ä»¥å°†æ•°æ®å‹ç¼©ï¼Œå¾—åˆ°ä¸åŒå°ºåº¦çš„æ•°æ®ï¼Œç„¶ååšå¯è§†åŒ–å‘ˆç°ã€‚è¿™4ä¸ªæ—¶é—´å°ºåº¦ä¸Šï¼Œæˆ‘ä»¬é€‰æ‹©æœˆä½œä¸ºé¢„æµ‹æ¨¡å‹çš„æ—¶é—´å°ºåº¦ï¼Œç›¸åº”çš„ï¼Œæˆ‘ä»¬é€‰æ‹©Weighted\_Priceè¿™ä¸ªå­—æ®µçš„æ•°å€¼ä½œä¸ºè§‚å¯Ÿç»“æœï¼Œåœ¨åŸå§‹æ•°æ®ä¸­ï¼ŒWeighted\_Priceå¯¹åº”çš„æ˜¯æ¯”ç‰¹å¸æ¯å¤©çš„å¹³å‡ä»·æ ¼ï¼Œå½“æˆ‘ä»¬ä»¥â€œæœˆâ€ä¸ºå•ä½è¿›è¡Œå‹ç¼©çš„æ—¶å€™ï¼Œå¯¹åº”çš„Weighted\_Priceå¾—åˆ°çš„å°±æ˜¯å½“æœˆçš„æ¯”ç‰¹å¸å¹³å‡ä»·æ ¼ã€‚å‹ç¼©ä»£ç å¦‚ä¸‹ï¼š

```
df_month = df.resample('M').mean()
```

æœ€ååœ¨é¢„æµ‹é˜¶æ®µåˆ›å»ºARMAæ—¶é—´åºåˆ—æ¨¡å‹ã€‚æˆ‘ä»¬å¹¶ä¸çŸ¥é“på’Œqå–ä»€ä¹ˆå€¼æ—¶ï¼Œæ¨¡å‹æœ€ä¼˜ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç»™å®ƒä»¬è®¾ç½®ä¸€ä¸ªåŒºé—´èŒƒå›´ï¼Œæ¯”å¦‚éƒ½æ˜¯range(0,3)ï¼Œç„¶åè®¡ç®—ä¸åŒæ¨¡å‹çš„AICæ•°å€¼ï¼Œé€‰æ‹©æœ€å°çš„AICæ•°å€¼å¯¹åº”çš„é‚£ä¸ªARMAæ¨¡å‹ã€‚æœ€åç”¨è¿™ä¸ªæœ€ä¼˜çš„ARMAæ¨¡å‹é¢„æµ‹æœªæ¥8ä¸ªæœˆçš„æ¯”ç‰¹å¸å¹³å‡ä»·æ ¼èµ°åŠ¿ï¼Œå¹¶å°†ç»“æœåšå¯è§†åŒ–å‘ˆç°ã€‚

åŸºäºè¿™ä¸ªæµç¨‹ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š

```
# -*- coding: utf-8 -*-
# æ¯”ç‰¹å¸èµ°åŠ¿é¢„æµ‹ï¼Œä½¿ç”¨æ—¶é—´åºåˆ—ARMA
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from statsmodels.tsa.arima_model import ARMA
import warnings
from itertools import product
from datetime import datetime
warnings.filterwarnings('ignore')
# æ•°æ®åŠ è½½
df = pd.read_csv('./bitcoin_2012-01-01_to_2018-10-31.csv')
# å°†æ—¶é—´ä½œä¸ºdfçš„ç´¢å¼•
df.Timestamp = pd.to_datetime(df.Timestamp)
df.index = df.Timestamp
# æ•°æ®æ¢ç´¢
print(df.head())
# æŒ‰ç…§æœˆï¼Œå­£åº¦ï¼Œå¹´æ¥ç»Ÿè®¡
df_month = df.resample('M').mean()
df_Q = df.resample('Q-DEC').mean()
df_year = df.resample('A-DEC').mean()
# æŒ‰ç…§å¤©ï¼Œæœˆï¼Œå­£åº¦ï¼Œå¹´æ¥æ˜¾ç¤ºæ¯”ç‰¹å¸çš„èµ°åŠ¿
fig = plt.figure(figsize=[15, 7])
plt.rcParams['font.sans-serif']=['SimHei'] #ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾
plt.suptitle('æ¯”ç‰¹å¸é‡‘é¢ï¼ˆç¾é‡‘ï¼‰', fontsize=20)
plt.subplot(221)
plt.plot(df.Weighted_Price, '-', label='æŒ‰å¤©')
plt.legend()
plt.subplot(222)
plt.plot(df_month.Weighted_Price, '-', label='æŒ‰æœˆ')
plt.legend()
plt.subplot(223)
plt.plot(df_Q.Weighted_Price, '-', label='æŒ‰å­£åº¦')
plt.legend()
plt.subplot(224)
plt.plot(df_year.Weighted_Price, '-', label='æŒ‰å¹´')
plt.legend()
plt.show()
# è®¾ç½®å‚æ•°èŒƒå›´
ps = range(0, 3)
qs = range(0, 3)
parameters = product(ps, qs)
parameters_list = list(parameters)
# å¯»æ‰¾æœ€ä¼˜ARMAæ¨¡å‹å‚æ•°ï¼Œå³best_aicæœ€å°
results = []
best_aic = float("inf") # æ­£æ— ç©·
for param in parameters_list:
    try:
        model = ARMA(df_month.Weighted_Price,order=(param[0], param[1])).fit()
    except ValueError:
        print('å‚æ•°é”™è¯¯:', param)
        continue
    aic = model.aic
    if aic < best_aic:
        best_model = model
        best_aic = aic
        best_param = param
    results.append([param, model.aic])
# è¾“å‡ºæœ€ä¼˜æ¨¡å‹
result_table = pd.DataFrame(results)
result_table.columns = ['parameters', 'aic']
print('æœ€ä¼˜æ¨¡å‹: ', best_model.summary())
# æ¯”ç‰¹å¸é¢„æµ‹
df_month2 = df_month[['Weighted_Price']]
date_list = [datetime(2018, 11, 30), datetime(2018, 12, 31), datetime(2019, 1, 31), datetime(2019, 2, 28), datetime(2019, 3, 31), 
             datetime(2019, 4, 30), datetime(2019, 5, 31), datetime(2019, 6, 30)]
future = pd.DataFrame(index=date_list, columns= df_month.columns)
df_month2 = pd.concat([df_month2, future])
df_month2['forecast'] = best_model.predict(start=0, end=91)
# æ¯”ç‰¹å¸é¢„æµ‹ç»“æœæ˜¾ç¤º
plt.figure(figsize=(20,7))
df_month2.Weighted_Price.plot(label='å®é™…é‡‘é¢')
df_month2.forecast.plot(color='r', ls='--', label='é¢„æµ‹é‡‘é¢')
plt.legend()
plt.title('æ¯”ç‰¹å¸é‡‘é¢ï¼ˆæœˆï¼‰')
plt.xlabel('æ—¶é—´')
plt.ylabel('ç¾é‡‘')
plt.show()
```

è¿è¡Œç»“æœï¼š

```
           Timestamp       ...        Weighted_Price
Timestamp                   ...                      
2011-12-31 2011-12-31       ...              4.471603
2012-01-01 2012-01-01       ...              4.806667
2012-01-02 2012-01-02       ...              5.000000
2012-01-03 2012-01-03       ...              5.252500
2012-01-04 2012-01-04       ...              5.208159

[5 rows x 8 columns]
```

![](https://static001.geekbang.org/resource/image/a9/2e/a91da037291f81fb6c90dc12223e9b2e.png?wh=1726%2A896)

![](https://static001.geekbang.org/resource/image/f6/98/f6a288ca19200918dfe219d2be47af98.png?wh=1729%2A932)

![](https://static001.geekbang.org/resource/image/a6/f9/a6648f60cf39dcba9fe81069da214cf9.png?wh=1729%2A661)  
æˆ‘ä»¬é€šè¿‡productå‡½æ•°åˆ›å»ºäº†(p,q)åœ¨range(0,3)èŒƒå›´å†…çš„æ‰€æœ‰å¯èƒ½ç»„åˆï¼Œå¹¶å¯¹æ¯ä¸ªARMA(p,q)æ¨¡å‹è¿›è¡Œäº†AICæ•°å€¼è®¡ç®—ï¼Œä¿å­˜äº†AICæ•°å€¼æœ€å°çš„æ¨¡å‹å‚æ•°ã€‚ç„¶åç”¨è¿™ä¸ªæ¨¡å‹å¯¹æ¯”ç‰¹å¸çš„æœªæ¥8ä¸ªæœˆè¿›è¡Œäº†é¢„æµ‹ã€‚

ä»ç»“æœä¸­ä½ èƒ½çœ‹åˆ°ï¼Œåœ¨2018å¹´10æœˆä¹‹å8ä¸ªæœˆçš„æ—¶é—´é‡Œï¼Œæ¯”ç‰¹å¸ä¼šè§¦åº•åˆ°4000ç¾é‡‘å·¦å³ï¼Œå®é™…ä¸Šæ¯”ç‰¹å¸åœ¨è¿™ä¸ªé˜¶æ®µç¡®å®é™ä½åˆ°äº†4000å…ƒç¾é‡‘ç”šè‡³æ›´ä½ã€‚åœ¨æ—¶é—´å°ºåº¦çš„é€‰æ‹©ä¸Šï¼Œæˆ‘ä»¬é€‰æ‹©äº†æœˆï¼Œè¿™æ ·å°±å¯¹æ•°æ®è¿›è¡Œäº†é™ç»´ï¼Œä¹ŸèŠ‚çº¦äº†ARMAçš„æ¨¡å‹è®­ç»ƒæ—¶é—´ã€‚ä½ èƒ½çœ‹åˆ°æ¯”ç‰¹å¸é‡‘é¢ï¼ˆç¾é‡‘ï¼‰è¿™å¼ å›¾ä¸­ï¼ŒæŒ‰æœˆåˆ’åˆ†çš„æ¯”ç‰¹å¸èµ°åŠ¿å’ŒæŒ‰å¤©åˆ’åˆ†çš„æ¯”ç‰¹å¸èµ°åŠ¿å·®åˆ«ä¸å¤§ï¼Œåœ¨å‡å°‘äº†å±€éƒ¨çš„æ³¢åŠ¨çš„åŒæ—¶ä¹Ÿèƒ½ä½“ç°å‡ºæ¯”ç‰¹å¸çš„è¶‹åŠ¿ï¼Œè¿™æ ·å°±èŠ‚çº¦äº†ARMAçš„æ¨¡å‹è®­ç»ƒæ—¶é—´ã€‚

## æ€»ç»“

ä»Šå¤©æˆ‘ç»™ä½ è®²äº†ä¸€ä¸ªæ¯”ç‰¹å¸è¶‹åŠ¿é¢„æµ‹çš„å®æˆ˜é¡¹ç›®ã€‚é€šè¿‡è¿™ä¸ªé¡¹ç›®ä½ åº”è¯¥èƒ½ä½“ä¼šåˆ°ï¼Œå½“æˆ‘ä»¬å¯¹ä¸€ä¸ªæ•°å€¼è¿›è¡Œé¢„æµ‹çš„æ—¶å€™ï¼Œå¦‚æœè€ƒè™‘çš„æ˜¯å¤šä¸ªå˜é‡å’Œç»“æœä¹‹é—´çš„å…³ç³»ï¼Œå¯ä»¥é‡‡ç”¨å›å½’åˆ†æï¼Œå¦‚æœè€ƒè™‘å•ä¸ªæ—¶é—´ç»´åº¦ä¸ç»“æœçš„å…³ç³»ï¼Œå¯ä»¥ä½¿ç”¨æ—¶é—´åºåˆ—åˆ†æã€‚

æ ¹æ®æ¯”ç‰¹å¸çš„å†å²æ•°æ®ï¼Œæˆ‘ä»¬ä½¿ç”¨ARMAæ¨¡å‹å¯¹æ¯”ç‰¹å¸æœªæ¥8ä¸ªæœˆçš„èµ°åŠ¿è¿›è¡Œäº†é¢„æµ‹ï¼Œå¹¶å¯¹ç»“æœè¿›è¡Œäº†å¯è§†åŒ–æ˜¾ç¤ºã€‚ä½ èƒ½çœ‹åˆ°ARMAå·¥å…·è¿˜æ˜¯å¾ˆå¥½ç”¨çš„ï¼Œè™½ç„¶æ¯”ç‰¹å¸çš„èµ°åŠ¿å—å¾ˆå¤šå¤–åœ¨å› ç´ å½±å“ï¼Œæ¯”å¦‚æ”¿ç­–ç¯å¢ƒã€‚ä¸è¿‡å½“æˆ‘ä»¬æŒæ¡äº†è¿™äº›å†å²æ•°æ®ï¼Œä¹Ÿä¸å¦¨ç”¨æ—¶é—´åºåˆ—æ¨¡å‹æ¥åˆ†æé¢„æµ‹ä¸€ä¸‹ã€‚

![](https://static001.geekbang.org/resource/image/24/94/24f8ee2f600a2451eecd58a98f7db894.png?wh=1726%2A846)  
æœ€åä¾ç„¶æ˜¯æ€è€ƒé¢˜ç¯èŠ‚ï¼Œä»Šå¤©æˆ‘ä»¬è®²äº†ARã€MAã€ARMAå’ŒARIMAï¼Œä½ èƒ½ç®€å•è¯´è¯´å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ä¹ˆï¼Ÿ

å¦å¤–æˆ‘åœ¨[GitHub](https://github.com/cystanford/bitcoin)ä¸­ä¸Šä¼ äº†æ²ªå¸‚æŒ‡æ•°çš„å†å²æ•°æ®ï¼ˆå¯¹åº”çš„shanghai\_1990-12-19\_to\_2019-2-28.csvï¼‰ï¼Œè¯·ä½ ç¼–å†™ä»£ç ä½¿ç”¨ARMAæ¨¡å‹å¯¹æ²ªå¸‚æŒ‡æ•°æœªæ¥10ä¸ªæœˆï¼ˆæˆªæ­¢åˆ°2019å¹´12æœˆ31æ—¥ï¼‰çš„å˜åŒ–è¿›è¡Œé¢„æµ‹ï¼ˆå°†æ•°æ®è½¬åŒ–ä¸ºæŒ‰æœˆç»Ÿè®¡å³å¯ï¼‰ã€‚

æ¬¢è¿ä½ åœ¨è¯„è®ºåŒºä¸æˆ‘åˆ†äº«ä½ çš„ç­”æ¡ˆï¼Œä¹Ÿæ¬¢è¿ç‚¹å‡»â€œè¯·æœ‹å‹è¯»â€ï¼ŒæŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–è€…åŒäº‹ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ15ï¼‰</strong></div><ul>
<li><span>Geek_2a6093</span> ğŸ‘ï¼ˆ17ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆèƒ½ä¸èƒ½è®²ä¸€ä¸‹LSTM
</p>2019-03-18</li><br/><li><span>Geek_hve78z</span> ğŸ‘ï¼ˆ7ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<p>è¿è¡Œæ²ªå¸‚æŒ‡æ•°æ•°æ®ç»“æœä¸ºï¼š
å‚æ•°é”™è¯¯: (0, 2)
æœ€ä¼˜æ¨¡å‹: ARMA Model Results  
é¢„æµ‹æ•°æ®ï¼š
2019-03-31		2841.753594
2019-04-30		2862.532373
2019-05-31		2816.252354
2019-06-30		2801.829572
2019-07-31		2773.588278
2019-08-31		2752.587602
2019-09-30		2729.086661
2019-10-31		2707.560415
2019-11-30		2685.923215
2019-12-31		2665.117874
-----------
df_month2[&#39;forecast&#39;]=best_model.predict(start=0,end=348)ç†è§£
start=0è¡¨ç¤ºä»ç¬¬0è¯¾æ•°æ®å¼€å§‹è®¡ç®—
end=348æ˜¯æŒ‡éœ€è¦è®¡ç®—348ä¸ªæ•°æ®ï¼Œå³ä»1990-12-19åˆ°2019-12-31ä¸€å…±æœ‰348ä¸ªæœˆï¼Œæ‰€ä»¥æœ‰348ä¸ªæ•°æ®</p>2019-03-18</li><br/><li><span>Geek_hve78z</span> ğŸ‘ï¼ˆ7ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p># -*- coding:utf-8 -*-
# ç¼–ç ä½¿ç”¨ ARMA æ¨¡å‹å¯¹æ²ªå¸‚æŒ‡æ•°æœªæ¥ 10 ä¸ªæœˆï¼ˆæˆªæ­¢åˆ° 2019 å¹´ 12 æœˆ 31 æ—¥ï¼‰çš„å˜åŒ–è¿›è¡Œé¢„æµ‹
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from statsmodels.tsa.arima_model import ARMA
import warnings
from itertools import product
from datetime import datetime
warnings.filterwarnings(&#39;ignore&#39;)

# æ•°æ®åŠ è½½
df=pd.read_csv(&#39;.&#47;bitcoin-master&#47;shanghai_1990-12-19_to_2019-2-28.csv&#39;)
# å°†æ—¶é—´ä½œä¸º df çš„ç´¢å¼•
df.Timestamp=pd.to_datetime(df.Timestamp)
df.index=df.Timestamp

# æ•°æ®æ¢ç´¢
print(df.head())

# æŒ‰ç…§æœˆæ¥ç»Ÿè®¡
df_month=df.resample(&#39;M&#39;).mean()

# æŒ‰ç…§æœˆæ¥æ˜¾ç¤ºæ²ªå¸‚æŒ‡æ•°çš„èµ°åŠ¿
fig=plt.figure(figsize=[15,7])
plt.rcParams[&#39;font.sans-serif&#39;]=[&#39;SimHei&#39;]
plt.suptitle(&#39;æ²ªå¸‚æŒ‡æ•°&#39;,fontsize=20)

plt.plot(df_month.Price,&#39;-&#39;,label=&#39;æŒ‰æœˆ&#39;)
plt.legend()
plt.show()

# è®¾ç½®å‚æ•°èŒƒå›´
ps=range(0,3)
qs=range(0,3)
parameters=product(ps,qs)
parameters_list=list(parameters)

# å¯»æ‰¾æœ€ä¼˜ ARMA æ¨¡å‹å‚æ•°ï¼Œå³ best_aic æœ€å°
results=[]
best_aic=float(&#39;inf&#39;)# æ­£æ— ç©·
for param in parameters_list:
    try:
        model=ARMA(df_month.Price,order=(param[0],param[1])).fit()
    except ValueError:
        print(&#39;å‚æ•°é”™è¯¯:&#39;,param)
        continue
    aic=model.aic
    if aic&lt;best_aic:
        best_model=model
        best_aic=aic
        best_param=param
    results.append([param,model.aic])
# è¾“å‡ºæœ€ä¼˜æ¨¡å‹
result_table=pd.DataFrame(results)
result_table.columns=[&#39;parameters&#39;,&#39;aic&#39;]
print(&#39;æœ€ä¼˜æ¨¡å‹:&#39;,best_model.summary())

# æ²ªå¸‚æŒ‡æ•°é¢„æµ‹
df_month2=df_month[[&#39;Price&#39;]]
date_list= [datetime(2019, 3, 31), datetime(2019, 4, 30), datetime(2019, 5, 31), datetime(2019, 6, 30), datetime(2019, 7, 31),
             datetime(2019, 8, 31), datetime(2019, 9, 30), datetime(2019, 10, 31),datetime(2019, 11, 30),datetime(2019, 12, 31)]
future=pd.DataFrame(index=date_list,columns=df_month.columns)
df_month2=pd.concat([df_month2,future])
df_month2[&#39;forecast&#39;]=best_model.predict(start=0,end=348)
# æ²ªå¸‚æŒ‡æ•°é¢„æµ‹ç»“æœæ˜¾ç¤º
plt.figure(figsize=(20,7))
df_month2.Price.plot(label=&#39;å®é™…æŒ‡æ•°&#39;)
df_month2.forecast.plot(color=&#39;r&#39;,ls=&#39;--&#39;,label=&#39;é¢„æµ‹æŒ‡æ•°&#39;)
plt.legend()
plt.title(&#39;æ²ªå¸‚æŒ‡æ•°ï¼ˆæœˆï¼‰&#39;)
plt.xlabel(&#39;æ—¶é—´&#39;)
plt.ylabel(&#39;æŒ‡æ•°&#39;)
plt.show()</p>2019-03-18</li><br/><li><span>å¼ ä¸½æ–Œ</span> ğŸ‘ï¼ˆ6ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è¿™æ˜¯åˆšå¥½æ’å¯¹äº†å§ï¼Œæ¯”ç‰¹å¸ã€è‚¡å¸‚ä»€ä¹ˆçš„é¢„æµ‹å—å„ç§å› ç´ å½±å“å¤ªå¤§äº†ã€‚æ›´å¤šæ˜¯è€ƒè™‘åŠ¨æ€å› ç´ </p>2019-04-01</li><br/><li><span>è·³è·³</span> ğŸ‘ï¼ˆ6ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>ä¸€ã€ARã€MAã€ARMAã€ARIMAçš„åŒºåˆ«
ARçš„æ ¸å¿ƒæ€æƒ³æ˜¯è¿‡å»è‹¥å¹²ç‚¹çš„çº¿æ€§ç»„åˆï¼Œå†åŠ ä¸Šç™½å™ªå£°é¢„æµ‹æœªæ¥æ—¶åˆ»ç‚¹çš„å€¼ã€‚
MAçš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡å†å²ç™½å™ªå£°çº¿æ€§ç»„åˆæ¥å½±å“å½“å‰çš„æ—¶åˆ»ç‚¹ã€‚
ARMAï¼šç»“åˆARã€MAçš„æ€æƒ³ï¼Œç»¼åˆè€ƒè™‘å†å²ç™½å™ªå£°å’Œå½“å‰ç™½å™ªå£°ï¼Œé¢„æµ‹æœªæ¥æ—¶åˆ»ç‚¹ã€‚
ARIMAï¼šè¾ƒARMAå¤šäº†å·®åˆ†è¿‡ç¨‹ï¼Œå¯¹ä¸å¹³è¡¡æ•°æ®è¿›è¡Œäº†å·®åˆ†å¹³ç¨³ã€‚
äºŒã€æ²ªå¸‚æŒ‡æ•°é¢„æµ‹ç»“æœå¦‚ä¸‹ï¼š
å‚æ•°é”™è¯¯: (0, 2)
æœ€ä¼˜æ¨¡å‹:                                ARMA Model Results                              
==============================================================================
Dep. Variable:                  Price   No. Observations:                  339
Model:                     ARMA(2, 2)   Log Likelihood               -2208.110
Method:                       css-mle   S.D. of innovations            162.159
Date:                Mon, 18 Mar 2019   AIC                           4428.219
Time:                        10:59:23   BIC                           4451.175
Sample:                    12-31-1990   HQIC                          4437.367
                         - 02-28-2019                                         
</p>2019-03-18</li><br/><li><span>éª‘è¡Œçš„æŒæŸœJ</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<p>æˆ‘ç”¨ARIMAæ¨¡å‹å¯¹è€å¸ˆä¸€å¼€å§‹çš„é‚£ç»„æ—¶é—´åºåˆ—è¿›è¡Œäº†åˆ†æé¢„æµ‹ï¼Œå› ä¸ºå­—æ•°é™åˆ¶ï¼šçœç•¥ä¸€å¼€å§‹çš„æ•°æ®åŠ è½½å’Œæœ€åçš„é¢„æµ‹æ­¥éª¤ï¼Œä½†æ˜¯åŠ å…¥å¯¹å·®åˆ†æ¬¡æ•°dçš„æŸ¥æ‰¾ã€æ‰¾ARIMAæ¨¡å‹çš„pã€qå€¼å’Œæ¨¡å‹æ£€éªŒä¸‰ä¸ªæ­¥éª¤ï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰ç”¨ï¼Œè°¢è°¢
# -*- coding: utf-8 -*-
# ç”¨ ARIMA è¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹
import numpy as np
from statsmodels.graphics.tsaplots import acf,pacf,plot_acf,plot_pacf
#2.ä¸‹é¢æˆ‘ä»¬å…ˆå¯¹éå¹³ç¨³æ—¶é—´åºåˆ—è¿›è¡Œæ—¶é—´åºåˆ—çš„å·®åˆ†ï¼Œæ‰¾å‡ºé€‚åˆçš„å·®åˆ†æ¬¡æ•°
#fig = plt.figure(figsize=(12, 8))
#ax1 = fig.add_subplot(111)
#diff1 = data.diff(1)
#diff1.plot(ax=ax1)
#è¿™é‡Œæ˜¯åšäº†1é˜¶å·®åˆ†ï¼Œå¯ä»¥çœ‹å‡ºæ—¶é—´åºåˆ—çš„å‡å€¼å’Œæ–¹å·®åŸºæœ¬å¹³ç¨³ï¼Œ
#è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ä¸€é˜¶å·®åˆ†çš„æ—¶é—´åºåˆ—ï¼ŒæŠŠä¸Šé¢ä»£ç æ³¨é‡Šæ‰
#3.æ¥ä¸‹æ¥æˆ‘ä»¬è¦æ‰¾åˆ°ARIMAæ¨¡å‹ä¸­åˆé€‚çš„på’Œqå€¼ï¼š
data = data.diff(1)
data.dropna(inplace=True)
#ç¬¬ä¸€æ­¥ï¼šå…ˆæ£€æŸ¥å¹³ç¨³åºåˆ—çš„è‡ªç›¸å…³å›¾å’Œåè‡ªç›¸å…³å›¾
fig = plt.figure(figsize=(12, 8))
ax1 = fig.add_subplot(211)
fig = sm.graphics.tsa.plot_acf(data,lags=40,ax=ax1)
#lags è¡¨ç¤ºæ»åçš„é˜¶æ•°ï¼Œä¸‹é¢åˆ†åˆ«å¾—åˆ°acf å›¾å’Œpacf å›¾
ax2 = fig.add_subplot(212)
fig = sm.graphics.tsa.plot_pacf(data, lags=40,ax=ax2)
#ç”±ä¸‹å›¾æˆ‘ä»¬å¯ä»¥åˆ†åˆ«ç”¨ARMA(0,1)æ¨¡å‹ã€ARMA(7,0)æ¨¡å‹ã€ARMA(7,1)æ¨¡å‹ç­‰æ¥æ‹Ÿåˆæ‰¾å‡ºæœ€ä½³æ¨¡å‹ï¼š
#ç¬¬ä¸‰æ­¥:æ‰¾å‡ºæœ€ä½³æ¨¡å‹ARMA
arma_mod1 = sm.tsa.ARMA(data,(7,0)).fit()
print(arma_mod1.aic, arma_mod1.bic, arma_mod1.hqic)
arma_mod2 = sm.tsa.ARMA(data,(0,1)).fit()
print(arma_mod2.aic, arma_mod2.bic, arma_mod2.hqic)
arma_mod3 = sm.tsa.ARMA(data,(7,1)).fit()
print(arma_mod3.aic, arma_mod3.bic, arma_mod3.hqic)
arma_mod4 = sm.tsa.ARMA(data,(8,0)).fit()
print(arma_mod4.aic, arma_mod4.bic, arma_mod4.hqic)
#ç”±ä¸Šé¢å¯ä»¥çœ‹å‡ºARMA(7,0)æ¨¡å‹æœ€ä½³
#ç¬¬å››æ­¥ï¼šè¿›è¡Œæ¨¡å‹æ£€éªŒï¼Œé¦–å…ˆå¯¹ARMA(7,0)æ¨¡å‹æ‰€äº§ç”Ÿçš„æ®‹å·®åšè‡ªç›¸å…³å›¾
resid = arma_mod1.resid
#ä¸€å®šè¦åŠ ä¸Šè¿™ä¸ªå˜é‡èµ‹å€¼è¯­å¥ï¼Œä¸ç„¶ä¼šæŠ¥é”™resid is not defined 
fig = plt.figure(figsize=(12, 8))
ax1 = fig.add_subplot(211)
fig = sm.graphics.tsa.plot_acf(resid.values.squeeze(),lags=40,ax=ax1)
ax2 = fig.add_subplot(212)
fig = sm.graphics.tsa.plot_pacf(resid, lags=40,ax=ax2)
#æ¥ç€åšå¾·å®¾-æ²ƒæ£®ï¼ˆD-Wï¼‰æ£€éªŒ
print(sm.stats.durbin_watson(arma_mod1.resid.values))
#å¾—å‡ºæ¥ç»“æœæ˜¯ä¸å­˜åœ¨è‡ªç›¸å…³æ€§çš„
#å†è§‚å¯Ÿæ˜¯å¦ç¬¦åˆæ­£æ€åˆ†å¸ƒ,è¿™é‡Œç”¨qqå›¾
fig = plt.figure(figsize=(12,8))
ax = fig.add_subplot(111)
fig = qqplot(resid, line=&#39;q&#39;,ax=ax, fit=True)
#æœ€åç”¨Ljung-Boxæ£€éªŒ:æ£€éªŒçš„ç»“æœå°±æ˜¯çœ‹æœ€åä¸€åˆ—å‰åäºŒè¡Œçš„æ£€éªŒæ¦‚ç‡ï¼ˆä¸€èˆ¬è§‚å¯Ÿæ»å1~12é˜¶ï¼‰
r,q,p = sm.tsa.acf(resid.values.squeeze(),qstat=True)
data1 = np.c_[range(1,41), r[1:], q, p]
table= pd.DataFrame(data1, columns=[ &#39;lag&#39;,&#39;AC&#39;,&#39;Q&#39;,&#39;Prob(&gt;Q)&#39;])
print(table.set_index(&#39;lag&#39;))
</p>2019-09-26</li><br/><li><span>æ»¢</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æƒ³é—®ä¸‹è€å¸ˆï¼Œï¼ˆ1ï¼‰å¯¹äºç±»ä¼¼äºå½©ç¥¨è¿™ç§ç±»å‹çš„æ•°æ®è¯¥ç”¨ä»€ä¹ˆç®—æ³•åˆ†æï¼Ÿï¼ˆ2ï¼‰å¯¹äºARMAçš„æœ€ä¼˜åªèƒ½äººä¸ºèµ‹å€¼ï¼Œå¾ªç¯æ£€æµ‹æœ€å¤§å€¼å—ï¼Ÿè‹¥æ•°æ®å¤šçš„æƒ…å†µæ€ä¹ˆåŠï¼Ÿ </p>2019-04-26</li><br/><li><span>å</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æˆ‘è§‰å¾—ç¡®å®æœ‰äº›é—®é¢˜ï¼Œåœ¨æ˜¯åŒarmaæ¨¡å‹ä¹‹å‰æ²¡æœ‰å¯¹æ•°æ®å¹³ç¨³æ€§æ£€éªŒï¼Œæ¯•ç«Ÿæ¨¡å‹æ˜¯åŸºäºå¹³ç¨³æ€§çš„ã€‚</p>2019-09-19</li><br/><li><span>Geek_hve78z</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ARã€MAã€ARMAå’ŒARIMAæ¨¡å‹åŒºåˆ«

1ã€AR ï¼ˆAuto Regressiveï¼‰ï¼Œä¸­æ–‡å«è‡ªå›å½’æ¨¡å‹ï¼Œå®ƒè®¤ä¸ºè¿‡å»è‹¥å¹²æ—¶åˆ»çš„ç‚¹é€šè¿‡çº¿æ€§ç»„åˆï¼Œå†åŠ ä¸Šç™½å™ªå£°å°±å¯ä»¥é¢„æµ‹æœªæ¥æŸä¸ªæ—¶åˆ»çš„ç‚¹ã€‚AR æ¨¡å‹è¿˜å­˜åœ¨ä¸€ä¸ªé˜¶æ•°ï¼Œç§°ä¸º ARï¼ˆpï¼‰æ¨¡å‹ï¼Œä¹Ÿå«ä½œ p é˜¶è‡ªå›å½’æ¨¡å‹ã€‚å®ƒæŒ‡çš„æ˜¯é€šè¿‡è¿™ä¸ªæ—¶åˆ»ç‚¹çš„å‰ p ä¸ªç‚¹ï¼Œé€šè¿‡çº¿æ€§ç»„åˆå†åŠ ä¸Šç™½å™ªå£°æ¥é¢„æµ‹å½“å‰æ—¶åˆ»ç‚¹çš„å€¼ã€‚

2ã€MA ï¼ˆ Moving Averageï¼‰ï¼Œä¸­æ–‡å«åšæ»‘åŠ¨å¹³å‡æ¨¡å‹ã€‚MA æ¨¡å‹å­˜åœ¨ä¸€ä¸ªé˜¶æ•°ï¼Œç§°ä¸º MA(q) æ¨¡å‹ï¼Œä¹Ÿå«ä½œ q é˜¶ç§»åŠ¨å¹³å‡æ¨¡å‹ã€‚MA æ¨¡å‹æ˜¯é€šè¿‡å°†ä¸€æ®µæ—¶é—´åºåˆ—ä¸­ç™½å™ªå£°åºåˆ—è¿›è¡ŒåŠ æƒå’Œã€‚

3ã€ARMA ï¼ˆ Auto Regressive Moving Averageï¼‰ï¼Œä¸­æ–‡å«åšè‡ªå›å½’æ»‘åŠ¨å¹³å‡æ¨¡å‹ï¼Œ ARMA æ¨¡å‹å­˜åœ¨ p å’Œ q ä¸¤ä¸ªé˜¶æ•°ï¼Œç§°ä¸º ARMA(p,q) æ¨¡å‹ã€‚

4ã€ARIMAï¼ˆ Auto Regressive Integrated Moving Average ï¼‰ï¼Œä¸­æ–‡å«å·®åˆ†è‡ªå›å½’æ»‘åŠ¨å¹³å‡æ¨¡å‹ï¼Œä¹Ÿå«æ±‚åˆè‡ªå›å½’æ»‘åŠ¨å¹³å‡æ¨¡å‹ã€‚ç›¸æ¯”äº ARMAï¼ŒARIMA å¤šäº†ä¸€ä¸ªå·®åˆ†çš„è¿‡ç¨‹ï¼Œä½œç”¨æ˜¯å¯¹ä¸å¹³ç¨³æ•°æ®è¿›è¡Œå·®åˆ†å¹³ç¨³ï¼Œåœ¨å·®åˆ†å¹³ç¨³åå†è¿›è¡Œå»ºæ¨¡ã€‚ARIMA æ˜¯ä¸€ä¸ªä¸‰å…ƒç»„çš„é˜¶æ•° (p,d,q)ï¼Œç§°ä¸º ARIMA(p,d,q) æ¨¡å‹ã€‚å…¶ä¸­ d æ˜¯å·®åˆ†é˜¶æ•°ã€‚</p>2019-03-18</li><br/><li><span>JustDoDT</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>äº¤ä½œä¸šï¼šå¿«å­¦å®Œç¬¬ä¸€éäº†ï¼Œå¥¥åˆ©ç»™å¹²äº†ã€‚
https:&#47;&#47;github.com&#47;LearningChanging&#47;Data-analysis-in-action&#47;tree&#47;master&#47;41-%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E5%AE%9E%E6%88%98%EF%BC%883%EF%BC%89%EF%BC%9A%E5%A6%82%E4%BD%95%E5%AF%B9%E6%AF%94%E7%89%B9%E5%B8%81%E8%B5%B0%E5%8A%BF%E8%BF%9B%E8%A1%8C%E9%A2%84%E6%B5%8B%EF%BC%9F</p>2020-04-24</li><br/><li><span>Ronnyz</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>AR 
éšæœºå˜é‡çš„å–å€¼æ˜¯å‰pæœŸçš„å¤šå…ƒçº¿æ€§å›å½’ï¼Œè®¤ä¸ºä¸»è¦å—è¿‡å»pæœŸçš„åºåˆ—å€¼å½±å“ã€‚è¯¯å·®é¡¹æ˜¯å½“å‰çš„éšæœºå¹²æ‰°ï¼Œä¸ºé›¶å‡å€¼ç™½å™ªå£°åºåˆ—
MA
åœ¨tæ—¶åˆ»çš„éšæœºå˜é‡çš„å–å€¼æ˜¯å‰qæœŸçš„éšæœºæ‰°åŠ¨çš„å¤šå…ƒçº¿æ€§å‡½æ•°ã€‚è¯¯å·®é¡¹æ˜¯å½“æœŸçš„éšæœºå¹²æ‰°,ä¸ºé›¶å‡å€¼ç™½å™ªå£°åºåˆ—ï¼Œæ˜¯åºåˆ—çš„å‡å€¼ã€‚è®¤ä¸ºä¸»è¦å—è¿‡å»qæœŸçš„è¯¯å·®é¡¹å½±å“ã€‚
ARMA
éšæœºå˜é‡çš„å–å€¼ä¸ä»…ä¸ä»¥å‰pæœŸçš„åºåˆ—å€¼æœ‰å…³è¿˜ä¸å‰qæœŸçš„éšæœºæ‰°åŠ¨æœ‰å…³ã€‚
ARIMA
å°†ARMAå’Œå·®åˆ†æ³•ç»“åˆï¼Œå¾—åˆ°ARIMA(p,d,q)ï¼Œå…¶ä¸­dæ˜¯éœ€è¦å¯¹æ•°æ®è¿›è¡Œå·®åˆ†çš„é˜¶æ•°ã€‚


#è®¾ç½®å‚æ•°è°ƒæ•´èŒƒå›´
p_scope=range(0,3)
q_scope=range(0,3)
æœ€ä¼˜æ¨¡å‹ï¼š
Model: 	ARMA(2, 2)
AIC 	4428.219</p>2019-12-02</li><br/><li><span>TKbook</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from statsmodels.tsa.arima_model import ARMA
import warnings
from itertools import product
from datetime import datetime
warnings.filterwarnings(&#39;ignore&#39;)
df = pd.read_csv(&#39;shanghai_1990-12-19_to_2019-2-28.csv&#39;)
df.index = pd.to_datetime(df.Timestamp)
df_month = df.resample(&#39;M&#39;).mean()
# è®¾ç½®å‚æ•°èŒƒå›´
ps = range(0, 3)
qs = range(0, 3)
parameters = product(ps, qs)
parameters_list = list(parameters)
# å¯»æ‰¾æœ€ä¼˜ARMAæ¨¡å‹å‚æ•°ï¼Œå³best_aicæœ€å°
results = []
best_aic = float(&#39;inf&#39;) # æ­£æ— ç©·
for param in parameters_list:
    try:
        model = ARMA(df_month.Price, order=(param[0], param[1])).fit()
    except ValueError:
        print(&#39;å‚æ•°é”™è¯¯ï¼š&#39;, param)
        continue
    aic = model.aic
    if aic &lt; best_aic:
        best_model = model
        best_aic = aic
        best_param = param
    results.append([param, model.aic])
# è¾“å‡ºæœ€ä¼˜æ¨¡å‹
result_table = pd.DataFrame(results)
result_table.columns = [&#39;parameters&#39;, &#39;aic&#39;]
print(&#39;æœ€ä¼˜æ¨¡å‹ï¼š&#39;, best_model.summary())
# è‚¡å¸‚é¢„æµ‹
date_list = [datetime(2019, 3, 31), datetime(2019, 4, 30), datetime(2019, 5, 31), datetime(2019, 6, 30),
             datetime(2019, 7, 31), datetime(2019, 8, 31), datetime(2019, 9, 30), datetime(2019, 10, 31),
             datetime(2019, 11, 30), datetime(2019, 12, 31)]
future = pd.DataFrame(index=date_list, columns=df_month.columns)
df_month = pd.concat([df_month, future])
df_month[&#39;forecast&#39;] = best_model.predict(start=0, end=348)
# é¢„æµ‹ç»“æœæ˜¾ç¤º
plt.figure(figsize=(20, 7))
df_month.Price.plot(label=&#39;å®é™…æŒ‡æ•°&#39;)
df_month.forecast.plot(color=&#39;r&#39;, ls=&#39;--&#39;, label=&#39;é¢„æµ‹æŒ‡æ•°&#39;)
plt.legend()
plt.title(&#39;é‡‘é¢ï¼ˆæœˆï¼‰&#39;)
plt.xlabel(&#39;TIME&#39;)
plt.ylabel(&#39;RMB&#39;)
plt.show()</p>2019-03-25</li><br/><li><span>éåŒå‡¡æƒ³</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>### best param (4,3)

import pandas as pd
from datetime import datetime
from statsmodels.tsa.arima_model import ARMA
import warnings
import matplotlib.pyplot as  plt
from itertools import product

warnings.filterwarnings(&#39;ignore&#39;)
data = pd.read_csv(&#39;~&#47;Documents&#47;bitcoin&#47;shanghai_1990-12-19_to_2019-2-28.csv&#39;)
print(data.head())
print(data.info())

data[&#39;Timestamp&#39;] = pd.to_datetime(data[&#39;Timestamp&#39;])
data.index = data[&#39;Timestamp&#39;]
print(data.head())
data_m = data.resample(&#39;M&#39;).mean()

q_range = range(0, 5)
p_range = range(0, 5)
params = product(q_range, p_range)
param_list = list(params)
# print(param_list)
results = []
best_aic = float(&#39;inf&#39;)

for param in param_list:
    try:
        model = ARMA(data_m[&#39;Price&#39;], order=(param[0], param[1])).fit()
    except ValueError:
        print(&quot;å‚æ•°é”™è¯¯&quot;, param)
        continue
    aic = model.aic
    if aic &lt; best_aic:
        best_model = model
        best_aic = aic
        best_param = param
    results.append([param, model.aic])

result_table = pd.DataFrame(results)
result_table.columns = [&#39;parameters&#39;, &#39;aic&#39;]

print(&quot;best model:&quot;, best_model.summary())
print(&quot;best param:&quot;, best_param)
data_month2 = data_m[[&#39;Price&#39;]]
date_list = [datetime(2019, 3, 31), datetime(2019, 4, 30), datetime(2019, 5, 31), datetime(2019, 6, 30),
             datetime(2019, 7, 31),
             datetime(2019, 8, 31), datetime(2019, 9, 30), datetime(2019, 10, 31), datetime(2019, 11, 30),
             datetime(2019, 12, 31)]
future = pd.DataFrame(index=date_list, columns=data_m.columns)
data_month2 = pd.concat([data_month2, future])
data_month2[&#39;forecast&#39;] = best_model.predict(start=0, end=384)
#start=0è¡¨ç¤ºä»ç¬¬0ä¸ªæ•°æ®å¼€å§‹è®¡ç®—
#end=348æ˜¯æŒ‡éœ€è¦è®¡ç®—348ä¸ªæ•°æ®ï¼Œå³ä»1990-12-19åˆ°2019-12-31ä¸€å…±æœ‰348ä¸ªæœˆï¼Œæ‰€ä»¥æœ‰348ä¸ªæ•°æ®
print(data_month2.head())
plt.figure(figsize=(20, 7))
plt.rcParams[&#39;font.sans-serif&#39;] = [&#39;SimHei&#39;]
data_month2[&#39;Price&#39;].plot(label=&#39;å®é™…æŒ‡æ•°&#39;)
data_month2[&#39;forecast&#39;].plot(label=&#39;é¢„æµ‹æŒ‡æ•°&#39;, ls=&#39;--&#39;, color=&#39;r&#39;)
plt.legend()
plt.title(&#39;æ²ªå¸‚æŒ‡æ•°ï¼ˆæœˆï¼‰&#39;)
plt.xlabel(&#39;æ—¶é—´&#39;)
plt.ylabel(&#39;æŒ‡æ•°&#39;)
plt.show()</p>2020-12-13</li><br/><li><span>å»ºå¼º</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è¯·é—®è€å¸ˆï¼Œæˆ‘ç”¨æ‚¨çš„æ–¹æ³•å¯»æ‰¾æœ€ä¼˜æ¨¡å‹æ—¶ï¼Œæœ€åå¾—åˆ°çš„æ¨¡å‹AICæ˜¯å°äº0çš„ï¼Œè¿™æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿæ˜¯ä¸æ˜¯å› ä¸ºæˆ‘çš„æ•°æ®åºåˆ—å€¼éƒ½æ˜¯å°äº1çš„åŸå› ï¼Ÿæœ€ç»ˆçš„è¾“å‡ºç»“æœæ˜¯è¿™æ ·çš„ï¼š
æœ€ä¼˜æ¨¡å‹:                                ARMA Model Results                              
==============================================================================
Dep. Variable:                   é£é™©ç³»æ•°   No. Observations:                  216
Model:                     ARMA(1, 1)   Log Likelihood                 364.911
Method:                       css-mle   S.D. of innovations              0.044
Date:                Tue, 30 Jun 2020   AIC                           -721.823
Time:                        17:37:35   BIC                           -708.322
Sample:                             0   HQIC                          -716.368
                                                                              
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
const          0.4613      0.072      6.415      0.000       0.320       0.602
ar.L1.é£é™©ç³»æ•°     0.9773      0.023     42.940      0.000       0.933       1.022
ma.L1.é£é™©ç³»æ•°    -0.4586      0.070     -6.583      0.000      -0.595      -0.322
                                    Roots                                    
=============================================================================
                  Real          Imaginary           Modulus         Frequency
-----------------------------------------------------------------------------
AR.1            1.0232           +0.0000j            1.0232            0.0000
MA.1            2.1805           +0.0000j            2.1805            0.0000
-----------------------------------------------------------------------------</p>2020-06-30</li><br/><li><span>æ»¢</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>Aè‚¡é¢„æµ‹ï¼Œè¯­è¨€Python3.6 ï¼Œæœ€ä½³æ¨¡å‹ARMA(5, 4)ï¼Œè®¾ç½®çš„èŒƒå›´ç¨å¤§ï¼Œå¾—åˆ°çš„ç»“æœè¿˜è›®æ¥è¿‘ï¼Œå¯ä»¥è®¾ç½®çš„å†å¤§ä¸€äº›ï¼Œä¸è¿‡æ•°æ®ä¼˜ç‚¹å¤šè·‘èµ·æ¥æ—¶é—´è¾ƒé•¿ã€‚
#æ•°æ®åŠ è½½
path = &#39;&#47;Users&#47;apple&#47;Desktop&#47;GitHubProject&#47;Read mark&#47;æ•°æ®åˆ†æ&#47;geekTime&#47;data&#47;&#39;
df = pd.read_csv(path + &#39;shanghai_1990-12-19_to_2019-2-28.csv&#39;)
#å°†æ—¶é—´ä½œä¸ºdfçš„ç´¢å¼•
df.Timestamp = pd.to_datetime(df.Timestamp)
df.index = df.Timestamp
#æ•°æ®æ¢ç´¢
print(df.head())
df_month = df.resample(&#39;M&#39;).mean()
print(df_month.head())

#æŒ‰ç…§å¤©ã€æœˆã€å­£åº¦ã€å¹´æ˜¾ç¤ºAè‚¡èµ°åŠ¿
fig = plt.figure(figsize=[15,7])
plt.rcParams[&#39;font.sans-serif&#39;]=[&#39;SimHei&#39;]
plt.suptitle(&#39;Aè‚¡æŒ‡æ•°&#39;,fontsize = 18.0)
plt.plot(df_month.Price, &#39;-&#39;, label =&#39;æŒ‰æœˆ&#39;)
plt.legend()
plt.show()

#è®¾ç½®å‚æ•°èŒƒå›´
ps = range(0,7)
qs = range(0,7)
parameters = product(ps,qs)
parameters_list = list(parameters)
#å¯»æ‰¾æœ€ä¼˜ARMAæ¨¡å‹å‚æ•°ï¼Œaicæœ€å°
results = []
best_aic = float(&quot;inf&quot;)
for param in parameters_list:
    try:
        model = ARMA(df_month.Price,order=(param[0],param[1])).fit()
    except ValueError:
        print(&#39;å‚æ•°é”™è¯¯:&#39;,param)
        continue
    aic = model.aic
    if aic &lt; best_aic:
        best_model = model
        best_aic=aic
        best_param = param
    results.append([param,model.aic])

#è¾“å‡ºæœ€ä¼˜æ¨¡å‹
result_table = pd.DataFrame(results)
result_table.columns = [&#39;parameters&#39;,&#39;aic&#39;]
print(&#39;æœ€ä½³æ¨¡å‹:&#39;,best_model.summary())
#Aè‚¡é¢„æµ‹
df_month_value = df_month[[&#39;Price&#39;]]
date_list = [datetime(2019,3,31),datetime(2019,4,30),datetime(2019,5,31),
             datetime(2019,6,30),datetime(2019,7,31),datetime(2019,8,31),
             datetime(2019,9,30),datetime(2019,10,31),datetime(2019,11,30),
             datetime(2019,12,31)]
future = pd.DataFrame(index=date_list,columns=df_month.columns)
df_month_value = pd.concat([df_month_value,future])
df_month_value[&#39;forecast&#39;]=best_model.predict(start=0, end=348)
#Aè‚¡é¢„æµ‹ç»“æœå±•ç¤º
plt.figure(figsize=(20,7))
df_month_value.Price.plot(label=&#39;å®é™…é‡‘é¢&#39;)
df_month_value.forecast.plot(color=&#39;r&#39;, ls=&#39;--&#39;, label=&#39;é¢„æµ‹é‡‘é¢&#39;)
plt.legend()
plt.title(&#39;Aè‚¡é‡‘é¢ï¼ˆæœˆï¼‰&#39;)
plt.xlabel(&#39;æ—¶é—´&#39;)
plt.ylabel(&#39;æŒ‡æ•°&#39;)
plt.show()</p>2019-04-26</li><br/>
</ul>