ä¸ŠèŠ‚è¯¾ï¼Œæˆ‘è®²è§£äº†K-Meansçš„åŸç†ï¼Œå¹¶ä¸”ç”¨K-Meanså¯¹20æ”¯äºšæ´²çƒé˜Ÿè¿›è¡Œäº†èšç±»ï¼Œåˆ†æˆ3ä¸ªæ¢¯é˜Ÿã€‚ä»Šå¤©æˆ‘ä»¬ç»§ç»­ç”¨K-Meansè¿›è¡Œèšç±»çš„å®æˆ˜ã€‚èšç±»çš„ä¸€ä¸ªå¸¸ç”¨åœºæ™¯å°±æ˜¯å¯¹å›¾åƒè¿›è¡Œåˆ†å‰²ã€‚

å›¾åƒåˆ†å‰²å°±æ˜¯åˆ©ç”¨å›¾åƒè‡ªèº«çš„ä¿¡æ¯ï¼Œæ¯”å¦‚é¢œè‰²ã€çº¹ç†ã€å½¢çŠ¶ç­‰ç‰¹å¾è¿›è¡Œåˆ’åˆ†ï¼Œå°†å›¾åƒåˆ†å‰²æˆä¸åŒçš„åŒºåŸŸï¼Œåˆ’åˆ†å‡ºæ¥çš„æ¯ä¸ªåŒºåŸŸå°±ç›¸å½“äºæ˜¯å¯¹å›¾åƒä¸­çš„åƒç´ è¿›è¡Œäº†èšç±»ã€‚å•ä¸ªåŒºåŸŸå†…çš„åƒç´ ä¹‹é—´çš„ç›¸ä¼¼åº¦å¤§ï¼Œä¸åŒåŒºåŸŸé—´çš„åƒç´ å·®å¼‚æ€§å¤§ã€‚è¿™ä¸ªç‰¹æ€§æ­£å¥½ç¬¦åˆèšç±»çš„ç‰¹æ€§ï¼Œæ‰€ä»¥ä½ å¯ä»¥æŠŠå›¾åƒåˆ†å‰²çœ‹æˆæ˜¯å°†å›¾åƒä¸­çš„ä¿¡æ¯è¿›è¡Œèšç±»ã€‚å½“ç„¶èšç±»åªæ˜¯åˆ†å‰²å›¾åƒçš„ä¸€ç§æ–¹å¼ï¼Œé™¤äº†èšç±»ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åŸºäºå›¾åƒé¢œè‰²çš„é˜ˆå€¼è¿›è¡Œåˆ†å‰²ï¼Œæˆ–è€…åŸºäºå›¾åƒè¾¹ç¼˜çš„ä¿¡æ¯è¿›è¡Œåˆ†å‰²ç­‰ã€‚

## å°†å¾®ä¿¡å¼€å±å°é¢è¿›è¡Œåˆ†å‰²

ä¸ŠèŠ‚è¯¾ï¼Œæˆ‘è®²äº†sklearnå·¥å…·åŒ…ä¸­çš„K-Meansç®—æ³•ä½¿ç”¨ï¼Œæˆ‘ä»¬ç°åœ¨ç”¨K-Meansç®—æ³•å¯¹å¾®ä¿¡é¡µé¢è¿›è¡Œåˆ†å‰²ã€‚å¾®ä¿¡å¼€å±å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š

![](https://static001.geekbang.org/resource/image/50/a2/50457e4e1fbd288c125364a6904774a2.png?wh=762%2A1355)  
æˆ‘ä»¬å…ˆè®¾å®šä¸‹èšç±»çš„æµç¨‹ï¼Œèšç±»çš„æµç¨‹å’Œåˆ†ç±»å·®ä¸å¤šï¼Œå¦‚å›¾æ‰€ç¤ºï¼š

![](https://static001.geekbang.org/resource/image/8a/78/8af94562f6bd3ac42036ec47f5ad2578.jpg?wh=2373%2A1087)  
åœ¨å‡†å¤‡é˜¶æ®µé‡Œï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ•°æ®è¿›è¡ŒåŠ è½½ã€‚å› ä¸ºå¤„ç†çš„æ˜¯å›¾åƒä¿¡æ¯ï¼Œæˆ‘ä»¬é™¤äº†è¦è·å–å›¾åƒæ•°æ®ä»¥å¤–ï¼Œè¿˜éœ€è¦è·å–å›¾åƒçš„å°ºå¯¸å’Œé€šé“æ•°ï¼Œç„¶ååŸºäºå›¾åƒä¸­æ¯ä¸ªé€šé“çš„æ•°å€¼è¿›è¡Œæ•°æ®è§„èŒƒåŒ–ã€‚è¿™é‡Œæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸ªå‡½æ•°load\_dataï¼Œæ¥å¸®æˆ‘ä»¬è¿›è¡Œå›¾åƒåŠ è½½å’Œæ•°æ®è§„èŒƒåŒ–ã€‚ä»£ç å¦‚ä¸‹ï¼š
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ20ï¼‰</strong></div><ul>
<li><img src="" width="30px"><span>æ·¡é­‚</span> ğŸ‘ï¼ˆ14ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è¯·é—®è€å¸ˆã€‚è‡ªå·±å†™Min-Maxè§„èŒƒåŒ–å…¬å¼çš„æ—¶å€™ä¸ºä»€ä¹ˆä¸ç›´æ¥é™¤ä»¥255ï¼Œè¿™æ ·å¾—åˆ°çš„æ•°æ®ä¹Ÿæ˜¯åœ¨[0,1]ä¹‹é—´ï¼Œæ˜¯å› ä¸ºé‚£ä¸ªå€¼ä¸å¯ä»¥ä¸º0å—ï¼Ÿä»€ä¹ˆåŸå› å‘¢ï¼Ÿ</div>2019-02-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/26/53/60fe31fb.jpg" width="30px"><span>æ·±ç™½æµ…é»‘</span> ğŸ‘ï¼ˆ7ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>è€å¸ˆä¸‹é¢å‡½æ•°ä¸­ï¼Œæœ€åçš„å‚æ•°ä»£è¡¨ä»€ä¹ˆæ„æ€ï¼Ÿæ‰‹å†Œä¸Šæ˜¾ç¤ºçš„æ˜¯n_featureï¼Œä½†æ²¡è¯´å…·ä½“çš„æ„ä¹‰ï¼Œä¸æ˜¯å¾ˆæ˜ç™½ã€‚
        c1 = kmeans.cluster_centers_[label[x, y], 2]
        c2 = kmeans.cluster_centers_[label[x, y], 1]
        c3 = kmeans.cluster_centers_[label[x, y], 0]</div>2019-02-19</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/icpJJI5qPlVwaZoOk6zKicZU9lFGkYyMJXmUXRBicibqBrrEvn7vKsL49ESrkibumd7qXUsXs7Yzj3Dib6npR6hB4ryQ/132" width="30px"><span>cua</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ4ï¼‰<div>ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¸ªé”™è¯¯å‘¢ValueError: too many values to unpack (expected 3)</div>2019-02-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg" width="30px"><span>mickey</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div># -*- coding: utf-8 -*-
# ä½¿ç”¨K-meanså¯¹å›¾åƒè¿›è¡Œèšç±»ï¼Œæ˜¾ç¤ºåˆ†å‰²æ ‡è¯†çš„å¯è§†åŒ–
import numpy as np
import PIL.Image as image
from sklearn.cluster import KMeans
from sklearn import preprocessing
from skimage import color

# åŠ è½½å›¾åƒï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œè§„èŒƒåŒ–
def load_data(filePath):
    # è¯»æ–‡ä»¶
    f = open(filePath,&#39;rb&#39;)
    data = []
    # å¾—åˆ°å›¾åƒçš„åƒç´ å€¼
    img = image.open(f)
    # å¾—åˆ°å›¾åƒå°ºå¯¸
    width, height = img.size
    for x in range(width):
        for y in range(height):
            # å¾—åˆ°ç‚¹(x,y)çš„ä¸‰ä¸ªé€šé“å€¼
            c1, c2, c3 = img.getpixel((x, y))
            data.append([c1, c2, c3])
    f.close()
    # é‡‡ç”¨Min-Maxè§„èŒƒåŒ–
    mm = preprocessing.MinMaxScaler()
    data = mm.fit_transform(data)
    return np.mat(data), width, height

# åŠ è½½å›¾åƒï¼Œå¾—åˆ°è§„èŒƒåŒ–çš„ç»“æœimgï¼Œä»¥åŠå›¾åƒå°ºå¯¸
img, width, height = load_data(&#39;.&#47;baby2.jpg&#39;)

# ç”¨K-Meanså¯¹å›¾åƒè¿›è¡Œ16èšç±»
kmeans =KMeans(n_clusters=16)
kmeans.fit(img)
label = kmeans.predict(img)
# å°†å›¾åƒèšç±»ç»“æœï¼Œè½¬åŒ–æˆå›¾åƒå°ºå¯¸çš„çŸ©é˜µ
label = label.reshape([width, height])
# å°†èšç±»æ ‡è¯†çŸ©é˜µè½¬åŒ–ä¸ºä¸åŒé¢œè‰²çš„çŸ©é˜µ
label_color = (color.label2rgb(label)*255).astype(np.uint8)
label_color = label_color.transpose(1,0,2)
images = image.fromarray(label_color)
images.save(&#39;baby_16.jpg&#39;)</div>2019-02-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/a4/5a/e708e423.jpg" width="30px"><span>third</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>é—®é¢˜ï¼šå·²ç»ä½¿ç”¨mmè¿›è¡Œæ•°æ®æ‹Ÿåˆè½¬æ¢äº†ï¼Œä¸ºä½•è¿˜è¦ä½¿ç”¨np.mat()è½¬æ¢å‘¢ï¼Ÿä½œç”¨åœ¨å“ªé‡Œï¼Ÿæ–¹ä¾¿åé¢ä½¿ç”¨np.uint8å—ï¼Ÿ

æ³¨æ„ï¼šå®æˆ˜çš„æ—¶å€™ï¼Œä¿å­˜å›¾ç‰‡ä¸ºjpgæ ¼å¼
å¦‚æœæ˜¯pngæ ¼å¼çš„è¯ï¼Œä¼šå‡ºç°4ä¸ªå€¼ï¼Œå¯¼è‡´èµ‹å€¼é”™è¯¯ï¼Œ(R, G, B, A)

import PIL.Image as image
import numpy as np
import pandas as pd
#è½½å…¥æ•°æ®
def load_data(file):
    with open(file,&#39;rb&#39;) as f:
        data=[]
        #æ‰“å¼€æ–‡ä»¶
        img=image.open(f)
        width,height=img.size
        #è·å–ç‰¹å¾æ•°æ®
        for x in range(width):
            for y in range(height):
                c1,c2,c3=img.getpixel((x,y))
                data.append([c1,c2,c3])
        #è¿›è¡Œmmè§„èŒƒåŒ–
        from sklearn.preprocessing import MinMaxScaler
        mm=MinMaxScaler()
        data=mm.fit_transform(data)
        return np.mat(data),width,height
data,width,height=load_data(&#39;.&#47;27&#47;baby.jpg&#39;)

#è¿›è¡Œèšç±»
from sklearn.cluster import KMeans
kmeans=KMeans(n_clusters=16)
label=kmeans.fit_predict(data)

#å¯è§†åŒ–
#è½¬æ¢æˆå›¾åƒçŸ©é˜µ
label=label.reshape([width,height])
#ç”Ÿæˆä¸€å¼ æ–°å›¾ç‰‡
# pic_1=image.new(&quot;L&quot;,(width,height))
# #æŠŠåƒç´ ä¿¡æ¯å†™å…¥
# #æ–¹æ³•1å†™å…¥ç°åº¦å€¼
# for x in range(width):
#     for y in range(height):
#         #æŒ‰ç…§åˆ†ç±»ç¡®å®šç°åº¦å€¼
#         pic_1.putpixel((x,y),int(label[x][y]*256&#47;16))
# pic_1.save(&#39;.&#47;27&#47;baby.jpg&#39;)

# #æ–¹æ³•2
# # ä½¿ç”¨æ¨¡ç»„ï¼Œå°†è¡¨ç¤ºçŸ©é˜µè½¬æ¢ä¸ºå„ç§é¢œè‰²çš„çŸ©é˜µ
# #ä½¿ç”¨label2rgb(label)*255è½¬åŒ–,å†æŠŠçŸ©é˜µè½¬åŒ–ä¸ºunit8ç±»å‹ï¼Œæ— ç¬¦å·æ•´æ•°
# from skimage import color
# label_color=(color.label2rgb(label)*255).astype(np.uint8)
# #ä¼¼ä¹éƒ½éœ€è¦è¿›è¡Œé¢ å€’å¤„ç†
# label_color=label_color.transpose(1,0,2)
# #ä½¿ç”¨fromarrayæŠŠçŸ©é˜µç”Ÿæˆå›¾ç‰‡
# images=image.fromarray(label_color)
# images.save(&#39;.&#47;27&#47;baby_color_2.jpg&#39;)

#æ–¹æ³•3è·å–å¯¹åº”åŸå›¾
#åˆ›å»ºæ–°çš„å›¾ç‰‡
imges1=image.new(&#39;RGB&#39;,(width,height))
#å†™å…¥å›¾ç‰‡
for x in  range(width):
    for y in range(height):
        #å§èŒƒå›´ä¸º0-255çš„æ•°å€¼æŠ•å°„åˆ°1-256
        #è·å–ç¬¬ä¸€åˆ—å³rçš„å€¼
        c1=kmeans.cluster_centers_[label[x,y],0]
        c2 = kmeans.cluster_centers_[label[x, y], 1]
        c3 = kmeans.cluster_centers_[label[x, y], 2]
        imges1.putpixel((x,y),(int(c1*256)-1,int(c2*256)-1,int(c3*256)-1))
imges1.save(&#39;.&#47;27&#47;baby_yasuo.jpg&#39;)</div>2019-02-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/b5/98/ffaf2aca.jpg" width="30px"><span>Ronnyz</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>import numpy as np
import PIL.Image as Image
from sklearn import preprocessing
from sklearn.cluster import KMeans
from skimage import color

#åŠ è½½å›¾ç‰‡ï¼Œå¹¶è¿›è¡Œè§„èŒƒåŒ–
def load_data(filepath):
    #è¯»å›¾ç‰‡
    f=open(filepath,&#39;rb&#39;)
    #è·å–å›¾ç‰‡åƒç´ 
    img=Image.open(f)
    #è·å–å›¾ç‰‡å°ºå¯¸å’Œåƒç´ çŸ©é˜µ
    width,height =img.size
    data=[]
    for x in range(width):
        for y in range(height):
            #å¾—åˆ°ç‚¹ï¼ˆx,yï¼‰çš„R,G,Bé€šé“å€¼
            r,g,b=img.getpixel((x,y))
            data.append([r,g,b])
    f.close()
    #é‡‡ç”¨min-maxè§„èŒƒåŒ–
    mm=preprocessing.MinMaxScaler()
    print(&#39;åŸä½ç½®åˆ—è¡¨ï¼š&#39;)
    print(type(data))
    print(len(data))
    data=mm.fit_transform(data)
    return np.mat(data),width,height

#åŠ è½½å›¾ç‰‡ï¼Œå¾—åˆ°è§„èŒƒåŒ–ç»“æœ
img,width,height = load_data(&#39;.&#47;kmeans-master&#47;baby.jpg&#39;)
print(&#39;\nè§„èŒƒåŒ–çš„åƒç´ çŸ©é˜µï¼š&#39;)
print(type(img))
print(img.shape)
#ç”¨K-Meansè¿›è¡Œ16èšç±»
kmeans = KMeans(n_clusters=16)
label=kmeans.fit_predict(img)

#å°†å›¾åƒç»“æœï¼Œè½¬åŒ–æˆå›¾åƒå°ºå¯¸çŸ©é˜µ
label=label.reshape([width,height])

#åˆ›å»ºé¢œè‰²è¡¨ç¤ºçŸ©é˜µå›¾
label_color = (color.label2rgb(label)*255).astype(np.uint8)
label_color=label_color.transpose(1,0,2)
print(&#39;\nåƒç´ é¢œè‰²çŸ©é˜µï¼š&#39;)
print(label_color.shape)
images=Image.fromarray(label_color)
images.save(&#39;.&#47;kmeans-master&#47;baby_mark.jpg&#39;)

#åˆ›å»ºæ–°å›¾åƒï¼Œä¿å­˜èšç±»å‹ç¼©ä¹‹åçš„ç»“æœ
img=Image.new(&#39;RGB&#39;,(width,height))
for x in range(width):
    for y in range(height):
        r1=kmeans.cluster_centers_[label[x, y],0]
        g1=kmeans.cluster_centers_[label[x, y], 1]
        b1=kmeans.cluster_centers_[label[x, y], 2]
        img.putpixel((x,y),(int(r1*256)-1,int(g1*256)-1,int(b1*256)-1))
img.save(&#39;.&#47;kmeans-master&#47;baby_new.jpg&#39;)</div>2019-11-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/7d/2a/4c7e2e2f.jpg" width="30px"><span>Â§mcÂ²ompleXWr</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>ä¸ºä»€ä¹ˆè¦ç”¨np.mat(data)??
æˆ‘ç”¨array()è·‘å‡ºæ¥çš„ç»“æœå®Œå…¨æ˜¯ä¸€æ ·çš„å•Šã€‚ã€‚</div>2020-07-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/7e/8b/3cc461b3.jpg" width="30px"><span>å®‹æ™“æ˜</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æå®¢æ—¶é—´ pcç•Œé¢ç»ˆäºæ”¹äº†ã€‚ã€‚ä¹‹å‰çš„ç•Œé¢æ‰¾æŸç¯‡æ–‡ç« è´¹æ­»ä¸ªåŠ²</div>2019-03-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/a1/74/3dfa4436.jpg" width="30px"><span>Rickie</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆå¥½ï¼Œæƒ³è¯·é—®ä¸‹æ‚¨èšç±»åå¾—åˆ°çš„é‚£å¼ ç°åº¦å›¾åƒæœ‰å…¶ä»–çš„è®¾ç½®å—ï¼Ÿæˆ‘ä½¿ç”¨è·Ÿæ‚¨ä¸€æ ·çš„ä»£ç ï¼Œæœ€åç”Ÿæˆçš„å›¾å°ºå¯¸éå¸¸å°ï¼Œä¸”ä¸€äº›ç»†èŠ‚å¹¶æ²¡æœ‰åˆ†ç±»æ­£ç¡®...ä¸çŸ¥é“æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ</div>2019-02-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg" width="30px"><span>mickey</span> ğŸ‘ï¼ˆ18ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>import PIL.Image as image
å¯¼å…¥çš„æ˜¯pillowåŒ…ï¼Œè€ŒépilåŒ…ã€‚
pilåŒ…ä¸æ”¯æŒ64ä½ï¼Œä½†æ˜¯æœ‰pillowåŒ…ä»£æ›¿ç”¨ã€‚</div>2019-02-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/34/13/d43ff5ed.jpg" width="30px"><span>vortual</span> ğŸ‘ï¼ˆ9ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>è¡·å¿ƒå¸Œæœ›è€å¸ˆèƒ½å¼€ä¸€è®²è®²ä¸‹æ•°æ®è§„èŒƒåŒ–çš„é—®é¢˜ã€‚ä»ä¹‹å‰çš„å‡ è®²æ€»æ˜¯é‡åˆ°æœ‰äº›æ˜¯minmaxè§„èŒƒåŒ–ï¼Œæœ‰äº›æ˜¯éœ€è¦æ­£æ€åˆ†å¸ƒï¼Œå¸Œæœ›è€å¸ˆèƒ½è®²ä¸‹å…·ä½“ä»€ä¹ˆæ—¶å€™ç”¨å“ªç§ï¼Œè€Œä¸”è§„èŒƒåŒ–çš„å¥½å¤„ï¼Œç›®å‰çŸ¥é“çš„æ˜¯åŠ å¿«æ”¶æ•›å’Œé™ä½ç»´åº¦ï¼Œä½†ä¸ºå•¥è¿˜ä¸æ˜¯å¾ˆæ¸…æ¥š</div>2019-03-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg" width="30px"><span>Geek_hve78z</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>æ–°æ¦‚å¿µæ€»ç»“
1ã€å›¾åƒåˆ†å‰²å°±æ˜¯æŠŠå›¾åƒåˆ†æˆè‹¥å¹²ä¸ªç‰¹å®šçš„ã€å…·æœ‰ç‹¬ç‰¹æ€§è´¨çš„åŒºåŸŸå¹¶æå‡ºæ„Ÿå…´è¶£ç›®æ ‡çš„æŠ€æœ¯å’Œè¿‡ç¨‹ã€‚å®ƒæ˜¯ç”±å›¾åƒå¤„ç†åˆ°å›¾åƒåˆ†æçš„å…³é”®æ­¥éª¤

æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæœ€åä¸€ä¸ªæ¡ˆä¾‹ä¸­ï¼Œå›¾åƒåˆ†å‰²ï¼Œè¾“å‡ºåŸå›¾æœ‰ä»€ä¹ˆæ„ä¹‰</div>2019-02-23</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/0M3kK7d2sLapYh9VgqzQargLNkiaJbJZTDNjzLhm9s9FYbFUVDSKa74yvcvH5IHWgknuibmh9fObbrHXvfAib28IQ/132" width="30px"><span>æ‰‹æŒ‡é¥¼å¹²</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>np.mat å·²ç»åºŸå¼ƒï¼Œéœ€è¦ç”¨ np.array æ›¿ä»£</div>2024-06-17</li><br/><li><img src="" width="30px"><span>Neo</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è¿™é‡Œå¥½åƒæ²¡æœ‰è®¾ç½®è¯„ä¼°èšç±»è¡¨ç°çš„ç¯èŠ‚ï¼Ÿè¯·é—®å¦‚ä½•æ¯”è¾ƒä¸åŒkå€¼çš„è¡¨ç°å‘¢</div>2020-02-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/5d/27/74e152d3.jpg" width="30px"><span>æ»¨æ»¨</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>å›¾åƒåˆ†å‰²çš„ä¸»è¦å·¥ä½œåœ¨äºæ•°æ®çš„é¢„å¤„ç†ï¼ŒåŒæ—¶åˆ†å‰²ä¸ºå‡ ç±»éœ€è¦äººå·¥æŒ‡å®šè¿™ä¸ªå¾ˆä¸æ–¹ä¾¿</div>2019-04-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/38/4f/61/018352d4.jpg" width="30px"><span>é™é™å‘€</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>è€å¸ˆï¼Œè¿™ä¸ªç®—æ³•æ˜¯ä¸æ˜¯å¯ä»¥ç”¨æ¥å‹ç¼©å›¾ç‰‡å‘¢ï¼Œé€šè¿‡èšç±»åå›¾ç‰‡ç¡®å®å˜å°äº†å¾ˆå¤šï¼Œä¹Ÿå˜æ¨¡ç³Šäº†ï¼ŒQQç›¸å†Œé‡Œçš„å›¾ç‰‡æ˜¯é€šè¿‡ç±»ä¼¼æ–¹å¼å¤„ç†çš„å—</div>2023-10-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1f/17/01/1c5309a3.jpg" width="30px"><span>McKee Chen</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>å­¦ä¹ æœ¬èŠ‚è¯¾çš„ä½“ä¼šï¼š
1.è¿ç”¨K-Meansè¿›è¡Œå›¾åƒåˆ†å‰²éœ€è¦çµæ´»è¿ç”¨çŸ©é˜µä¸å›¾åƒä¹‹é—´çš„è½¬æ¢ï¼Œä»¥åŠlabel2rgbã€fromarrayã€transposeå‡½æ•°çš„ä½¿ç”¨å’Œç†è§£ï¼›
2.åœ¨æ•°æ®è§„èŒƒåŒ–è¿™ä¸€å¤„ç†ä¸Šå¯ä»¥ä½¿ç”¨kmeansè‡ªå¸¦çš„å‡½æ•°ï¼Œä¹Ÿå¯ä»¥è‡ªè¡Œè¿›è¡Œæ•°æ®è§„èŒƒåŒ–(å‰ææ˜¯çŸ¥é“æ•°å€¼æ‰€å¤„çš„èŒƒå›´)ï¼›
3.å¯¹å›¾åƒé€šé“ã€ç°åº¦å€¼ç­‰æœ‰äº†äº†è§£ï¼›
4.è¿˜æ˜¯å¾—å¤šå†™ä»£ç ï¼Œæ‰èƒ½ç†Ÿèƒ½ç”Ÿå·§ï¼Œå°†çŸ¥è¯†å¸æ”¶æˆè‡ªå·±çš„ã€‚

#ç”¨ K-Means èšç±»æ–¹æ³•å°† baby.jpg çš„å›¾ç‰‡åˆ†å‰²æˆ 16 ä¸ªéƒ¨åˆ†
from sklearn.cluster import KMeans
from sklearn.preprocessing import MinMaxScaler
from skimage import color
import PIL.Image as image
import numpy as np

def load_data(filepath):
    #è¯»å–æ–‡ä»¶
    f = open(filepath, &#39;rb&#39;)
    data = []
    #å¾—åˆ°å›¾åƒçš„åƒç´ å€¼
    img = image.open(f)#è¾“å…¥æ–‡ä»¶è·¯å¾„ï¼Œé€‰æ‹©å¯è¯»å†™äºŒè¿›åˆ¶æ–‡ä»¶æ¨¡å¼
    #å¾—åˆ°å›¾åƒå°ºå¯¸
    width, height = img.size
    for x in range(width):
        for y in range(height):
            #å¾—åˆ°ç‚¹ (x, y) çš„ä¸‰ä¸ªé€šé“å€¼
            c1, c2, c3 = img.getpixel((x, y))
            data.append([c1, c2, c3])
    f.close()
    #é‡‡ç”¨MinMaxè§„èŒƒåŒ–
    mm = MinMaxScaler()
    data = mm.fit_transform(data)
    return np.mat(data), width, height
#åŠ è½½å›¾åƒï¼Œå¾—åˆ°è§„èŒƒåŒ–ç»“æœ imgï¼Œä»¥åŠå›¾åƒå°ºå¯¸ widthï¼Œ height
img, width, height = load_data(r&#39;C:\Users\Desktop\baby.jpg&#39;)
#ç”¨ K-Means å¯¹å›¾åƒè¿›è¡Œ16èšç±»
kmeans = KMeans(n_clusters=16)
label = kmeans.fit_predict(img)#è·å¾—èšç±»ç»“æœ
#å°†å›¾åƒèšç±»ç»“æœï¼Œè½¬åŒ–æˆå›¾åƒå°ºå¯¸çš„çŸ©é˜µ
label = label.reshape([width, height])
#å°†èšç±»è¡¨ç¤ºè½¬åŒ–æˆä¸åŒé¢œè‰²çš„çŸ©é˜µ
label_color = (color.label2rgb(label)*255).astype(np.uint8)
label_color = label_color.transpose(1, 0, 2)
images = image.fromarray(label_color)
#å›¾ç‰‡ä¿å­˜
images.save(r&#39;C:\Users\Desktop\baby_new_color.jpg&#39;)</div>2021-01-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1a/e2/c4/25acaa38.jpg" width="30px"><span>è‹¹æœ</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>èšç±»å¤„ç†åï¼Œæ¯”å¦‚n_claster = 16 ,æ¯”è¾ƒåŸå›¾ç‰‡æ›´æ¨¡ç³Šäº›ï¼Œå¯è§ï¼Œkå€¼å–è¶Šå°ï¼Œå›¾ç‰‡æ›´æ¨¡ç³Šï¼Œç”¨èšç±»ç®—æ³•ä½¿å›¾ç‰‡æ¨¡ç³Šï¼Œå¥½åƒæ€é¸¡ç„‰ç”¨ç‰›åˆ€å‘€</div>2020-02-10</li><br/><li><img src="" width="30px"><span>ä¸‰ç¡åŸºç”²è‹¯</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div> ä¸€å¼€å§‹å¯¹é‚£ä¸ªbabyçš„å›¾è¿›è¡Œ16ä»½ç”¨Kmeansåˆ†ç±»åçš„é¢œè‰²æ„Ÿè§‰åˆ°æ€ªæ€ªçš„ï¼ŒæŠ˜è…¾äº†å¥½ä¹…æ‰ååº”è¿‡æ¥ï¼Œè¿™ä¸ªæ˜¯ä¸ªåˆ†ç±»ï¼Œè¿˜å¥½é†’æ‚Ÿçš„æ—©ï¼Œä¸ç„¶è¿™ä¸ªè¦çº ç»“å¥½ä¹…ï¼Œä»¥ä¸ºè‡ªå·±å“ªé‡Œæœ‰é—®é¢˜ã€‚ã€‚</div>2019-03-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/df/f0/ea4d36a7.jpg" width="30px"><span>æ¢åˆ©æ–‡</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>é‚£è¿æ¥åªèƒ½åœ¨æ‰‹æœºä¸Šçœ‹ï¼Œåœ¨ç”µè„‘ä¸Šçœ‹ä¸åˆ°ï¼Œä¸æ–¹ä¾¿çœ‹æ¡ˆä¾‹å’Œæ“ä½œ</div>2019-02-14</li><br/>
</ul>