ä»Šå¤©æˆ‘æ¥å¸¦ä½ åšä¸€ä¸ªæ•°æ®é‡‡é›†çš„å®æˆ˜ã€‚ä¹‹å‰æˆ‘è®²åˆ°å¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹å·¥å…·ï¼Œæ¯”å¦‚å…«çˆªé±¼åšæ•°æ®é‡‡é›†ï¼Œä¹Ÿå¯ä»¥è‡ªå·±ç¼–å†™è„šæœ¬ï¼Œæ¯”å¦‚ä½¿ç”¨Pythonã€‚ç¼–å†™Pythonåšæ•°æ®é‡‡é›†å’Œè‡ªåŠ¨åŒ–æœ€å¤§çš„å¥½å¤„å°±æ˜¯å¯æ§æ€§å¼ºï¼Œæ¯ä¸ªæ­¥éª¤éƒ½å¯ä»¥è°ƒè¯•ï¼Œè€Œä¸”å¯ä»¥æ‰¾åˆ°é—®é¢˜æ‰€åœ¨å¹¶ä¸€ä¸€çªç ´ã€‚

ä»Šå¤©æˆ‘å°±å¸¦ä½ ä½¿ç”¨Pythonè‡ªåŠ¨åŒ–è¿è¥å¾®åšã€‚å…³äºä»Šå¤©çš„å­¦ä¹ ï¼Œå¸Œæœ›ä½ èƒ½è¾¾æˆä»¥ä¸‹çš„3ä¸ªå­¦ä¹ ç›®æ ‡ï¼š

1. æŒæ¡Seleniumè‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·ï¼Œä»¥åŠå…ƒç´ å®šä½çš„æ–¹æ³•ï¼›
2. å­¦ä¼šç¼–å†™å¾®åšè‡ªåŠ¨åŒ–åŠŸèƒ½æ¨¡å—ï¼šåŠ å…³æ³¨ï¼Œå†™è¯„è®ºï¼Œå‘å¾®åšï¼›
3. å¯¹å¾®åšè‡ªåŠ¨åŒ–åšè‡ªæˆ‘æ€»ç»“ã€‚

## Seleniumè‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·

å½“æˆ‘ä»¬åšWebè‡ªåŠ¨åŒ–æµ‹è¯•çš„æ—¶å€™ï¼Œå¯ä»¥é€‰ç”¨Seleniumæˆ–è€…Puppeteerå·¥å…·ã€‚æˆ‘åœ¨[ç¬¬10ç¯‡](https://time.geekbang.org/column/article/76001)çš„æ—¶å€™ç®€å•ä»‹ç»è¿‡Seleniumè¿™ä¸ªå·¥å…·ï¼Œä½ å¯ä»¥å†å›é¡¾ä¸€ä¸‹ã€‚Puppeteeré€šè¿‡æ§åˆ¶æ— å¤´Chromeæ¥å®Œæˆæµè§ˆå™¨çš„å·¥ä½œã€‚è¿™ä¸¤ä¸ªå·¥å…·ä¹‹é—´çš„åŒºåˆ«åœ¨äºï¼šSeleniumæ›´å…³æ³¨ç¨‹åºæ‰§è¡Œçš„æµç¨‹æœ¬èº«ï¼Œæ¯”å¦‚æ‰¾åˆ°æŒ‡å®šçš„å…ƒç´ ï¼Œè®¾ç½®ç›¸åº”çš„å€¼ï¼Œç„¶åç‚¹å‡»æ“ä½œã€‚è€ŒPuppeteeræ˜¯æµè§ˆè€…çš„è§†è§’ï¼Œæ¯”å¦‚å…‰æ ‡ç§»åŠ¨åˆ°æŸä¸ªå…ƒç´ ä¸Šï¼Œé”®ç›˜è¾“å…¥æŸä¸ªå†…å®¹ç­‰ã€‚

ä»Šå¤©æˆ‘ä»¬ç»§ç»­ä½¿ç”¨Seleniumå·¥å…·è‡ªåŠ¨åŒ–æ¨¡æ‹Ÿæµè§ˆå™¨ï¼Œé‡ç‚¹æ˜¯å­¦ä¹ å¯¹å…ƒç´ çš„å®šä½ã€‚åœ¨ç¬¬10ç¯‡è®²åˆ°Selenium WebDriverçš„ä½¿ç”¨æ—¶ï¼Œé‡ç‚¹æ˜¯å¯¹HTMLè¿›è¡Œè·å–å’Œè§£æï¼Œç„¶åé€šè¿‡HTMLä¸­çš„XPathè¿›è¡Œæå–ï¼Œè¯»å–ç›¸åº”çš„å†…å®¹ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ25ï¼‰</strong></div><ul>
<li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/KQpJHrQFQnezpyMlffXh9m9Dh6o8Z2yZXw8lEN73TyltgMGgDjhAz2cTbMpe2jgwWzkPr5Ribf2LgIDOE77kLdA/132" width="30px"><span>ç‰›å¥¶å¸ƒä¸</span> ğŸ‘ï¼ˆ16ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>è€å¸ˆï¼Œå¾®åšç™»å½•æ—¶éœ€è¦éªŒè¯ç æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ</div>2019-03-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/77/be/1f2409e8.jpg" width="30px"><span>æ¢æ—æ¾</span> ğŸ‘ï¼ˆ13ï¼‰ ğŸ’¬ï¼ˆ4ï¼‰<div>ç»™æ‰“å®¶ä»‹ç»ä¸€ä¸ªXPathçš„å°çªé—¨ï¼š ä¸‹è½½ XPath Helperæ’ä»¶ï¼Œå®‰è£…å åœ¨ç½‘é¡µä¸Šé€‰å–æƒ³è¦æå–çš„å…ƒç´ ï¼Œ ç‚¹å‡»å³é”® é€‰ä¸­ æ£€æŸ¥ ç„¶å å¼€å‘è€…å·¥å…·è‡ªåŠ¨æ‰“å¼€ ä½ å¯ä»¥çœ‹åˆ° HTMLä»£ç  ï¼Œé€‰ä¸­ç„¶åå†æ¬¡ç‚¹å‡»å³é”®ï¼Œé€‰ä¸­copy é‡Œçš„ copy to xpathè¿™æ ·å°±å¾—åˆ°äº†xpathçš„å€¼äº†ã€‚</div>2019-03-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/24/b0/a6e0b03a.jpg" width="30px"><span>ä¸€è¯­ä¸­çš„</span> ğŸ‘ï¼ˆ11ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æ•°æ®æ€ç»´å’Œç®—æ³•æ˜¯æˆ‘çš„è–„å¼±é¡¹ï¼Œè¿˜åœ¨ä¸€èŠ‚ä¸€èŠ‚æ•²ä¹‹å‰ä¾‹å­ä¸­çš„ä»£ç ï¼Œä½†seleniumå’Œçˆ¬è™«æ˜¯å¼ºé¡¹ï¼Œ8ç§å®šä½æ–¹æ³•ç»“åˆWebDriverWaitï¼Œå†åŠ ä¸ŠActionChainsä¸­çš„æ–¹æ³•å’ŒjsåŸºæœ¬å¤©å¤©ç”¨ã€‚
è™½ç„¶å­¦çš„æœ‰ç‚¹è™(é™¤äº†æœ¬è¯¾ç¨‹æœ€è¿‘åŒæ—¶åœ¨è¡¥ã€Šåˆ©ç”¨pythonè¿›è¡Œæ•°æ®åˆ†æã€‹ã€Šç²¾ç›Šæ•°æ®åˆ†æã€‹)ä½†æ˜¯å¾ˆå¼€å¿ƒ~~~</div>2019-03-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg" width="30px"><span>Geek_hve78z</span> ğŸ‘ï¼ˆ8ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>å–æ¶ˆå…³æ³¨æ—¶ï¼Œå¿…é¡»ç™»å½•è´¦æˆ·
______________
#æ¨¡æ‹Ÿå¾®åšè‡ªåŠ¨ç™»å½•
from selenium import webdriver
import time
browser=webdriver.Chrome(&#39;.&#47;chromedriver&#39;)

# ç™»é™†å¾®åš
def weibo_login(username,password):
    # æ‰“å¼€å¾®åšç™»å½•é¡µ
    browser.get(&#39;https:&#47;&#47;passport.weibo.cn&#47;signin&#47;login&#39;)
    browser.implicitly_wait(5)
    time.sleep(1)
    # å¡«å†™ç™»å½•ä¿¡æ¯ï¼šç”¨æˆ·åã€å¯†ç 
    browser.find_element_by_id(&quot;loginName&quot;).send_keys(username)
    browser.find_element_by_id(&quot;loginPassword&quot;).send_keys(password)
    time.sleep(1)
    # ç‚¹å‡»ç™»å½•
    browser.find_element_by_id(&quot;loginAction&quot;).click()
    time.sleep(1)
    
# è®¾ç½®ç”¨æˆ·åã€å¯†ç 
username=&#39;**********&#39;
password=&#39;*********&#39;
weibo_login(username,password)



# å–æ¶ˆæŒ‡å®šçš„ç”¨æˆ·
def out_follow(uid):
    browser.get(&#39;https:&#47;&#47;m.weibo.cn&#47;u&#47;&#39;+str(uid))
    time.sleep(1)
    #browser.find_element_by_id(&quot;follow&quot;).click()
    out_follow_button=browser.find_element_by_xpath(&#39;&#47;&#47;*[@id=&quot;app&quot;]&#47;div[1]&#47;div[4]&#47;div[2]&#47;div&#47;div[1]&#47;div&#47;span&#47;h4&#39;)
    out_follow_button.click()
    time.sleep(1)
    
    # ç‚¹å‡»å–æ¶ˆå…³æ³¨
    out_button1=browser.find_element_by_xpath(&#39;&#47;&#47;*[@id=&quot;app&quot;]&#47;div[1]&#47;div[4]&#47;div[2]&#47;div&#47;div[1]&#47;div&#47;div&#47;ul&#47;li[2]&#47;div&#47;h4&#39;)
    out_button1.click()
    
    #å†æ¬¡ç¡®è®¤å–æ¶ˆå…³æ³¨
    out_button2=browser.find_element_by_xpath(&#39;&#47;&#47;*[@id=&quot;app&quot;]&#47;div[2]&#47;div[1]&#47;div[2]&#47;footer&#47;div[2]&#47;a&#39;)
    out_button2.click()
    time.sleep(1)
# æ¯å¤©å­¦ç‚¹å¿ƒç†å­¦ UID
uid=&#39;1890826225&#39;
out_follow(uid)
</div>2019-03-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/f5/12/a5383fff.jpg" width="30px"><span>å¿—</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è¯¾åç»ƒä¹ å–æ¶ˆå…³æ³¨æ¨¡å—ï¼š
# å–å…³æŒ‡å®šçš„ç”¨æˆ·
def unfollow(uid):
    browser.get(&#39;https:&#47;&#47;m.weibo.com&#47;u&#47;&#39;+str(uid))
    time.sleep(1)
    unfollow_button = browser.find_element_by_xpath(&#39;&#47;&#47;*[@id=&quot;app&quot;]&#47;div[1]&#47;div[4]&#47;div[2]&#47;div&#47;div[1]&#47;div&#39;)
    unfollow_button.click()
    time.sleep(1)
    # é€‰æ‹©å–æ¶ˆå…³æ³¨
    uf_button = browser.find_element_by_xpath(&#39;&#47;&#47;*[@id=&quot;app&quot;]&#47;div[1]&#47;div[4]&#47;div[2]&#47;div&#47;div[1]&#47;div&#47;div&#47;ul&#47;li[2]&#47;div&#39;)
    uf_button.click()
    time.sleep(1)
    # ç¡®å®šå–æ¶ˆ
    confirm_button = browser.find_element_by_xpath(&#39;&#47;&#47;*[@id=&quot;app&quot;]&#47;div[2]&#47;div[1]&#47;div[2]&#47;footer&#47;div[2]&#47;a&#39;)
    confirm_button.click()
    time.sleep(1)
    
# æ¯å¤©å­¦ç‚¹å¿ƒç†å­¦ UID
uid = &#39;1890826225&#39; 
unfollow(uid)</div>2019-03-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/dc/68/006ba72c.jpg" width="30px"><span>Untitled</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ç›¸å¯¹äºå‘å¾®åšå’ŒåŠ å…³æ³¨ï¼Œæ›´å¤šéœ€æ±‚æ˜¯çˆ¬å–è¯„è®º</div>2020-03-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/c2/de/98cd7728.jpg" width="30px"><span>Lisa</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>selenium.common.exceptions.NoSuchElementException: Message: no such element: Unable to locate element: {&quot;method&quot;:&quot;css selector&quot;,&quot;selector&quot;:&quot;textarea.W_input&quot;}
  (Session info: chrome=76.0.3809.132)
è¿™ä¸ªæŠ¥é”™æ€ä¹ˆå¤„ç†ï¼Ÿï¼Ÿï¼Ÿ</div>2019-08-29</li><br/><li><img src="" width="30px"><span>å‘¨å¿—ç¿”</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>å¯èƒ½æ˜¯è¿™ä¸ªç½‘ç«™ç”¨çš„æ¯”è¾ƒå¤šäº†ï¼Œxpathå®šä½å˜äº†</div>2019-07-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/a3/87/c415e370.jpg" width="30px"><span>æ»¢</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>ä¸€ç›´æç¤ºè¿™ä¸ªé—®é¢˜  driver.find_elements_by_css_selector(&quot;[node-type=&#39;publish&#39;]&quot;).click()
AttributeError: &#39;list&#39; object has no attribute &#39;click&#39;   è€å¸ˆèƒ½å¸®å¿™çœ‹ä¸‹å˜›ï¼Ÿ 
å¦å¤–ï¼Œä¸€ç›´åœ¨åˆ·ä¸€ç›´åœ¨åˆ· å¾®åšä¸è®©ç™»å½•æ¥ï¼Œè¯¾åç»ƒä¹ åé¢è¡¥ä¸Š</div>2019-04-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/7f/e6/c8a69b20.jpg" width="30px"><span>éšä¾¿è®²ä¸¤å¥</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>å…³æ³¨&#47;å–æ¶ˆå…³æ³¨ç”¨ [ https:&#47;&#47;m.weibo.cn&#47;profile&#47;:uid ] è¿™ä¸ªé¡µé¢ä¹Ÿå¾ˆæ–¹ä¾¿ã€‚

# å–æ¶ˆå…³æ³¨
def unfollow(uid):
    browser.get(&#39;https:&#47;&#47;m.weibo.cn&#47;profile&#47;&#39; + str(uid))
    browser.implicitly_wait(5)
    time.sleep(1)
    browser.find_element_by_xpath(&quot;&#47;&#47;a[@class=&#39;m-btn m-btn-block m-btn-lite-white&#39;]&quot;).click()
    time.sleep(1)
    browser.find_element_by_xpath(&quot;&#47;&#47;a[@class=&#39;m-btn m-btn-white m-btn-text-orange&#39;]&quot;).click()
    time.sleep(1)</div>2019-04-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg" width="30px"><span>Geek_hve78z</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>css_selectorå®šä½æ€»ç»“
https:&#47;&#47;www.cnblogs.com&#47;yahutiaotiao&#47;p&#47;8044849.html
</div>2019-03-09</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/oseia6IjJIPziamTI2EQ0Bpr8icUicXTea2UuH105t4Bia4yFwBHld49cIQbjORvDdTtMCVdL39H9WxFwzyXspqqHUg/132" width="30px"><span>groot888</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆä½ å¥½ï¼Œè‡ªåŠ¨åŒ–è¿è¥å¾®åšæˆ‘æƒ³ä¸Šä¼ å›¾ç‰‡æ€ä¹ˆåšå‘¢ï¼Œçœ‹åˆ°ç½‘ä¸Šè¯´ç”¨AutoIt3è„šæœ¬è¯­è¨€ï¼Œä½†æ˜¯æ¯æ¬¡ä¸Šä¼ éœ€è¦ä¼ ä¸åŒçš„å›¾ç‰‡æ‰è¡Œå•Š</div>2020-05-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg" width="30px"><span>Geek_hve78z</span> ğŸ‘ï¼ˆ6ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>åˆ©ç”¨Seleniumåœ¨å¾®åšç”¨æˆ·é¡µé¢ç‚¹å‡»å…³æ³¨ï¼Œå¼¹å‡ºæ–°çš„å°çª—å£ï¼Œä½†æ˜¯ç¨‹åºæ˜¾ç¤ºæ— æ³•å®šä½åˆ°â€œå–æ¶ˆæŒ‰é’®â€ã€‚é€šè¿‡ç½‘ä¸ŠæŸ¥æ‰¾ï¼Œè¯´æ˜¯éœ€è¦driver.switchTo().fame(&quot;&quot;)é‡æ–°å®šä½é¡µé¢ï¼Œä½†æ˜¯è¿è¡Œå¤±è´¥ï¼Œæ±‚æŒ‡å¯¼ã€‚
https:&#47;&#47;www.cnblogs.com&#47;ella-yao&#47;p&#47;7762352.html
</div>2019-03-08</li><br/><li><img src="" width="30px"><span>yanyu-xin</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>ä½¿ç”¨Selenium 4.19.0ç‰ˆæœ¬æ—¶é‡åˆ°äº†AttributeError: &#39;WebDriver&#39; object has no attribute &#39;find_element_by_xpath&#39;çš„é”™è¯¯ï¼Œè¿™æ„å‘³ç€éœ€è¦å°†ä»£ç ä¸­çš„å…ƒç´ æŸ¥æ‰¾æ–¹æ³•æ›´æ–°ä¸ºæ–°çš„è¯­æ³•ã€‚å…·ä½“æ¥è¯´ï¼Œéœ€è¦ä»selenium.webdriver.common.byå¯¼å…¥Byç±»ï¼Œå¹¶ä½¿ç”¨find_elementæ–¹æ³•æ¥æ›¿ä»£åŸæ¥çš„find_element_by_xpathæ–¹æ³•ã€‚

åœ¨Selenium 4.3.0åŠä¹‹åçš„ç‰ˆæœ¬ä¸­ï¼ŒåŸæœ‰çš„å…ƒç´ æŸ¥æ‰¾æ–¹æ³•find_element_by_*å’Œfind_elements_by_*å·²ç»è¢«å¼ƒç”¨ã€‚ç°åœ¨ï¼ŒSeleniumæ¨èä½¿ç”¨æ–°çš„æŸ¥æ‰¾å…ƒç´ çš„æ–¹æ³•ï¼Œå³é€šè¿‡find_elementå‡½æ•°ç»“åˆByç±»æ¥å®šä½å…ƒç´ ã€‚ä¾‹å¦‚ï¼ŒåŸæ¥ä½¿ç”¨find_element_by_xpathçš„æ–¹å¼ç°åœ¨åº”è¯¥æ”¹ä¸ºfind_element(By.XPATH, ...)çš„å½¢å¼</div>2024-04-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/28/ed/78/2a1f3a48.jpg" width="30px"><span>GodlovezZ</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>è€å¸ˆå¥½ï¼Œæ‚¨è¿™äº›éƒ½æ˜¯é€šè¿‡python2å®ç°çš„ï¼Œè¯·é—®æœ‰å¯¹åº”python3çš„ä»£ç å˜›</div>2021-07-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/dc/68/006ba72c.jpg" width="30px"><span>Untitled</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>æœ‰éªŒè¯ç è¿™ä¸ªæ€ä¹ˆå¤„ç†ï¼Ÿï¼Ÿ</div>2020-03-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/77/be/1f2409e8.jpg" width="30px"><span>æ¢æ—æ¾</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>æˆ‘å‘ç°åªè¦ç›´æ¥ç‚¹å‡»ç§ä¿¡  udiå°±å‡ºç°äº†ã€‚
https:&#47;&#47;api.weibo.com&#47;chat&#47;#&#47;chat?to_uid=1890826225</div>2019-03-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/a4/5a/e708e423.jpg" width="30px"><span>third</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>é—®é¢˜
1.å¯èƒ½æ˜¯æˆ‘ä¸ç©å¾®åšçš„åŸå› å§ï¼Œä¸ºä»€ä¹ˆæˆ‘ç‚¹å‡»æ¯å¤©å­¦ç‚¹å¿ƒç†å­¦ä¸»é¡µçš„å·¦è¾¹å…³æ³¨åé¢çš„1884976ç²‰ä¸ï¼Œå¾—åˆ°çš„æ˜¯https:&#47;&#47;weibo.com&#47;p&#47;1005051890826225&#47;follow?relate=fans&amp;from=100505&amp;wvr=6&amp;mod=headfans&amp;current=fans#placeè¿™ä¸ªç½‘å€ï¼Ÿï¼Œæ€ä¹ˆæ‰èƒ½å¾—åˆ°https:&#47;&#47;weibo.com&#47;1890826225&#47;fans
2.å¼ºåˆ¶ç­‰å¾…1sä¸»è¦æ˜¯ä¸ºäº†ä»€ä¹ˆå‘¢ï¼Ÿæ˜¯ä¸ºäº†ï¼Œé˜²æ­¢åçˆ¬æœºåˆ¶å—ï¼Ÿé‚£å¦‚æœè¿™æ ·ï¼Œè®¾ç½®æˆéšæœºå¼ºåˆ¶ä¼‘çœ æ˜¯ä¸æ˜¯ä¼šæ›´å¥½ï¼Ÿ
3.æˆ‘åå¤æµ‹è¯•ï¼Œå¥½åƒè¢«å¾®åšå‘ç°äº†ï¼Œç°åœ¨è¿›ä¸å»å¾®åšäº†ã€‚ç„¶åç­‰ä¸€æ—¶é—´åˆèƒ½è¿›å»äº†
4.å½“æˆ‘è¿›å…¥å¾®åšçš„ä¸»é¡µçš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰ä¿æŒç™»å½•çŠ¶æ€ï¼Œå˜æˆäº†æ— ç™»å½•çŠ¶æ€ï¼Œè¦è®¾ç½®æˆä¿æŒç™»å½•çŠ¶æ€å—ï¼Ÿ
5.ä½œä¸š
def unfollow(uid):
    browser.get(&#39;https:&#47;&#47;m.weibo.com&#47;u&#47;&#39;+str(uid))
    already_concerned_button=browser.find_element_by_xpath(&quot;&#47;&#47;div[@class=&#39;m-diy-btn m-box-col m-box-center m-box-center-a&#39;][1]&#47;&#47;span&quot;)
    already_concerned_button.click()
    time.sleep(1)
    unfollow_buttom=browser.find_element_by_xpath(&quot;&#47;&#47;div[4]&#47;&#47;li[2]&quot;)
    unfollow_buttom.click()
    time.sleep(1)
    confirm_buttom=browser.find_element_by_xpath(&quot;&#47;&#47;div[@class=&#39;m-box-col&#39;][2]&quot;)
    time.sleep(1)
uid=&#39;1890826225&#39;
# add_follw(uid)
unfollow(uid)</div>2019-03-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/aa/d1/076482f3.jpg" width="30px"><span>ç™½å¤œ</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆï¼Œæˆ‘æƒ³é—®é—®ï¼Œæ¯å¤©å­¦ç‚¹å¿ƒç†å­¦ é‡Œçš„å†…å®¹ï¼Œæ˜¯ä»å“ªé‡Œæ‰¾æ¥çš„ï¼Ÿä¸æ€•è¢«ä¸¾æŠ¥æŠ„è¢­å—</div>2019-03-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/1f/d0/660502a4.jpg" width="30px"><span>åˆ</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>å¥½å¤šé¡µé¢å…ƒç´ æ”¹äº†ï¼Œè¿˜æœ‰find_elementçš„è¯­æ³•ä¹Ÿæ”¹äº†ï¼ŒæŠŠç™»å½•å’ŒåŠ å…³æ³¨çš„è„šæœ¬æ”¹äº†ï¼Œåé¢çš„ä¸æ”¹äº†ã€‚ä¹‹å‰åšè¿‡ä»51jobä¸Šçˆ¬æ‹›è˜æ•°æ®ï¼Œæ‰€ä»¥æ‰¾xpathè¿˜æŒºå®¹æ˜“çš„ã€‚æ•´ä¸ªæµç¨‹ä¹ŸåŸºæœ¬å°±æ˜¯ æ‰¾å…ƒç´ -å¡å†…å®¹-æ“ä½œå…ƒç´ ï¼Œä¸è¿‡å¼€å¤´çš„ä¸¤ä¸ªéªŒè¯ç çœŸçš„å¤ªçƒ¦äº†ï¼Œå›¾å½¢éªŒè¯ç +æ‰‹æœºéªŒè¯ç ï¼Œè¿™ä¿©æˆ‘æ˜¯é€šè¿‡sleepè¶³å¤Ÿçš„æ—¶é—´ä¹‹åæ‰‹åŠ¨æ“ä½œçš„ã€‚</div>2024-07-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/38/4f/61/018352d4.jpg" width="30px"><span>é™é™å‘€</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>xpathå®šä½å®åœ¨æ˜¯å¤ªéš¾äº†ï¼Œæ•´äº†åŠå¤©è¿˜æ˜¯å®šä½é”™çš„ï¼Œå¥½éš¾</div>2023-10-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/26/9e/836f603b.jpg" width="30px"><span>KokutoDa</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>å…³äºæœ‰éªŒè¯ç æ€ä¹ˆè‡ªåŠ¨ç™»å½•
1.loginæ–¹æ³•ï¼šç”¨æˆ·å¯†ç ç™»å½•ï¼ŒéªŒè¯ç å¤„æ‰‹åŠ¨æ“ä½œï¼Œç™»å½•æˆåŠŸåæ‰“å°å‡º cookie
2.login_by_cookieï¼šæ·»åŠ  cookie åˆ° driverï¼Œå†åˆ·æ–°é¡µé¢å°±ç™»å½•æˆåŠŸäº†ã€‚

from selenium import webdriver
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.common.keys import Keys
import time

# æ‰‹åŠ¨ç™»å½•
def login(driver, user, pw):
    xpath_user = &quot;&#47;&#47;input[@id=&#39;loginname&#39;]&quot;
    xpath_pw = &quot;&#47;&#47;input[@type=&#39;password&#39;]&quot;
    # ç­‰å¾…é¡µé¢æ˜¾ç¤º
    WebDriverWait(driver, 10).until(lambda driver: driver.find_element_by_xpath(xpath_user))
    # ç”¨æˆ·å¯†ç ç™»å½•
    elem_user = driver.find_element_by_xpath(xpath_user)
    elem_user.send_keys(user)
    elem_pw = driver.find_element_by_xpath(xpath_pw)
    elem_pw.send_keys(pw)
    elem_pw.send_keys(Keys.RETURN)
    # è·å–æ‰‹åŠ¨ç™»å½•åçš„ cookie
    time.sleep(60)
    print(driver.get_cookies())

def login_by_cookie(driver, cookies):
    time.sleep(5)
    for i in cookies:
        driver.add_cookie(i)
    time.sleep(3)
    driver.refresh()

url = &#39;https:&#47;&#47;weibo.com&#47;&#39;
driver = webdriver.Firefox()
driver.get(url)

user = &#39;***&#39;
pw = &quot;***&quot;
cookies = [&#39;...&#39;]
# login(driver, user, pw)
# ä½¿ç”¨ç™»å½•åè·å¾—çš„ cookie ç™»å½•
login_by_cookie(driver, cookies)</div>2021-05-31</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/51/86/b5fd8dd8.jpg" width="30px"><span>å»ºå¼º</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div># å¾®åšè‡ªåŠ¨åŒ–è¿è¥æ¨¡æ‹Ÿï¼Œå› å­—æ•°é™åˆ¶ï¼Œè¿™é‡Œåªæ”¾äº†ä¸¤ä¸ªåŠŸèƒ½ï¼šå¯¹æŒ‡å®šç”¨æˆ·åŠ å…³æ³¨ã€å¯¹æŒ‡å®šç”¨æˆ·å–æ¶ˆå…³æ³¨ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªåŠŸèƒ½æ˜¯è€å¸ˆå†™çš„ã€‚
from selenium import webdriver
import time

# å…³æ³¨æŒ‡å®šçš„ç”¨æˆ·
def add_follow(browser, weibourl, uid):
#BEGIN
    browser.get(weibourl + str(uid))
    time.sleep(1)
    follow_button = browser.find_element_by_xpath(&quot;&#47;&#47;div[@class=&#39;m-add-box m-followBtn m-btn m-btn-block m-btn-blue&#39;]&quot;)
    follow_button.click()
    time.sleep(1)

    # é€‰æ‹©&quot;ç‰¹åˆ«å…³æ³¨&quot;åˆ†ç»„
    group_button = browser.find_element_by_xpath(&quot;&#47;&#47;li[1]&#47;label[@class=&#39;m-checkbox&#39;]&quot;)
    group_button.click()
    time.sleep(1)

    # ç‚¹å‡»&quot;ç¡®å®š&quot;æŒ‰é’®
    ok_button = browser.find_element_by_xpath(&quot;&#47;&#47;a[@class=&#39;m-btn m-btn-white m-btn-text-orange&#39;]&quot;)
    ok_button.click()
    time.sleep(1)
#END

# å–æ¶ˆå…³æ³¨æŒ‡å®šçš„ç”¨æˆ·
def del_follow(browser, weibourl, uid):
#BEGIN
    browser.get(weibourl + str(uid))
    time.sleep(1)

    # å®šä½&quot;å·²å…³æ³¨&quot;æŒ‰é’®ï¼Œå¹¶ç‚¹å‡»
    follow_button = browser.find_element_by_xpath(&quot;&#47;&#47;a[@class=&#39;m-btn m-btn-block m-btn-lite-white&#39;]&quot;)
    follow_button.click()
    time.sleep(1)

    # å®šä½&quot;ç¡®å®š&quot;æŒ‰é’®ï¼Œå¹¶ç‚¹å‡»
    ok_button = browser.find_element_by_xpath(&quot;&#47;&#47;a[@class=&#39;m-btn m-btn-white m-btn-text-orange&#39;]&quot;)
    ok_button.click()
    time.sleep(1)
#END

# ä¸»ç¨‹åº
def main():
#BEGIN

    # å…³æ³¨ç”¨æˆ·&quot;å®…å‰§æ’è¡Œæ¦œ&quot;
    weibourl = &#39;https:&#47;&#47;m.weibo.cn&#47;profile&#47;&#39;
    uid = &#39;1878531805&#39; 
    add_follow(browser, weibourl, uid)

    # å¯¹ç”¨æˆ·&quot;å®…å‰§æ’è¡Œæ¦œ&quot;å–æ¶ˆå…³æ³¨
    del_follow(browser, weibourl, uid)
#END

if __name__ == &#39;__main__&#39;:
    main()

&#39;&#39;&#39;
ä¸»è¦æ”¶è·:
1. å¯¹ç½‘é¡µè‡ªåŠ¨åŒ–æ“ä½œæœ‰äº†åˆæ­¥è®¤è¯†
2. è¿›ä¸€æ­¥æŒæ¡äº†åˆ©ç”¨xpathè¿›è¡Œç½‘é¡µå…ƒç´ å®šä½çš„æ“ä½œã€‚
&#39;&#39;&#39;</div>2020-02-16</li><br/><li><img src="https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIc88LLmwU7RU1tGcmo5OZyPibKeXPg31wMxyc2uByEO3g44f6uLcu1bXGNO9AHVgn0PK5hwkcfYZA/132" width="30px"><span>è‘£å¤§ç³å„¿</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>NoSuchElementException: no such element: Unable to locate element: {&quot;method&quot;:&quot;xpath&quot;,&quot;selector&quot;:&quot;&#47;&#47;div[@class=&quot;m-btn m-btn-white m-btn-text-black&quot;]&quot;}
  (Session info: chrome=75.0.3770.100)ï¼Œï¼Œï¼Œä¸€ç›´åœ¨æŠ¥é”™</div>2019-06-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/a6/29/3ee29119.jpg" width="30px"><span>ping</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>é€šè¿‡åŒæ ·çš„æ–¹æ³•ï¼Œä½ å¯ä»¥æŸ¥çœ‹â€œå–æ¶ˆâ€è¿™ä¸ªæŒ‰é’®å¯¹åº”çš„ HTML , ä½†æ˜¯å°±æ˜¯æ²¡æ‰¾åˆ°ï¼š
no such element: Unable to locate element

</div>2019-04-28</li><br/>
</ul>