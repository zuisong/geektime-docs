ä¸Šæ¬¡æˆ‘ç»™ä½ è®²äº†å…³è”è§„åˆ™æŒ–æ˜çš„åŸç†ã€‚å…³è”è§„åˆ™æŒ–æ˜åœ¨ç”Ÿæ´»ä¸­æœ‰å¾ˆå¤šä½¿ç”¨åœºæ™¯ï¼Œä¸ä»…æ˜¯å•†å“çš„æ†ç»‘é”€å”®ï¼Œç”šè‡³åœ¨æŒ‘é€‰æ¼”å‘˜å†³ç­–ä¸Šï¼Œä½ ä¹Ÿèƒ½é€šè¿‡å…³è”è§„åˆ™æŒ–æ˜çœ‹å‡ºæ¥æŸä¸ªå¯¼æ¼”é€‰æ‹©æ¼”å‘˜çš„å€¾å‘ã€‚

ä»Šå¤©æˆ‘æ¥å¸¦ä½ ç”¨Aprioriç®—æ³•åšä¸€ä¸ªé¡¹ç›®å®æˆ˜ã€‚ä½ éœ€è¦æŒæ¡çš„æ˜¯ä»¥ä¸‹å‡ ç‚¹ï¼š

1. ç†Ÿæ‚‰ä¸ŠèŠ‚è¯¾è®²åˆ°çš„å‡ ä¸ªé‡è¦æ¦‚å¿µï¼šæ”¯æŒåº¦ã€ç½®ä¿¡åº¦å’Œæå‡åº¦ï¼›
2. ç†Ÿæ‚‰ä¸æŒæ¡Aprioriå·¥å…·åŒ…çš„ä½¿ç”¨ï¼›
3. åœ¨å®é™…é—®é¢˜ä¸­ï¼Œçµæ´»è¿ç”¨ã€‚åŒ…æ‹¬æ•°æ®é›†çš„å‡†å¤‡ç­‰ã€‚

## å¦‚ä½•ä½¿ç”¨Aprioriå·¥å…·åŒ…

Aprioriè™½ç„¶æ˜¯åå¤§ç®—æ³•ä¹‹ä¸€ï¼Œä¸è¿‡åœ¨sklearnå·¥å…·åŒ…ä¸­å¹¶æ²¡æœ‰å®ƒï¼Œä¹Ÿæ²¡æœ‰FP-Growthç®—æ³•ã€‚è¿™é‡Œæ•™ä½ ä¸ªæ–¹æ³•ï¼Œæ¥é€‰æ‹©Pythonä¸­å¯ä»¥ä½¿ç”¨çš„å·¥å…·åŒ…ï¼Œä½ å¯ä»¥é€šè¿‡[https://pypi.org/](https://pypi.org/) æœç´¢å·¥å…·åŒ…ã€‚

![](https://static001.geekbang.org/resource/image/76/c7/76a3b34beccbe7b69a11951b4efd80c7.png?wh=1726%2A767)  
è¿™ä¸ªç½‘ç«™æä¾›çš„å·¥å…·åŒ…éƒ½æ˜¯Pythonè¯­è¨€çš„ï¼Œä½ èƒ½æ‰¾åˆ°8ä¸ªPythonè¯­è¨€çš„Aprioriå·¥å…·åŒ…ï¼Œå…·ä½“é€‰æ‹©å“ªä¸ªå‘¢ï¼Ÿå»ºè®®ä½ ä½¿ç”¨ç¬¬äºŒä¸ªå·¥å…·åŒ…ï¼Œå³efficient-aprioriã€‚åé¢æˆ‘ä¼šè®²åˆ°ä¸ºä»€ä¹ˆæ¨èè¿™ä¸ªå·¥å…·åŒ…ã€‚

é¦–å…ˆä½ éœ€è¦é€šè¿‡pip install efficient-apriori å®‰è£…è¿™ä¸ªå·¥å…·åŒ…ã€‚

ç„¶åçœ‹ä¸‹å¦‚ä½•ä½¿ç”¨å®ƒï¼Œæ ¸å¿ƒçš„ä»£ç å°±æ˜¯è¿™ä¸€è¡Œï¼š

```
itemsets, rules = apriori(data, min_support,  min_confidence)
```

å…¶ä¸­dataæ˜¯æˆ‘ä»¬è¦æä¾›çš„æ•°æ®é›†ï¼Œå®ƒæ˜¯ä¸€ä¸ªlistæ•°ç»„ç±»å‹ã€‚min\_supportå‚æ•°ä¸ºæœ€å°æ”¯æŒåº¦ï¼Œåœ¨efficient-aprioriå·¥å…·åŒ…ä¸­ç”¨0åˆ°1çš„æ•°å€¼ä»£è¡¨ç™¾åˆ†æ¯”ï¼Œæ¯”å¦‚0.5ä»£è¡¨æœ€å°æ”¯æŒåº¦ä¸º50%ã€‚min\_confidenceæ˜¯æœ€å°ç½®ä¿¡åº¦ï¼Œæ•°å€¼ä¹Ÿä»£è¡¨ç™¾åˆ†æ¯”ï¼Œæ¯”å¦‚1ä»£è¡¨100%ã€‚

å…³äºæ”¯æŒåº¦ã€ç½®ä¿¡åº¦å’Œæå‡åº¦ï¼Œæˆ‘ä»¬å†æ¥ç®€å•å›å¿†ä¸‹ã€‚

æ”¯æŒåº¦æŒ‡çš„æ˜¯æŸä¸ªå•†å“ç»„åˆå‡ºç°çš„æ¬¡æ•°ä¸æ€»æ¬¡æ•°ä¹‹é—´çš„æ¯”ä¾‹ã€‚æ”¯æŒåº¦è¶Šé«˜ï¼Œä»£è¡¨è¿™ä¸ªç»„åˆå‡ºç°çš„æ¦‚ç‡è¶Šå¤§ã€‚

ç½®ä¿¡åº¦æ˜¯ä¸€ä¸ªæ¡ä»¶æ¦‚å¿µï¼Œå°±æ˜¯åœ¨Aå‘ç”Ÿçš„æƒ…å†µä¸‹ï¼ŒBå‘ç”Ÿçš„æ¦‚ç‡æ˜¯å¤šå°‘ã€‚

æå‡åº¦ä»£è¡¨çš„æ˜¯â€œå•†å“Açš„å‡ºç°ï¼Œå¯¹å•†å“Bçš„å‡ºç°æ¦‚ç‡æå‡äº†å¤šå°‘â€ã€‚

æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨è¿™ä¸ªå·¥å…·åŒ…ï¼Œè·‘ä¸€ä¸‹ä¸ŠèŠ‚è¯¾ä¸­è®²åˆ°çš„è¶…å¸‚è´­ç‰©çš„ä¾‹å­ã€‚ä¸‹é¢æ˜¯å®¢æˆ·è´­ä¹°çš„å•†å“åˆ—è¡¨ï¼š

![](https://static001.geekbang.org/resource/image/a4/a6/a48f4a2961c3be811431418eb84aeaa6.png?wh=476%2A202)

å…·ä½“å®ç°çš„ä»£ç å¦‚ä¸‹ï¼š

```
from efficient_apriori import apriori
# è®¾ç½®æ•°æ®é›†
data = [('ç‰›å¥¶','é¢åŒ…','å°¿å¸ƒ'),
           ('å¯ä¹','é¢åŒ…', 'å°¿å¸ƒ', 'å•¤é…’'),
           ('ç‰›å¥¶','å°¿å¸ƒ', 'å•¤é…’', 'é¸¡è›‹'),
           ('é¢åŒ…', 'ç‰›å¥¶', 'å°¿å¸ƒ', 'å•¤é…’'),
           ('é¢åŒ…', 'ç‰›å¥¶', 'å°¿å¸ƒ', 'å¯ä¹')]
# æŒ–æ˜é¢‘ç¹é¡¹é›†å’Œé¢‘ç¹è§„åˆ™
itemsets, rules = apriori(data, min_support=0.5,  min_confidence=1)
print(itemsets)
print(rules)

```

è¿è¡Œç»“æœï¼š

```
{1: {('å•¤é…’',): 3, ('å°¿å¸ƒ',): 5, ('ç‰›å¥¶',): 4, ('é¢åŒ…',): 4}, 2: {('å•¤é…’', 'å°¿å¸ƒ'): 3, ('å°¿å¸ƒ', 'ç‰›å¥¶'): 4, ('å°¿å¸ƒ', 'é¢åŒ…'): 4, ('ç‰›å¥¶', 'é¢åŒ…'): 3}, 3: {('å°¿å¸ƒ', 'ç‰›å¥¶', 'é¢åŒ…'): 3}}
[{å•¤é…’} -> {å°¿å¸ƒ}, {ç‰›å¥¶} -> {å°¿å¸ƒ}, {é¢åŒ…} -> {å°¿å¸ƒ}, {ç‰›å¥¶, é¢åŒ…} -> {å°¿å¸ƒ}]
```

ä½ èƒ½ä»ä»£ç ä¸­çœ‹å‡ºæ¥ï¼Œdataæ˜¯ä¸ªListæ•°ç»„ç±»å‹ï¼Œå…¶ä¸­æ¯ä¸ªå€¼éƒ½å¯ä»¥æ˜¯ä¸€ä¸ªé›†åˆã€‚å®é™…ä¸Šä½ ä¹Ÿå¯ä»¥æŠŠdataæ•°ç»„ä¸­çš„æ¯ä¸ªå€¼è®¾ç½®ä¸ºListæ•°ç»„ç±»å‹ï¼Œæ¯”å¦‚ï¼š

```
data = [['ç‰›å¥¶','é¢åŒ…','å°¿å¸ƒ'],
           ['å¯ä¹','é¢åŒ…', 'å°¿å¸ƒ', 'å•¤é…’'],
           ['ç‰›å¥¶','å°¿å¸ƒ', 'å•¤é…’', 'é¸¡è›‹'],
           ['é¢åŒ…', 'ç‰›å¥¶', 'å°¿å¸ƒ', 'å•¤é…’'],
           ['é¢åŒ…', 'ç‰›å¥¶', 'å°¿å¸ƒ', 'å¯ä¹']]
```

ä¸¤è€…çš„è¿è¡Œç»“æœæ˜¯ä¸€æ ·çš„ï¼Œefficient-apriori å·¥å…·åŒ…æŠŠæ¯ä¸€æ¡æ•°æ®é›†é‡Œçš„é¡¹å¼éƒ½æ”¾åˆ°äº†ä¸€ä¸ªé›†åˆä¸­è¿›è¡Œè¿ç®—ï¼Œå¹¶æ²¡æœ‰è€ƒè™‘å®ƒä»¬ä¹‹é—´çš„å…ˆåé¡ºåºã€‚å› ä¸ºå®é™…æƒ…å†µä¸‹ï¼ŒåŒä¸€ä¸ªè´­ç‰©ç¯®ä¸­çš„ç‰©å“ä¹Ÿä¸éœ€è¦è€ƒè™‘è´­ä¹°çš„å…ˆåé¡ºåºã€‚

è€Œå…¶ä»–çš„Aprioriç®—æ³•å¯èƒ½ä¼šå› ä¸ºè€ƒè™‘äº†å…ˆåé¡ºåºï¼Œå‡ºç°è®¡ç®—é¢‘ç¹é¡¹é›†ç»“æœä¸å¯¹çš„æƒ…å†µã€‚æ‰€ä»¥è¿™é‡Œé‡‡ç”¨çš„æ˜¯efficient-aprioriè¿™ä¸ªå·¥å…·åŒ…ã€‚

## æŒ–æ˜å¯¼æ¼”æ˜¯å¦‚ä½•é€‰æ‹©æ¼”å‘˜çš„

åœ¨å®é™…å·¥ä½œä¸­ï¼Œæ•°æ®é›†æ˜¯éœ€è¦è‡ªå·±æ¥å‡†å¤‡çš„ï¼Œæ¯”å¦‚ä»Šå¤©æˆ‘ä»¬è¦æŒ–æ˜å¯¼æ¼”æ˜¯å¦‚ä½•é€‰æ‹©æ¼”å‘˜çš„æ•°æ®æƒ…å†µï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å…¬å¼€çš„æ•°æ®é›†å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¹‹å‰è®²åˆ°çš„Pythonçˆ¬è™«è¿›è¡Œæ•°æ®é‡‡é›†ã€‚

ä¸åŒå¯¼æ¼”é€‰æ‹©æ¼”å‘˜çš„è§„åˆ™æ˜¯ä¸åŒçš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å…ˆæŒ‡å®šå¯¼æ¼”ã€‚æ•°æ®æºæˆ‘ä»¬é€‰ç”¨è±†ç“£ç”µå½±ã€‚

å…ˆæ¥æ¢³ç†ä¸‹é‡‡é›†çš„å·¥ä½œæµç¨‹ã€‚

é¦–å…ˆæˆ‘ä»¬å…ˆåœ¨[https://movie.douban.com](https://movie.douban.com)æœç´¢æ¡†ä¸­è¾“å…¥å¯¼æ¼”å§“åï¼Œæ¯”å¦‚â€œå®æµ©â€ã€‚

![](https://static001.geekbang.org/resource/image/ea/ef/eaba9861825a38b6fbd5af1bff7194ef.png?wh=1728%2A1150)  
é¡µé¢ä¼šå‘ˆç°å‡ºæ¥å¯¼æ¼”ä¹‹å‰çš„æ‰€æœ‰ç”µå½±ï¼Œç„¶åå¯¹é¡µé¢è¿›è¡Œè§‚å¯Ÿï¼Œä½ èƒ½è§‚å¯Ÿåˆ°ä»¥ä¸‹å‡ ä¸ªç°è±¡ï¼š

1. é¡µé¢é»˜è®¤æ˜¯15æ¡æ•°æ®åé¦ˆï¼Œç¬¬ä¸€é¡µä¼šè¿”å›16æ¡ã€‚å› ä¸ºç¬¬ä¸€æ¡æ•°æ®å®é™…ä¸Šè¿™ä¸ªå¯¼æ¼”çš„æ¦‚è§ˆï¼Œä½ å¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€æ¡å¹¿å‘Šçš„æ’å…¥ï¼Œä¸‹é¢æ‰æ˜¯çœŸæ­£çš„è¿”å›ç»“æœã€‚
2. æ¯æ¡æ•°æ®çš„æœ€åä¸€è¡Œæ˜¯ç”µå½±çš„æ¼”å‡ºäººå‘˜çš„ä¿¡æ¯ï¼Œç¬¬ä¸€ä¸ªäººå‘˜æ˜¯å¯¼æ¼”ï¼Œå…¶ä½™ä¸ºæ¼”å‘˜å§“åã€‚å§“åä¹‹é—´ç”¨â€œ/â€åˆ†å‰²ã€‚

æœ‰äº†è¿™äº›è§‚å¯Ÿä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç¼–å†™æŠ“å–ç¨‹åºäº†ã€‚åœ¨ä»£ç è®²è§£ä¸­ä½ èƒ½çœ‹å‡ºè¿™ä¸¤ç‚¹è§‚å¯Ÿçš„ä½œç”¨ã€‚æŠ“å–ç¨‹åºçš„ç›®çš„æ˜¯ä¸ºäº†ç”Ÿæˆå®æµ©å¯¼æ¼”ï¼ˆä½ ä¹Ÿå¯ä»¥æŠ“å–å…¶ä»–å¯¼æ¼”ï¼‰çš„æ•°æ®é›†ï¼Œç»“æœä¼šä¿å­˜åœ¨csvæ–‡ä»¶ä¸­ã€‚å®Œæ•´çš„æŠ“å–ä»£ç å¦‚ä¸‹ï¼š

```
# -*- coding: utf-8 -*-
# ä¸‹è½½æŸä¸ªå¯¼æ¼”çš„ç”µå½±æ•°æ®é›†
from efficient_apriori import apriori
from lxml import etree
import time
from selenium import webdriver
import csv
driver = webdriver.Chrome()
# è®¾ç½®æƒ³è¦ä¸‹è½½çš„å¯¼æ¼” æ•°æ®é›†
director = u'å®æµ©'
# å†™CSVæ–‡ä»¶
file_name = './' + director + '.csv'
base_url = 'https://movie.douban.com/subject_search?search_text='+director+'&cat=1002&start='
out = open(file_name,'w', newline='', encoding='utf-8-sig')
csv_write = csv.writer(out, dialect='excel')
flags=[]
# ä¸‹è½½æŒ‡å®šé¡µé¢çš„æ•°æ®
def download(request_url):
	driver.get(request_url)
	time.sleep(1)
	html = driver.find_element_by_xpath("//*").get_attribute("outerHTML")
	html = etree.HTML(html)
	# è®¾ç½®ç”µå½±åç§°ï¼Œå¯¼æ¼”æ¼”å‘˜ çš„XPATH
	movie_lists = html.xpath("/html/body/div[@id='wrapper']/div[@id='root']/div[1]//div[@class='item-root']/div[@class='detail']/div[@class='title']/a[@class='title-text']")
	name_lists = html.xpath("/html/body/div[@id='wrapper']/div[@id='root']/div[1]//div[@class='item-root']/div[@class='detail']/div[@class='meta abstract_2']")
	# è·å–è¿”å›çš„æ•°æ®ä¸ªæ•°
	num = len(movie_lists)
	if num > 15: #ç¬¬ä¸€é¡µä¼šæœ‰16æ¡æ•°æ®
		# é»˜è®¤ç¬¬ä¸€ä¸ªä¸æ˜¯ï¼Œæ‰€ä»¥éœ€è¦å»æ‰
		movie_lists = movie_lists[1:]
		name_lists = name_lists[1:]
	for (movie, name_list) in zip(movie_lists, name_lists):
		# ä¼šå­˜åœ¨æ•°æ®ä¸ºç©ºçš„æƒ…å†µ
		if name_list.text is None: 
			continue
		# æ˜¾ç¤ºä¸‹æ¼”å‘˜åç§°
		print(name_list.text)
		names = name_list.text.split('/')
		# åˆ¤æ–­å¯¼æ¼”æ˜¯å¦ä¸ºæŒ‡å®šçš„director
		if names[0].strip() == director and movie.text not in flags:
			# å°†ç¬¬ä¸€ä¸ªå­—æ®µè®¾ç½®ä¸ºç”µå½±åç§°
			names[0] = movie.text
			flags.append(movie.text)
			csv_write.writerow(names)
	print('OK') # ä»£è¡¨è¿™é¡µæ•°æ®ä¸‹è½½æˆåŠŸ
	print(num)
	if num >= 14: #æœ‰å¯èƒ½ä¸€é¡µä¼šæœ‰14ä¸ªç”µå½±
		# ç»§ç»­ä¸‹ä¸€é¡µ
		return True
	else:
		# æ²¡æœ‰ä¸‹ä¸€é¡µ
		return False

# å¼€å§‹çš„IDä¸º0ï¼Œæ¯é¡µå¢åŠ 15
start = 0
while start<10000: #æœ€å¤šæŠ½å–1ä¸‡éƒ¨ç”µå½±
	request_url = base_url + str(start)
	# ä¸‹è½½æ•°æ®ï¼Œå¹¶è¿”å›æ˜¯å¦æœ‰ä¸‹ä¸€é¡µ
	flag = download(request_url)
	if flag:
		start = start + 15
	else:
		break
out.close()
print('finished')
```

ä»£ç ä¸­æ¶‰åŠåˆ°äº†å‡ ä¸ªæ¨¡å—ï¼Œæˆ‘ç®€å•è®²è§£ä¸‹è¿™å‡ ä¸ªæ¨¡å—ã€‚

åœ¨å¼•ç”¨åŒ…è¿™ä¸€æ®µï¼Œæˆ‘ä»¬ä½¿ç”¨csvå·¥å…·åŒ…è¯»å†™CSVæ–‡ä»¶ï¼Œç”¨efficient\_aprioriå®ŒæˆAprioriç®—æ³•ï¼Œç”¨lxmlè¿›è¡ŒXPathè§£æï¼Œtimeå·¥å…·åŒ…å¯ä»¥è®©æˆ‘ä»¬åœ¨æ¨¡æ‹Ÿåæœ‰ä¸ªé€‚å½“åœç•™ï¼Œä»£ç ä¸­æˆ‘è®¾ç½®ä¸º1ç§’é’Ÿï¼Œç­‰HTMLæ•°æ®å®Œå…¨è¿”å›åå†è¿›è¡ŒHTMLå†…å®¹çš„è·å–ã€‚ä½¿ç”¨seleniumçš„webdriveræ¥æ¨¡æ‹Ÿæµè§ˆå™¨çš„è¡Œä¸ºã€‚

åœ¨è¯»å†™æ–‡ä»¶è¿™ä¸€å—ï¼Œæˆ‘ä»¬éœ€è¦äº‹å…ˆå‘Šè¯‰pythonçš„openå‡½æ•°ï¼Œæ–‡ä»¶çš„ç¼–ç æ˜¯utf-8-sigï¼ˆå¯¹åº”ä»£ç ï¼šencoding=â€˜utf-8-sigâ€™ï¼‰ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬ä¼šç”¨åˆ°ä¸­æ–‡ï¼Œä¸ºäº†é¿å…ç¼–ç æ··ä¹±ã€‚

ç¼–å†™downloadå‡½æ•°ï¼Œå‚æ•°ä¼ å…¥æˆ‘ä»¬è¦é‡‡é›†çš„é¡µé¢åœ°å€ï¼ˆrequest\_urlï¼‰ã€‚é’ˆå¯¹è¿”å›çš„HTMLï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°ä¹‹å‰è®²åˆ°çš„Chromeæµè§ˆå™¨çš„XPath Helperå·¥å…·ï¼Œæ¥è·å–ç”µå½±åç§°ä»¥åŠæ¼”å‡ºäººå‘˜çš„XPathã€‚æˆ‘ç”¨é¡µé¢è¿”å›çš„æ•°æ®ä¸ªæ•°æ¥åˆ¤æ–­å½“å‰æ‰€å¤„çš„é¡µé¢åºå·ã€‚å¦‚æœæ•°æ®ä¸ªæ•°&gt;15ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€é¡µï¼Œç¬¬ä¸€é¡µçš„ç¬¬ä¸€æ¡æ•°æ®æ˜¯å¹¿å‘Šï¼Œæˆ‘ä»¬éœ€è¦å¿½ç•¥ã€‚å¦‚æœæ•°æ®ä¸ªæ•°=15ï¼Œä»£è¡¨æ˜¯ä¸­é—´é¡µï¼Œéœ€è¦ç‚¹å‡»â€œä¸‹ä¸€é¡µâ€ï¼Œä¹Ÿå°±æ˜¯ç¿»é¡µã€‚å¦‚æœæ•°æ®ä¸ªæ•°&lt;15ï¼Œä»£è¡¨æœ€åä¸€é¡µï¼Œæ²¡æœ‰ä¸‹ä¸€é¡µã€‚

åœ¨ç¨‹åºä¸»ä½“éƒ¨åˆ†ï¼Œæˆ‘ä»¬è®¾ç½®startä»£è¡¨æŠ“å–çš„IDï¼Œä»0å¼€å§‹æœ€å¤šæŠ“å–1ä¸‡éƒ¨ç”µå½±çš„æ•°æ®ï¼ˆä¸€ä¸ªå¯¼æ¼”ä¸ä¼šè¶…è¿‡1ä¸‡éƒ¨ç”µå½±ï¼‰ï¼Œæ¯æ¬¡ç¿»é¡µstartè‡ªåŠ¨å¢åŠ 15ï¼Œç›´åˆ°flag=Falseä¸ºæ­¢ï¼Œä¹Ÿå°±æ˜¯ä¸å­˜åœ¨ä¸‹ä¸€é¡µçš„æƒ…å†µã€‚

ä½ å¯ä»¥æ¨¡æ‹Ÿä¸‹æŠ“å–çš„æµç¨‹ï¼Œè·å¾—æŒ‡å®šå¯¼æ¼”çš„æ•°æ®ï¼Œæ¯”å¦‚æˆ‘ä¸Šé¢æŠ“å–çš„å®æµ©çš„æ•°æ®ã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè±†ç“£çš„ç”µå½±æ•°æ®å¯èƒ½æ˜¯ä¸å…¨çš„ï¼Œä½†åŸºæœ¬ä¸Šå¤Ÿæˆ‘ä»¬ç”¨ã€‚

![](https://static001.geekbang.org/resource/image/5e/16/5ea61131d1fce390040cf0edf6897a16.png?wh=1729%2A411)  
æœ‰äº†æ•°æ®ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨Aprioriç®—æ³•æ¥æŒ–æ˜é¢‘ç¹é¡¹é›†å’Œå…³è”è§„åˆ™ï¼Œä»£ç å¦‚ä¸‹ï¼š

```
# -*- coding: utf-8 -*-
from efficient_apriori import apriori
import csv
director = u'å®æµ©'
file_name = './'+director+'.csv'
lists = csv.reader(open(file_name, 'r', encoding='utf-8-sig'))
# æ•°æ®åŠ è½½
data = []
for names in lists:
     name_new = []
     for name in names:
           # å»æ‰æ¼”å‘˜æ•°æ®ä¸­çš„ç©ºæ ¼
           name_new.append(name.strip())
     data.append(name_new[1:])
# æŒ–æ˜é¢‘ç¹é¡¹é›†å’Œå…³è”è§„åˆ™
itemsets, rules = apriori(data, min_support=0.5,  min_confidence=1)
print(itemsets)
print(rules)
```

ä»£ç ä¸­ä½¿ç”¨çš„aprioriæ–¹æ³•å’Œå¼€å¤´ä¸­ç”¨Aprioriè·å–è´­ç‰©ç¯®è§„å¾‹çš„æ–¹æ³•ç±»ä¼¼ï¼Œæ¯”å¦‚ä»£ç ä¸­éƒ½è®¾å®šäº†æœ€å°æ”¯æŒåº¦å’Œæœ€å°ç½®ä¿¡ç³»æ•°ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°æ”¯æŒåº¦å¤§äº50%ï¼Œç½®ä¿¡ç³»æ•°ä¸º1çš„é¢‘ç¹é¡¹é›†å’Œå…³è”è§„åˆ™ã€‚

è¿™æ˜¯æœ€åçš„è¿è¡Œç»“æœï¼š

```
{1: {('å¾å³¥',): 5, ('é»„æ¸¤',): 6}, 2: {('å¾å³¥', 'é»„æ¸¤'): 5}}
[{å¾å³¥} -> {é»„æ¸¤}]
```

ä½ èƒ½çœ‹å‡ºæ¥ï¼Œå®æµ©å¯¼æ¼”å–œæ¬¢ç”¨å¾å³¥å’Œé»„æ¸¤ï¼Œå¹¶ä¸”æœ‰å¾å³¥çš„æƒ…å†µä¸‹ï¼Œä¸€èˆ¬éƒ½ä¼šç”¨é»„æ¸¤ã€‚ä½ ä¹Ÿå¯ä»¥ç”¨ä¸Šé¢çš„ä»£ç æ¥æŒ–æ˜ä¸‹å…¶ä»–å¯¼æ¼”é€‰æ‹©æ¼”å‘˜çš„è§„å¾‹ã€‚

## æ€»ç»“

Aprioriç®—æ³•çš„æ ¸å¿ƒå°±æ˜¯ç†è§£é¢‘ç¹é¡¹é›†å’Œå…³è”è§„åˆ™ã€‚åœ¨ç®—æ³•è¿ç®—çš„è¿‡ç¨‹ä¸­ï¼Œè¿˜è¦é‡ç‚¹æŒæ¡å¯¹æ”¯æŒåº¦ã€ç½®ä¿¡åº¦å’Œæå‡åº¦çš„ç†è§£ã€‚åœ¨å·¥å…·ä½¿ç”¨ä¸Šï¼Œä½ å¯ä»¥ä½¿ç”¨efficient-aprioriè¿™ä¸ªå·¥å…·åŒ…ï¼Œå®ƒä¼šæŠŠæ¯ä¸€æ¡æ•°æ®ä¸­çš„é¡¹ï¼ˆitemï¼‰æ”¾åˆ°ä¸€ä¸ªé›†åˆï¼ˆç¯®å­ï¼‰é‡Œæ¥å¤„ç†ï¼Œä¸è€ƒè™‘é¡¹ï¼ˆitemï¼‰ä¹‹é—´çš„å…ˆåé¡ºåºã€‚

åœ¨å®é™…è¿ç”¨ä¸­ä½ è¿˜éœ€è¦çµæ´»å¤„ç†ï¼Œæ¯”å¦‚å¯¼æ¼”å¦‚ä½•é€‰æ‹©æ¼”å‘˜è¿™ä¸ªæ¡ˆä¾‹ï¼Œè™½ç„¶å·¥å…·çš„ä½¿ç”¨ä¼šå¾ˆæ–¹ä¾¿ï¼Œä½†é‡è¦çš„è¿˜æ˜¯æ•°æ®æŒ–æ˜å‰çš„å‡†å¤‡è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯è·å–æŸä¸ªå¯¼æ¼”çš„ç”µå½±æ•°æ®é›†ã€‚

![](https://static001.geekbang.org/resource/image/28/9d/282c25e8651b3e0b675be7267d13629d.png?wh=1727%2A509)  
æœ€åç»™ä½ ç•™ä¸¤é“æ€è€ƒé¢˜å§ã€‚è¯·ä½ ç¼–å†™ä»£ç æŒ–æ˜ä¸‹å¼ è‰ºè°‹å¯¼æ¼”ä½¿ç”¨æ¼”å‘˜çš„é¢‘ç¹é¡¹é›†å’Œå…³è”è§„åˆ™ï¼Œæœ€å°æ”¯æŒåº¦å¯ä»¥è®¾ç½®ä¸º0.1æˆ–0.05ã€‚å¦å¤–ä½ è®¤ä¸ºAprioriç®—æ³•ä¸­çš„æœ€å°æ”¯æŒåº¦å’Œæœ€å°ç½®ä¿¡åº¦ï¼Œä¸€èˆ¬è®¾ç½®ä¸ºå¤šå°‘æ¯”è¾ƒåˆç†ï¼Ÿ

æ¬¢è¿ä½ åœ¨è¯„è®ºåŒºä¸æˆ‘åˆ†äº«ä½ çš„ç­”æ¡ˆï¼Œä¹Ÿæ¬¢è¿ç‚¹å‡»â€œè¯·æœ‹å‹è¯»â€ï¼ŒæŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–è€…åŒäº‹ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ15ï¼‰</strong></div><ul>
<li><span>mickey</span> ğŸ‘ï¼ˆ13ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>æœ€å°æ”¯æŒåº¦ä¸º0.1ï¼š
{  1: {(&#39;å€ªå¤§çº¢&#39;,): 2, (&#39;åˆ˜å¾·å&#39;,): 2, (&#39;å§œæ–‡&#39;,): 2, (&#39;å·©ä¿&#39;,): 5, (&#39;æé›ªå¥&#39;,): 2, (&#39;ç« å­æ€¡&#39;,): 3, (&#39;è‘›ä¼˜&#39;,): 2, (&#39;éƒ­æ¶›&#39;,): 2, (&#39;é™ˆé“æ˜&#39;,): 2}, 
   2: {(&#39;å€ªå¤§çº¢&#39;, &#39;å·©ä¿&#39;): 2, (&#39;å·©ä¿&#39;, &#39;éƒ­æ¶›&#39;): 2}}
[{å€ªå¤§çº¢} -&gt; {å·©ä¿}, {éƒ­æ¶›} -&gt; {å·©ä¿}]

æœ€å°æ”¯æŒåº¦ä¸º0.05ï¼š
å¤ªå¤šäº†ã€‚ã€‚ã€‚ã€‚

ç»“è®ºï¼šä¸ç®¡ç”·ä¸€å·é€‰è°ï¼Œå¥³ä¸€å·å¿…é¡»æ˜¯å·©ä¿ã€‚</p>2019-03-05</li><br/><li><span>third</span> ğŸ‘ï¼ˆ11ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ä¸ªäººçš„ç›´è§‰æ„Ÿè§‰ï¼Œè¿™ä¸ªåº”è¯¥è·Ÿæ•°æ®é›†çš„å¤§å°å’Œç‰¹ç‚¹æœ‰å…³ã€‚

</p>2019-02-22</li><br/><li><span>æ»¢</span> ğŸ‘ï¼ˆ7ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>é€‰çš„å¼ è‰ºè°‹çˆ¬å–æ•°æ®ï¼Œå¼€å§‹çš„æ—¶å€™è®¾ç½®min_support = 0.5 æ²¡æœ‰åˆ†æå‡ºé¡¹é›†ï¼Œè¿˜ä»¥ä¸ºæ˜¯æ•°æ®æœ‰é”™ï¼Œç»“æœå‘ç°æ˜¯æ”¯æŒåº¦è®¾çš„å¤ªé«˜æ¥ï¼Œæ²¡æœ‰è¾¾åˆ°æ¡ä»¶çš„ã€‚å¥½å°´å°¬~ 
#ç¬¬äºŒæ­¥ï¼šç”¨Aprioriç®—æ³•è¿›è¡Œå…³è”åˆ†æ
#æ•°æ®åŠ è½½
director = &#39;å¼ è‰ºè°‹&#39;
#å†™CSVæ–‡ä»¶
path = &#39;&#47;Users&#47;apple&#47;Desktop&#47;GitHubProject&#47;Read mark&#47;æ•°æ®åˆ†æ&#47;geekTime&#47;data&#47;&#39;
file_name = path + director +&#39;.csv&#39;
print(file_name)
lists = csv.reader(open(file_name, &#39;r&#39;, encoding=&#39;utf-8-sig&#39;))
data =[]
for names in lists:
    name_new = []
    for name in names:
        name_new.append(name.strip())
    if len(name_new[1:]) &gt;0:
        data.append(name_new[1:])
print(&#39;data--&#39;,data)

#æŒ–æ˜é¢‘ç¹é¡¹é›†åˆå…³è”è§„åˆ™
items,rules = apriori(data,min_support=0.05,min_confidence=1)
print(items)
print(rules)
è¾“å‡ºç»“æœï¼š
{1: {(&#39;å€ªå¤§çº¢&#39;,): 3, (&#39;å‚…å½ª&#39;,): 2, (&#39;åˆ˜ä½©ç¦&#39;,): 2, (&#39;åˆ˜å¾·å&#39;,): 2, (&#39;å§œæ–‡&#39;,): 2, (&#39;å­™çº¢é›·&#39;,): 3, (&#39;å·©ä¿&#39;,): 9, (&#39;æä¿ç”°&#39;,): 3, (&#39;ææ›¼&#39;,): 2, (&#39;æé›ªå¥&#39;,): 5, (&#39;æ¨å‡¤è‰¯&#39;,): 2, (&#39;ç‰›çŠ‡&#39;,): 2, (&#39;ç« å­æ€¡&#39;,): 3, (&#39;è‘›ä¼˜&#39;,): 3, (&#39;èµµæœ¬å±±&#39;,): 2, (&#39;éƒ­æ¶›&#39;,): 2, (&#39;é—«å¦®&#39;,): 2, (&#39;é™ˆé“æ˜&#39;,): 2}, 2: {(&#39;å€ªå¤§çº¢&#39;, &#39;å·©ä¿&#39;): 2, (&#39;å‚…å½ª&#39;, &#39;æé›ªå¥&#39;): 2, (&#39;åˆ˜ä½©ç¦&#39;, &#39;å·©ä¿&#39;): 2, (&#39;å­™çº¢é›·&#39;, &#39;èµµæœ¬å±±&#39;): 2, (&#39;å·©ä¿&#39;, &#39;æä¿ç”°&#39;): 2, (&#39;å·©ä¿&#39;, &#39;æ¨å‡¤è‰¯&#39;): 2, (&#39;å·©ä¿&#39;, &#39;è‘›ä¼˜&#39;): 2, (&#39;å·©ä¿&#39;, &#39;éƒ­æ¶›&#39;): 2, (&#39;æä¿ç”°&#39;, &#39;æé›ªå¥&#39;): 2}}
[{å‚…å½ª} -&gt; {æé›ªå¥}, {åˆ˜ä½©ç¦} -&gt; {å·©ä¿}, {èµµæœ¬å±±} -&gt; {å­™çº¢é›·}, {æ¨å‡¤è‰¯} -&gt; {å·©ä¿}, {éƒ­æ¶›} -&gt; {å·©ä¿}]</p>2019-04-20</li><br/><li><span>ä¸€ é’(à¹‘â€¢ . â€¢à¹‘)ã‚</span> ğŸ‘ï¼ˆ5ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼ŒFP-growth åœ¨pythonæœ‰é›†æˆå—ï¼Œï¼Œæƒ³ç”¨fp-growthè¯•è¯•</p>2019-10-25</li><br/><li><span>Geeky_Ben</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è¯·é—®ä¸€ä¸‹å„ä½å¤§ç¥ï¼Œä¸ºä»€ä¹ˆæˆ‘è¿™ä¸ªä»£ç åªæŠŠæ¯ä¸€é¡µçš„ç¬¬ä¸€ä¸ªç”µå½±çš„èµ„æ–™ä¸‹è½½ä¸‹æ¥ã€‚æˆ‘åå¤æ ¸å¯¹äº†å¾ˆå¤šæ¬¡ï¼Œè·Ÿå¯¼å¸ˆçš„ä¸€æ ·... è‹¦æ¼~~@@
from efficient_apriori import apriori
from lxml import etree
import time
from selenium import webdriver
from webdriver_manager.chrome import ChromeDriverManager
import csv
driver = webdriver.Chrome(ChromeDriverManager().install())
director = u&#39;å®æµ©&#39;
file_name = &#39;.&#47;&#39; + director + &#39;.csv&#39;
base_url = &#39;https:&#47;&#47;movie.douban.com&#47;subject_search?search_text=&#39;+director+&#39;&amp;cat=1002&amp;start=&#39;
out = open(file_name,&#39;w&#39;,newline = &#39;&#39;,encoding=&#39;utf-8-sig&#39;)
csv_write = csv.writer(out,dialect=&#39;excel&#39;)
flags = []

def download(request_url):
    driver.get(request_url)
    time.sleep(1)
    html = driver.find_element_by_xpath(&quot;&#47;&#47;*&quot;).get_attribute(&quot;outerHTML&quot;)
    html = etree.HTML(html)
    movie_lists = html.xpath(&quot;&#47;html&#47;body&#47;div[@id=&#39;wrapper&#39;]&#47;div[@id=&#39;root&#39;]&#47;div[1]&#47;&#47;div[@class=&#39;item-root&#39;]&#47;div[@class=&#39;detail&#39;]&#47;div[@class=&#39;title&#39;]&#47;a[@class=&#39;title-text&#39;]&quot;)
    name_lists = html.xpath(&quot;&#47;html&#47;body&#47;div[@id=&#39;wrapper&#39;]&#47;div[@id=&#39;root&#39;]&#47;div[1]&#47;&#47;div[@class=&#39;item-root&#39;]&#47;div[@class=&#39;detail&#39;]&#47;div[@class=&#39;meta abstract_2&#39;]&quot;)
    num = len(movie_lists)
    if num &gt; 15:
        movie_lists = movie_lists[1:]
        name_lists = name_lists[1:]
    for (movie,name_list) in zip(movie_lists,name_lists):
        if name_list.text is None:
            continue
        print(name_list.text)
        names = name_list.text.split(&#39;&#47;&#39;)
        if names[0].strip() == director and movie.text not in flags:
            names[0] = movie.text
            flags.append(movie.text)
            csv_write.writerow(names)
        print(&#39;OK&#39;)
        print(num)
        if num &gt;= 14:
            return True
        else:
            return False
start = 0
while start &lt;10000:
    request_url = base_url + str(start)
    flag = download(request_url)
    if flag:
        start = start + 15
    else:
        break
out.close()
print(&#39;Finished&#39;)
</p>2020-07-03</li><br/><li><span>JustDoDT</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>Python3.6 é‡åˆ°å¦‚ä¸‹é”™è¯¯åŠè§£å†³æ–¹æ¡ˆï¼š
è¿è¡Œæ—¶æŠ¥é”™ï¼š
ModuleNotFoundError: No module named &#39;dataclasses&#39;
æ˜¯å› ä¸ºefficient_apriori ä¾èµ– dataclasses å®‰è£… dataclasses å³å¯
pip install dataclasses</p>2020-04-08</li><br/><li><span>æ™®ç½—ç±³ä¿®æ–¯</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>å¦‚æœè¦ä½¿ç”¨FP-Growthè¿™ä¸ªç®—æ³•ï¼Œæ˜¯ç›´æ¥ä½¿ç”¨FP-Growthè¿™ä¸ªåŒ…å—ï¼Ÿ</p>2019-04-11</li><br/><li><span>æ»¢</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆèƒ½æ¨èå‡ æœ¬æœ‰å…³ æ¦‚ç‡è®ºã€ç»Ÿè®¡å­¦ã€è¿ç­¹å­¦çš„ä¹¦å˜› ï¼Œæ„Ÿè§‰å¤§å­¦çš„è¯¾æœ¬æ¯”è¾ƒæ¯ç‡¥</p>2019-03-11</li><br/><li><span>third</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æ„Ÿè§‰ï¼š1ï¼Œå¼ è‰ºè°‹å–œæ¬¢ç”¨é‚£äº›ç»„åˆçš„äºº
2.æŸäº›ç»„åˆå‡ºç°çš„åŒ¹é…ç‡

æœ€å°æ”¯æŒåº¦ä¸º0.1ï¼Œ{1: {(&#39; å·©ä¿ &#39;,): 9, (&#39; æé›ªå¥ &#39;,): 5}}

æœ€å°æ”¯æŒåº¦ä¸º0.05ï¼Œ{1: {(&#39; è‘›ä¼˜ &#39;,): 3, (&#39; å·©ä¿ &#39;,): 9, (&#39; å§œæ–‡ &#39;,): 2, (&#39; éƒ­æ¶› &#39;,): 2, (&#39; æé›ªå¥ &#39;,): 5, (&#39; é™ˆç»´äºš &#39;,): 2, (&#39; å¼ ç»§é’¢ &#39;,): 2, (&#39; åˆ˜å¾·å &#39;,): 2, (&#39; å€ªå¤§çº¢ &#39;,): 3, (&#39; å‚…å½ª &#39;,): 2, (&#39; ç‰›çŠ‡ &#39;,): 2, (&#39; å­™çº¢é›· &#39;,): 2, (&#39; é—«å¦® &#39;,): 2, (&#39; é™ˆé“æ˜ &#39;,): 2, (&#39; èµµæœ¬å±± &#39;,): 2, (&#39; æ¨å‡¤è‰¯ &#39;,): 2, (&#39; ç« å­æ€¡ &#39;,): 3, (&#39; æä¿ç”° &#39;,): 3, (&#39; åˆ˜ä½©ç¦ &#39;,): 2}, 2: {(&#39; å·©ä¿ &#39;, &#39; æä¿ç”° &#39;): 2, (&#39; å·©ä¿ &#39;, &#39; åˆ˜ä½©ç¦ &#39;): 2, (&#39; è‘›ä¼˜ &#39;, &#39; å·©ä¿ &#39;): 2, (&#39; æé›ªå¥ &#39;, &#39; å‚…å½ª &#39;): 2, (&#39; æé›ªå¥ &#39;, &#39; æä¿ç”° &#39;): 2, (&#39; å·©ä¿ &#39;, &#39; éƒ­æ¶› &#39;): 2, (&#39; é™ˆç»´äºš &#39;, &#39; å¼ ç»§é’¢ &#39;): 2, (&#39; å·©ä¿ &#39;, &#39; æ¨å‡¤è‰¯ &#39;): 2, (&#39; å·©ä¿ &#39;, &#39; å€ªå¤§çº¢ &#39;): 2}}
[{ åˆ˜ä½©ç¦ } -&gt; { å·©ä¿ }, { å‚…å½ª } -&gt; { æé›ªå¥ }, { éƒ­æ¶› } -&gt; { å·©ä¿ }, { å¼ ç»§é’¢ } -&gt; { é™ˆç»´äºš }, { é™ˆç»´äºš } -&gt; { å¼ ç»§é’¢ }, { æ¨å‡¤è‰¯ } -&gt; { å·©ä¿ }]</p>2019-02-22</li><br/><li><span>å¬å¦ˆå¦ˆçš„è¯</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æˆ‘è§‰å¾—mtimeç½‘ä¸Šçš„ç”µå½±ä¿¡æ¯æ›´åŠ å…¨é¢ï¼Œå°±ä»ä¸Šé¢çˆ¬å–çš„ä¿¡æ¯
æœ€å°æ”¯æŒåº¦ä¸º0.1:
{1: {(&#39;å€ªå¤§çº¢&#39;,): 3, (&#39;å­™çº¢é›·&#39;,): 3, (&#39;å·©ä¿&#39;,): 9, (&#39;æä¿ç”°&#39;,): 4, (&#39;æé›ªå¥&#39;,): 4, (&#39;ç« å­æ€¡&#39;,): 3, (&#39;è‘›ä¼˜&#39;,): 3, (&#39;èµµæœ¬å±±&#39;,): 3}, 2: {(&#39;å·©ä¿&#39;, &#39;æä¿ç”°&#39;): 3}}
[]
æœ€å°æ”¯æŒåº¦ä¸º0.05:
{1: {(&#39;ä¸å˜‰ä¸½&#39;,): 2, (&#39;å€ªå¤§çº¢&#39;,): 3, (&#39;å‚…å½ª&#39;,): 2, (&#39;åˆ˜ä½©ç¦&#39;,): 2, (&#39;åˆ˜å¾·å&#39;,): 2, (&#39;å§œæ–‡&#39;,): 2, (&#39;å­™çº¢é›·&#39;,): 3, (&#39;å·©ä¿&#39;,): 9, (&#39;å¼ è‰ºè°‹&#39;,): 2, (&#39;æä¿ç”°&#39;,): 4, (&#39;æé›ªå¥&#39;,): 4, (&#39;ç‰›çŠ‡&#39;,): 2, (&#39;çª¦éª&#39;,): 2, (&#39;ç« å­æ€¡&#39;,): 3, (&#39;è‘›ä¼˜&#39;,): 3, (&#39;è‘£ç«‹èŒƒ&#39;,): 2, (&#39;èµµæœ¬å±±&#39;,): 3, (&#39;éƒ‘æº&#39;,): 2, (&#39;éƒ­æ¶›&#39;,): 2, (&#39;é—«å¦®&#39;,): 2, (&#39;é™ˆé“æ˜&#39;,): 2, (&#39;é½è¾¾å†…Â·è‹é˜¿å†…&#39;,): 2}, 2: {(&#39;å€ªå¤§çº¢&#39;, &#39;å·©ä¿&#39;): 2, (&#39;å‚…å½ª&#39;, &#39;æé›ªå¥&#39;): 2, (&#39;åˆ˜ä½©ç¦&#39;, &#39;å·©ä¿&#39;): 2, (&#39;å­™çº¢é›·&#39;, &#39;èµµæœ¬å±±&#39;): 2, (&#39;å·©ä¿&#39;, &#39;æä¿ç”°&#39;): 3, (&#39;å·©ä¿&#39;, &#39;è‘›ä¼˜&#39;): 

2, (&#39;å·©ä¿&#39;, &#39;éƒ­æ¶›&#39;): 2, (&#39;æä¿ç”°&#39;, &#39;æé›ªå¥&#39;): 2, (&#39;æé›ªå¥&#39;, &#39;èµµæœ¬å±±&#39;): 2, (&#39;ç‰›çŠ‡&#39;, &#39;è‘£ç«‹èŒƒ&#39;): 2}}
[{å‚…å½ª} -&gt; {æé›ªå¥}, {åˆ˜ä½©ç¦} -&gt; {å·©ä¿}, {éƒ­æ¶›} -&gt; {å·©ä¿}, {è‘£ç«‹èŒƒ} -&gt; {ç‰›çŠ‡}, {ç‰›çŠ‡} -&gt; {è‘£ç«‹èŒƒ}]</p>2019-03-23</li><br/><li><span>mickey</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>å®‰è£…å·¥å…·åŒ…æŠ¥é”™ï¼Œè¯·é—®æ€æ ·è§£å†³ï¼Ÿ
E:\DevelopTool\Python\Python27\Scripts&gt;pip install efficient-apriori
DEPRECATION: Python 2.7 will reach the end of its life on January 1st, 2020. Please upgrade your Python as Python 2.7 won&#39;t be maintained after that date. A future versio
ill drop support for Python 2.7.
Collecting efficient-apriori
  Using cached https:&#47;&#47;files.pythonhosted.org&#47;packages&#47;d2&#47;7b&#47;71c12582b2e1b561e76cf52239bcece4ced6aac9c93974b7fdede5f407e7&#47;efficient_apriori-0.4.5.tar.gz
    Complete output from command python setup.py egg_info:
    Traceback (most recent call last):
      File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;
      File &quot;c:\users\wujian\appdata\local\temp\pip-install-p5k8a3\efficient-apriori\setup.py&quot;, line 15, in &lt;module&gt;
        from efficient_apriori import __version__
      File &quot;c:\users\wujian\appdata\local\temp\pip-install-p5k8a3\efficient-apriori\efficient_apriori\__init__.py&quot;, line 9, in &lt;module&gt;
        from efficient_apriori.apriori import apriori
      File &quot;c:\users\wujian\appdata\local\temp\pip-install-p5k8a3\efficient-apriori\efficient_apriori\apriori.py&quot;, line 12
        def apriori(transactions: typing.List[tuple], min_support: float=0.5,
                                ^
    SyntaxError: invalid syntax

    ----------------------------------------
Command &quot;python setup.py egg_info&quot; failed with error code 1 in c:\users\wujian\appdata\local\temp\pip-install-p5k8a3\efficient-apriori\</p>2019-03-01</li><br/><li><span>Geek_hve78z</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>1ï¼‰æœ€å°æ”¯æŒåº¦è®¾ç½®ä¸º0.1
{1: {(&#39;å€ªå¤§çº¢&#39;,): 3, (&#39;å­™çº¢é›·&#39;,): 3, (&#39;å·©ä¿&#39;,): 9, (&#39;æä¿ç”°&#39;,): 3, (&#39;æé›ªå¥&#39;,): 4, (&#39;ç« å­æ€¡&#39;,): 3, (&#39;è‘›ä¼˜&#39;,): 3}}
[]
2ï¼‰æœ€å°æ”¯æŒåº¦è®¾ç½®ä¸º0.05
{1: {(&#39;å€ªå¤§çº¢&#39;,): 3, (&#39;å‚…å½ª&#39;,): 2, (&#39;åˆ˜ä½©ç¦&#39;,): 2, (&#39;åˆ˜å¾·å&#39;,): 2, (&#39;å§œæ–‡&#39;,): 2, (&#39;å­™çº¢é›·&#39;,): 3, (&#39;å·©ä¿&#39;,): 9, (&#39;æä¿ç”°&#39;,): 3, (&#39;æé›ªå¥&#39;,): 4, (&#39;æ¨å‡¤è‰¯&#39;,): 2, (&#39;ç‰›çŠ‡&#39;,): 2, (&#39;ç« å­æ€¡&#39;,): 3, (&#39;è‘›ä¼˜&#39;,): 3, (&#39;èµµæœ¬å±±&#39;,): 2, (&#39;éƒ­æ¶›&#39;,): 2, (&#39;é—«å¦®&#39;,): 2, (&#39;é™ˆé“æ˜&#39;,): 2}, 2: {(&#39;å€ªå¤§çº¢&#39;, &#39;å·©ä¿&#39;): 2, (&#39;å‚…å½ª&#39;, &#39;æé›ªå¥&#39;): 2, (&#39;åˆ˜ä½©ç¦&#39;, &#39;å·©ä¿&#39;): 2, (&#39;å­™çº¢é›·&#39;, &#39;èµµæœ¬å±±&#39;): 2, (&#39;å·©ä¿&#39;, &#39;æä¿ç”°&#39;): 2, (&#39;å·©ä¿&#39;, &#39;æ¨å‡¤è‰¯&#39;): 2, (&#39;å·©ä¿&#39;, &#39;è‘›ä¼˜&#39;): 2, (&#39;å·©ä¿&#39;, &#39;éƒ­æ¶›&#39;): 2, (&#39;æä¿ç”°&#39;, &#39;æé›ªå¥&#39;): 2}}
[{å‚…å½ª} -&gt; {æé›ªå¥}, {åˆ˜ä½©ç¦} -&gt; {å·©ä¿}, {èµµæœ¬å±±} -&gt; {å­™çº¢é›·}, {æ¨å‡¤è‰¯} -&gt; {å·©ä¿}, {éƒ­æ¶›} -&gt; {å·©ä¿}]</p>2019-02-24</li><br/><li><span>third</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>å¯¹äºXpathçš„queryçš„åˆ é™¤ï¼Œæ¥æ‰¾åˆ°éœ€è¦æŸ¥æ‰¾çš„å†…å®¹ï¼Œè¡¨ç¤ºè‰°éš¾ã€‚

è‡ªå·±æ€»ç»“çš„æ˜¯ï¼Œ
1.ä¿ç•™div[1]
2.åˆ é™¤åå­—æ¯”è¾ƒé•¿çš„class
3.ä¿ç•™&#47;&#47;
4.æ³¨æ„çœ‹å³è¾¹çš„ç»“æœ

ä¸çŸ¥é“è¯¥æ€ä¹ˆåˆ ï¼Œæœ‰ä»€ä¹ˆæŠ€å·§å—ï¼Ÿ</p>2019-02-22</li><br/><li><span>ç™½å¤œ</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æœ€å°æ”¯æŒåº¦å¯ä»¥è®¾ç½®çš„å°ï¼Œè€Œå¦‚æœæœ€å°æ”¯æŒåº¦å°ï¼Œç½®ä¿¡åº¦å°±è¦è®¾ç½®çš„ç›¸å¯¹å¤§ä¸€ç‚¹ï¼Œä¸ç„¶å³ä½¿æå‡åº¦é«˜ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯å·§åˆã€‚è¿™ä¸ªå‚æ•°è·Ÿæ•°æ®é‡ä»¥åŠé¡¹çš„æ•°é‡æœ‰å…³ã€‚
ç†è§£å¯¹å—ï¼Ÿ


# -*- coding: utf-8 -*-
from efficient_apriori import apriori
import csv
import pprint
director = u&#39;å¼ è‰ºè°‹&#39;
file_name = &#39;.&#47;&#39;+director+&#39;.csv&#39;
lists = csv.reader(open(file_name, &#39;r&#39;, encoding=&#39;utf-8-sig&#39;))
# æ•°æ®åŠ è½½
data = []
for names in lists:
     name_new = []
     for name in names:
           # å»æ‰æ¼”å‘˜æ•°æ®ä¸­çš„ç©ºæ ¼
           name_new.append(name.strip())
     data.append(name_new[1:])
# æŒ–æ˜é¢‘ç¹é¡¹é›†å’Œå…³è”è§„åˆ™
itemsets, rules = apriori(data, min_support=0.05,  min_confidence=0.5)
#data æ˜¯æˆ‘ä»¬è¦æä¾›çš„æ•°æ®é›†ï¼Œå®ƒæ˜¯ä¸€ä¸ª list æ•°ç»„ç±»å‹ã€‚min_support å‚æ•°ä¸ºæœ€å°æ”¯æŒåº¦ï¼Œåœ¨ efficient-apriori å·¥å…·åŒ…ä¸­ç”¨ 0 åˆ° 1 çš„æ•°å€¼ä»£è¡¨ç™¾åˆ†æ¯”ï¼Œæ¯”å¦‚ 0.5 ä»£è¡¨æœ€å°æ”¯æŒåº¦ä¸º 50%ã€‚min_confidence æ˜¯æœ€å°ç½®ä¿¡åº¦ï¼Œæ•°å€¼ä¹Ÿä»£è¡¨ç™¾åˆ†æ¯”ï¼Œæ¯”å¦‚ 1 ä»£è¡¨ 100%ã€‚
pprint.pprint(itemsets)
print(rules)
</p>2019-02-22</li><br/><li><span>jion</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ä½ å¥½ï¼Œæˆ‘æƒ³é—®ä¸€ä¸‹æ–‡ä¸­è®¡ç®—çš„ç»“æœæ ¼å¼ï¼Œ1:ä»£è¡¨å•¥ç„¶åå­—å…¸é‡Œé¢(&#39;å¾å³¥&#39;,): 5ä»£è¡¨å•¥ï¼Œå¯å¦å¯¹ç»“æœåˆ†æä¸€ä¸‹ï¼Ÿ
{1: {(&#39;å¾å³¥&#39;,): 5, (&#39;é»„æ¸¤&#39;,): 6}, 2: {(&#39;å¾å³¥&#39;, &#39;é»„æ¸¤&#39;): 5}}
[{å¾å³¥} -&gt; {é»„æ¸¤}]</p>2021-03-10</li><br/>
</ul>