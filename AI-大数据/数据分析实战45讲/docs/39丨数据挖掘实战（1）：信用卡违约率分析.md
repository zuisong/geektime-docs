ä»Šå¤©æˆ‘æ¥å¸¦ä½ åšä¸€ä¸ªæ•°æ®æŒ–æ˜çš„é¡¹ç›®ã€‚åœ¨æ•°æ®æŒ–æ˜çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚ï¼šå¦‚ä½•é€‰æ‹©å„ç§åˆ†ç±»å™¨ï¼Œåˆ°åº•é€‰æ‹©å“ªä¸ªåˆ†ç±»ç®—æ³•ï¼Œæ˜¯SVMï¼Œå†³ç­–æ ‘ï¼Œè¿˜æ˜¯KNNï¼Ÿå¦‚ä½•ä¼˜åŒ–åˆ†ç±»å™¨çš„å‚æ•°ï¼Œä»¥ä¾¿å¾—åˆ°æ›´å¥½çš„åˆ†ç±»å‡†ç¡®ç‡ï¼Ÿ

è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œæ˜¯æ•°æ®æŒ–æ˜æ ¸å¿ƒçš„é—®é¢˜ã€‚å½“ç„¶å¯¹äºä¸€ä¸ªæ–°çš„é¡¹ç›®ï¼Œæˆ‘ä»¬è¿˜æœ‰å…¶ä»–çš„é—®é¢˜éœ€è¦äº†è§£ï¼Œæ¯”å¦‚æŒæ¡æ•°æ®æ¢ç´¢å’Œæ•°æ®å¯è§†åŒ–çš„æ–¹å¼ï¼Œè¿˜éœ€è¦å¯¹æ•°æ®çš„å®Œæ•´æ€§å’Œè´¨é‡åšè¯„ä¼°ã€‚è¿™äº›å†…å®¹æˆ‘åœ¨ä¹‹å‰çš„è¯¾ç¨‹ä¸­éƒ½æœ‰è®²åˆ°è¿‡ã€‚

ä»Šå¤©çš„å­¦ä¹ ä¸»è¦å›´ç»•ä¸‹é¢çš„ä¸‰ä¸ªç›®æ ‡ï¼Œå¹¶é€šè¿‡å®ƒä»¬å®Œæˆä¿¡ç”¨å¡è¿çº¦ç‡é¡¹ç›®çš„å®æˆ˜ï¼Œè¿™ä¸‰ä¸ªç›®æ ‡åˆ†åˆ«æ˜¯ï¼š

1. åˆ›å»ºå„ç§åˆ†ç±»å™¨ï¼ŒåŒ…æ‹¬å·²ç»æŒæ¡çš„SVMã€å†³ç­–æ ‘ã€KNNåˆ†ç±»å™¨ï¼Œä»¥åŠéšæœºæ£®æ—åˆ†ç±»å™¨ï¼›
2. æŒæ¡GridSearchCVå·¥å…·ï¼Œä¼˜åŒ–ç®—æ³•æ¨¡å‹çš„å‚æ•°ï¼›
3. ä½¿ç”¨Pipelineç®¡é“æœºåˆ¶è¿›è¡Œæµæ°´çº¿ä½œä¸šã€‚å› ä¸ºåœ¨åšåˆ†ç±»ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€äº›å‡†å¤‡è¿‡ç¨‹ï¼Œæ¯”å¦‚æ•°æ®è§„èŒƒåŒ–ï¼Œæˆ–è€…æ•°æ®é™ç»´ç­‰ã€‚

## æ„å»ºéšæœºæ£®æ—åˆ†ç±»å™¨

åœ¨ç®—æ³•ç¯‡ä¸­ï¼Œæˆ‘ä¸»è¦è®²äº†æ•°æ®æŒ–æ˜åå¤§ç»å…¸ç®—æ³•ã€‚å®é™…å·¥ä½œä¸­ï¼Œä½ ä¹Ÿå¯èƒ½ä¼šç”¨åˆ°éšæœºæ£®æ—ã€‚

éšæœºæ£®æ—çš„è‹±æ–‡æ˜¯Random Forestï¼Œè‹±æ–‡ç®€å†™æ˜¯RFã€‚å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªåŒ…å«å¤šä¸ªå†³ç­–æ ‘çš„åˆ†ç±»å™¨ï¼Œæ¯ä¸€ä¸ªå­åˆ†ç±»å™¨éƒ½æ˜¯ä¸€æ£µCARTåˆ†ç±»å›å½’æ ‘ã€‚æ‰€ä»¥éšæœºæ£®æ—æ—¢å¯ä»¥åšåˆ†ç±»ï¼Œåˆå¯ä»¥åšå›å½’ã€‚å½“å®ƒåšåˆ†ç±»çš„æ—¶å€™ï¼Œè¾“å‡ºç»“æœæ˜¯æ¯ä¸ªå­åˆ†ç±»å™¨çš„åˆ†ç±»ç»“æœä¸­æœ€å¤šçš„é‚£ä¸ªã€‚ä½ å¯ä»¥ç†è§£æ˜¯æ¯ä¸ªåˆ†ç±»å™¨éƒ½åšæŠ•ç¥¨ï¼Œå–æŠ•ç¥¨æœ€å¤šçš„é‚£ä¸ªç»“æœã€‚å½“å®ƒåšå›å½’çš„æ—¶å€™ï¼Œè¾“å‡ºç»“æœæ˜¯æ¯æ£µCARTæ ‘çš„å›å½’ç»“æœçš„å¹³å‡å€¼ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ30ï¼‰</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/18/24/ad/54571ab3.jpg" width="30px"><span>è¥¿æ¹–æ™¨æ›¦</span> ğŸ‘ï¼ˆ29ï¼‰ ğŸ’¬ï¼ˆ8ï¼‰<div>æˆ‘æ˜¯é“¶è¡Œä¿¡ç”¨å¡éƒ¨çš„ä»ä¸šäººå‘˜ï¼Œä¹Ÿå¾ˆå–œæ¬¢æ•°æ®åˆ†æã€‚

ä½†æ˜¯çœ‹äº†è¿™ä¸ªæ¡ˆä¾‹ï¼Œæ„Ÿè§‰è¿™ä¸ªæ¡ˆä¾‹èƒ½å¤Ÿç»™ä¿¡ç”¨å¡çš„æ•°æ®åˆ†æå¸¦æ¥ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘çš„æ„æ€æ˜¯ï¼Œèƒ½å¤Ÿåˆ†æå‡ºä»€ä¹ˆé—®é¢˜å—ï¼Ÿé“¶è¡Œä¿¡ç”¨å¡éƒ¨åº”è¯¥åœ¨æŒå¡äººç”¨å¡çš„ä»€ä¹ˆé˜¶æ®µå¼€å§‹å¼€å§‹è¦é‡‡å–æªæ–½é˜²æ­¢è¯ˆéª—ï¼Ÿä»€ä¹ˆç±»å‹çš„å®¢æˆ·å®¹æ˜“è¯ˆéª—ï¼Ÿ---æ„Ÿè§‰è¿™ä¸ªæ¡ˆä¾‹å°±æ˜¯ä»æ•°å­—åˆ°æ•°å­—ï¼Œæ²¡æœ‰èƒ½å¤Ÿç»™çœŸå®ä¸šåŠ¡å¸¦æ¥ä»€ä¹ˆå¸®åŠ©ã€‚

-----ä¹Ÿæƒ³å¯¹ä»äº‹æ•°æ®åˆ†æçš„äººå‘˜æä¸ªé†’ï¼Œæ•°æ®åˆ†æä¸æ˜¯ä»çº¯æ•°å­—åˆ°çº¯æ•°å­—çš„çº¯å­¦æœ¯ç ”ç©¶ï¼Œåº”è¯¥æ˜¯è”ç³»å®é™…å·¥ä½œï¼Œèƒ½å¤Ÿç»™å®é™…å·¥ä½œå¸¦æ¥å¸®åŠ©çš„å•Šï¼è”ç³»åˆ°æ­¤æ¡ˆä¾‹ï¼Œåº”è¯¥æ˜¯èƒ½å¤Ÿç»™é“¶è¡Œä¿¡ç”¨å¡éƒ¨çš„é˜²æ¬ºè¯ˆå·¥ä½œå¸¦æ¥æå‡çš„å•Š~åˆ†æäº†ä»€ä¹ˆå‡ºæ¥ï¼Ÿé“¶è¡Œçš„å“ªä¸ªç¯èŠ‚åº”è¯¥æå‡ä»¥é˜²æ­¢æ¬ºè¯ˆï¼Ÿ</div>2019-09-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/34/13/d43ff5ed.jpg" width="30px"><span>vortual</span> ğŸ‘ï¼ˆ15ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆï¼Œå®é™…å·¥ä½œä¸­æ•°æ®é‡å¤§çš„è¯è·‘ä¸ªæ¨¡å‹åº”è¯¥è¦ä¸å°‘æ—¶é—´ï¼Œåº”è¯¥ä¸å…è®¸è¿™ä¹ˆå»è¯•æ‰€æœ‰å‚æ•°å’Œé‚£ä¹ˆå¤šç®—æ³•å§ï¼Ÿè¿˜æœ‰ä¸€ä¸ªç–‘é—®æ˜¯æ•°æ®é‡è¶…è¿‡ä¸€å®šé‡æ˜¯ä¸æ˜¯è¦ç”¨æ·±åº¦å­¦ä¹ äº†ï¼Ÿå¸Œæœ›è€å¸ˆèƒ½è§£æƒ‘ä¸‹</div>2019-03-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg" width="30px"><span>Geek_hve78z</span> ğŸ‘ï¼ˆ6ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;n_estimators&#39;: 10}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8187
å‡†ç¡®ç‡ 0.8129
-----ä»£ç ------

# -*- coding: utf-8 -*-
# ä¿¡ç”¨å¡è¿çº¦ç‡åˆ†æ
import pandas as pd
from sklearn.model_selection import learning_curve, train_test_split,GridSearchCV
from sklearn.preprocessing import StandardScaler
from sklearn.pipeline import Pipeline
from sklearn.metrics import accuracy_score
from sklearn.ensemble import AdaBoostClassifier

from matplotlib import pyplot as plt
import seaborn as sns
# æ•°æ®åŠ è½½
data=data=pd.read_csv(&#39;.&#47;credit_default-master&#47;UCI_Credit_Card.csv&#39;)
# æ•°æ®æ¢ç´¢
print(data.shape) # æŸ¥çœ‹æ•°æ®é›†å¤§å°
print(data.describe()) # æ•°æ®é›†æ¦‚è§ˆ
# æŸ¥çœ‹ä¸‹ä¸€ä¸ªæœˆè¿çº¦ç‡çš„æƒ…å†µ
next_month = data[&#39;default.payment.next.month&#39;].value_counts()
print(next_month)
df = pd.DataFrame({&#39;default.payment.next.month&#39;: next_month.index,&#39;values&#39;: next_month.values})
plt.rcParams[&#39;font.sans-serif&#39;]=[&#39;SimHei&#39;] #ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾
plt.figure(figsize = (6,6))
plt.title(&#39;ä¿¡ç”¨å¡è¿çº¦ç‡å®¢æˆ·\n (è¿çº¦ï¼š1ï¼Œå®ˆçº¦ï¼š0)&#39;)
sns.set_color_codes(&quot;pastel&quot;)
sns.barplot(x = &#39;default.payment.next.month&#39;, y=&quot;values&quot;, data=df)
locs, labels = plt.xticks()
plt.show()
# ç‰¹å¾é€‰æ‹©ï¼Œå»æ‰IDå­—æ®µã€æœ€åä¸€ä¸ªç»“æœå­—æ®µå³å¯
data.drop([&#39;ID&#39;], inplace=True, axis =1) #IDè¿™ä¸ªå­—æ®µæ²¡æœ‰ç”¨
target = data[&#39;default.payment.next.month&#39;].values
columns = data.columns.tolist()
columns.remove(&#39;default.payment.next.month&#39;)
features = data[columns].values
# 30%ä½œä¸ºæµ‹è¯•é›†ï¼Œå…¶ä½™ä½œä¸ºè®­ç»ƒé›†
train_x, test_x, train_y, test_y = train_test_split(features, target, test_size=0.30, stratify = target, random_state = 1)


#åˆ†ç±»å™¨
ada=AdaBoostClassifier( random_state=1)
#éœ€è¦è°ƒæ•´çš„å‚æ•°
parameters={&#39;n_estimators&#39;:[10,50,100]}

# ä½¿ç”¨ GridSearchCV è¿›è¡Œå‚æ•°è°ƒä¼˜
clf=GridSearchCV(estimator=ada,param_grid=parameters,scoring = &#39;accuracy&#39;)

clf.fit(train_x,train_y)
print(&quot;GridSearchæœ€ä¼˜å‚æ•°ï¼š&quot;, clf.best_params_)
print(&quot;GridSearchæœ€ä¼˜åˆ†æ•°ï¼š %0.4lf&quot; %clf.best_score_)
predict_y=clf.predict(test_x)
print(&quot;å‡†ç¡®ç‡ %0.4lf&quot; %accuracy_score(test_y, predict_y))
 


</div>2019-03-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/80/84/a7af5eae.jpg" width="30px"><span>CR77</span> ğŸ‘ï¼ˆ5ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>åœ¨åšçš„æ—¶å€™åˆå¦‚ä¸‹é—®é¢˜ï¼Œæˆ‘è§‰å¾—éœ€è¦æ³¨æ„ï¼š
ç¬¬ä¸€ã€PAY_0åˆ°PAY_6ç»å…¸æŒ‡æ ‡æ€§çš„ç‰¹å¾ï¼Œä½†æ˜¯å…·ä½“ä»€ä¹ˆæ„ä¹‰ä¸çŸ¥é“ï¼Œä¸ªäººè®¤ä¸ºä¸åº”è¯¥è‰è‰çš„å½’ä¸€åŒ–ã€‚
ç¬¬äºŒï¼Œæ¯æœˆè´¦å•é‡‘é¢ä½“ç°çš„æ˜¯å®¢æˆ·çš„æ¶ˆè´¹æ°´å¹³ï¼Œæ¯æœˆçš„è¿˜æ¬¾é‡‘é¢ä½“ç°çš„æ˜¯å®¢æˆ·çš„å®é™…ç»æµæƒ…å†µï¼ˆå½“ç„¶ä¸æ’é™¤é‚£äº›ï¼Œæœ‰é’±ä½†æ˜¯ä¸è¿˜æ¬¾çš„æƒ…å†µï¼‰ï¼Œæ‰€ä»¥æˆ‘æƒ³èƒ½ä¸èƒ½å°†ï¼ˆæ¯æœˆçš„è´¦å•é‡‘é¢ - æ¯æœˆçš„è¿˜æ¬¾é‡‘é¢ï¼‰è®¾ç½®ä¸ºä¸€ä¸ªæ–°çš„ç‰¹å¾ï¼Œå¯èƒ½èƒ½æ›´åŠ è´´è¿‘ç”¨æˆ·çš„å®é™…ç»æµæƒ…å†µã€‚
ç¬¬ä¸‰ï¼Œæ˜¯å¦éœ€è¦é‡‡ç”¨ä¸‹é‡‡æ ·ï¼Ÿå› ä¸ºæ¯•ç«Ÿæ­£è´Ÿæ ·æœ¬çš„æ¯”ä¾‹æ˜¯æœ‰ä¸€å®šçš„å·®è·çš„ï¼Œæˆ‘ä»¬æ¨¡å‹è®­ç»ƒå‡ºæ¥çš„æ•ˆæœå¹¶ä¸æ˜¯å¾ˆå¥½æ˜¯ä¸æ˜¯æœ‰å…³ç³»
ç¬¬å››ï¼Œé—®é¢˜çš„å®é™…æ„ä¹‰çš„åˆ†æï¼Œè¿™æ˜¯ä¸€ä¸ªè¿çº¦ç‡çš„æ•°æ®æŒ–æ˜ï¼Œæ›´å¤šçš„å¯ä»¥è¯´æ˜¯ä¸€ç§åˆ†æï¼Œæˆ‘ä»¬å¾—åˆ°çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Œæ˜¯ä¸€ä¸ªæ–°çš„å®¢æˆ·åœ¨äº§ç”Ÿç§ç§äº¤æ˜“ä¹‹åï¼Œä»–è¿çº¦çš„å¯èƒ½ï¼Œè¿™æ˜¯æˆ‘èƒ½æƒ³åˆ°çš„æ„ä¹‰ï¼Œæ”¾åˆ°å•†ä¸šä¸Šçš„è¯æˆ‘ä»¬å®é™…ä¸Šæ˜¯è¦åšå‡ºæ€ä¹ˆæ ·çš„å†³ç­–å‘¢ï¼Ÿ</div>2020-04-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/e5/43/7bc7cfe3.jpg" width="30px"><span>è·³è·³</span> ğŸ‘ï¼ˆ5ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>1.å¯¹GridSearchCVçš„ç†è§£ï¼šå°±æ˜¯åœ¨ä¹‹å‰çš„ç»éªŒçš„åŸºç¡€ä¸Šé€‰æ‹©äº†ä¸€äº›è¾ƒå¥½çš„å–å€¼å¤‡é€‰ï¼Œç„¶ååˆ†åˆ«å»è¯•ï¼Œå¾—åˆ°ä¸€ä¸ªå¥½çš„æ€§èƒ½ã€‚æ¯”ç›´æ¥é€‰æ‹©å‚æ•°å¤šäº†ä¸€äº›ä¿éšœï¼Œä½†æ˜¯ä¹Ÿå¢åŠ ä¸€äº›è®¡ç®—è´Ÿæ‹…ã€‚
2.åœ¨è€å¸ˆä»£ç çš„åŸºç¡€ä¸Šæ·»åŠ äº†adabooståˆ†ç±»ï¼Œä½¿ç”¨adaboosté»˜è®¤çš„åˆ†ç±»å™¨ï¼Œç»“æœæ˜¯åœ¨n_estimators=10çš„æ—¶å€™å–å¾—æœ€ä¼˜æ€§èƒ½ï¼Œå‡†ç¡®ç‡æ˜¯0.8187
GridSearch æœ€ä¼˜å‚æ•°ï¼š {&#39;AdaBoostClassifier__n_estimators&#39;: 10}
GridSearch æœ€ä¼˜åˆ†æ•°ï¼š 0.8187
 å‡†ç¡®ç‡ 0.8129</div>2019-03-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/a4/5a/e708e423.jpg" width="30px"><span>third</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>æé—®ï¼šè€æ˜¯å‡ºç°futureWarning,æ˜¯ä»€ä¹ˆæƒ…å†µ

GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;n_estimators&#39;: 10}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8187
å‡†ç¡®ç‡ 0.8129</div>2019-03-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg" width="30px"><span>Geek_hve78z</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ä½¿ç”¨ Pipeline ç®¡é“æœºåˆ¶çš„ä¼˜åŠ¿ï¼Œå‚è€ƒèµ„æ–™ï¼š
https:&#47;&#47;www.jianshu.com&#47;p&#47;9c2c8c8ef42d
https:&#47;&#47;blog.csdn.net&#47;qq_41598851&#47;article&#47;details&#47;80957893

ä¸ªäººç†è§£ï¼š
Pipelineæ˜¯å°†æ•°æ®å¤„ç†æµç¨‹çš„å…±åŒéƒ¨åˆ†æå–å‡ºæ¥ï¼Œç®€åŒ–ä»£ç ã€‚
ä»¥æœ¬æ–‡æœ€åçš„ç¼–ç¨‹æ¡ˆä¾‹ä¸ºä¾‹ï¼Œå…±åŒéƒ¨åˆ†æ˜¯â€œæ•°æ®è§„èŒƒåŒ–â€å’Œâ€œä½¿ç”¨æ•°æ®åˆ†ç±»ç®—æ³•â€ï¼Œå°†ä¿©éƒ¨åˆ†å°è£…ã€‚
åœ¨æ¯ä¸€æ¬¡å¾ªç¯â€œç®—æ³•â€æ—¶ï¼Œpipelineé‡Œå¤´å®Œæˆç®—æ³•æ›´æ–°ã€‚GridSearchCVå¼•ç”¨å›ºå®šçš„pipelineï¼Œå®åˆ™ç®—æ³•å·²ç»æ›´æ–°äº†ã€‚è¿™æ ·å‡å°‘äº†å¤šä½™ä»£ç çš„ä¹¦å†™ã€‚
</div>2019-03-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/aa/d1/076482f3.jpg" width="30px"><span>ç™½å¤œ</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>ä¸‰ä¸‡æ¡ï¼Œ25ä¸ªå­—æ®µå°±è¦è¿ç®—å‡ åˆ†é’Ÿäº†ï¼Œæ•°æ®ä¸Šäº¿ã€‚ã€‚ã€‚
&#39;&#39;&#39;
GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;svc__C&#39;: 1, &#39;svc__gamma&#39;: 0.01}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8174
å‡†ç¡®ç‡ 0.8172
68.59484457969666 s
GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;decisiontreeclassifier__max_depth&#39;: 6}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8186
å‡†ç¡®ç‡ 0.8113
1.8460278511047363 s
GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;randomforestclassifier__n_estimators&#39;: 6}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.7998
å‡†ç¡®ç‡ 0.7994
2.297856330871582 s
GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;kneighborsclassifier__n_neighbors&#39;: 8}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8040
å‡†ç¡®ç‡ 0.8036
154.36387968063354 s
GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;adaboostclassifier__n_estimators&#39;: 10}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8187
å‡†ç¡®ç‡ 0.8129
13.483576774597168 s
&#39;&#39;&#39;</div>2019-03-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/86/d7/46842f90.jpg" width="30px"><span>å°æ™¨</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>ç”¨32ä½çš„pythonåœ¨æ‰§è¡Œkneighborsclassifieråˆ†ç±»å™¨æ—¶ï¼Œä¼šæŠ¥å†…å­˜é”™è¯¯ï¼šnumpy.core._exceptions.MemoryError: Unable to allocate 1.00 GiB for an array with shape (6391, 21000) and data type float64
è€å¸ˆæœ‰æ— åŠæ³•å°†numpyæ•°æ®ç±»å‹float64æ”¹ä¸ºfloat16æˆ–float32å‘¢ï¼Ÿæˆ–æ˜¯å…¶ä»–åŠæ³•è§£å†³
&#47;&#47;&#47;é‡è£…64ä½ï¼Œå…¨éƒ¨åº“éœ€è¦é‡è£…&#47;&#47;&#47;</div>2021-03-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/52/c6/8eb48963.jpg" width="30px"><span>ä¸€çº¸ä¹¦</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>å‹‰å‹‰å¼ºå¼ºçœ‹æ‡‚,ä½†å¿ƒçŸ¥è‹¥è®©æˆ‘åœ¨ä¸€ç‰‡ç©ºç™½çš„pythonæ–‡ä»¶ä¸­,å®Œå…¨ç‹¬ç«‹å®Œæˆè¿™ä¸ªé¡¹ç›®;æˆ‘åšä¸åˆ°; </div>2019-11-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/a3/87/c415e370.jpg" width="30px"><span>æ»¢</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æ—¸è€å¸ˆï¼Œæƒ³è¯·æ•™å‡ ä¸ªé—®é¢˜ï¼š1.ä¸ºä½•æ‰§è¡Œå¤šæ¬¡ æœ€ä¼˜åˆ†æ•°æ˜¯ä¸€å®šçš„ 0.9667  ä½†æ˜¯æœ€ä¼˜å‚æ•°ï¼Œn_estimators æ¯æ¬¡éƒ½ä¸ä¸€æ ·ï¼Œè¿™æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ2.éšæœºæ£®æ—æ˜¯ä¸æ˜¯æ­£å¥½ä¸AdaBoostç›¸åï¼Œéƒ½æ•°æ®é›†æˆæ¨¡å¼ï¼Œä¸€ä¸ªæ˜¯é›†æˆé‡Œçš„æŠ•ç¥¨æ¨¡å¼ï¼Œä¸€ä¸ªæ˜¯å­¦ä¹ æ¨¡å¼ã€‚è¿™æ ·ç†è§£æ­£ç¡®å—ï¼Ÿ</div>2019-04-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/22/df/a9/bf395f99.jpg" width="30px"><span>èµµå®</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è¯·é—®â€œå®¢æˆ·è¿˜æ¬¾æƒ…å†µâ€å­—æ®µé‡Œçš„å€¼åˆ†åˆ«ä»£è¡¨ä»€ä¹ˆæ„æ€ï¼Ÿ</div>2020-12-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/36/88/20b6a6ee.jpg" width="30px"><span>Simon</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ä»best_score_çœ‹ï¼Œæ˜¯å¦å¯¹æ•°æ®æ ‡å‡†åŒ–ï¼Œå¯¹éšæœºæ£®æ—ç®—æ³•ç¡®å®æ²¡æœ‰å½±å“ã€‚å¯¹å†³ç­–æ ‘è€Œè¨€ï¼Œé‡è¦çš„æ˜¯å±æ€§çš„æ¬¡åºï¼Œè€Œä¸æ˜¯ç»å¯¹å¤§å°ã€‚</div>2020-04-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/94/6d/5cd6e8c7.jpg" width="30px"><span>å¼ è´º</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;adaboostclassifier__n_estimators&#39;: 10}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8187
å‡†ç¡®ç‡ 0.8129</div>2020-03-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/b5/98/ffaf2aca.jpg" width="30px"><span>Ronnyz</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div># -*- coding:utf-8 -*-
import pandas as pd
from sklearn.model_selection import GridSearchCV,train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.pipeline import Pipeline
from sklearn.datasets import load_iris
from sklearn.metrics import accuracy_score
from sklearn.ensemble import AdaBoostClassifier
from matplotlib import pyplot as plt
import seaborn as sns
from warnings import simplefilter
simplefilter(action=&#39;ignore&#39;,category=FutureWarning)

#æ•°æ®åŠ è½½
credits=pd.read_csv(&#39;CreditCard_data&#47;UCI_Credit_Card.csv&#39;)
#æ•°æ®æ¢ç´¢
print(credits.shape)
print(credits.describe()) #æŸ¥çœ‹æ•°æ®æ¦‚è§ˆ

#ç‰¹å¾é€‰æ‹©ï¼Œå»æ‰IDå­—æ®µ
credits.drop([&#39;ID&#39;],inplace=True,axis=1)
target=credits[&#39;default.payment.next.month&#39;].values
columns=credits.columns.tolist()
columns.remove(&#39;default.payment.next.month&#39;)
features=credits[columns].values

#åˆ†å‰²æ•°æ®ï¼Œå°†30%ä½œä¸ºæµ‹è¯•é›†
X_train,X_test,y_train,y_test=train_test_split(features,target,test_size=0.3,random_state=666)

#æ„å»ºåˆ†ç±»å™¨
ada=AdaBoostClassifier()
#ä½¿ç”¨ç½‘æ ¼æœç´¢è°ƒæ•´å‚æ•°
#å‚æ•°è®¾ç½®
parameters={
    &#39;n_estimators&#39;:[10,50,100]
}
gscv=GridSearchCV(estimator=ada,param_grid=parameters,scoring=&#39;accuracy&#39;,n_jobs=-1)
gscv.fit(X_train,y_train)
print(&#39;GridSearchæœ€ä¼˜å‚æ•°ï¼š&#39;,gscv.best_params_)
print(&#39;GridSearchæœ€ä¼˜åˆ†æ•°ï¼š%0.4lf&#39; % gscv.best_score_)
y_pred=gscv.predict(X_test)
print(&#39;å‡†ç¡®ç‡ï¼š&#39;,accuracy_score(y_test,y_pred))

GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;n_estimators&#39;: 50}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š0.8197
å‡†ç¡®ç‡ï¼š 0.8121111111111111</div>2019-11-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/ce/9b/46b3dc8d.jpg" width="30px"><span>å­Ÿå›</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆï¼Œè¿™ä¸ªæ•°æ®é›†æ˜¯æ˜æ˜¾çš„unbalanced dedatasetã€‚ éœ€è¦å…ˆè¿›è¡Œbalanceå¤„ç†å—ï¼Ÿæˆ‘ä»¥å‰å¤„ç†lending clubçš„datasetï¼Œå‘ç°ç»è¿‡convert to balance datasetä¹‹åï¼Œrandom forestçš„å‡†ç¡®ç‡é«˜äº†ä¸å°‘</div>2019-11-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/43/0b/7688f18c.jpg" width="30px"><span>æ±Ÿ Nina</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆï¼Œå‚èµ›çš„èŒƒå›´åˆ’åˆ†æœ‰ä»€ä¹ˆä¾æ®å—?è¿˜æ˜¯è¯´æˆ‘ä¸‹æ¬¡é‡åˆ°ç±»ä¼¼çš„é¢˜ç›®ï¼Œä¾‹å¦‚é¢„æµ‹ç”¨æˆ·ç‚¹å‡»å¹¿å‘Šçš„æ¦‚ç‡ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å¥—ç”¨æ‚¨è¿™å¥—ä»£ç å’Œå‚æ•°æ°›å›´ï¼Œç„¶åå¾—å‡ºæœ€ä¼˜çš„åˆ†ç±»æ–¹æ¡ˆå’Œå‚æ•°å–å€¼?

å¦å¤–ï¼Œå¦‚æœå­—æ®µè¿‡å¤šï¼Œéœ€è¦è¿›è¡Œé™çº¬å¤„ç†å—?æ€ä¹ˆå¤„ç†?</div>2019-11-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/5d/27/74e152d3.jpg" width="30px"><span>æ»¨æ»¨</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>GridSearchCVæœ¬è´¨æ˜¯ä¸€ç§ç©·ä¸¾æ³•</div>2019-04-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/62/a5/43aa0c27.jpg" width="30px"><span>TKbook</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ada = AdaBoostClassifier()
parameters = {&#39;adaboostclassifier__n_estimators&#39;: [10, 50, 100]}
pipeline = Pipeline([
    (&#39;scaler&#39;, StandardScaler()),
    (&#39;adaboostclassifier&#39;, ada)
])
clf = GridSearchCV(estimator=pipeline, param_grid=parameters)
clf.fit(train_x, train_y)
print(&#39;GridSearchæœ€ä¼˜å‚æ•°ï¼š&#39;, clf.best_params_)
print(&#39;GridSearchæœ€ä¼˜åˆ†æ•°ï¼š%0.4lf&#39; % clf.best_score_)
predict_y = clf.predict(test_x)
print(&#39;å‡†ç¡®ç‡%0.4lf&#39; % accuracy_score(test_y, predict_y))

GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;adaboostclassifier__n_estimators&#39;: 10}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š0.8187
å‡†ç¡®ç‡0.8129</div>2019-03-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/4b/68/a6198a59.jpg" width="30px"><span>Geek_2a6093</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è¿™æ¬¡getåˆ°äº†pipeline å’ŒgridsearchçœŸå¥½ï¼Œè°¢è°¢è€å¸ˆï¼è€å¸ˆä¸‹æ¬¡èƒ½ä¸èƒ½è¯¦ç»†åœ°ä»‹ç»ä¸€ä¸‹é›†æˆæ–¹æ³•å¦‚Stackingï¼Œæˆ–è€…XgBoostè¿™ä¸ªåº“çš„ç‰¹ç‚¹å‘€ï¼Ÿ</div>2019-03-13</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI45zO9GOMquk9JymTibN9sC25Sy4WtsDGRQzIRVIoIzPnaJGKmGe3jXqxP0zKZyTYazrXHBGYjBzw/132" width="30px"><span>æŸšå­</span> ğŸ‘ï¼ˆ31ï¼‰ ğŸ’¬ï¼ˆ4ï¼‰<div>è€å¸ˆï¼Œ ä½¿ç”¨GridSearchCV å·¥å…·å¤šæ¬¡æ‰§è¡Œæ¯æ¬¡ç»“æœéƒ½ä¸ä¸€æ ·ï¼Œæ˜¯æ€ä¹ˆåˆ¤å®šæœ€ä¼˜åˆ†æ•°å°±æ˜¯0.9667ï¼Œæœ€ä¼˜å‚æ•°å°±æ˜¯6å‘¢ï¼Ÿ</div>2019-03-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg" width="30px"><span>Geek_hve78z</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>â€˜GridSearchæœ€ä¼˜åˆ†æ•°â€™å’Œâ€˜é¢„æµ‹æ•°æ®å‡†ç¡®ç‡â€™æ˜¯æ€ä¹ˆç†è§£çš„ã€‚ä»¥ä¸‹æˆ‘çš„ç†è§£å¯¹å—

æˆ‘ç†è§£æ˜¯â€˜GridSearchæœ€ä¼˜åˆ†æ•°â€™æ˜¯ä»ã€è®­ç»ƒæ•°æ®ã€‘ä¸­å¾—åˆ°çš„æœ€ä¼˜å‡†ç¡®ç‡ã€‚
è€Œâ€˜é¢„æµ‹æ•°æ®å‡†ç¡®ç‡â€™æ˜¯åˆ©ç”¨æœ€ä¼˜æ¨¡å‹ï¼Œåˆ†æã€æµ‹è¯•æ•°æ®ã€‘å¾—åˆ°çš„å‡†ç¡®ç‡ã€‚</div>2019-03-13</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/wJphZ3HcvhjVUyTWCIsCugzfQY5NAy6VJ0XoPLibDlcHWMswFmFe678zd0lUjFETia80NQhyQcVnGDlKgKPcRGyw/132" width="30px"><span>JingZ</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div># ä¿¡ç”¨å¡è¿çº¦ç‡åˆ†æ
KNNç›¸æ¯”è¾ƒè€Œè¨€ï¼Œè·‘å¾—æœ€æ…¢äº†ç‚¹

from sklearn.ensemble import AdaBoostClassifier

# æ„é€ å„ç§åˆ†ç±»å™¨
AdaBoostClassifier(random_state=1)

# åˆ†ç±»å™¨åç§°
&#39;adaboostclassifier&#39;

# åˆ†ç±»å™¨å‚æ•°
{&#39;adaboostclassifier__n_estimators&#39;: [10, 50, 100]}

ç»“æœï¼š

GridSearch æœ€ä¼˜åˆ†æ•°ï¼š0.8187
GridSearch æœ€ä¼˜å‚æ•°: {&#39;adaboostclassifier__n_estimators&#39;: 10}
å‡†ç¡®ç‡ 0.8129</div>2019-03-13</li><br/><li><img src="" width="30px"><span>Geek_ad52f1</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>åˆ†ç±»å™¨å‚æ•°æ˜¯æ€ä¹ˆè®¾ç½®çš„</div>2023-05-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/21/c3/b9/216db319.jpg" width="30px"><span>æ–¹ä¾¿é¢è¶…äºº</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>å®Œå…¨çœ‹ä¸æ‡‚æ˜¯æ€ä¹ˆå›äº‹
</div>2022-11-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/17/4d/62/0fe9cbb3.jpg" width="30px"><span>Williamï½Zhang</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>ä½¿ç”¨gridsearchcvçš„æ—¶å€™ï¼Œæ¯”å¦‚ç®—æ³•æ¨¡å‹æœ‰nä¸ªå‚æ•°ï¼Œé‚£ä¹ˆparam_gridè¿™ä¸ªå­—å…¸æ˜¯ä¸æ˜¯åº”è¯¥å¯¹åº”å†™ä¸Šå‚æ•°çš„åç§°ï¼Œä½†æ˜¯åœ¨æ–‡ç« ä¸­ï¼Œè€å¸ˆå¥½åƒåœ¨å‰é¢è¿˜åŠ ä¸Šäº†æ¨¡å‹åç§°æ¯”å¦‚svc__gamma</div>2020-03-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/51/86/b5fd8dd8.jpg" width="30px"><span>å»ºå¼º</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>åŠ å…¥AdaBooståˆ†ç±»å™¨åï¼Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š
GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;svc__C&#39;: 1, &#39;svc__gamma&#39;: 0.01}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8174
å‡†ç¡®ç‡ 0.8172
GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;decisiontreeclassifier__max_depth&#39;: 6}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8186
å‡†ç¡®ç‡ 0.8113
GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;randomforestclassifier__n_estimators&#39;: 6}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.7998
å‡†ç¡®ç‡ 0.7994
GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;kneighborsclassifier__n_neighbors&#39;: 8}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8040
å‡†ç¡®ç‡ 0.8036
GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;adaboostclassifier__n_estimators&#39;: 10}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8187
å‡†ç¡®ç‡ 0.8129

AdaBoostçš„n_estimatorsæœ€ä½³å€¼æ˜¯10ï¼Œå‡†ç¡®ç‡è¾ƒé«˜ï¼Œä»…æ¬¡äºæ”¯æŒå‘é‡æœºï¼ˆSVC)ç®—æ³•</div>2020-03-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/fb/31/f0a884a3.jpg" width="30px"><span>Geek_dancer</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>æˆ‘å‘ç°ï¼šclassifier_param_gridçš„keyså¿…é¡»ä¸¥æ ¼æŒ‰ç…§&#39;classifier_names&#39;+&#39;__&#39;+&#39;classifier_param_name&#39;çš„æ ¼å¼æ¥å†™</div>2019-03-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/60/a1/45ffdca3.jpg" width="30px"><span>é™å¿ƒ</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>åƒ&#39;svc__C&#39;:[1]ã€decisiontreeclassifier__max_depthã€randomforestclassifier__n_estimatorsã€kneighborsclassifier__n_neighborsè¿™æ ·çš„æ ¼å¼çš„è§„å¾‹æ˜¯ä»€ä¹ˆï¼Ÿæ²¡ææ˜ç™½ã€‚</div>2021-12-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/33/07/8f351609.jpg" width="30px"><span>JustDoDT</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>äº¤ä½œä¸šï¼š
https:&#47;&#47;github.com&#47;LearningChanging&#47;Data-analysis-in-action&#47;tree&#47;master&#47;39-%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E5%AE%9E%E6%88%98%EF%BC%881%EF%BC%89%EF%BC%9A%E4%BF%A1%E7%94%A8%E5%8D%A1%E8%BF%9D%E7%BA%A6%E7%8E%87%E5%88%86%E6%9E%90</div>2020-04-16</li><br/>
</ul>