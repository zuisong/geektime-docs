ä»Šå¤©æˆ‘æ¥å¸¦ä½ åšä¸€ä¸ªæ•°æ®æŒ–æ˜çš„é¡¹ç›®ã€‚åœ¨æ•°æ®æŒ–æ˜çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚ï¼šå¦‚ä½•é€‰æ‹©å„ç§åˆ†ç±»å™¨ï¼Œåˆ°åº•é€‰æ‹©å“ªä¸ªåˆ†ç±»ç®—æ³•ï¼Œæ˜¯SVMï¼Œå†³ç­–æ ‘ï¼Œè¿˜æ˜¯KNNï¼Ÿå¦‚ä½•ä¼˜åŒ–åˆ†ç±»å™¨çš„å‚æ•°ï¼Œä»¥ä¾¿å¾—åˆ°æ›´å¥½çš„åˆ†ç±»å‡†ç¡®ç‡ï¼Ÿ

è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œæ˜¯æ•°æ®æŒ–æ˜æ ¸å¿ƒçš„é—®é¢˜ã€‚å½“ç„¶å¯¹äºä¸€ä¸ªæ–°çš„é¡¹ç›®ï¼Œæˆ‘ä»¬è¿˜æœ‰å…¶ä»–çš„é—®é¢˜éœ€è¦äº†è§£ï¼Œæ¯”å¦‚æŒæ¡æ•°æ®æ¢ç´¢å’Œæ•°æ®å¯è§†åŒ–çš„æ–¹å¼ï¼Œè¿˜éœ€è¦å¯¹æ•°æ®çš„å®Œæ•´æ€§å’Œè´¨é‡åšè¯„ä¼°ã€‚è¿™äº›å†…å®¹æˆ‘åœ¨ä¹‹å‰çš„è¯¾ç¨‹ä¸­éƒ½æœ‰è®²åˆ°è¿‡ã€‚

ä»Šå¤©çš„å­¦ä¹ ä¸»è¦å›´ç»•ä¸‹é¢çš„ä¸‰ä¸ªç›®æ ‡ï¼Œå¹¶é€šè¿‡å®ƒä»¬å®Œæˆä¿¡ç”¨å¡è¿çº¦ç‡é¡¹ç›®çš„å®æˆ˜ï¼Œè¿™ä¸‰ä¸ªç›®æ ‡åˆ†åˆ«æ˜¯ï¼š

1. åˆ›å»ºå„ç§åˆ†ç±»å™¨ï¼ŒåŒ…æ‹¬å·²ç»æŒæ¡çš„SVMã€å†³ç­–æ ‘ã€KNNåˆ†ç±»å™¨ï¼Œä»¥åŠéšæœºæ£®æ—åˆ†ç±»å™¨ï¼›
2. æŒæ¡GridSearchCVå·¥å…·ï¼Œä¼˜åŒ–ç®—æ³•æ¨¡å‹çš„å‚æ•°ï¼›
3. ä½¿ç”¨Pipelineç®¡é“æœºåˆ¶è¿›è¡Œæµæ°´çº¿ä½œä¸šã€‚å› ä¸ºåœ¨åšåˆ†ç±»ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€äº›å‡†å¤‡è¿‡ç¨‹ï¼Œæ¯”å¦‚æ•°æ®è§„èŒƒåŒ–ï¼Œæˆ–è€…æ•°æ®é™ç»´ç­‰ã€‚

## æ„å»ºéšæœºæ£®æ—åˆ†ç±»å™¨

åœ¨ç®—æ³•ç¯‡ä¸­ï¼Œæˆ‘ä¸»è¦è®²äº†æ•°æ®æŒ–æ˜åå¤§ç»å…¸ç®—æ³•ã€‚å®é™…å·¥ä½œä¸­ï¼Œä½ ä¹Ÿå¯èƒ½ä¼šç”¨åˆ°éšæœºæ£®æ—ã€‚

éšæœºæ£®æ—çš„è‹±æ–‡æ˜¯Random Forestï¼Œè‹±æ–‡ç®€å†™æ˜¯RFã€‚å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªåŒ…å«å¤šä¸ªå†³ç­–æ ‘çš„åˆ†ç±»å™¨ï¼Œæ¯ä¸€ä¸ªå­åˆ†ç±»å™¨éƒ½æ˜¯ä¸€æ£µCARTåˆ†ç±»å›å½’æ ‘ã€‚æ‰€ä»¥éšæœºæ£®æ—æ—¢å¯ä»¥åšåˆ†ç±»ï¼Œåˆå¯ä»¥åšå›å½’ã€‚å½“å®ƒåšåˆ†ç±»çš„æ—¶å€™ï¼Œè¾“å‡ºç»“æœæ˜¯æ¯ä¸ªå­åˆ†ç±»å™¨çš„åˆ†ç±»ç»“æœä¸­æœ€å¤šçš„é‚£ä¸ªã€‚ä½ å¯ä»¥ç†è§£æ˜¯æ¯ä¸ªåˆ†ç±»å™¨éƒ½åšæŠ•ç¥¨ï¼Œå–æŠ•ç¥¨æœ€å¤šçš„é‚£ä¸ªç»“æœã€‚å½“å®ƒåšå›å½’çš„æ—¶å€™ï¼Œè¾“å‡ºç»“æœæ˜¯æ¯æ£µCARTæ ‘çš„å›å½’ç»“æœçš„å¹³å‡å€¼ã€‚

åœ¨sklearnä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨RandomForestClassifier()æ„é€ éšæœºæ£®æ—æ¨¡å‹ï¼Œå‡½æ•°é‡Œæœ‰ä¸€äº›å¸¸ç”¨çš„æ„é€ å‚æ•°ï¼š

![](https://static001.geekbang.org/resource/image/35/f9/352035fe3e92d412d652fd55c77f23f9.png?wh=629%2A210)  
å½“æˆ‘ä»¬åˆ›å»ºå¥½ä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨fitå‡½æ•°æ‹Ÿåˆï¼Œä½¿ç”¨predictå‡½æ•°é¢„æµ‹ã€‚

## ä½¿ç”¨GridSearchCVå·¥å…·å¯¹æ¨¡å‹å‚æ•°è¿›è¡Œè°ƒä¼˜

åœ¨åšåˆ†ç±»ç®—æ³•çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ç»å¸¸è°ƒèŠ‚ç½‘ç»œå‚æ•°ï¼ˆå¯¹åº”ä¸Šé¢çš„æ„é€ å‚æ•°ï¼‰ï¼Œç›®çš„æ˜¯å¾—åˆ°æ›´å¥½çš„åˆ†ç±»ç»“æœã€‚å®é™…ä¸Šä¸€ä¸ªåˆ†ç±»ç®—æ³•æœ‰å¾ˆå¤šå‚æ•°ï¼Œå–å€¼èŒƒå›´ä¹Ÿæ¯”è¾ƒå¹¿ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•è°ƒä¼˜å‘¢ï¼Ÿ

Pythonç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå¾ˆå¥½ç”¨çš„å·¥å…·GridSearchCVï¼Œå®ƒæ˜¯Pythonçš„å‚æ•°è‡ªåŠ¨æœç´¢æ¨¡å—ã€‚æˆ‘ä»¬åªè¦å‘Šè¯‰å®ƒæƒ³è¦è°ƒä¼˜çš„å‚æ•°æœ‰å“ªäº›ä»¥åŠå‚æ•°çš„å–å€¼èŒƒå›´ï¼Œå®ƒå°±ä¼šæŠŠæ‰€æœ‰çš„æƒ…å†µéƒ½è·‘ä¸€éï¼Œç„¶åå‘Šè¯‰æˆ‘ä»¬å“ªä¸ªå‚æ•°æ˜¯æœ€ä¼˜çš„ï¼Œç»“æœå¦‚ä½•ã€‚

ä½¿ç”¨GridSearchCVæ¨¡å—éœ€è¦å…ˆå¼•ç”¨å·¥å…·åŒ…ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š

```
from sklearn.model_selection import GridSearchCV
```

ç„¶åæˆ‘ä»¬ä½¿ç”¨GridSearchCV(estimator, param\_grid, cv=None, scoring=None)æ„é€ å‚æ•°çš„è‡ªåŠ¨æœç´¢æ¨¡å—ï¼Œè¿™é‡Œæœ‰ä¸€äº›ä¸»è¦çš„å‚æ•°éœ€è¦è¯´æ˜ä¸‹ï¼š

![](https://static001.geekbang.org/resource/image/70/fd/7042cb450e5dcac9306d0178265642fd.png?wh=630%2A183)  
æ„é€ å®ŒGridSearchCVä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨fitå‡½æ•°æ‹Ÿåˆè®­ç»ƒï¼Œä½¿ç”¨predictå‡½æ•°é¢„æµ‹ï¼Œè¿™æ—¶é¢„æµ‹é‡‡ç”¨çš„æ˜¯æœ€ä¼˜å‚æ•°æƒ…å†µä¸‹çš„åˆ†ç±»å™¨ã€‚

è¿™é‡Œä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæˆ‘ä»¬ç”¨sklearnè‡ªå¸¦çš„IRISæ•°æ®é›†ï¼Œé‡‡ç”¨éšæœºæ£®æ—å¯¹IRISæ•°æ®åˆ†ç±»ã€‚å‡è®¾æˆ‘ä»¬æƒ³çŸ¥é“n\_estimatorsåœ¨1-10çš„èŒƒå›´å†…å–å“ªä¸ªå€¼çš„åˆ†ç±»ç»“æœæœ€å¥½ï¼Œå¯ä»¥ç¼–å†™ä»£ç ï¼š

```
# -*- coding: utf-8 -*-
# ä½¿ç”¨RandomForestå¯¹IRISæ•°æ®é›†è¿›è¡Œåˆ†ç±»
# åˆ©ç”¨GridSearchCVå¯»æ‰¾æœ€ä¼˜å‚æ•°
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import GridSearchCV
from sklearn.datasets import load_iris
rf = RandomForestClassifier()
parameters = {"n_estimators": range(1,11)}
iris = load_iris()
# ä½¿ç”¨GridSearchCVè¿›è¡Œå‚æ•°è°ƒä¼˜
clf = GridSearchCV(estimator=rf, param_grid=parameters)
# å¯¹irisæ•°æ®é›†è¿›è¡Œåˆ†ç±»
clf.fit(iris.data, iris.target)
print("æœ€ä¼˜åˆ†æ•°ï¼š %.4lf" %clf.best_score_)
print("æœ€ä¼˜å‚æ•°ï¼š", clf.best_params_)
è¿è¡Œç»“æœå¦‚ä¸‹ï¼š
æœ€ä¼˜åˆ†æ•°ï¼š 0.9667
æœ€ä¼˜å‚æ•°ï¼š {'n_estimators': 6}
```

ä½ èƒ½çœ‹åˆ°å½“æˆ‘ä»¬é‡‡ç”¨éšæœºæ£®æ—ä½œä¸ºåˆ†ç±»å™¨çš„æ—¶å€™ï¼Œæœ€ä¼˜å‡†ç¡®ç‡æ˜¯0.9667ï¼Œå½“n\_estimators=6çš„æ—¶å€™ï¼Œæ˜¯æœ€ä¼˜å‚æ•°ï¼Œä¹Ÿå°±æ˜¯éšæœºæ£®æ—ä¸€å…±æœ‰6ä¸ªå­å†³ç­–æ ‘ã€‚

## ä½¿ç”¨Pipelineç®¡é“æœºåˆ¶è¿›è¡Œæµæ°´çº¿ä½œä¸š

åšåˆ†ç±»çš„æ—¶å€™å¾€å¾€éƒ½æ˜¯æœ‰æ­¥éª¤çš„ï¼Œæ¯”å¦‚å…ˆå¯¹æ•°æ®è¿›è¡Œè§„èŒƒåŒ–å¤„ç†ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨PCAæ–¹æ³•ï¼ˆä¸€ç§å¸¸ç”¨çš„é™ç»´æ–¹æ³•ï¼‰å¯¹æ•°æ®é™ç»´ï¼Œæœ€åä½¿ç”¨åˆ†ç±»å™¨åˆ†ç±»ã€‚

Pythonæœ‰ä¸€ç§Pipelineç®¡é“æœºåˆ¶ã€‚ç®¡é“æœºåˆ¶å°±æ˜¯è®©æˆ‘ä»¬æŠŠæ¯ä¸€æ­¥éƒ½æŒ‰é¡ºåºåˆ—ä¸‹æ¥ï¼Œä»è€Œåˆ›å»ºPipelineæµæ°´çº¿ä½œä¸šã€‚æ¯ä¸€æ­¥éƒ½é‡‡ç”¨(â€˜åç§°â€™, æ­¥éª¤)çš„æ–¹å¼æ¥è¡¨ç¤ºã€‚

æˆ‘ä»¬éœ€è¦å…ˆé‡‡ç”¨StandardScaleræ–¹æ³•å¯¹æ•°æ®è§„èŒƒåŒ–ï¼Œå³é‡‡ç”¨æ•°æ®è§„èŒƒåŒ–ä¸ºå‡å€¼ä¸º0ï¼Œæ–¹å·®ä¸º1çš„æ­£æ€åˆ†å¸ƒï¼Œç„¶åé‡‡ç”¨PCAæ–¹æ³•å¯¹æ•°æ®è¿›è¡Œé™ç»´ï¼Œæœ€åé‡‡ç”¨éšæœºæ£®æ—è¿›è¡Œåˆ†ç±»ã€‚

å…·ä½“ä»£ç å¦‚ä¸‹ï¼š

```
from sklearn.model_selection import GridSearchCV
pipeline = Pipeline([
        ('scaler', StandardScaler()),
        ('pca', PCA()),
        ('randomforestclassifier', RandomForestClassifier())
])
```

é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨é‡‡ç”¨Pipelineç®¡é“æœºåˆ¶ï¼Œç”¨éšæœºæ£®æ—å¯¹IRISæ•°æ®é›†åšä¸€ä¸‹åˆ†ç±»ã€‚å…ˆç”¨StandardScaleræ–¹æ³•å¯¹æ•°æ®è§„èŒƒåŒ–ï¼Œç„¶åå†ç”¨éšæœºæ£®æ—åˆ†ç±»ï¼Œç¼–å†™ä»£ç å¦‚ä¸‹ï¼š

```
# -*- coding: utf-8 -*-
# ä½¿ç”¨RandomForestå¯¹IRISæ•°æ®é›†è¿›è¡Œåˆ†ç±»
# åˆ©ç”¨GridSearchCVå¯»æ‰¾æœ€ä¼˜å‚æ•°,ä½¿ç”¨Pipelineè¿›è¡Œæµæ°´ä½œä¸š
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import GridSearchCV
from sklearn.datasets import load_iris
from sklearn.preprocessing import StandardScaler
from sklearn.pipeline import Pipeline
rf = RandomForestClassifier()
parameters = {"randomforestclassifier__n_estimators": range(1,11)}
iris = load_iris()
pipeline = Pipeline([
        ('scaler', StandardScaler()),
        ('randomforestclassifier', rf)
])
# ä½¿ç”¨GridSearchCVè¿›è¡Œå‚æ•°è°ƒä¼˜
clf = GridSearchCV(estimator=pipeline, param_grid=parameters)
# å¯¹irisæ•°æ®é›†è¿›è¡Œåˆ†ç±»
clf.fit(iris.data, iris.target)
print("æœ€ä¼˜åˆ†æ•°ï¼š %.4lf" %clf.best_score_)
print("æœ€ä¼˜å‚æ•°ï¼š", clf.best_params_)
è¿è¡Œç»“æœï¼š
æœ€ä¼˜åˆ†æ•°ï¼š 0.9667
æœ€ä¼˜å‚æ•°ï¼š {'randomforestclassifier__n_estimators': 9}
```

ä½ èƒ½çœ‹åˆ°æ˜¯å¦é‡‡ç”¨æ•°æ®è§„èŒƒåŒ–å¯¹ç»“æœè¿˜æ˜¯æœ‰ä¸€äº›å½±å“çš„ï¼Œæœ‰äº†GridSearchCVå’ŒPipelineè¿™ä¸¤ä¸ªå·¥å…·ä¹‹åï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨åˆ†ç±»å™¨çš„æ—¶å€™å°±ä¼šæ–¹ä¾¿å¾ˆå¤šã€‚

## å¯¹ä¿¡ç”¨å¡è¿çº¦ç‡è¿›è¡Œåˆ†æ

æˆ‘ä»¬ç°åœ¨æ¥åšä¸€ä¸ªä¿¡ç”¨å¡è¿çº¦ç‡çš„é¡¹ç›®ï¼Œè¿™ä¸ªæ•°æ®é›†ä½ å¯ä»¥ä»GitHubä¸Šä¸‹è½½ï¼š[https://github.com/cystanford/credit\_default](https://github.com/cystanford/credit_default)ã€‚

è¿™ä¸ªæ•°æ®é›†æ˜¯å°æ¹¾æŸé“¶è¡Œ2005å¹´4æœˆåˆ°9æœˆçš„ä¿¡ç”¨å¡æ•°æ®ï¼Œæ•°æ®é›†ä¸€å…±åŒ…æ‹¬25ä¸ªå­—æ®µï¼Œå…·ä½“å«ä¹‰å¦‚ä¸‹ï¼š

![](https://static001.geekbang.org/resource/image/17/88/1730fb3a809c99950739e7f50e1a6988.jpg?wh=627%2A843)  
ç°åœ¨æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è¦é’ˆå¯¹è¿™ä¸ªæ•°æ®é›†æ„å»ºä¸€ä¸ªåˆ†æä¿¡ç”¨å¡è¿çº¦ç‡çš„åˆ†ç±»å™¨ã€‚å…·ä½“é€‰æ‹©å“ªä¸ªåˆ†ç±»å™¨ï¼Œä»¥åŠåˆ†ç±»å™¨çš„å‚æ•°å¦‚ä½•ä¼˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨GridSearchCVè¿™ä¸ªå·¥å…·è·‘ä¸€éã€‚

å…ˆæ¢³ç†ä¸‹æ•´ä¸ªé¡¹ç›®çš„æµç¨‹ï¼š

![](https://static001.geekbang.org/resource/image/92/a5/929c96584cbc25972f63ef39101c96a5.jpg?wh=2350%2A1079)

1. åŠ è½½æ•°æ®ï¼›
2. å‡†å¤‡é˜¶æ®µï¼šæ¢ç´¢æ•°æ®ï¼Œé‡‡ç”¨æ•°æ®å¯è§†åŒ–æ–¹å¼å¯ä»¥è®©æˆ‘ä»¬å¯¹æ•°æ®æœ‰æ›´ç›´è§‚çš„äº†è§£ï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³è¦äº†è§£ä¿¡ç”¨å¡è¿çº¦ç‡å’Œä¸è¿çº¦ç‡çš„äººæ•°ã€‚å› ä¸ºæ•°æ®é›†æ²¡æœ‰ä¸“é—¨çš„æµ‹è¯•é›†ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨train\_test\_splitåˆ’åˆ†æ•°æ®é›†ã€‚
3. åˆ†ç±»é˜¶æ®µï¼šä¹‹æ‰€ä»¥æŠŠæ•°æ®è§„èŒƒåŒ–æ”¾åˆ°è¿™ä¸ªé˜¶æ®µï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Pipelineç®¡é“æœºåˆ¶ï¼Œå°†æ•°æ®è§„èŒƒåŒ–è®¾ç½®ä¸ºç¬¬ä¸€æ­¥ï¼Œåˆ†ç±»ä¸ºç¬¬äºŒæ­¥ã€‚å› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“é‡‡ç”¨å“ªä¸ªåˆ†ç±»å™¨æ•ˆæœå¥½ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¤šç”¨å‡ ä¸ªåˆ†ç±»å™¨ï¼Œæ¯”å¦‚SVMã€å†³ç­–æ ‘ã€éšæœºæ£®æ—å’ŒKNNã€‚ç„¶åé€šè¿‡GridSearchCVå·¥å…·ï¼Œæ‰¾åˆ°æ¯ä¸ªåˆ†ç±»å™¨çš„æœ€ä¼˜å‚æ•°å’Œæœ€ä¼˜åˆ†æ•°ï¼Œæœ€ç»ˆæ‰¾åˆ°æœ€é€‚åˆè¿™ä¸ªé¡¹ç›®çš„åˆ†ç±»å™¨å’Œè¯¥åˆ†ç±»å™¨çš„å‚æ•°ã€‚

åŸºäºä¸Šé¢çš„æµç¨‹ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š

```
# -*- coding: utf-8 -*-
# ä¿¡ç”¨å¡è¿çº¦ç‡åˆ†æ
import pandas as pd
from sklearn.model_selection import learning_curve, train_test_split,GridSearchCV
from sklearn.preprocessing import StandardScaler
from sklearn.pipeline import Pipeline
from sklearn.metrics import accuracy_score
from sklearn.svm import SVC
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier
from sklearn.neighbors import KNeighborsClassifier
from matplotlib import pyplot as plt
import seaborn as sns
# æ•°æ®åŠ è½½
data = data = pd.read_csv('./UCI_Credit_Card.csv')
# æ•°æ®æ¢ç´¢
print(data.shape) # æŸ¥çœ‹æ•°æ®é›†å¤§å°
print(data.describe()) # æ•°æ®é›†æ¦‚è§ˆ
# æŸ¥çœ‹ä¸‹ä¸€ä¸ªæœˆè¿çº¦ç‡çš„æƒ…å†µ
next_month = data['default.payment.next.month'].value_counts()
print(next_month)
df = pd.DataFrame({'default.payment.next.month': next_month.index,'values': next_month.values})
plt.rcParams['font.sans-serif']=['SimHei'] #ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾
plt.figure(figsize = (6,6))
plt.title('ä¿¡ç”¨å¡è¿çº¦ç‡å®¢æˆ·\n (è¿çº¦ï¼š1ï¼Œå®ˆçº¦ï¼š0)')
sns.set_color_codes("pastel")
sns.barplot(x = 'default.payment.next.month', y="values", data=df)
locs, labels = plt.xticks()
plt.show()
# ç‰¹å¾é€‰æ‹©ï¼Œå»æ‰IDå­—æ®µã€æœ€åä¸€ä¸ªç»“æœå­—æ®µå³å¯
data.drop(['ID'], inplace=True, axis =1) #IDè¿™ä¸ªå­—æ®µæ²¡æœ‰ç”¨
target = data['default.payment.next.month'].values
columns = data.columns.tolist()
columns.remove('default.payment.next.month')
features = data[columns].values
# 30%ä½œä¸ºæµ‹è¯•é›†ï¼Œå…¶ä½™ä½œä¸ºè®­ç»ƒé›†
train_x, test_x, train_y, test_y = train_test_split(features, target, test_size=0.30, stratify = target, random_state = 1)
    
# æ„é€ å„ç§åˆ†ç±»å™¨
classifiers = [
    SVC(random_state = 1, kernel = 'rbf'),    
    DecisionTreeClassifier(random_state = 1, criterion = 'gini'),
    RandomForestClassifier(random_state = 1, criterion = 'gini'),
    KNeighborsClassifier(metric = 'minkowski'),
]
# åˆ†ç±»å™¨åç§°
classifier_names = [
            'svc', 
            'decisiontreeclassifier',
            'randomforestclassifier',
            'kneighborsclassifier',
]
# åˆ†ç±»å™¨å‚æ•°
classifier_param_grid = [
            {'svc__C':[1], 'svc__gamma':[0.01]},
            {'decisiontreeclassifier__max_depth':[6,9,11]},
            {'randomforestclassifier__n_estimators':[3,5,6]} ,
            {'kneighborsclassifier__n_neighbors':[4,6,8]},
]
 
# å¯¹å…·ä½“çš„åˆ†ç±»å™¨è¿›è¡ŒGridSearchCVå‚æ•°è°ƒä¼˜
def GridSearchCV_work(pipeline, train_x, train_y, test_x, test_y, param_grid, score = 'accuracy'):
    response = {}
    gridsearch = GridSearchCV(estimator = pipeline, param_grid = param_grid, scoring = score)
    # å¯»æ‰¾æœ€ä¼˜çš„å‚æ•° å’Œæœ€ä¼˜çš„å‡†ç¡®ç‡åˆ†æ•°
    search = gridsearch.fit(train_x, train_y)
    print("GridSearchæœ€ä¼˜å‚æ•°ï¼š", search.best_params_)
    print("GridSearchæœ€ä¼˜åˆ†æ•°ï¼š %0.4lf" %search.best_score_)
	predict_y = gridsearch.predict(test_x)
    print("å‡†ç¡®ç‡ %0.4lf" %accuracy_score(test_y, predict_y))
    response['predict_y'] = predict_y
    response['accuracy_score'] = accuracy_score(test_y,predict_y)
    return response
 
for model, model_name, model_param_grid in zip(classifiers, classifier_names, classifier_param_grid):
    pipeline = Pipeline([
            ('scaler', StandardScaler()),
            (model_name, model)
    ])
    result = GridSearchCV_work(pipeline, train_x, train_y, test_x, test_y, model_param_grid , score = 'accuracy')
```

```
è¿è¡Œç»“æœï¼š
(30000, 25)
                 ID             ...              default.payment.next.month
count  30000.000000             ...                            30000.000000
mean   15000.500000             ...                                0.221200
std     8660.398374             ...                                0.415062
min        1.000000             ...                                0.000000
25%     7500.750000             ...                                0.000000
50%    15000.500000             ...                                0.000000
75%    22500.250000             ...                                0.000000
max    30000.000000             ...                                1.000000

[8 rows x 25 columns]

GridSearchæœ€ä¼˜å‚æ•°ï¼š {'svc__C': 1, 'svc__gamma': 0.01}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8174
å‡†ç¡®ç‡ 0.8172
GridSearchæœ€ä¼˜å‚æ•°ï¼š {'decisiontreeclassifier__max_depth': 6}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8186
å‡†ç¡®ç‡ 0.8113
GridSearchæœ€ä¼˜å‚æ•°ï¼š {'randomforestclassifier__n_estimators': 6}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.7998
å‡†ç¡®ç‡ 0.7994
GridSearchæœ€ä¼˜å‚æ•°ï¼š {'kneighborsclassifier__n_neighbors': 8}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8040
å‡†ç¡®ç‡ 0.8036
```

![](https://static001.geekbang.org/resource/image/18/72/187d0233d4fb5f07a9653e5ae4754372.png?wh=1729%2A1774)  
ä»ç»“æœä¸­ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°SVMåˆ†ç±»å™¨çš„å‡†ç¡®ç‡æœ€é«˜ï¼Œæµ‹è¯•å‡†ç¡®ç‡ä¸º0.8172ã€‚

åœ¨å†³ç­–æ ‘åˆ†ç±»ä¸­ï¼Œæˆ‘è®¾ç½®äº†3ç§æœ€å¤§æ·±åº¦ï¼Œå½“æœ€å¤§æ·±åº¦=6æ—¶ç»“æœæœ€ä¼˜ï¼Œæµ‹è¯•å‡†ç¡®ç‡ä¸º0.8113ï¼›åœ¨éšæœºæ£®æ—åˆ†ç±»ä¸­ï¼Œæˆ‘è®¾ç½®äº†3ä¸ªå†³ç­–æ ‘ä¸ªæ•°çš„å–å€¼ï¼Œå–å€¼ä¸º6æ—¶ç»“æœæœ€ä¼˜ï¼Œæµ‹è¯•å‡†ç¡®ç‡ä¸º0.7994ï¼›åœ¨KNNåˆ†ç±»ä¸­ï¼Œæˆ‘è®¾ç½®äº†3ä¸ªnçš„å–å€¼ï¼Œå–å€¼ä¸º8æ—¶ç»“æœæœ€ä¼˜ï¼Œæµ‹è¯•å‡†ç¡®ç‡ä¸º0.8036ã€‚

## æ€»ç»“

ä»Šå¤©æˆ‘ç»™ä½ è®²äº†éšæœºæ£®æ—çš„æ¦‚å¿µåŠå·¥å…·çš„ä½¿ç”¨ï¼Œå¦å¤–é’ˆå¯¹æ•°æ®æŒ–æ˜ç®—æ³•ä¸­ç»å¸¸é‡‡ç”¨çš„å‚æ•°è°ƒä¼˜ï¼Œä¹Ÿä»‹ç»äº†GridSearchCVå·¥å…·è¿™ä¸ªåˆ©å™¨ã€‚å¹¶å°†è¿™ä¸¤è€…ç»“åˆèµ·æ¥ï¼Œåœ¨ä¿¡ç”¨å¡è¿çº¦åˆ†æè¿™ä¸ªé¡¹ç›®ä¸­è¿›è¡Œäº†ä½¿ç”¨ã€‚

å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬ä¸çŸ¥é“è¯¥é‡‡ç”¨å“ªç§åˆ†ç±»ç®—æ³•æ›´é€‚åˆã€‚å³ä¾¿æ˜¯å¯¹äºä¸€ç§åˆ†ç±»ç®—æ³•ï¼Œä¹Ÿæœ‰å¾ˆå¤šå‚æ•°å¯ä»¥è°ƒä¼˜ï¼Œæ¯ä¸ªå‚æ•°éƒ½æœ‰ä¸€å®šçš„å–å€¼èŒƒå›´ã€‚æˆ‘ä»¬å¯ä»¥æŠŠæƒ³è¦é‡‡ç”¨çš„åˆ†ç±»å™¨ï¼Œä»¥åŠè¿™äº›å‚æ•°çš„å–å€¼èŒƒå›´éƒ½è®¾ç½®åˆ°æ•°ç»„é‡Œï¼Œç„¶åä½¿ç”¨GridSearchCVå·¥å…·è¿›è¡Œè°ƒä¼˜ã€‚

![](https://static001.geekbang.org/resource/image/14/16/14f9cddc17d6cceb0b8cbc4381c65216.png?wh=1728%2A1019)  
ä»Šå¤©æˆ‘ä»¬è®²äº†å¦‚ä½•ä½¿ç”¨GridSearchCVåšå‚æ•°è°ƒä¼˜ï¼Œä½ å¯ä»¥è¯´è¯´ä½ çš„ç†è§£ï¼Œå¦‚æœæœ‰ä½¿ç”¨çš„ç»éªŒä¹Ÿå¯ä»¥åˆ†äº«ä¸‹ã€‚

å¦å¤–é’ˆå¯¹ä¿¡ç”¨å¡è¿çº¦ç‡åˆ†æè¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†SVMã€å†³ç­–æ ‘ã€éšæœºæ£®æ—å’ŒKNNåˆ†ç±»å™¨ï¼Œä½ èƒ½ä¸èƒ½ç¼–å†™ä»£ç ä½¿ç”¨AdaBooståˆ†ç±»å™¨åšåˆ†ç±»å‘¢ï¼Ÿå…¶ä¸­n\_estimatorsçš„å–å€¼æœ‰10ã€50ã€100ä¸‰ç§å¯èƒ½ï¼Œä½ å¯ä»¥ä½¿ç”¨GridSearchCVè¿è¡Œçœ‹çœ‹æœ€ä¼˜å‚æ•°æ˜¯å¤šå°‘ï¼Œæµ‹è¯•å‡†ç¡®ç‡æ˜¯å¤šå°‘ï¼Ÿ

æ¬¢è¿ä½ åœ¨è¯„è®ºåŒºä¸æˆ‘åˆ†äº«ä½ çš„ç­”æ¡ˆï¼Œå¦‚æœæœ‰é—®é¢˜ä¹Ÿå¯ä»¥å†™åœ¨è¯„è®ºåŒºã€‚å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰ä»·å€¼ï¼Œæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–è€…åŒäº‹ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ15ï¼‰</strong></div><ul>
<li><span>è¥¿æ¹–æ™¨æ›¦</span> ğŸ‘ï¼ˆ29ï¼‰ ğŸ’¬ï¼ˆ8ï¼‰<p>æˆ‘æ˜¯é“¶è¡Œä¿¡ç”¨å¡éƒ¨çš„ä»ä¸šäººå‘˜ï¼Œä¹Ÿå¾ˆå–œæ¬¢æ•°æ®åˆ†æã€‚

ä½†æ˜¯çœ‹äº†è¿™ä¸ªæ¡ˆä¾‹ï¼Œæ„Ÿè§‰è¿™ä¸ªæ¡ˆä¾‹èƒ½å¤Ÿç»™ä¿¡ç”¨å¡çš„æ•°æ®åˆ†æå¸¦æ¥ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘çš„æ„æ€æ˜¯ï¼Œèƒ½å¤Ÿåˆ†æå‡ºä»€ä¹ˆé—®é¢˜å—ï¼Ÿé“¶è¡Œä¿¡ç”¨å¡éƒ¨åº”è¯¥åœ¨æŒå¡äººç”¨å¡çš„ä»€ä¹ˆé˜¶æ®µå¼€å§‹å¼€å§‹è¦é‡‡å–æªæ–½é˜²æ­¢è¯ˆéª—ï¼Ÿä»€ä¹ˆç±»å‹çš„å®¢æˆ·å®¹æ˜“è¯ˆéª—ï¼Ÿ---æ„Ÿè§‰è¿™ä¸ªæ¡ˆä¾‹å°±æ˜¯ä»æ•°å­—åˆ°æ•°å­—ï¼Œæ²¡æœ‰èƒ½å¤Ÿç»™çœŸå®ä¸šåŠ¡å¸¦æ¥ä»€ä¹ˆå¸®åŠ©ã€‚

-----ä¹Ÿæƒ³å¯¹ä»äº‹æ•°æ®åˆ†æçš„äººå‘˜æä¸ªé†’ï¼Œæ•°æ®åˆ†æä¸æ˜¯ä»çº¯æ•°å­—åˆ°çº¯æ•°å­—çš„çº¯å­¦æœ¯ç ”ç©¶ï¼Œåº”è¯¥æ˜¯è”ç³»å®é™…å·¥ä½œï¼Œèƒ½å¤Ÿç»™å®é™…å·¥ä½œå¸¦æ¥å¸®åŠ©çš„å•Šï¼è”ç³»åˆ°æ­¤æ¡ˆä¾‹ï¼Œåº”è¯¥æ˜¯èƒ½å¤Ÿç»™é“¶è¡Œä¿¡ç”¨å¡éƒ¨çš„é˜²æ¬ºè¯ˆå·¥ä½œå¸¦æ¥æå‡çš„å•Š~åˆ†æäº†ä»€ä¹ˆå‡ºæ¥ï¼Ÿé“¶è¡Œçš„å“ªä¸ªç¯èŠ‚åº”è¯¥æå‡ä»¥é˜²æ­¢æ¬ºè¯ˆï¼Ÿ</p>2019-09-03</li><br/><li><span>vortual</span> ğŸ‘ï¼ˆ15ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼Œå®é™…å·¥ä½œä¸­æ•°æ®é‡å¤§çš„è¯è·‘ä¸ªæ¨¡å‹åº”è¯¥è¦ä¸å°‘æ—¶é—´ï¼Œåº”è¯¥ä¸å…è®¸è¿™ä¹ˆå»è¯•æ‰€æœ‰å‚æ•°å’Œé‚£ä¹ˆå¤šç®—æ³•å§ï¼Ÿè¿˜æœ‰ä¸€ä¸ªç–‘é—®æ˜¯æ•°æ®é‡è¶…è¿‡ä¸€å®šé‡æ˜¯ä¸æ˜¯è¦ç”¨æ·±åº¦å­¦ä¹ äº†ï¼Ÿå¸Œæœ›è€å¸ˆèƒ½è§£æƒ‘ä¸‹</p>2019-03-13</li><br/><li><span>Geek_hve78z</span> ğŸ‘ï¼ˆ6ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;n_estimators&#39;: 10}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8187
å‡†ç¡®ç‡ 0.8129
-----ä»£ç ------

# -*- coding: utf-8 -*-
# ä¿¡ç”¨å¡è¿çº¦ç‡åˆ†æ
import pandas as pd
from sklearn.model_selection import learning_curve, train_test_split,GridSearchCV
from sklearn.preprocessing import StandardScaler
from sklearn.pipeline import Pipeline
from sklearn.metrics import accuracy_score
from sklearn.ensemble import AdaBoostClassifier

from matplotlib import pyplot as plt
import seaborn as sns
# æ•°æ®åŠ è½½
data=data=pd.read_csv(&#39;.&#47;credit_default-master&#47;UCI_Credit_Card.csv&#39;)
# æ•°æ®æ¢ç´¢
print(data.shape) # æŸ¥çœ‹æ•°æ®é›†å¤§å°
print(data.describe()) # æ•°æ®é›†æ¦‚è§ˆ
# æŸ¥çœ‹ä¸‹ä¸€ä¸ªæœˆè¿çº¦ç‡çš„æƒ…å†µ
next_month = data[&#39;default.payment.next.month&#39;].value_counts()
print(next_month)
df = pd.DataFrame({&#39;default.payment.next.month&#39;: next_month.index,&#39;values&#39;: next_month.values})
plt.rcParams[&#39;font.sans-serif&#39;]=[&#39;SimHei&#39;] #ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾
plt.figure(figsize = (6,6))
plt.title(&#39;ä¿¡ç”¨å¡è¿çº¦ç‡å®¢æˆ·\n (è¿çº¦ï¼š1ï¼Œå®ˆçº¦ï¼š0)&#39;)
sns.set_color_codes(&quot;pastel&quot;)
sns.barplot(x = &#39;default.payment.next.month&#39;, y=&quot;values&quot;, data=df)
locs, labels = plt.xticks()
plt.show()
# ç‰¹å¾é€‰æ‹©ï¼Œå»æ‰IDå­—æ®µã€æœ€åä¸€ä¸ªç»“æœå­—æ®µå³å¯
data.drop([&#39;ID&#39;], inplace=True, axis =1) #IDè¿™ä¸ªå­—æ®µæ²¡æœ‰ç”¨
target = data[&#39;default.payment.next.month&#39;].values
columns = data.columns.tolist()
columns.remove(&#39;default.payment.next.month&#39;)
features = data[columns].values
# 30%ä½œä¸ºæµ‹è¯•é›†ï¼Œå…¶ä½™ä½œä¸ºè®­ç»ƒé›†
train_x, test_x, train_y, test_y = train_test_split(features, target, test_size=0.30, stratify = target, random_state = 1)


#åˆ†ç±»å™¨
ada=AdaBoostClassifier( random_state=1)
#éœ€è¦è°ƒæ•´çš„å‚æ•°
parameters={&#39;n_estimators&#39;:[10,50,100]}

# ä½¿ç”¨ GridSearchCV è¿›è¡Œå‚æ•°è°ƒä¼˜
clf=GridSearchCV(estimator=ada,param_grid=parameters,scoring = &#39;accuracy&#39;)

clf.fit(train_x,train_y)
print(&quot;GridSearchæœ€ä¼˜å‚æ•°ï¼š&quot;, clf.best_params_)
print(&quot;GridSearchæœ€ä¼˜åˆ†æ•°ï¼š %0.4lf&quot; %clf.best_score_)
predict_y=clf.predict(test_x)
print(&quot;å‡†ç¡®ç‡ %0.4lf&quot; %accuracy_score(test_y, predict_y))
 


</p>2019-03-13</li><br/><li><span>CR77</span> ğŸ‘ï¼ˆ5ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>åœ¨åšçš„æ—¶å€™åˆå¦‚ä¸‹é—®é¢˜ï¼Œæˆ‘è§‰å¾—éœ€è¦æ³¨æ„ï¼š
ç¬¬ä¸€ã€PAY_0åˆ°PAY_6ç»å…¸æŒ‡æ ‡æ€§çš„ç‰¹å¾ï¼Œä½†æ˜¯å…·ä½“ä»€ä¹ˆæ„ä¹‰ä¸çŸ¥é“ï¼Œä¸ªäººè®¤ä¸ºä¸åº”è¯¥è‰è‰çš„å½’ä¸€åŒ–ã€‚
ç¬¬äºŒï¼Œæ¯æœˆè´¦å•é‡‘é¢ä½“ç°çš„æ˜¯å®¢æˆ·çš„æ¶ˆè´¹æ°´å¹³ï¼Œæ¯æœˆçš„è¿˜æ¬¾é‡‘é¢ä½“ç°çš„æ˜¯å®¢æˆ·çš„å®é™…ç»æµæƒ…å†µï¼ˆå½“ç„¶ä¸æ’é™¤é‚£äº›ï¼Œæœ‰é’±ä½†æ˜¯ä¸è¿˜æ¬¾çš„æƒ…å†µï¼‰ï¼Œæ‰€ä»¥æˆ‘æƒ³èƒ½ä¸èƒ½å°†ï¼ˆæ¯æœˆçš„è´¦å•é‡‘é¢ - æ¯æœˆçš„è¿˜æ¬¾é‡‘é¢ï¼‰è®¾ç½®ä¸ºä¸€ä¸ªæ–°çš„ç‰¹å¾ï¼Œå¯èƒ½èƒ½æ›´åŠ è´´è¿‘ç”¨æˆ·çš„å®é™…ç»æµæƒ…å†µã€‚
ç¬¬ä¸‰ï¼Œæ˜¯å¦éœ€è¦é‡‡ç”¨ä¸‹é‡‡æ ·ï¼Ÿå› ä¸ºæ¯•ç«Ÿæ­£è´Ÿæ ·æœ¬çš„æ¯”ä¾‹æ˜¯æœ‰ä¸€å®šçš„å·®è·çš„ï¼Œæˆ‘ä»¬æ¨¡å‹è®­ç»ƒå‡ºæ¥çš„æ•ˆæœå¹¶ä¸æ˜¯å¾ˆå¥½æ˜¯ä¸æ˜¯æœ‰å…³ç³»
ç¬¬å››ï¼Œé—®é¢˜çš„å®é™…æ„ä¹‰çš„åˆ†æï¼Œè¿™æ˜¯ä¸€ä¸ªè¿çº¦ç‡çš„æ•°æ®æŒ–æ˜ï¼Œæ›´å¤šçš„å¯ä»¥è¯´æ˜¯ä¸€ç§åˆ†æï¼Œæˆ‘ä»¬å¾—åˆ°çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Œæ˜¯ä¸€ä¸ªæ–°çš„å®¢æˆ·åœ¨äº§ç”Ÿç§ç§äº¤æ˜“ä¹‹åï¼Œä»–è¿çº¦çš„å¯èƒ½ï¼Œè¿™æ˜¯æˆ‘èƒ½æƒ³åˆ°çš„æ„ä¹‰ï¼Œæ”¾åˆ°å•†ä¸šä¸Šçš„è¯æˆ‘ä»¬å®é™…ä¸Šæ˜¯è¦åšå‡ºæ€ä¹ˆæ ·çš„å†³ç­–å‘¢ï¼Ÿ</p>2020-04-05</li><br/><li><span>è·³è·³</span> ğŸ‘ï¼ˆ5ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>1.å¯¹GridSearchCVçš„ç†è§£ï¼šå°±æ˜¯åœ¨ä¹‹å‰çš„ç»éªŒçš„åŸºç¡€ä¸Šé€‰æ‹©äº†ä¸€äº›è¾ƒå¥½çš„å–å€¼å¤‡é€‰ï¼Œç„¶ååˆ†åˆ«å»è¯•ï¼Œå¾—åˆ°ä¸€ä¸ªå¥½çš„æ€§èƒ½ã€‚æ¯”ç›´æ¥é€‰æ‹©å‚æ•°å¤šäº†ä¸€äº›ä¿éšœï¼Œä½†æ˜¯ä¹Ÿå¢åŠ ä¸€äº›è®¡ç®—è´Ÿæ‹…ã€‚
2.åœ¨è€å¸ˆä»£ç çš„åŸºç¡€ä¸Šæ·»åŠ äº†adabooståˆ†ç±»ï¼Œä½¿ç”¨adaboosté»˜è®¤çš„åˆ†ç±»å™¨ï¼Œç»“æœæ˜¯åœ¨n_estimators=10çš„æ—¶å€™å–å¾—æœ€ä¼˜æ€§èƒ½ï¼Œå‡†ç¡®ç‡æ˜¯0.8187
GridSearch æœ€ä¼˜å‚æ•°ï¼š {&#39;AdaBoostClassifier__n_estimators&#39;: 10}
GridSearch æœ€ä¼˜åˆ†æ•°ï¼š 0.8187
 å‡†ç¡®ç‡ 0.8129</p>2019-03-13</li><br/><li><span>third</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>æé—®ï¼šè€æ˜¯å‡ºç°futureWarning,æ˜¯ä»€ä¹ˆæƒ…å†µ

GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;n_estimators&#39;: 10}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8187
å‡†ç¡®ç‡ 0.8129</p>2019-03-20</li><br/><li><span>Geek_hve78z</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ä½¿ç”¨ Pipeline ç®¡é“æœºåˆ¶çš„ä¼˜åŠ¿ï¼Œå‚è€ƒèµ„æ–™ï¼š
https:&#47;&#47;www.jianshu.com&#47;p&#47;9c2c8c8ef42d
https:&#47;&#47;blog.csdn.net&#47;qq_41598851&#47;article&#47;details&#47;80957893

ä¸ªäººç†è§£ï¼š
Pipelineæ˜¯å°†æ•°æ®å¤„ç†æµç¨‹çš„å…±åŒéƒ¨åˆ†æå–å‡ºæ¥ï¼Œç®€åŒ–ä»£ç ã€‚
ä»¥æœ¬æ–‡æœ€åçš„ç¼–ç¨‹æ¡ˆä¾‹ä¸ºä¾‹ï¼Œå…±åŒéƒ¨åˆ†æ˜¯â€œæ•°æ®è§„èŒƒåŒ–â€å’Œâ€œä½¿ç”¨æ•°æ®åˆ†ç±»ç®—æ³•â€ï¼Œå°†ä¿©éƒ¨åˆ†å°è£…ã€‚
åœ¨æ¯ä¸€æ¬¡å¾ªç¯â€œç®—æ³•â€æ—¶ï¼Œpipelineé‡Œå¤´å®Œæˆç®—æ³•æ›´æ–°ã€‚GridSearchCVå¼•ç”¨å›ºå®šçš„pipelineï¼Œå®åˆ™ç®—æ³•å·²ç»æ›´æ–°äº†ã€‚è¿™æ ·å‡å°‘äº†å¤šä½™ä»£ç çš„ä¹¦å†™ã€‚
</p>2019-03-13</li><br/><li><span>ç™½å¤œ</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<p>ä¸‰ä¸‡æ¡ï¼Œ25ä¸ªå­—æ®µå°±è¦è¿ç®—å‡ åˆ†é’Ÿäº†ï¼Œæ•°æ®ä¸Šäº¿ã€‚ã€‚ã€‚
&#39;&#39;&#39;
GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;svc__C&#39;: 1, &#39;svc__gamma&#39;: 0.01}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8174
å‡†ç¡®ç‡ 0.8172
68.59484457969666 s
GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;decisiontreeclassifier__max_depth&#39;: 6}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8186
å‡†ç¡®ç‡ 0.8113
1.8460278511047363 s
GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;randomforestclassifier__n_estimators&#39;: 6}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.7998
å‡†ç¡®ç‡ 0.7994
2.297856330871582 s
GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;kneighborsclassifier__n_neighbors&#39;: 8}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8040
å‡†ç¡®ç‡ 0.8036
154.36387968063354 s
GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;adaboostclassifier__n_estimators&#39;: 10}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8187
å‡†ç¡®ç‡ 0.8129
13.483576774597168 s
&#39;&#39;&#39;</p>2019-03-13</li><br/><li><span>å°æ™¨</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>ç”¨32ä½çš„pythonåœ¨æ‰§è¡Œkneighborsclassifieråˆ†ç±»å™¨æ—¶ï¼Œä¼šæŠ¥å†…å­˜é”™è¯¯ï¼šnumpy.core._exceptions.MemoryError: Unable to allocate 1.00 GiB for an array with shape (6391, 21000) and data type float64
è€å¸ˆæœ‰æ— åŠæ³•å°†numpyæ•°æ®ç±»å‹float64æ”¹ä¸ºfloat16æˆ–float32å‘¢ï¼Ÿæˆ–æ˜¯å…¶ä»–åŠæ³•è§£å†³
&#47;&#47;&#47;é‡è£…64ä½ï¼Œå…¨éƒ¨åº“éœ€è¦é‡è£…&#47;&#47;&#47;</p>2021-03-15</li><br/><li><span>ä¸€çº¸ä¹¦</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>å‹‰å‹‰å¼ºå¼ºçœ‹æ‡‚,ä½†å¿ƒçŸ¥è‹¥è®©æˆ‘åœ¨ä¸€ç‰‡ç©ºç™½çš„pythonæ–‡ä»¶ä¸­,å®Œå…¨ç‹¬ç«‹å®Œæˆè¿™ä¸ªé¡¹ç›®;æˆ‘åšä¸åˆ°; </p>2019-11-22</li><br/><li><span>æ»¢</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æ—¸è€å¸ˆï¼Œæƒ³è¯·æ•™å‡ ä¸ªé—®é¢˜ï¼š1.ä¸ºä½•æ‰§è¡Œå¤šæ¬¡ æœ€ä¼˜åˆ†æ•°æ˜¯ä¸€å®šçš„ 0.9667  ä½†æ˜¯æœ€ä¼˜å‚æ•°ï¼Œn_estimators æ¯æ¬¡éƒ½ä¸ä¸€æ ·ï¼Œè¿™æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ2.éšæœºæ£®æ—æ˜¯ä¸æ˜¯æ­£å¥½ä¸AdaBoostç›¸åï¼Œéƒ½æ•°æ®é›†æˆæ¨¡å¼ï¼Œä¸€ä¸ªæ˜¯é›†æˆé‡Œçš„æŠ•ç¥¨æ¨¡å¼ï¼Œä¸€ä¸ªæ˜¯å­¦ä¹ æ¨¡å¼ã€‚è¿™æ ·ç†è§£æ­£ç¡®å—ï¼Ÿ</p>2019-04-24</li><br/><li><span>èµµå®</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è¯·é—®â€œå®¢æˆ·è¿˜æ¬¾æƒ…å†µâ€å­—æ®µé‡Œçš„å€¼åˆ†åˆ«ä»£è¡¨ä»€ä¹ˆæ„æ€ï¼Ÿ</p>2020-12-30</li><br/><li><span>Simon</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ä»best_score_çœ‹ï¼Œæ˜¯å¦å¯¹æ•°æ®æ ‡å‡†åŒ–ï¼Œå¯¹éšæœºæ£®æ—ç®—æ³•ç¡®å®æ²¡æœ‰å½±å“ã€‚å¯¹å†³ç­–æ ‘è€Œè¨€ï¼Œé‡è¦çš„æ˜¯å±æ€§çš„æ¬¡åºï¼Œè€Œä¸æ˜¯ç»å¯¹å¤§å°ã€‚</p>2020-04-14</li><br/><li><span>å¼ è´º</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;adaboostclassifier__n_estimators&#39;: 10}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8187
å‡†ç¡®ç‡ 0.8129</p>2020-03-27</li><br/><li><span>Ronnyz</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p># -*- coding:utf-8 -*-
import pandas as pd
from sklearn.model_selection import GridSearchCV,train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.pipeline import Pipeline
from sklearn.datasets import load_iris
from sklearn.metrics import accuracy_score
from sklearn.ensemble import AdaBoostClassifier
from matplotlib import pyplot as plt
import seaborn as sns
from warnings import simplefilter
simplefilter(action=&#39;ignore&#39;,category=FutureWarning)

#æ•°æ®åŠ è½½
credits=pd.read_csv(&#39;CreditCard_data&#47;UCI_Credit_Card.csv&#39;)
#æ•°æ®æ¢ç´¢
print(credits.shape)
print(credits.describe()) #æŸ¥çœ‹æ•°æ®æ¦‚è§ˆ

#ç‰¹å¾é€‰æ‹©ï¼Œå»æ‰IDå­—æ®µ
credits.drop([&#39;ID&#39;],inplace=True,axis=1)
target=credits[&#39;default.payment.next.month&#39;].values
columns=credits.columns.tolist()
columns.remove(&#39;default.payment.next.month&#39;)
features=credits[columns].values

#åˆ†å‰²æ•°æ®ï¼Œå°†30%ä½œä¸ºæµ‹è¯•é›†
X_train,X_test,y_train,y_test=train_test_split(features,target,test_size=0.3,random_state=666)

#æ„å»ºåˆ†ç±»å™¨
ada=AdaBoostClassifier()
#ä½¿ç”¨ç½‘æ ¼æœç´¢è°ƒæ•´å‚æ•°
#å‚æ•°è®¾ç½®
parameters={
    &#39;n_estimators&#39;:[10,50,100]
}
gscv=GridSearchCV(estimator=ada,param_grid=parameters,scoring=&#39;accuracy&#39;,n_jobs=-1)
gscv.fit(X_train,y_train)
print(&#39;GridSearchæœ€ä¼˜å‚æ•°ï¼š&#39;,gscv.best_params_)
print(&#39;GridSearchæœ€ä¼˜åˆ†æ•°ï¼š%0.4lf&#39; % gscv.best_score_)
y_pred=gscv.predict(X_test)
print(&#39;å‡†ç¡®ç‡ï¼š&#39;,accuracy_score(y_test,y_pred))

GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;n_estimators&#39;: 50}
GridSearchæœ€ä¼˜åˆ†æ•°ï¼š0.8197
å‡†ç¡®ç‡ï¼š 0.8121111111111111</p>2019-11-30</li><br/>
</ul>