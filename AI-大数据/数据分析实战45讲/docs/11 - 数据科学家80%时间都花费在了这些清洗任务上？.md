æˆ‘ä»¬åœ¨ä¸Šä¸€èŠ‚ä¸­è®²äº†æ•°æ®é‡‡é›†ï¼Œä»¥åŠç›¸å…³çš„å·¥å…·ä½¿ç”¨ï¼Œä½†åšå®Œæ•°æ®é‡‡é›†å°±å¯ä»¥ç›´æ¥è¿›è¡ŒæŒ–æ˜äº†å—ï¼Ÿè‚¯å®šä¸æ˜¯çš„ã€‚

å°±æ‹¿åšé¥­æ‰“ä¸ªæ¯”æ–¹å§ï¼Œå¯¹äºå¾ˆå¤šäººæ¥è¯´ï¼Œçƒ­æ²¹ä¸‹é”…ã€æŒå‹ºç¿»ç‚’ä¸€å®šæ˜¯åšé¥­ä¸­æœ€è¿‡ç˜¾çš„ç¯èŠ‚ï¼Œä½†å®é™…ä¸Šç‚’èœè¿™ä¸ªè¿‡ç¨‹åªå åšé¥­æ—¶é—´çš„20%ï¼Œå‰©ä¸‹80%çš„æ—¶é—´éƒ½æ˜¯åœ¨åšå‡†å¤‡ï¼Œæ¯”å¦‚ä¹°èœã€æ‹©èœã€æ´—èœç­‰ç­‰ã€‚

åœ¨æ•°æ®æŒ–æ˜ä¸­ï¼Œæ•°æ®æ¸…æ´—å°±æ˜¯è¿™æ ·çš„å‰æœŸå‡†å¤‡å·¥ä½œã€‚å¯¹äºæ•°æ®ç§‘å­¦å®¶æ¥è¯´ï¼Œæˆ‘ä»¬ä¼šé‡åˆ°å„ç§å„æ ·çš„æ•°æ®ï¼Œåœ¨åˆ†æå‰ï¼Œè¦æŠ•å…¥å¤§é‡çš„æ—¶é—´å’Œç²¾åŠ›æŠŠæ•°æ®â€œ**æ•´ç†è£å‰ª**â€æˆè‡ªå·±æƒ³è¦æˆ–éœ€è¦çš„æ ·å­ã€‚

ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬é‡‡é›†åˆ°çš„æ•°æ®å¾€å¾€æœ‰å¾ˆå¤šé—®é¢˜ã€‚

æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªä¾‹å­ï¼Œå‡è®¾è€æ¿ç»™ä½ ä»¥ä¸‹çš„æ•°æ®ï¼Œè®©ä½ åšæ•°æ®åˆ†æï¼Œä½ çœ‹åˆ°è¿™ä¸ªæ•°æ®åæœ‰ä»€ä¹ˆæ„Ÿè§‰å‘¢ï¼Ÿ

![](https://static001.geekbang.org/resource/image/5e/23/5e69b73b96c0d824240ac8035fe69723.png?wh=522%2A334)

ä½ åˆšçœ‹åˆ°è¿™äº›æ•°æ®å¯èƒ½ä¼šæ¯”è¾ƒæ‡µï¼Œå› ä¸ºè¿™äº›æ•°æ®ç¼ºå°‘æ ‡æ³¨ã€‚

æˆ‘ä»¬åœ¨æ”¶é›†æ•´ç†æ•°æ®çš„æ—¶å€™ï¼Œä¸€å®šè¦å¯¹æ•°æ®åšæ ‡æ³¨ï¼Œæ•°æ®è¡¨å¤´å¾ˆé‡è¦ã€‚æ¯”å¦‚è¿™ä»½æ•°æ®è¡¨ï¼Œå°±ç¼ºå°‘åˆ—åçš„æ ‡æ³¨ï¼Œè¿™æ ·ä¸€æ¥æˆ‘ä»¬å°±ä¸çŸ¥é“æ¯åˆ—æ•°æ®æ‰€ä»£è¡¨çš„å«ä¹‰ï¼Œæ— æ³•ä»ä¸šåŠ¡ä¸­ç†è§£è¿™äº›æ•°å€¼çš„ä½œç”¨ï¼Œä»¥åŠè¿™äº›æ•°å€¼æ˜¯å¦æ­£ç¡®ã€‚ä½†åœ¨å®é™…å·¥ä½œä¸­ï¼Œä¹Ÿå¯èƒ½åƒè¿™ä¸ªæ¡ˆä¾‹ä¸€æ ·ï¼Œæ•°æ®æ˜¯ç¼ºå°‘æ ‡æ³¨çš„ã€‚

æˆ‘ç®€å•è§£é‡Šä¸‹è¿™äº›æ•°æ®ä»£è¡¨çš„å«ä¹‰ã€‚

è¿™æ˜¯ä¸€å®¶æœè£…åº—ç»Ÿè®¡çš„ä¼šå‘˜æ•°æ®ã€‚æœ€ä¸Šé¢çš„ä¸€è¡Œæ˜¯åˆ—åæ ‡ï¼Œæœ€å·¦ä¾§ä¸€åˆ—æ˜¯è¡Œåæ ‡ã€‚

åˆ—åæ ‡ä¸­ï¼Œç¬¬0åˆ—ä»£è¡¨çš„æ˜¯åºå·ï¼Œç¬¬1åˆ—ä»£è¡¨çš„ä¼šå‘˜çš„å§“åï¼Œç¬¬2åˆ—ä»£è¡¨å¹´é¾„ï¼Œç¬¬3åˆ—ä»£è¡¨ä½“é‡ï¼Œç¬¬4~6åˆ—ä»£è¡¨ç”·æ€§ä¼šå‘˜çš„ä¸‰å›´å°ºå¯¸ï¼Œç¬¬7~9åˆ—ä»£è¡¨å¥³æ€§ä¼šå‘˜çš„ä¸‰å›´å°ºå¯¸ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ30ï¼‰</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/0f/a4/5a/e708e423.jpg" width="30px"><span>third</span> ğŸ‘ï¼ˆ47ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>è‡ªå·±ä¸çŸ¥é“æœ‰æ²¡æœ‰ä»€ä¹ˆå¥½çš„å·¥å…·ï¼Œæ‰€ä»¥å°±æŠŠå›¾ç‰‡ä¸Šä¸€ä¸ªä¸€ä¸ªæ•²è¿›å»äº†ã€‚
æ•°æ®.csvæ ¼å¼
é“¾æ¥ï¼šhttps:&#47;&#47;pan.baidu.com&#47;s&#47;1jNnUpntrlxFSubmna3HtXw 
æå–ç ï¼še9hc</div>2019-02-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/ca/98/a75e400b.jpg" width="30px"><span>wonderland</span> ğŸ‘ï¼ˆ46ï¼‰ ğŸ’¬ï¼ˆ5ï¼‰<div>ä¸€ã€é¦–å…ˆæŒ‰ç…§æ‰€è®²çš„æ•°æ®è´¨é‡å‡†åˆ™ï¼Œæ•°æ®å­˜åœ¨çš„é—®é¢˜æœ‰ï¼š
1.&quot;å®Œæ•´æ€§&quot;é—®é¢˜ï¼šæ•°æ®æœ‰ç¼ºå¤±ï¼Œåœ¨ouncesåˆ—çš„ç¬¬ä¸‰è¡Œå­˜åœ¨ç¼ºå¤±å€¼
å¤„ç†åŠæ³•ï¼šå¯ä»¥ç”¨è¯¥åˆ—çš„å¹³å‡å€¼æ¥å¡«å……æ­¤ç¼ºå¤±å€¼
2.â€œå…¨é¢æ€§â€é—®é¢˜ï¼šfoodåˆ—çš„å€¼å¤§å°å†™ä¸ç»Ÿä¸€
å¤„ç†åŠæ³•ï¼šç»Ÿä¸€æ”¹ä¸ºå°å†™
3.â€œåˆç†æ€§â€é—®é¢˜ï¼šæŸä¸€è¡Œçš„ounceså€¼å‡ºç°è´Ÿå€¼
å¤„ç†åŠæ³•ï¼šå°†è¯¥æ¡æ•°æ®è®°å½•åˆ é™¤
4.â€œå”¯ä¸€æ€§â€é—®é¢˜ï¼šfoodåˆ—å¤§å°å†™ç»Ÿä¸€åä¼šå‡ºç°åŒåç°è±¡ï¼Œ
å¤„ç†åŠæ³•ï¼šéœ€è¦å°†foodåˆ—å’Œanimalåˆ—å€¼å‡ç›¸åŒçš„æ•°æ®è®°å½•è¿›è¡Œåˆå¹¶åˆ°åŒä¸€å¤©è®°å½•ä¸­å›½</div>2019-01-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/a3/87/c415e370.jpg" width="30px"><span>æ»¢</span> ğŸ‘ï¼ˆ38ï¼‰ ğŸ’¬ï¼ˆ6ï¼‰<div>åŸå§‹æ•°æ®é“¾æ¥ï¼šhttps:&#47;&#47;github.com&#47;onlyAngelia&#47;Read-Mark&#47;blob&#47;master&#47;æ•°æ®åˆ†æ&#47;geekTime&#47;data&#47;accountMessage.xlsx    ï¼ˆè¯¾ç¨‹ä¸­è®²è§£åŸå§‹æ•°æ®-ç‚¹å‡»view Rawå³å¯ä¸‹è½½ï¼‰
è¯¾åç»ƒä¹ åŸå§‹æ•°æ®: https:&#47;&#47;github.com&#47;onlyAngelia&#47;Read-Mark&#47;blob&#47;master&#47;æ•°æ®åˆ†æ&#47;geekTime&#47;data&#47;foodInformation.xlsx ï¼ˆç‚¹å‡»View Rawä¸‹è½½ï¼‰</div>2019-04-11</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eonMJazpAb9sj7ialYVsumyv9wC1F8RTHpmBPMgj7yNDmof7cpuONtultJc8NRlLyQ34uHjmxByfPg/132" width="30px"><span>Geek_5hxn61</span> ğŸ‘ï¼ˆ27ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>import pandas as pd
&quot;&quot;&quot;åˆ©ç”¨Pandasæ¸…æ´—ç¾é£Ÿæ•°æ®&quot;&quot;&quot;

# è¯»å–csvæ–‡ä»¶
df = pd.read_csv(&quot;c.csv&quot;)

df[&#39;food&#39;] = df[&#39;food&#39;].str.lower()  # ç»Ÿä¸€ä¸ºå°å†™å­—æ¯
df.dropna(inplace=True)  # åˆ é™¤æ•°æ®ç¼ºå¤±çš„è®°å½•
df[&#39;ounces&#39;] = df[&#39;ounces&#39;].apply(lambda a: abs(a))  # è´Ÿå€¼ä¸åˆæ³•ï¼Œå–ç»å¯¹å€¼

# æŸ¥æ‰¾foodé‡å¤çš„è®°å½•ï¼Œåˆ†ç»„æ±‚å…¶å¹³å‡å€¼
d_rows = df[df[&#39;food&#39;].duplicated(keep=False)]
g_items = d_rows.groupby(&#39;food&#39;).mean()
g_items[&#39;food&#39;] = g_items.index
print(g_items)

# éå†å°†é‡å¤foodçš„å¹³å‡å€¼èµ‹å€¼ç»™df
for i, row in g_items.iterrows():
    df.loc[df.food == row.food, &#39;ounces&#39;] = row.ounces
df.drop_duplicates(inplace=True)  # åˆ é™¤é‡å¤è®°å½•

df.index = range(len(df))  # é‡è®¾ç´¢å¼•å€¼
print(df)</div>2019-02-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/37/d0/26975fba.jpg" width="30px"><span>è¥¿å—ååŒ—</span> ğŸ‘ï¼ˆ16ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è¿™äº›ä¸œè¥¿ï¼Œå¤§å®¶éƒ½ä¸€å®šè¦ä¸Šæ‰‹å»å®ç°ä¸€éã€‚æœ€ç®€å•çš„å°±æ˜¯ï¼Œæä¸€ä¸ªæ–‡æœ¬ï¼ŒæŠŠè¿™äº›æ•°æ®æ”¾è¿›å»ï¼Œç”¨Pythonè¯»è¿™ä¸ªæ–‡æœ¬ï¼Œè½¬æˆdataframeï¼ŒæŠŠè€å¸ˆè®²çš„é‚£äº›æ¸…æ´—ç›¸å…³çš„APIéƒ½ä¸€ä¸ªä¸€ä¸ªè¯•ä¸€ä¸‹ï¼Œæ‰ä¼šæœ‰ä½“ä¼šï¼Œå…‰çœ‹ä¸€éçœŸçš„æ²¡å•¥ç”¨çš„ï¼
ç°åœ¨åªæ˜¯å¾ˆå°‘çš„å‡ åæ¡æ•°æ®ï¼Œç­‰ä½ çœŸæ­£å»æé‚£äº›ä¸Šäº¿çš„æ•°æ®çš„æ—¶å€™ï¼Œå°±çŸ¥é“æ ¸å¯¹æ•°æ®æ˜¯ä¸ªå¤šä¹ˆå¤æ‚çš„äº‹æƒ…äº†â€¦â€¦</div>2019-01-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/a3/87/c415e370.jpg" width="30px"><span>æ»¢</span> ğŸ‘ï¼ˆ9ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>è§‰å¾—å®Œå…¨åˆä¸€åŸåˆ™æŒºå¥½ï¼Œä¸è¿‡æœ‰äº›æ“ä½œé¡ºåºæ˜¯ä¸æ˜¯å¾—æ›´æ”¹ä¸€ä¸‹ï¼Œæ¯”å¦‚æ•°å€¼è¡¥å…¨è¦åœ¨åˆ é™¤å…¨ç©ºè¡Œä¹‹åï¼Œå¦åˆ™åœ¨è¡¥å…¨çš„æ—¶å€™å…¨ç©ºè¡Œä¹Ÿä¼šè¡¥å…¨ã€‚æ¥ä¸‹æ¥æ€»ç»“åœ¨æ¸…æ´—è¿‡ç¨‹ä¸­çš„é—®é¢˜ï¼šï¼ˆ1ï¼‰ ä¸çŸ¥é“Python2 æ‰§è¡Œæƒ…å†µå¦‚ä½•ï¼Œåœ¨ç”¨Python3è¿›è¡Œæ•°æ®æ¸…ç†çš„æ—¶å€™ï¼Œå¯¹äºå¥³æ€§ä¸‰å›´æ•°æ®è¡¥å…¨çš„æ—¶å€™å› ä¸ºåˆ—ä¸­æœ‰ç©ºå­—ç¬¦çš„å­˜åœ¨ï¼Œä¼šæç¤ºâ€˜must str not intâ€™,éœ€è¦è‡ªå·±è¿‡æ»¤å«æœ‰æ•°å€¼çš„æœ‰æ•ˆæ•°æ®è¿›è¡Œmean()è®¡ç®—ã€‚  (2)ç”Ÿæˆçš„æ–°åˆ—ä¸€èˆ¬ä¼šè‡ªåŠ¨è¡¥åˆ°åé¢ï¼Œä½†first_name,last_nameéœ€è¦åœ¨ç¬¬ä¸€åˆ—å’Œç¬¬äºŒåˆ—ï¼Œæ‰€ä»¥è¦è¿›è¡Œåˆ—ç§»åŠ¨æˆ–åˆ—äº¤æ¢ã€‚(3)åœ¨åˆ é™¤æ•°æ®ä¹‹åé»˜è®¤åŠ è½½çš„ç´¢å¼•ä¼šå‡ºç°é—®é¢˜ï¼Œéœ€è¦è‡ªå·±æ›´æ–°ç´¢å¼•</div>2019-04-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/60/de/5c67895a.jpg" width="30px"><span>å‘¨é£</span> ğŸ‘ï¼ˆ6ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>å®Œæ•´æ€§ï¼šounces åˆ—æ•°æ®ä¸­å­˜åœ¨NAN
å…¨é¢æ€§ï¼šfoodåˆ—æ•°æ®ä¸­å­˜åœ¨å¤§å°å†™ä¸ä¸€è‡´é—®é¢˜
åˆæ³•æ€§ï¼šouncesåˆ—æ•°æ®å­˜åœ¨è´Ÿå€¼
å”¯ä¸€æ€§ï¼šfoodåˆ—æ•°æ®å­˜åœ¨é‡å¤
# -*- coding: utf-8 -*
import pandas as pd
import numpy as np
from pandas import Series, DataFrame
df = pd.read_csv(&#39;.&#47;fooddata.csv&#39;)
# æŠŠounces åˆ—ä¸­çš„NaNæ›¿æ¢ä¸ºå¹³å‡å€¼
df[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(), inplace=True)
# æŠŠfoodåˆ—ä¸­çš„å¤§å†™å­—æ¯å…¨éƒ¨è½¬æ¢ä¸ºå°å†™
df[&#39;food&#39;] = df[&#39;food&#39;].str.lower()
# æŠŠounces åˆ—ä¸­çš„è´Ÿæ•°è½¬åŒ–ä¸ºæ­£æ•°
df[&#39;ounces&#39;]= df[&#39;ounces&#39;].apply(lambda x: abs(x))
#åˆ é™¤foodåˆ—ä¸­çš„é‡å¤å€¼
df.drop_duplicates(&#39;food&#39;,inplace=True)
print (df)
</div>2019-01-12</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJAeZ2VCia2y3bW9N7EMfgBqX8WClXUydwaXDPcK7Bm3XaMnMKx7q5ffA0UuTeJmEusxtQAibf8djCA/132" width="30px"><span>ä¸Šå®˜</span> ğŸ‘ï¼ˆ6ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>weight = int(float((lbs_row[&#39;weight&#39;][:-3])&#47;2.2)
è€å¸ˆå¥½ï¼Œè¿™è¡Œä»£ç ä¸­[ï¼š-3]çš„ä½œç”¨æ˜¯ä»€ä¹ˆå•Šï¼Ÿ


</div>2019-01-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/02/82/abed70a0.jpg" width="30px"><span>åŒ—æ–¹</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>#!&#47;usr&#47;bin&#47;env python
# -*- coding:utf8 -*-
# __author__ = &#39;åŒ—æ–¹å§†Q&#39;
# __datetime__ = 2019&#47;1&#47;11 15:53


import pandas as pd

# å¯¼å…¥
df = pd.read_csv(&quot;.&#47;s11.csv&quot;)
# å»é™¤å®Œå…¨çš„ç©ºè¡Œ
df.dropna(how=&#39;all&#39;, inplace=True)
# é£Ÿç‰©ååˆ‡åˆ†å¹¶å»æ‰åŸæœ¬åˆ—
df[[&quot;first_name&quot;, &quot;last_name&quot;]] = df[&quot;food&quot;].str.split(expand=True)
df.drop(&quot;food&quot;, axis=1, inplace=True)
# åç§°é¦–å­—æ¯å¤§å†™
df[&quot;first_name&quot;] = df[&quot;first_name&quot;].str.capitalize()
df[&quot;last_name&quot;] = df[&quot;last_name&quot;].str.capitalize()
# ä»¥é£Ÿç‰©åä¸ºæ ‡å‡†å»é‡
df.drop_duplicates([&quot;first_name&quot;, &quot;last_name&quot;], inplace=True)

print(df)</div>2019-01-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/18/d0/49b06424.jpg" width="30px"><span>qinggeouye</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>https:&#47;&#47;github.com&#47;qinggeouye&#47;GeekTime&#47;blob&#47;master&#47;DataAnalysis&#47;11_data_clean.py

import pandas as pd

# è¯»å–æ•°æ®
data_init = pd.read_csv(&quot;.&#47;11_clothingStoreMembers.csv&quot;)

# æ¸…æ´—æ•°æ®

# åˆ é™¤ &#39;\t&#39; åˆ—, è¯»å– csv æ–‡ä»¶å¤šäº†ä¸€åˆ—
data_init.drop(columns=&#39;\t&#39;, inplace=True)
# é‡å‘½ååˆ—å
data_init.rename(
    columns={&quot;0&quot;: &quot;SEQ&quot;, &quot;1&quot;: &quot;NAME&quot;, &quot;2&quot;: &quot;AGE&quot;, &quot;3&quot;: &quot;WEIGHT&quot;, &quot;4&quot;: &quot;BUST_M&quot;, &quot;5&quot;: &quot;WAIST_M&quot;, &quot;6&quot;: &quot;HIP_M&quot;,
             &quot;7&quot;: &quot;BUST_F&quot;, &quot;8&quot;: &quot;WAIST_F&quot;, &quot;9&quot;: &quot;HIP_F&quot;}, inplace=True)
print(data_init)

# 1ã€å®Œæ•´æ€§
# åˆ é™¤ç©ºè¡Œ
data_init.dropna(how=&#39;all&#39;, inplace=True)

# 4ã€å”¯ä¸€æ€§
# ä¸€åˆ—å¤šä¸ªå‚æ•°åˆ‡åˆ†
data_init[[&quot;FIRST_NAME&quot;, &quot;LAST_NAME&quot;]] = data_init[&quot;NAME&quot;].str.split(expand=True)
data_init.drop(&quot;NAME&quot;, axis=1, inplace=True)
# åˆ é™¤é‡å¤æ•°æ®
data_init.drop_duplicates([&quot;FIRST_NAME&quot;, &quot;LAST_NAME&quot;], inplace=True)

# 2ã€å…¨é¢æ€§
# åˆ—æ•°æ®å•ä½ç»Ÿä¸€, ä½“é‡ WEIGHT å•ä½ç»Ÿä¸€ï¼ˆlbs è‹±é•‘ï¼Œ kg åƒå…‹ï¼‰
rows_with_lbs = data_init[&quot;WEIGHT&quot;].str.contains(&quot;lbs&quot;).fillna(False)
print(rows_with_lbs)
# lbs è½¬ä¸º kg
for i, lbs_row in data_init[rows_with_lbs].iterrows():
    weight = int(float(lbs_row[&quot;WEIGHT&quot;][:-3]) &#47; 2.2)
    data_init.at[i, &quot;WEIGHT&quot;] = &quot;{}kgs&quot;.format(weight)
print(data_init)

# 3ã€åˆç†æ€§
# é ASCII å­—ç¬¦è½¬æ¢ï¼Œè¿™é‡Œåˆ é™¤å¤„ç†
data_init[&quot;FIRST_NAME&quot;].replace({r&#39;[^\x00-\x7F]+&#39;: &#39;&#39;}, regex=True, inplace=True)
data_init[&quot;LAST_NAME&quot;].replace({r&#39;[^\x00-\x7F]+&#39;: &#39;&#39;}, regex=True, inplace=True)

# 1ã€å®Œæ•´æ€§
# è¡¥å……ç¼ºå¤±å€¼-å‡å€¼è¡¥å……
data_init[&quot;AGE&quot;].fillna(data_init[&quot;AGE&quot;].mean(), inplace=True)
# ä½“é‡å…ˆå»æ‰ kgs çš„å•ä½ç¬¦å·
data_init[&quot;WEIGHT&quot;].replace(&#39;kgs$&#39;, &#39;&#39;, regex=True, inplace=True)  # ä¸å¸¦å•ä½ç¬¦å· kgs
data_init[&quot;WEIGHT&quot;] = data_init[&quot;WEIGHT&quot;].astype(&#39;float&#39;)
data_init[&quot;WEIGHT&quot;].fillna(data_init[&quot;WEIGHT&quot;].mean(), inplace=True)

data_init.replace(&#39;-&#39;, 0, regex=True, inplace=True)  # è¯»å–çš„ csv æ•°æ®å¤šäº†&#39;-&#39;
data_init[&quot;WAIST_F&quot;] = data_init[&quot;WAIST_F&quot;].astype(&#39;float&#39;)
data_init[&quot;WAIST_F&quot;].fillna(data_init[&quot;WAIST_F&quot;].mean(), inplace=True)

# ç”¨æœ€é«˜é¢‘çš„æ•°æ®å¡«å……
age_max_freq = data_init[&quot;AGE&quot;].value_counts().index[0]
print(age_max_freq)
data_init[&quot;AGE&quot;].fillna(age_max_freq, inplace=True)
print(data_init)</div>2019-11-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/8e/6d/c68e07ef.jpg" width="30px"><span>Chino</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æœ‰ä¸€ä¸ªé—®é¢˜ å°±æ˜¯ä»£ç æœ€åé‚£é‡Œto_excel å¦‚æœå‚æ•°çš„è·¯å¾„æ˜¯æŒ‡å®šçš„é‚£ç§ å°±ä¼šæŠ¥é”™æ˜¾ç¤ºfilenotfound æœäº†å¾ˆä¹…éƒ½æ²¡æ‰¾åˆ°æ˜¯ä»€ä¹ˆåŸå›  æ±‚è§£
å¦å¤–æ„Ÿè§‰è¿™ä¸€è®²æœ‰å¥½å¤šç‚¹éƒ½æ²¡è®²æ·±å…¥å‘€ ä¸‹é¢ä»£ç æ˜¯å¯¹è¯¾ç¨‹ä¸­çš„æ ·ä¾‹è¿›è¡Œæ¸…æ´— æ„Ÿè§‰åªèƒ½åšåˆ°å‡ å°ç‚¹äº†. ç‰¹åˆ«æ˜¯åœ¨å¡«å……nanå€¼çš„æ—¶å€™ ä¸€å¼€å§‹æƒ³ç€éå†æ¯ä¸€ä¸ªnanå€¼ ç„¶åå†ç‰¹åˆ¤åˆ—çš„ç±»å‹è¿›è¡Œå¡«å……çš„. ä½†æ˜¯å‘ç°ä¸‰å›´é‚£é‡Œæœ‰ä¸ªå¤§é—®é¢˜ æŒ‰ç†è¯´ä¸‰å›´åº”è¯¥æ˜¯intç±»å‹ ä½†æ˜¯å› ä¸ºæœ‰- è¿™ä¸ªä¸œè¥¿çš„å­˜åœ¨ æçš„ä¸‰å›´æ˜¯objectç±»å‹ ä¸€å¼€å§‹èµ‹å€¼çš„æ—¶å€™æŠ¥é”™æç¤ºéœ€è¦str åæ¥æƒ³æŠŠåˆ—çš„ç±»å‹è½¬æ¢æˆintä¹Ÿå¤±è´¥äº† è¿˜æœ‰å¥½å¤šåœ°æ–¹éƒ½å¡ç€äº†...
import pandas as pd
import numpy as np
from pandas import Series, DataFrame

data = DataFrame(pd.read_excel(&#39;~&#47;Desktop&#47;data.xlsx&#39;))

print(data)

# æ›´æ”¹åˆ—å
data.rename(columns={0:&#39;åºå·&#39;,1:&#39;å§“å&#39;,2:&#39;å¹´é¾„&#39;,3:&#39;ä½“é‡&#39;,4:&#39;ç”·ä¸‰å›´1&#39;,5:&#39;ç”·ä¸‰å›´2&#39;,6:&#39;ç”·ä¸‰å›´3&#39;,7:&#39;å¥³ä¸‰å›´1&#39;,8:&#39;å¥³ä¸‰å›´2&#39;,9:&#39;å¥³ä¸‰å›´3&#39;},inplace = True)

# å»æ‰é‡å¤è¡Œ
data = data.drop_duplicates()

# 1.å®Œæ•´æ€§
# å¡«å……ç¼ºå¤±å€¼
col = data.columns.values.tolist()
row = data._stat_axis.values.tolist()

# å…ˆæŠŠå§“åçš„æ•°æ®ç±»å‹æ”¹æˆå­—ç¬¦ä¸²
data[&#39;å§“å&#39;] = data[&#39;å§“å&#39;].astype(&#39;str&#39;) 

# 1.1 å…ˆæ¸…é™¤ç©ºè¡Œ
data.dropna(how = &#39;all&#39;, inplace = True)

# 1.2 å¡«å……ç¼ºå¤±å€¼
age_maxf = data[&#39;å¹´é¾„&#39;].value_counts().index[0]

# ä»¥å¹´é¾„é¢‘ç‡æœ€å¤§å€¼æ¥å¡«å……
data[&#39;å¹´é¾„&#39;].fillna(age_maxf, inplace=True)

# 2.å…¨é¢æ€§
# æŠŠä½“é‡å•ä½ä¸ºlbsçš„è½¬åŒ–ä¸ºkgs 2.2lbs = 1kgs
# æŠŠæ‰€æœ‰ä½“é‡å•ä½ä¸ºlbsçš„è®°å½•å­˜æ”¾åœ¨ä¸€èµ· (å¦‚æœä½“é‡æ˜¯nanåˆ™ä¸è¦)
rows_with_lbs = data[&#39;ä½“é‡&#39;].str.contains(&#39;lbs&#39;).fillna(False)

for i,lbs_row in data[rows_with_lbs].iterrows():
    weight = int(float(lbs_row[&#39;ä½“é‡&#39;][:-3]) &#47; 2.2)
    # ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯yåæ ‡(ç«–) ç¬¬äºŒä¸ªå‚æ•°æ˜¯xåæ ‡(æ¨ª) 
    data.at[i,&#39;ä½“é‡&#39;] = &#39;{}kgs&#39;.format(weight)

print(data)

# æŠŠæ¸…æ´—åçš„æ•°æ®è¾“å‡º
data.to_excel(&#39;CleanData.xlsx&#39;)
# ä¼šæŠ¥é”™
# data.to_excel(&#39;~&#47;Desktop&#47;CleanData.xlsx&#39;)</div>2019-01-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/24/b0/a6e0b03a.jpg" width="30px"><span>ä¸€è¯­ä¸­çš„</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>#pdè¯»å–æ•°æ®
df = pd.read_excel(&#39;testdata11.xlsx&#39;)
#1.å®Œæ•´æ€§ï¼Œouncesåˆ—NAå€¼ç”¨å¹³å‡å€¼å¡«å……
df[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(), inplace=True)
#2.å…¨é¢æ€§ï¼Œç»Ÿä¸€foodåˆ—å¤§å°å†™
df[&#39;food&#39;] = df[&#39;food&#39;].str.lower()
#3.åˆæ³•æ€§ï¼Œouncesåˆ—è´Ÿå€¼å–ç»å¯¹å€¼
df[&#39;ounces&#39;] = df[&#39;ounces&#39;].apply(lambda x: abs(x))
#4.å”¯ä¸€æ€§.animalåˆ—æœ‰é‡å¤å€¼
df.drop_duplicates(&#39;food&#39;, inplace=True)
#5.é‡æ–°æ’åºæ˜¾ç¤º
df.reset_index(drop=True, inplace=True)
print(df)

</div>2019-02-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/f9/81/54b1a5a8.jpg" width="30px"><span>littlePerfect</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>import pandas as pd

df = pd.read_excel(&quot;E:\data_analys_work&#47;food_data.xlsx&quot;)

# 1. å®Œæ•´æ€§é—®é¢˜: ç¼ºå¤±å€¼
# df[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(),inplace=True) # å¹³å‡å€¼
ounces_maxf = df[&#39;ounces&#39;].value_counts().index[0] # å‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼
df[&#39;ounces&#39;].fillna(ounces_maxf, inplace=True)

# 2. å…¨é¢æ€§é—®é¢˜: åˆ—é¦–å­—æ¯ä¸ç»Ÿä¸€
df[&#39;food&#39;] = df[&#39;food&#39;].str.title()

# 3. åˆç†æ€§é—®é¢˜: åˆ—æ•°æ®çš„å•ä½ä¸ç»Ÿä¸€
df[&#39;ounces&#39;] = df[&#39;ounces&#39;].apply(lambda x: abs(x))

# 4. å”¯ä¸€æ€§é—®é¢˜: é£Ÿç‰©é‡å¤å‡ºç°,æ±‚å’Œåˆå¹¶,å¹¶åˆ é™¤å¤šä½™è¡Œ
# æ²¡æƒ³å‡ºæ¥.....
</div>2019-02-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg" width="30px"><span>Geek_hve78z</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>1ã€å®Œæ•´æ€§ï¼š
åœ¨ouncesä¸€åˆ—ï¼Œå­˜åœ¨ç¼ºå¤±å€¼ã€‚å¤„ç†æ­¥éª¤ï¼šåˆ é™¤ï¼Œå› ä¸ºæœ‰é‡å¤å€¼
2ã€å…¨é¢æ€§ï¼š
foodåˆ—é¦–å­—æ¯å¤§å°å†™ä¸ç»Ÿä¸€ã€‚å¤„ç†æ­¥éª¤ï¼šåˆ©ç”¨DataFrame.columns.str.lower()å…¨éƒ¨æ¢æˆå°å†™
3ã€åˆæ³•æ€§ï¼š
åœ¨é‡é‡ä¸€åˆ—ï¼Œå­˜åœ¨è´Ÿæ•°ã€‚å¤„ç†æ­¥éª¤ï¼Œåˆ é™¤
4ã€å”¯ä¸€æ€§ï¼š
åœ¨é£Ÿå“åç§°ä¸€åˆ—ï¼Œç»Ÿä¸€å¤§å°å†™åï¼Œå­˜åœ¨é‡å¤å€¼ã€‚å¤„ç†ï¼šæ±‚å’Œåˆå¹¶</div>2019-02-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/8e/6d/c68e07ef.jpg" width="30px"><span>Chino</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ä½œä¸š
import pandas as pd
import numpy as py
from pandas import Series, DataFrame

data = DataFrame(pd.read_excel(&#39;~&#47;Desktop&#47;HomeworkData.xlsx&#39;))

# æŠŠé£Ÿç‰©çš„åå­—ç»Ÿä¸€å¤§å°å†™
data[&#39;food&#39;] = data[&#39;food&#39;].str.title()

# å®Œæ•´æ€§
# å¡«å……ç©ºå€¼
data[&#39;ounces&#39;].fillna(data[&#39;ounces&#39;].mean(), inplace = True)

# å…¨é¢æ€§
# æ²¡æœ‰å‘ç°é—®é¢˜

# åˆç†æ€§
# ounceså€¼åº”å¤§äºç­‰äº0 è´Ÿå€¼å–ç»å¯¹å€¼
data[&#39;ounces&#39;][data[&#39;ounces&#39;] &lt; 0] = data[&#39;ounces&#39;][data[&#39;ounces&#39;] &lt; 0] * -1

# å”¯ä¸€æ€§
# æ¸…é™¤é£Ÿç‰©åé‡å¤çš„æ•°æ®
data.drop_duplicates(&#39;food&#39;,inplace = True)

data.to_excel(&#39;HomeworkCleanData.xlsx&#39;)
</div>2019-01-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/5e/cb/ad85b408.jpg" width="30px"><span>é»ƒå–»æ¦†</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>1. å®Œæ•´æ€§: æœ‰ä¸€æ ¼ç¼ºå¤±å€¼
2. å…¨é¢æ€§: å–®ä½ä¸çµ±ä¸€ï¼Œfoodæ¬„ä½å€¼æœ‰å¤§å°å¯«ï¼Œä¸ä¸€è‡´
3. åˆç†æ€§: è‹¥é€™æ˜¯ç‰©æ–™æ§ç®¡æ¸…å–®ï¼Œè² å€¼å¯èƒ½æ˜¯å‡ºè²¨ï¼Œæ‰€ä»¥æ¸›å°‘åº«å­˜ã€‚éœ€è¦è·Ÿæ¥­ä¸»ç¢ºèªã€‚
4. å”¯ä¸€æ€§: è‹¥æ˜¯å‡ºè²¨ç´€éŒ„ï¼Œå°±æ²’å¿…è¦è¦æ±‚foodæ¬„ä½æ˜¯å”¯ä¸€ã€‚</div>2021-02-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1f/17/01/1c5309a3.jpg" width="30px"><span>McKee Chen</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>#ç»ƒä¹ 
æˆ‘çš„æ€è€ƒï¼šä»excelä¸­æ‰“å¼€æ•°æ®ï¼Œå¯¹å…¶ç©ºç™½å€¼è¿›è¡Œå¡«å……ï¼Œç„¶åå¯¹foodåˆ—çš„å€¼å…¨éƒ¨å°å†™ï¼Œå†æŒ‰foodå’Œanimalå¯¹æ•°æ®è¿›è¡Œåˆ†ç±»ï¼Œè®¡ç®—ounceså‡å€¼ï¼Œæœ€åæ•°æ®è¾“å‡ºæˆæ–°çš„excel
import pandas as pd
import numpy as np
from pandas import Series,DataFrame
#å»ºç«‹æ•°æ®è¡¨
df1 = pd.read_excel(r&#39;C:\Users\XXX\Desktop\0928.xlsx&#39;)
#ç”¨ounces.mean()å¡«å……ç©ºç™½å€¼
df1[&#39;ounces&#39;].fillna(df1[&#39;ounces&#39;].mean(), inplace=True)
#å°†foodåˆ—å…¨éƒ¨å°å†™
for i in range(9):
    df1.at[i,&#39;food&#39;] = df1[&#39;food&#39;][i].lower()
#é€šè¿‡groupbyå¯¹ç›¸åŒçš„foodå’Œanimalæ±‚ounceså‡å€¼
df1 = df1.groupby([df1[&#39;food&#39;],df1[&#39;animal&#39;]]).mean()
df1.to_excel(r&#39;C:\Users\XXX\Desktop\0928_1.xlsx&#39;)

è€å¸ˆè®²çš„æ•°æ®æ¸…æ´—éå¸¸æ˜“æ‡‚ï¼Œå¾—å¤šåŠ ç»ƒä¹ ï¼Œæ‰èƒ½ç†Ÿèƒ½ç”Ÿå·§ï¼Œå¹¶è¦åšåˆ°æ¸©æ•…çŸ¥æ–°</div>2020-09-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1f/da/9d/1f825568.jpg" width="30px"><span>æ‹¾å…‰</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è¿™æ˜¯ocrè¯†åˆ«çš„æºæ•°æ®ï¼Œä¾›å®éªŒç”¨
[[&quot;bacon&quot;, 4.0, &quot;pig&quot;],
[&quot;pulled pork&quot;, 3.0, &quot;pig&quot;],
[&quot;bacon&quot;, NaN , &quot;pig&quot;],
[&quot;Pastrami&quot;, 6.0, &quot;cow&quot;],
[&quot;corned beef&quot;, 7.5, &quot;cow&quot;],
[&quot;Bacon&quot;, 8.0, &quot;pig&quot;],
[&quot;pastrami&quot;, 3.0, &quot;cow&quot;],
[&quot;honey ham&quot;, 5.0, &quot;pig&quot;],
[&quot;nova lox&quot;, 6.0, &quot;salmon&quot;]]</div>2020-08-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1f/3c/b8/cd7dc389.jpg" width="30px"><span>çƒ­æ²³</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>import pandas as pd

file_path = &quot;.&#47;foodInformation.csv&quot;
df = pd.read_csv(file_path)
#æ•°æ®æ¸…æ´—å››é¡¹åŸºæœ¬åŸåˆ™
#1ã€å®Œæ•´æ€§ï¼šç¼ºå¤±ã€ç©ºè¡Œ
#åˆ é™¤ç©ºè¡Œ,howä¸å†™å«æœ‰nançš„è¡Œå…¨éƒ¨åˆ é™¤
df.dropna(how=&quot;all&quot;, inplace=True)

#å‡å€¼æ›¿æ¢
#df[&quot;ounces&quot;].fillna(df[&quot;ounces&quot;].mean(), inplace=True)
#é«˜é¢‘æ›¿æ¢
ou_maxf = df[&quot;ounces&quot;].value_counts().index[0]
df[&quot;ounces&quot;].fillna(ou_maxf, inplace=True)

#2ã€åˆæ³•æ€§ï¼šè´Ÿæ•°è½¬ä¸ºæ­£æ•°
# for i in df[&quot;ounces&quot;]:
#     if i&lt;0:
#         i = abs(i)
df[&quot;ounces&quot;] = df[&quot;ounces&quot;].apply(lambda a: abs(a))

#åˆæ³•æ€§ï¼šç»Ÿä¸€å¤§å°å†™
df[&quot;food&quot;] = df[&quot;food&quot;].str.lower()

#å”¯ä¸€æ€§ï¼šåˆ é™¤é‡å¤
df.drop_duplicates(&quot;food&quot;, inplace=True)

#æ’åº
df_sort = df.sort_values(by=[&quot;ounces&quot;], axis=0, ascending=True)

print(df_sort)
</div>2020-07-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1f/3c/b8/cd7dc389.jpg" width="30px"><span>çƒ­æ²³</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>import pandas as pd

file_path = &quot;.&#47;foodInformation.csv&quot;
df = pd.read_csv(file_path)
#æ•°æ®æ¸…æ´—å››é¡¹åŸºæœ¬åŸåˆ™
#1ã€å®Œæ•´æ€§ï¼šç¼ºå¤±ã€ç©ºè¡Œ
#åˆ é™¤ç©ºè¡Œ,howä¸å†™å«æœ‰nançš„è¡Œå…¨éƒ¨åˆ é™¤
df.dropna(how=&quot;all&quot;, inplace=True)

#å‡å€¼æ›¿æ¢
#df[&quot;ounces&quot;].fillna(df[&quot;ounces&quot;].mean(), inplace=True)
#é«˜é¢‘æ›¿æ¢
ou_maxf = df[&quot;ounces&quot;].value_counts().index[0]
df[&quot;ounces&quot;].fillna(ou_maxf, inplace=True)

#2ã€åˆæ³•æ€§ï¼šè´Ÿæ•°è½¬ä¸ºæ­£æ•°
# for i in df[&quot;ounces&quot;]:
#     if i&lt;0:
#         i = abs(i)
df[&quot;ounces&quot;] = df[&quot;ounces&quot;].apply(lambda a: abs(a))

#åˆæ³•æ€§ï¼šç»Ÿä¸€å¤§å°å†™
df[&quot;food&quot;] = df[&quot;food&quot;].str.lower()

#å”¯ä¸€æ€§ï¼šåˆ é™¤é‡å¤
df.drop_duplicates(&quot;food&quot;, inplace=True)

#æ’åº
df_sort = df.sort_values(by=[&quot;ounces&quot;], axis=0, ascending=True)

print(df_sort)
</div>2020-07-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1f/0e/3d/ded8bc06.jpg" width="30px"><span>As1m0v</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>Python3 
Jupyter Notebook
ç»ƒä¹ é¢˜å›ç­”
# æ ¹æ®ouncesåˆ—åˆ é™¤å«æœ‰ç¼ºå¤±å€¼æ•°æ®é¡¹
file2.dropna(subset = [&#39;ounces&#39;], inplace = True)

# å°†foodåˆ—ä¸­æ¯ä¸€è¡Œæ•°æ®ç»Ÿä¸€å¤§å°å†™
file2[&#39;food&#39;] = file2[&#39;food&#39;].str.lower()

# å°†ouncesåˆ—ä¸­æ•°æ®ç»Ÿä¸€ä¸ºæ­£æ•°(æ–¹æ³•ä¸€)
file2[&#39;ounces&#39;] = file2[&#39;ounces&#39;].abs()

# å°†ouncesåˆ—ä¸­å¼‚å¸¸æ•°æ®åˆ é™¤(æ–¹æ³•äºŒ)
# è¿™ç§æƒ…å†µä¸‹ï¼Œè¿™ä¸€æ–¹æ³•å¯ä»¥å’Œç¬¬ä¸€æ¡åˆå¹¶
#file2 = file2[file2[&#39;ounces&#39;]&gt;0]

# å°†å…·æœ‰ç›¸åŒfoodåˆ—å€¼å’Œanimalåˆ—å€¼çš„æ•°æ®ï¼ˆå¯é€‰ï¼‰
file3 = file2.groupby([&#39;food&#39;,&#39;animal&#39;]).sum()</div>2020-06-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1e/54/d9/76a53118.jpg" width="30px"><span>æ¸…é£</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>import pandas as pd
import numpy as np
df = pd.DataFrame({&#39;food&#39;:[&#39;bacon&#39;, &#39;pulled pork&#39;, &#39;bacon&#39;, &#39;Pastrami&#39;, &#39;corned beef&#39;, &#39;Bacon&#39;, &#39;pastrami&#39;, &#39;honey ham&#39;, &#39;nova lox&#39;],
                  &#39;ounces&#39;:[4.0, 3.0, None, 6.0, 7.5, 8.0, -3.0, 5.0, 6.0],
                  &#39;animal&#39;:[&#39;pig&#39;, &#39;pig&#39;, &#39;pig&#39;, &#39;cow&#39;, &#39;cow&#39;, &#39;pig&#39;, &#39;cow&#39;, &#39;pig&#39;, &#39;salmon&#39;]},
                 columns=[&#39;food&#39;, &#39;ounces&#39;, &#39;animal&#39;])
df
df.isnull().any()
# å¤„ç†Noneå€¼ èµ‹å€¼ä¸ºé«˜é¢‘è¯
# è¿™é‡Œåˆå§‹å¤„ç†æ—¶æŒ‰èµ‹å€¼ åæ¥å‘ç°åˆ é™¤å¯èƒ½æ›´å¥½ä¸€ç‚¹
# df[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].value_counts().index[0], inplace=True)
df.dropna(inplace=True)
# æŠŠè´Ÿå€¼èµ‹å€¼ä¸º6.0
# df[&#39;ounces&#39;].where(df[&#39;ounces&#39;] &gt; 0, df[&#39;ounces&#39;].value_counts().index[0])
# ç»å¯¹å€¼å¤„ç†
df[&#39;ounces&#39;] = df[&#39;ounces&#39;].apply(lambda x:abs(x))
df
df[&#39;food&#39;] = df[&#39;food&#39;].str.lower()
items = df.groupby(&#39;food&#39;).mean()
items[&#39;food&#39;] = items.index
for i, row in items.iterrows():
    df.loc[df[&#39;food&#39;] == row[&#39;food&#39;],&#39;ounces&#39;] = row[&#39;ounces&#39;]
df.drop_duplicates(inplace=True)
df.reset_index(inplace=True, drop=True)
df</div>2020-06-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/3c/a2/09a2215c.jpg" width="30px"><span>å¤•å­</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ï¼ˆ1ï¼‰å®Œæ•´æ€§ï¼šouncesåˆ—å­˜åœ¨ç©ºå€¼NaN
æ¸…æ´—æ–¹å¼ï¼šç”¨å‡å€¼å¡«å……
ï¼ˆ2ï¼‰å…¨é¢æ€§ï¼šfoodåˆ—å¤§å°å†™ä¸ç»Ÿä¸€
æ¸…æ´—æ–¹å¼ï¼šç»Ÿä¸€ä¸ºå°å†™
ï¼ˆ3ï¼‰åˆç†æ€§ï¼šouncesåˆ—å­˜åœ¨è´Ÿå€¼
æ¸…æ´—æ–¹å¼ï¼šåˆ¤æ–­æ˜¯å¦åˆç†ï¼Œè‹¥ä¸åˆç†ï¼Œåˆ é™¤æˆ–è€…å‡å€¼å¡«å……
ï¼ˆ4ï¼‰å”¯ä¸€æ€§ï¼šfoodåˆ—æœ‰é‡å¤
æ¸…æ´—æ–¹å¼ï¼šå»é‡</div>2020-04-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/b5/0d/df1f17b5.jpg" width="30px"><span>å“å“Ÿå“Ÿ</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>1ï¼Œç¬¬å››è¡Œç¬¬äºŒåˆ—ç¼ºå¤±æ•°æ®ï¼Œéœ€åˆ é™¤ã€‚
2ï¼Œå€’æ•°ç¬¬3è¡Œç¬¬2åˆ—æ•°æ®ä¸åˆæ³•ï¼Œéœ€åˆ é™¤ã€‚
3ï¼Œé‡å¤æ•°æ®ï¼Œbaconæœ‰3æ¡æ•°æ®ã€pastramiæœ‰2è¡Œæ•°æ®ï¼Œå¦‚æœæ•°æ®æœ‰æ•ˆéœ€åˆå¹¶ï¼Œå¦åˆ™åˆ é™¤ã€‚
4ï¼Œfoodåˆ—æœ‰å¤§å°å†™ï¼Œéœ€ç»Ÿä¸€æ›¿æ¢ã€‚

æ“ä½œæ­¥éª¤ï¼šå…ˆåˆ é™¤ç©ºå€¼ã€ä¸åˆæ³•æ•°æ®ã€‚æ›¿æ¢å¤§å°å†™ï¼Œåˆå¹¶æœ‰æ•ˆæ•°æ®ã€åˆ é™¤é‡å¤æ•°æ®ã€‚

ç¯å¢ƒå°±æ•´äº†å‡ å¤©ç»“æœè¿˜æ˜¯æ²¡æå®šï¼ŒpyCharmè£…ç¬¬ä¸‰æ–¹åº“é¡ºåˆ©çš„æ—¶å€™çœŸç®€å•ï¼Œä¸€æ—¦æœ‰é—®é¢˜å„ç§å¤æ‚ï¼Œæœ€åç”¨Spyderè·‘äº†ã€æ™¨æ˜Ÿã€‘åŒå­¦çš„ä»£ç ç»ˆäºè·‘é€šäº†ï¼Œå·®ç‚¹åˆæ­»åœ¨ç¯å¢ƒä¸Šã€‚ã€‚ã€‚</div>2020-04-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/4d/dc/6c0a311e.jpg" width="30px"><span>Geek_æ¨—</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>åˆšå¼€å§‹æ¥è§¦è¿™ä¸ªå·¥ä½œæ—¶ï¼Œå°±å› ä¸ºä¸æ³¨æ„æ•°æ®çš„æ•´æ´ï¼ŒçŠ¯äº†ä¸å°‘ç¬‘è¯ã€‚è·‘å‡ºæ¥çš„æŠ¥è¡¨æ•°æ®å“æ­»ä¸ªäººã€‚</div>2020-03-30</li><br/><li><img src="" width="30px"><span>åå…­ã€‚</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>import pandas as pd
from pandas import Series,DataFrame

df = pd.read_csv(&#39;dws&#47;foodInfo.csv&#39;)
# é¦–å…ˆ é€šè¿‡å­¦ä¹ çš„æ•°æ®åˆ†æçš„â€˜å®Œå…¨åˆä¸€â€™ç®€å•æ¸…æ´—å®šç†æ¥åˆ†ææ•°æ®
# æ•°æ®å­˜åœ¨ç©ºå€¼ï¼ˆç©ºå€¼å¯ä»¥åˆ é™¤æˆ–æ˜¯ä½¿ç”¨å‡å€¼å¡«å…¥ï¼Œæ­¤å¤„æˆ‘ä»¬åˆ é™¤ï¼‰ã€å¤§å°å†™ä¸ä¸€ã€å•ä½ä¸åˆç†å­˜åœ¨è´Ÿæ•°
# é¦–å…ˆå»é™¤å¯¼å…¥è¿›æ¥æ—¶å¤šå‡ºå’Œè¡Œ
df = df.dropna()
df = df.drop(df[df[&#39;ounces&#39;] &lt; 0].index)
df[&#39;food&#39;] = df[&#39;food&#39;].str.lower()
# å¯¹æ•°æ®è¿›è¡Œé‡æ–°è¡Œç´¢å¼•
df.index = range(len(df))
# df.reindex(index=list(range(len(df))))
df

	food	ounces	animal
0	bacon	4.0	pig
1	pulled port	3.0	pig
2	pastrami	6.0	cow
3	corned beef	7.5	cow
4	bacon	8.0	pig
5	honey ham	5.0	pig
6	nova lox	6.0	salmon


</div>2020-03-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/6d/ff/d5d14e2c.jpg" width="30px"><span>pyall</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æ•´ç†æ€è·¯ï¼š
1ã€åˆ æ‰æ— æ•ˆæ•°æ®ï¼ˆæ•´è¡Œï¼‰ï¼Œå¹¶å¡«å……ç¼ºå¤±å€¼
2ã€æ·»åŠ æ€§åˆ«åˆ—ï¼Œå¡«å……æ€§åˆ«å€¼
3ã€åˆå¹¶ä¸‰ç»´ï¼ˆä¸‰åˆ—ï¼‰æ•°æ®
4ã€é‡å‘½åè¡¨å¤´å­—æ®µåç§°
5ã€ç¬¬3åˆ—ç»Ÿä¸€æ ‡å‡†å•ä½ï¼Œä¸”æ•°å­—åŒ–

&quot;&quot;&quot;
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

path = r&quot;E:\accountMessage.xlsx&quot;

df = pd.read_excel(path)
df.columns #Index([&#39;\t&#39;, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9], dtype=&#39;object&#39;)
#df.drop([&#39;&#39;])
df = df[[ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9]]
#1ã€åˆ æ‰ç©ºå€¼ï¼ˆæ•´è¡Œï¼‰
df.dropna(axis=0,how=&#39;all&#39;,inplace = True)

#é‡å‘½åè¡¨å¤´å­—æ®µåç§°
df = df.rename(columns = {0:&#39;id&#39;,1:&#39;Name&#39;,2:&#39;Age&#39;,3:&#39;Weight&#39;})
df[&#39;Age&#39;] = df[&#39;Age&#39;].fillna(round(df[&#39;Age&#39;].mean(),0)) #ä½¿ç”¨å¹³å‡æ•°å¡«å……
df[&#39;Age&#39;].value_counts().index[0]#ä½¿ç”¨é¢‘æ•°æœ€é«˜çš„æ•°å¡«å……


#2ã€æ·»åŠ æ€§åˆ«åˆ—ï¼Œå¡«å……æ€§åˆ«å€¼
df[&#39;sex&#39;]=&#39;&#39;
df[&#39;sex&#39;][df[4]==&quot;-&quot;]=&#39;female&#39;
df[&#39;sex&#39;][df[4]!=&quot;-&quot;]=&#39;male&#39;

#3ã€åˆå¹¶ä¸‰ç»´ï¼ˆä¸‰åˆ—ï¼‰æ•°æ®
df[df==&#39;-&#39;]=0
df2 = df.replace(&#39;-&#39;,0)
df2[&#39;d1&#39;] =df2[4] +df2[7]
df2[&#39;d2&#39;] =df2[5] +df2[8]
df2[&#39;d3&#39;] =df2[6] +df2[9]

df3 = df2.drop([4,5,6,7,8,9],axis=1)
df3 = df2.drop([4]) #é»˜è®¤åˆ é™¤è¡Œæ•°æ®

#5ã€ç¬¬3åˆ—ç»Ÿä¸€æ ‡å‡†å•ä½ï¼Œä¸”æ•°å­—åŒ–
#1ç£…(lb)=0.4535924å…¬æ–¤(kg)

df3.isnull().sum()

#æ•°å­—ä¸å­—æ¯åˆ†å¼€,åˆ†æˆä¸¤åˆ—
df3[&#39;Weight&#39;].str.replace(&#39;s&#39;,&quot;z&quot;)
df3[&#39;w_unit&#39;] = df3[&#39;Weight&#39;].str[-3:]
df3[&#39;w_new&#39;] = df3[&#39;Weight&#39;].str[:-3].astype(float)

#è½¬åŒ–å•ä½æ•°å€¼
df3[&#39;w_kg&#39;] = 0
#ä¸æ‰§è¡Œ
df3[df3[&#39;w_unit&#39;]==&#39;lbs&#39;].loc[:,&#39;w_kg&#39;] = df3[&#39;w_new&#39;]*0.4535924
#æ‰§è¡ŒæˆåŠŸ
df3.loc[:,&#39;w_kg&#39;][df3[&#39;w_unit&#39;]==&#39;lbs&#39;] = df3[&#39;w_new&#39;]*0.4535924
df3.loc[:,&#39;w_kg&#39;][df3[&#39;w_unit&#39;]==&#39;kgs&#39;] = df3[&#39;w_new&#39;]</div>2020-03-26</li><br/><li><img src="" width="30px"><span>å‘¨é“­å®‡</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>data = {&#39;food&#39;:[&#39;bacon&#39;,&#39;pulled pork&#39;,&#39;bacon&#39;,&#39;Pastrami&#39;,&#39;couned beef&#39;,&#39;bacon&#39;,&#39;pastrami&#39;,&#39;honey ham&#39;,&#39;nova lox&#39;],
        &#39;ounces&#39;:[4.0,3.0,None,6.0,7.5,8.0,-3.0,5.0,6.0],
        &#39;animal&#39;:[&#39;pig&#39;,&#39;pig&#39;,&#39;pig&#39;,&#39;cow&#39;,&#39;cow&#39;,&#39;pig&#39;,&#39;cow&#39;,&#39;pig&#39;,&#39;salmon&#39;,]}

df1 = DataFrame(data)
df1.columns = df1.columns.str.title() # å¤§å†™å¼€å¤´
df1[&#39;Food&#39;] = df1[&#39;Food&#39;].str.title()
df1[&#39;Ounces&#39;].fillna(df1[&#39;Ounces&#39;].mean(),inplace=True) # å¡«å……ç©ºå€¼
df1[&#39;Ounces&#39;] = df1[&#39;Ounces&#39;].apply(lambda a:abs(a)) # æ›¿æ¢è´Ÿå€¼
df1.sort_values([&#39;Food&#39;],ascending=[False],inplace=True) # é‡æ–°æ’åº
df1.index = range(len(df1)) 
indexArray = [0]
for i in range(1,df1[&#39;Food&#39;].count()): 
    indexArray.append(i)
df1[&#39;Id&#39;] = indexArray
pysqldf = lambda sql: sqldf(sql, globals())
data1 = {&#39;Food&#39;:[&#39;0&#39;]}
lastResult = DataFrame(data1) # åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ® ç”¨æ¥åˆ¤æ–­æ˜¯å¦ä¸ºé‡å¤æ•°æ®
repeatArray = []
for i in range(0,df1[&#39;Food&#39;].count()): # æ‰¾å‡ºåˆ—å€¼å‡ç›¸åŒè¡Œ
    sql = &quot;select * from df1 where Animal = &#39;{}&#39; AND Food = &#39;{}&#39;&quot;.format(df1[&#39;Animal&#39;][i],df1[&#39;Food&#39;][i])
    result = DataFrame(pysqldf(sql))
    if len(result) != 1:
        if result[&#39;Food&#39;][0] != lastResult[&#39;Food&#39;][0]: # åˆ¤æ–­æ˜¯å¦æ•°æ®
            lastResult = result
            repeatArray.append(result)



def calculate(result): # è®¡ç®—å¹³å‡æ•°
    mean = 0.0;
    for i in range(0,result[&#39;Food&#39;].count()):
        mean = result[&#39;Ounces&#39;][i] + mean

    mean = mean &#47; result[&#39;Food&#39;].count()
    return mean

def replaceOunces(result,mean): # å°†å¹³å‡æ•°æ”¹ä¸ºOuncesçš„å€¼

    for i in range(0,result[&#39;Food&#39;].count()):
        resultId = result[&#39;Id&#39;][i]
        df1.Ounces[df1[&#39;Id&#39;]==resultId]=mean


for i in range(0,len(repeatArray)): # åˆæ¬¡æ¸…æ´—
    mean = calculate(repeatArray[i])
    replaceOunces(repeatArray[i],mean)

df1.drop([&#39;Id&#39;],axis=1,inplace=True) #åˆ é™¤
df1.drop_duplicates(inplace=True) # å»é‡
print(df1)

&#39;&#39;&#39;
è¾“å‡ºç»“æœ
          Food    Ounces  Animal
0  Pulled Pork  3.000000     pig
1     Pastrami  4.500000     cow
3     Nova Lox  6.000000  salmon
4    Honey Ham  5.000000     pig
5  Couned Beef  7.500000     cow
6        Bacon  5.520833     pig

&#39;&#39;&#39;</div>2020-03-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/bd/66/bf0cfd22.jpg" width="30px"><span>å¢å˜‰æ•</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æ–‡å­—çš„ç¼ºå¤±è¯¥å¦‚ä½•å®ç°æ•°æ®æ¸…æ´—</div>2019-09-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/e9/e9/1f95e422.jpg" width="30px"><span>æ¨é™†ä¼Ÿ</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>å¾®æœåŠ¡æ¶æ„æä¾›æ•°æ®çš„å¾®æœåŠ¡ä¸­ä¹Ÿå¯ä»¥å¸çº³æ•°æ®æ¸…æ´—çš„æ€æƒ³</div>2019-08-21</li><br/>
</ul>