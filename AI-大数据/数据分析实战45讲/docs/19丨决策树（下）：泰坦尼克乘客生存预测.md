åœ¨å‰é¢çš„ä¸¤ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ç»™ä½ è®²äº†å†³ç­–æ ‘ç®—æ³•ã€‚å†³ç­–æ ‘ç®—æ³•æ˜¯ç»å¸¸ä½¿ç”¨çš„æ•°æ®æŒ–æ˜ç®—æ³•ï¼Œè¿™æ˜¯å› ä¸ºå†³ç­–æ ‘å°±åƒä¸€ä¸ªäººè„‘ä¸­çš„å†³ç­–æ¨¡å‹ä¸€æ ·ï¼Œå‘ˆç°å‡ºæ¥éå¸¸ç›´è§‚ã€‚åŸºäºå†³ç­–æ ‘è¿˜è¯ç”Ÿäº†å¾ˆå¤šæ•°æ®æŒ–æ˜ç®—æ³•ï¼Œæ¯”å¦‚éšæœºæ£®æ—ï¼ˆRandom forestï¼‰ã€‚

ä»Šå¤©æˆ‘æ¥å¸¦ä½ ç”¨å†³ç­–æ ‘è¿›è¡Œé¡¹ç›®çš„å®æˆ˜ã€‚

å†³ç­–æ ‘åˆ†ç±»çš„åº”ç”¨åœºæ™¯éå¸¸å¹¿æ³›ï¼Œåœ¨å„è¡Œå„ä¸šéƒ½æœ‰åº”ç”¨ï¼Œæ¯”å¦‚åœ¨é‡‘èè¡Œä¸šå¯ä»¥ç”¨å†³ç­–æ ‘åšè´·æ¬¾é£é™©è¯„ä¼°ï¼ŒåŒ»ç–—è¡Œä¸šå¯ä»¥ç”¨å†³ç­–æ ‘ç”Ÿæˆè¾…åŠ©è¯Šæ–­ï¼Œç”µå•†è¡Œä¸šå¯ä»¥ç”¨å†³ç­–æ ‘å¯¹é”€å”®é¢è¿›è¡Œé¢„æµ‹ç­‰ã€‚

åœ¨äº†è§£å†³ç­–æ ‘çš„åŸç†åï¼Œä»Šå¤©æˆ‘ä»¬ç”¨sklearnå·¥å…·è§£å†³ä¸€ä¸ªå®é™…çš„é—®é¢˜ï¼šæ³°å¦å°¼å…‹å·ä¹˜å®¢çš„ç”Ÿå­˜é¢„æµ‹ã€‚

## sklearnä¸­çš„å†³ç­–æ ‘æ¨¡å‹

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æŒæ¡sklearnä¸­è‡ªå¸¦çš„å†³ç­–æ ‘åˆ†ç±»å™¨DecisionTreeClassifierï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š

```
clf = DecisionTreeClassifier(criterion='entropy')
```

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œsklearnä¸­åªå®ç°äº†ID3ä¸CARTå†³ç­–æ ‘ï¼Œæ‰€ä»¥æˆ‘ä»¬æš‚æ—¶åªèƒ½ä½¿ç”¨è¿™ä¸¤ç§å†³ç­–æ ‘ï¼Œåœ¨æ„é€ DecisionTreeClassifierç±»æ—¶ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå‚æ•°æ˜¯criterionï¼Œæ„ä¸ºæ ‡å‡†ã€‚å®ƒå†³å®šäº†æ„é€ çš„åˆ†ç±»æ ‘æ˜¯é‡‡ç”¨ID3åˆ†ç±»æ ‘ï¼Œè¿˜æ˜¯CARTåˆ†ç±»æ ‘ï¼Œå¯¹åº”çš„å–å€¼åˆ†åˆ«æ˜¯entropyæˆ–è€…giniï¼š

- entropy: åŸºäºä¿¡æ¯ç†µï¼Œä¹Ÿå°±æ˜¯ID3ç®—æ³•ï¼Œå®é™…ç»“æœä¸C4.5ç›¸å·®ä¸å¤§ï¼›
- giniï¼šé»˜è®¤å‚æ•°ï¼ŒåŸºäºåŸºå°¼ç³»æ•°ã€‚CARTç®—æ³•æ˜¯åŸºäºåŸºå°¼ç³»æ•°åšå±æ€§åˆ’åˆ†çš„ï¼Œæ‰€ä»¥criterion=giniæ—¶ï¼Œå®é™…ä¸Šæ‰§è¡Œçš„æ˜¯CARTç®—æ³•ã€‚

æˆ‘ä»¬é€šè¿‡è®¾ç½®criterion='entropyâ€™å¯ä»¥åˆ›å»ºä¸€ä¸ªID3å†³ç­–æ ‘åˆ†ç±»å™¨ï¼Œç„¶åæ‰“å°ä¸‹clfï¼Œçœ‹ä¸‹å†³ç­–æ ‘åœ¨sklearnä¸­æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Ÿ

```
DecisionTreeClassifier(class_weight=None, criterion='entropy', max_depth=None,
            max_features=None, max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, presort=False, random_state=None,
            splitter='best')
```

è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°äº†å¾ˆå¤šå‚æ•°ï¼Œé™¤äº†è®¾ç½®criterioné‡‡ç”¨ä¸åŒçš„å†³ç­–æ ‘ç®—æ³•å¤–ï¼Œä¸€èˆ¬å»ºè®®ä½¿ç”¨é»˜è®¤çš„å‚æ•°ï¼Œé»˜è®¤å‚æ•°ä¸ä¼šé™åˆ¶å†³ç­–æ ‘çš„æœ€å¤§æ·±åº¦ï¼Œä¸é™åˆ¶å¶å­èŠ‚ç‚¹æ•°ï¼Œè®¤ä¸ºæ‰€æœ‰åˆ†ç±»çš„æƒé‡éƒ½ç›¸ç­‰ç­‰ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥è°ƒæ•´è¿™äº›å‚æ•°ï¼Œæ¥åˆ›å»ºä¸åŒçš„å†³ç­–æ ‘æ¨¡å‹ã€‚

æˆ‘æ•´ç†äº†è¿™äº›å‚æ•°ä»£è¡¨çš„å«ä¹‰ï¼š

![](https://static001.geekbang.org/resource/image/ea/0c/ead008e025a039c8731884ce2e29510c.jpg?wh=620%2A930)

åœ¨æ„é€ å†³ç­–æ ‘åˆ†ç±»å™¨åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨fitæ–¹æ³•è®©åˆ†ç±»å™¨è¿›è¡Œæ‹Ÿåˆï¼Œä½¿ç”¨predictæ–¹æ³•å¯¹æ–°æ•°æ®è¿›è¡Œé¢„æµ‹ï¼Œå¾—åˆ°é¢„æµ‹çš„åˆ†ç±»ç»“æœï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨scoreæ–¹æ³•å¾—åˆ°åˆ†ç±»å™¨çš„å‡†ç¡®ç‡ã€‚

ä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ˜¯fitæ–¹æ³•ã€predictæ–¹æ³•å’Œscoreæ–¹æ³•çš„ä½œç”¨ã€‚

![](https://static001.geekbang.org/resource/image/3c/f8/3c7057b582b8078129c8342cde709ef8.png?wh=468%2A158)

## Titanicä¹˜å®¢ç”Ÿå­˜é¢„æµ‹

**é—®é¢˜æè¿°**

æ³°å¦å°¼å…‹æµ·éš¾æ˜¯è‘—åçš„åå¤§ç¾éš¾ä¹‹ä¸€ï¼Œç©¶ç«Ÿå¤šå°‘äººé‡éš¾ï¼Œå„æ–¹ç»Ÿè®¡çš„ç»“æœä¸ä¸€ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å¾—åˆ°éƒ¨åˆ†çš„æ•°æ®ï¼Œå…·ä½“æ•°æ®ä½ å¯ä»¥ä»GitHubä¸Šä¸‹è½½ï¼š[https://github.com/cystanford/Titanic\_Data](https://github.com/cystanford/Titanic_Data)

ï¼ˆå®Œæ•´çš„é¡¹ç›®ä»£ç è§ï¼š[https://github.com/cystanford/Titanic\_Data/blob/master/titanic\_analysis.py](https://github.com/cystanford/Titanic_Data/blob/master/titanic_analysis.py) ä½ å¯ä»¥è·Ÿç€å­¦ä¹ åè‡ªå·±ç»ƒä¹ ï¼‰

å…¶ä¸­æ•°æ®é›†æ ¼å¼ä¸ºcsvï¼Œä¸€å…±æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼š

- train.csvæ˜¯è®­ç»ƒæ•°æ®é›†ï¼ŒåŒ…å«ç‰¹å¾ä¿¡æ¯å’Œå­˜æ´»ä¸å¦çš„æ ‡ç­¾ï¼›
- test.csv: æµ‹è¯•æ•°æ®é›†ï¼ŒåªåŒ…å«ç‰¹å¾ä¿¡æ¯ã€‚

ç°åœ¨æˆ‘ä»¬éœ€è¦ç”¨å†³ç­–æ ‘åˆ†ç±»å¯¹è®­ç»ƒé›†è¿›è¡Œè®­ç»ƒï¼Œé’ˆå¯¹æµ‹è¯•é›†ä¸­çš„ä¹˜å®¢è¿›è¡Œç”Ÿå­˜é¢„æµ‹ï¼Œå¹¶å‘ŠçŸ¥åˆ†ç±»å™¨çš„å‡†ç¡®ç‡ã€‚

åœ¨è®­ç»ƒé›†ä¸­ï¼ŒåŒ…æ‹¬äº†ä»¥ä¸‹å­—æ®µï¼Œå®ƒä»¬å…·ä½“ä¸ºï¼š

![](https://static001.geekbang.org/resource/image/2c/0a/2c14e00b64a73f40d75451a180c57b0a.png?wh=466%2A370)  
**ç”Ÿå­˜é¢„æµ‹çš„å…³é”®æµç¨‹**

æˆ‘ä»¬è¦å¯¹è®­ç»ƒé›†ä¸­ä¹˜å®¢çš„ç”Ÿå­˜è¿›è¡Œé¢„æµ‹ï¼Œè¿™ä¸ªè¿‡ç¨‹å¯ä»¥åˆ’åˆ†ä¸ºä¸¤ä¸ªé‡è¦çš„é˜¶æ®µï¼š

![](https://static001.geekbang.org/resource/image/6c/7f/6c08ca83a20a969100e5ceddee0ab27f.jpg?wh=2416%2A1127)

1. **å‡†å¤‡é˜¶æ®µ**ï¼šæˆ‘ä»¬é¦–å…ˆéœ€è¦å¯¹è®­ç»ƒé›†ã€æµ‹è¯•é›†çš„æ•°æ®è¿›è¡Œæ¢ç´¢ï¼Œåˆ†ææ•°æ®è´¨é‡ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œæ¸…æ´—ï¼Œç„¶åé€šè¿‡ç‰¹å¾é€‰æ‹©å¯¹æ•°æ®è¿›è¡Œé™ç»´ï¼Œæ–¹ä¾¿åç»­åˆ†ç±»è¿ç®—ï¼›
2. **åˆ†ç±»é˜¶æ®µ**ï¼šé¦–å…ˆé€šè¿‡è®­ç»ƒé›†çš„ç‰¹å¾çŸ©é˜µã€åˆ†ç±»ç»“æœå¾—åˆ°å†³ç­–æ ‘åˆ†ç±»å™¨ï¼Œç„¶åå°†åˆ†ç±»å™¨åº”ç”¨äºæµ‹è¯•é›†ã€‚ç„¶åæˆ‘ä»¬å¯¹å†³ç­–æ ‘åˆ†ç±»å™¨çš„å‡†ç¡®æ€§è¿›è¡Œåˆ†æï¼Œå¹¶å¯¹å†³ç­–æ ‘æ¨¡å‹è¿›è¡Œå¯è§†åŒ–ã€‚

ä¸‹é¢ï¼Œæˆ‘åˆ†åˆ«å¯¹è¿™äº›æ¨¡å—è¿›è¡Œä»‹ç»ã€‚

**æ¨¡å—1ï¼šæ•°æ®æ¢ç´¢**

æ•°æ®æ¢ç´¢è¿™éƒ¨åˆ†è™½ç„¶å¯¹åˆ†ç±»å™¨æ²¡æœ‰å®è´¨ä½œç”¨ï¼Œä½†æ˜¯ä¸å¯å¿½ç•¥ã€‚æˆ‘ä»¬åªæœ‰è¶³å¤Ÿäº†è§£è¿™äº›æ•°æ®çš„ç‰¹æ€§ï¼Œæ‰èƒ½å¸®åŠ©æˆ‘ä»¬åšæ•°æ®æ¸…æ´—ã€ç‰¹å¾é€‰æ‹©ã€‚

é‚£ä¹ˆå¦‚ä½•è¿›è¡Œæ•°æ®æ¢ç´¢å‘¢ï¼Ÿè¿™é‡Œæœ‰ä¸€äº›å‡½æ•°ä½ éœ€è¦äº†è§£ï¼š

- ä½¿ç”¨info()äº†è§£æ•°æ®è¡¨çš„åŸºæœ¬æƒ…å†µï¼šè¡Œæ•°ã€åˆ—æ•°ã€æ¯åˆ—çš„æ•°æ®ç±»å‹ã€æ•°æ®å®Œæ•´åº¦ï¼›
- ä½¿ç”¨describe()äº†è§£æ•°æ®è¡¨çš„ç»Ÿè®¡æƒ…å†µï¼šæ€»æ•°ã€å¹³å‡å€¼ã€æ ‡å‡†å·®ã€æœ€å°å€¼ã€æœ€å¤§å€¼ç­‰ï¼›
- ä½¿ç”¨describe(include=\[â€˜Oâ€™])æŸ¥çœ‹å­—ç¬¦ä¸²ç±»å‹ï¼ˆéæ•°å­—ï¼‰çš„æ•´ä½“æƒ…å†µï¼›
- ä½¿ç”¨headæŸ¥çœ‹å‰å‡ è¡Œæ•°æ®ï¼ˆé»˜è®¤æ˜¯å‰5è¡Œï¼‰ï¼›
- ä½¿ç”¨tailæŸ¥çœ‹åå‡ è¡Œæ•°æ®ï¼ˆé»˜è®¤æ˜¯æœ€å5è¡Œï¼‰ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Pandasä¾¿æ·åœ°å¤„ç†è¿™äº›é—®é¢˜ï¼š

```
import pandas as pd
# æ•°æ®åŠ è½½
train_data = pd.read_csv('./Titanic_Data/train.csv')
test_data = pd.read_csv('./Titanic_Data/test.csv')
# æ•°æ®æ¢ç´¢
print(train_data.info())
print('-'*30)
print(train_data.describe())
print('-'*30)
print(train_data.describe(include=['O']))
print('-'*30)
print(train_data.head())
print('-'*30)
print(train_data.tail())
```

è¿è¡Œç»“æœï¼š

```
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 891 entries, 0 to 890
Data columns (total 12 columns):
PassengerId    891 non-null int64
Survived       891 non-null int64
Pclass         891 non-null int64
Name           891 non-null object
Sex            891 non-null object
Age            714 non-null float64
SibSp          891 non-null int64
Parch          891 non-null int64
Ticket         891 non-null object
Fare           891 non-null float64
Cabin          204 non-null object
Embarked       889 non-null object
dtypes: float64(2), int64(5), object(5)
memory usage: 83.6+ KB
None
------------------------------
       PassengerId    Survived     ...           Parch        Fare
count   891.000000  891.000000     ...      891.000000  891.000000
mean    446.000000    0.383838     ...        0.381594   32.204208
std     257.353842    0.486592     ...        0.806057   49.693429
min       1.000000    0.000000     ...        0.000000    0.000000
25%     223.500000    0.000000     ...        0.000000    7.910400
50%     446.000000    0.000000     ...        0.000000   14.454200
75%     668.500000    1.000000     ...        0.000000   31.000000
max     891.000000    1.000000     ...        6.000000  512.329200

[8 rows x 7 columns]
------------------------------
                                          Name   Sex   ...       Cabin Embarked
count                                      891   891   ...         204      889
unique                                     891     2   ...         147        3
top     Peter, Mrs. Catherine (Catherine Rizk)  male   ...     B96 B98        S
freq                                         1   577   ...           4      644

[4 rows x 5 columns]
------------------------------
   PassengerId  Survived  Pclass    ...        Fare Cabin  Embarked
0            1         0       3    ...      7.2500   NaN         S
1            2         1       1    ...     71.2833   C85         C
2            3         1       3    ...      7.9250   NaN         S
3            4         1       1    ...     53.1000  C123         S
4            5         0       3    ...      8.0500   NaN         S

[5 rows x 12 columns]
------------------------------
     PassengerId  Survived  Pclass    ...      Fare Cabin  Embarked
886          887         0       2    ...     13.00   NaN         S
887          888         1       1    ...     30.00   B42         S
888          889         0       3    ...     23.45   NaN         S
889          890         1       1    ...     30.00  C148         C
890          891         0       3    ...      7.75   NaN         Q

[5 rows x 12 columns]
```

**æ¨¡å—2ï¼šæ•°æ®æ¸…æ´—**

é€šè¿‡æ•°æ®æ¢ç´¢ï¼Œæˆ‘ä»¬å‘ç°Ageã€Fareå’ŒCabinè¿™ä¸‰ä¸ªå­—æ®µçš„æ•°æ®æœ‰æ‰€ç¼ºå¤±ã€‚å…¶ä¸­Ageä¸ºå¹´é¾„å­—æ®µï¼Œæ˜¯æ•°å€¼å‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¹³å‡å€¼è¿›è¡Œè¡¥é½ï¼›Fareä¸ºèˆ¹ç¥¨ä»·æ ¼ï¼Œæ˜¯æ•°å€¼å‹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å…¶ä»–äººè´­ä¹°èˆ¹ç¥¨çš„å¹³å‡å€¼è¿›è¡Œè¡¥é½ã€‚

å…·ä½“å®ç°çš„ä»£ç å¦‚ä¸‹ï¼š

```
# ä½¿ç”¨å¹³å‡å¹´é¾„æ¥å¡«å……å¹´é¾„ä¸­çš„nanå€¼
train_data['Age'].fillna(train_data['Age'].mean(), inplace=True)
test_data['Age'].fillna(test_data['Age'].mean(),inplace=True)
# ä½¿ç”¨ç¥¨ä»·çš„å‡å€¼å¡«å……ç¥¨ä»·ä¸­çš„nanå€¼
train_data['Fare'].fillna(train_data['Fare'].mean(), inplace=True)
test_data['Fare'].fillna(test_data['Fare'].mean(),inplace=True)
```

Cabinä¸ºèˆ¹èˆ±ï¼Œæœ‰å¤§é‡çš„ç¼ºå¤±å€¼ã€‚åœ¨è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸­çš„ç¼ºå¤±ç‡åˆ†åˆ«ä¸º77%å’Œ78%ï¼Œæ— æ³•è¡¥é½ï¼›Embarkedä¸ºç™»é™†æ¸¯å£ï¼Œæœ‰å°‘é‡çš„ç¼ºå¤±å€¼ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠç¼ºå¤±å€¼è¡¥é½ã€‚

é¦–å…ˆè§‚å¯Ÿä¸‹Embarkedå­—æ®µçš„å–å€¼ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š

```
print(train_data['Embarked'].value_counts())
```

ç»“æœå¦‚ä¸‹ï¼š

```
S    644
C    168
Q     77
```

æˆ‘ä»¬å‘ç°ä¸€å…±å°±3ä¸ªç™»é™†æ¸¯å£ï¼Œå…¶ä¸­Sæ¸¯å£äººæ•°æœ€å¤šï¼Œå åˆ°äº†72%ï¼Œå› æ­¤æˆ‘ä»¬å°†å…¶ä½™ç¼ºå¤±çš„Embarkedæ•°å€¼å‡è®¾ç½®ä¸ºSï¼š

```
# ä½¿ç”¨ç™»å½•æœ€å¤šçš„æ¸¯å£æ¥å¡«å……ç™»å½•æ¸¯å£çš„nanå€¼
train_data['Embarked'].fillna('S', inplace=True)
test_data['Embarked'].fillna('S',inplace=True)
```

**æ¨¡å—3ï¼šç‰¹å¾é€‰æ‹©**

ç‰¹å¾é€‰æ‹©æ˜¯åˆ†ç±»å™¨çš„å…³é”®ã€‚ç‰¹å¾é€‰æ‹©ä¸åŒï¼Œå¾—åˆ°çš„åˆ†ç±»å™¨ä¹Ÿä¸åŒã€‚é‚£ä¹ˆæˆ‘ä»¬è¯¥é€‰æ‹©å“ªäº›ç‰¹å¾åšç”Ÿå­˜çš„é¢„æµ‹å‘¢ï¼Ÿ

é€šè¿‡æ•°æ®æ¢ç´¢æˆ‘ä»¬å‘ç°ï¼ŒPassengerIdä¸ºä¹˜å®¢ç¼–å·ï¼Œå¯¹åˆ†ç±»æ²¡æœ‰ä½œç”¨ï¼Œå¯ä»¥æ”¾å¼ƒï¼›Nameä¸ºä¹˜å®¢å§“åï¼Œå¯¹åˆ†ç±»æ²¡æœ‰ä½œç”¨ï¼Œå¯ä»¥æ”¾å¼ƒï¼›Cabinå­—æ®µç¼ºå¤±å€¼å¤ªå¤šï¼Œå¯ä»¥æ”¾å¼ƒï¼›Ticketå­—æ®µä¸ºèˆ¹ç¥¨å·ç ï¼Œæ‚ä¹±æ— ç« ä¸”æ— è§„å¾‹ï¼Œå¯ä»¥æ”¾å¼ƒã€‚å…¶ä½™çš„å­—æ®µåŒ…æ‹¬ï¼šPclassã€Sexã€Ageã€SibSpã€Parchå’ŒFareï¼Œè¿™äº›å±æ€§åˆ†åˆ«è¡¨ç¤ºäº†ä¹˜å®¢çš„èˆ¹ç¥¨ç­‰çº§ã€æ€§åˆ«ã€å¹´é¾„ã€äº²æˆšæ•°é‡ä»¥åŠèˆ¹ç¥¨ä»·æ ¼ï¼Œå¯èƒ½ä¼šå’Œä¹˜å®¢çš„ç”Ÿå­˜é¢„æµ‹åˆ†ç±»æœ‰å…³ç³»ã€‚å…·ä½“æ˜¯ä»€ä¹ˆå…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥äº¤ç»™åˆ†ç±»å™¨æ¥å¤„ç†ã€‚

å› æ­¤æˆ‘ä»¬å…ˆå°†Pclassã€Sexã€Ageç­‰è¿™äº›å…¶ä½™çš„å­—æ®µä½œç‰¹å¾ï¼Œæ”¾åˆ°ç‰¹å¾å‘é‡featuresé‡Œã€‚

```
# ç‰¹å¾é€‰æ‹©
features = ['Pclass', 'Sex', 'Age', 'SibSp', 'Parch', 'Fare', 'Embarked']
train_features = train_data[features]
train_labels = train_data['Survived']
test_features = test_data[features]
```

ç‰¹å¾å€¼é‡Œæœ‰ä¸€äº›æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™æ ·ä¸æ–¹ä¾¿åç»­çš„è¿ç®—ï¼Œéœ€è¦è½¬æˆæ•°å€¼ç±»å‹ï¼Œæ¯”å¦‚Sexå­—æ®µï¼Œæœ‰maleå’Œfemaleä¸¤ç§å–å€¼ã€‚æˆ‘ä»¬å¯ä»¥æŠŠå®ƒå˜æˆSex=maleå’ŒSex=femaleä¸¤ä¸ªå­—æ®µï¼Œæ•°å€¼ç”¨0æˆ–1æ¥è¡¨ç¤ºã€‚

åŒç†Embarkedæœ‰Sã€Cã€Qä¸‰ç§å¯èƒ½ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ”¹æˆEmbarked=Sã€Embarked=Cå’ŒEmbarked=Qä¸‰ä¸ªå­—æ®µï¼Œæ•°å€¼ç”¨0æˆ–1æ¥è¡¨ç¤ºã€‚

é‚£è¯¥å¦‚ä½•æ“ä½œå‘¢ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨sklearnç‰¹å¾é€‰æ‹©ä¸­çš„DictVectorizerç±»ï¼Œç”¨å®ƒå°†å¯ä»¥å¤„ç†ç¬¦å·åŒ–çš„å¯¹è±¡ï¼Œå°†ç¬¦å·è½¬æˆæ•°å­—0/1è¿›è¡Œè¡¨ç¤ºã€‚å…·ä½“æ–¹æ³•å¦‚ä¸‹ï¼š

```
from sklearn.feature_extraction import DictVectorizer
dvec=DictVectorizer(sparse=False)
train_features=dvec.fit_transform(train_features.to_dict(orient='record'))
```

ä½ ä¼šçœ‹åˆ°ä»£ç ä¸­ä½¿ç”¨äº†fit\_transformè¿™ä¸ªå‡½æ•°ï¼Œå®ƒå¯ä»¥å°†ç‰¹å¾å‘é‡è½¬åŒ–ä¸ºç‰¹å¾å€¼çŸ©é˜µã€‚ç„¶åæˆ‘ä»¬çœ‹ä¸‹dvecåœ¨è½¬åŒ–åçš„ç‰¹å¾å±æ€§æ˜¯æ€æ ·çš„ï¼Œå³æŸ¥çœ‹dvecçš„feature\_names\_å±æ€§å€¼ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š

```
print(dvec.feature_names_)
```

è¿è¡Œç»“æœï¼š

```
['Age', 'Embarked=C', 'Embarked=Q', 'Embarked=S', 'Fare', 'Parch', 'Pclass', 'Sex=female', 'Sex=male', 'SibSp']
```

ä½ å¯ä»¥çœ‹åˆ°åŸæœ¬æ˜¯ä¸€åˆ—çš„Embarkedï¼Œå˜æˆäº†â€œEmbarked=Câ€â€œEmbarked=Qâ€â€œEmbarked=Sâ€ä¸‰åˆ—ã€‚Sexåˆ—å˜æˆäº†â€œSex=femaleâ€â€œSex=maleâ€ä¸¤åˆ—ã€‚

è¿™æ ·train\_featuresç‰¹å¾çŸ©é˜µå°±åŒ…æ‹¬10ä¸ªç‰¹å¾å€¼ï¼ˆåˆ—ï¼‰ï¼Œä»¥åŠ891ä¸ªæ ·æœ¬ï¼ˆè¡Œï¼‰ï¼Œå³891è¡Œï¼Œ10åˆ—çš„ç‰¹å¾çŸ©é˜µã€‚

**æ¨¡å—4ï¼šå†³ç­–æ ‘æ¨¡å‹**

åˆšæ‰æˆ‘ä»¬å·²ç»è®²äº†å¦‚ä½•ä½¿ç”¨sklearnä¸­çš„å†³ç­–æ ‘æ¨¡å‹ã€‚ç°åœ¨æˆ‘ä»¬ä½¿ç”¨ID3ç®—æ³•ï¼Œå³åœ¨åˆ›å»ºDecisionTreeClassifieræ—¶ï¼Œè®¾ç½®criterion=â€˜entropyâ€™ï¼Œç„¶åä½¿ç”¨fitè¿›è¡Œè®­ç»ƒï¼Œå°†ç‰¹å¾å€¼çŸ©é˜µå’Œåˆ†ç±»æ ‡è¯†ç»“æœä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œå¾—åˆ°å†³ç­–æ ‘åˆ†ç±»å™¨ã€‚

```
from sklearn.tree import DecisionTreeClassifier
# æ„é€ ID3å†³ç­–æ ‘
clf = DecisionTreeClassifier(criterion='entropy')
# å†³ç­–æ ‘è®­ç»ƒ
clf.fit(train_features, train_labels)
```

**æ¨¡å—5ï¼šæ¨¡å‹é¢„æµ‹&amp;è¯„ä¼°**

åœ¨é¢„æµ‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦å¾—åˆ°æµ‹è¯•é›†çš„ç‰¹å¾å€¼çŸ©é˜µï¼Œç„¶åä½¿ç”¨è®­ç»ƒå¥½çš„å†³ç­–æ ‘clfè¿›è¡Œé¢„æµ‹ï¼Œå¾—åˆ°é¢„æµ‹ç»“æœpred\_labelsï¼š

```
test_features=dvec.transform(test_features.to_dict(orient='record'))
# å†³ç­–æ ‘é¢„æµ‹
pred_labels = clf.predict(test_features)
```

åœ¨æ¨¡å‹è¯„ä¼°ä¸­ï¼Œå†³ç­–æ ‘æä¾›äº†scoreå‡½æ•°å¯ä»¥ç›´æ¥å¾—åˆ°å‡†ç¡®ç‡ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸çŸ¥é“çœŸå®çš„é¢„æµ‹ç»“æœï¼Œæ‰€ä»¥æ— æ³•ç”¨é¢„æµ‹å€¼å’ŒçœŸå®çš„é¢„æµ‹ç»“æœåšæ¯”è¾ƒã€‚æˆ‘ä»¬åªèƒ½ä½¿ç”¨è®­ç»ƒé›†ä¸­çš„æ•°æ®è¿›è¡Œæ¨¡å‹è¯„ä¼°ï¼Œå¯ä»¥ä½¿ç”¨å†³ç­–æ ‘è‡ªå¸¦çš„scoreå‡½æ•°è®¡ç®—ä¸‹å¾—åˆ°çš„ç»“æœï¼š

```
# å¾—åˆ°å†³ç­–æ ‘å‡†ç¡®ç‡
acc_decision_tree = round(clf.score(train_features, train_labels), 6)
print(u'scoreå‡†ç¡®ç‡ä¸º %.4lf' % acc_decision_tree)
```

è¿è¡Œç»“æœï¼š

```
scoreå‡†ç¡®ç‡ä¸º 0.9820
```

ä½ ä¼šå‘ç°ä½ åˆšç”¨è®­ç»ƒé›†åšè®­ç»ƒï¼Œå†ç”¨è®­ç»ƒé›†è‡ªèº«åšå‡†ç¡®ç‡è¯„ä¼°è‡ªç„¶ä¼šå¾ˆé«˜ã€‚ä½†è¿™æ ·å¾—å‡ºçš„å‡†ç¡®ç‡å¹¶ä¸èƒ½ä»£è¡¨å†³ç­–æ ‘åˆ†ç±»å™¨çš„å‡†ç¡®ç‡ã€‚

è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ

å› ä¸ºæˆ‘ä»¬æ²¡æœ‰æµ‹è¯•é›†çš„å®é™…ç»“æœï¼Œå› æ­¤æ— æ³•ç”¨æµ‹è¯•é›†çš„é¢„æµ‹ç»“æœä¸å®é™…ç»“æœåšå¯¹æ¯”ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨scoreå‡½æ•°å¯¹è®­ç»ƒé›†çš„å‡†ç¡®ç‡è¿›è¡Œç»Ÿè®¡ï¼Œæ­£ç¡®ç‡ä¼šæ¥è¿‘äº100%ï¼ˆå¦‚ä¸Šç»“æœä¸º98.2%ï¼‰ï¼Œæ— æ³•å¯¹åˆ†ç±»å™¨çš„åœ¨å®é™…ç¯å¢ƒä¸‹åšå‡†ç¡®ç‡çš„è¯„ä¼°ã€‚

é‚£ä¹ˆæœ‰ä»€ä¹ˆåŠæ³•ï¼Œæ¥ç»Ÿè®¡å†³ç­–æ ‘åˆ†ç±»å™¨çš„å‡†ç¡®ç‡å‘¢ï¼Ÿ

è¿™é‡Œå¯ä»¥ä½¿ç”¨KæŠ˜äº¤å‰éªŒè¯çš„æ–¹å¼ï¼Œäº¤å‰éªŒè¯æ˜¯ä¸€ç§å¸¸ç”¨çš„éªŒè¯åˆ†ç±»å‡†ç¡®ç‡çš„æ–¹æ³•ï¼ŒåŸç†æ˜¯æ‹¿å‡ºå¤§éƒ¨åˆ†æ ·æœ¬è¿›è¡Œè®­ç»ƒï¼Œå°‘é‡çš„ç”¨äºåˆ†ç±»å™¨çš„éªŒè¯ã€‚KæŠ˜äº¤å‰éªŒè¯ï¼Œå°±æ˜¯åšKæ¬¡äº¤å‰éªŒè¯ï¼Œæ¯æ¬¡é€‰å–Kåˆ†ä¹‹ä¸€çš„æ•°æ®ä½œä¸ºéªŒè¯ï¼Œå…¶ä½™ä½œä¸ºè®­ç»ƒã€‚è½®æµKæ¬¡ï¼Œå–å¹³å‡å€¼ã€‚

KæŠ˜äº¤å‰éªŒè¯çš„åŸç†æ˜¯è¿™æ ·çš„ï¼š

1. å°†æ•°æ®é›†å¹³å‡åˆ†å‰²æˆKä¸ªç­‰ä»½ï¼›
2. ä½¿ç”¨1ä»½æ•°æ®ä½œä¸ºæµ‹è¯•æ•°æ®ï¼Œå…¶ä½™ä½œä¸ºè®­ç»ƒæ•°æ®ï¼›
3. è®¡ç®—æµ‹è¯•å‡†ç¡®ç‡ï¼›
4. ä½¿ç”¨ä¸åŒçš„æµ‹è¯•é›†ï¼Œé‡å¤2ã€3æ­¥éª¤ã€‚

åœ¨sklearnçš„model\_selectionæ¨¡å‹é€‰æ‹©ä¸­æä¾›äº†cross\_val\_scoreå‡½æ•°ã€‚cross\_val\_scoreå‡½æ•°ä¸­çš„å‚æ•°cvä»£è¡¨å¯¹åŸå§‹æ•°æ®åˆ’åˆ†æˆå¤šå°‘ä»½ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„Kå€¼ï¼Œä¸€èˆ¬å»ºè®®Kå€¼å–10ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è®¾ç½®CV=10ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ¯”ä¸‹scoreå’Œcross\_val\_scoreä¸¤ç§å‡½æ•°çš„æ­£ç¡®ç‡çš„è¯„ä¼°ç»“æœï¼š

```
import numpy as np
from sklearn.model_selection import cross_val_score
# ä½¿ç”¨KæŠ˜äº¤å‰éªŒè¯ ç»Ÿè®¡å†³ç­–æ ‘å‡†ç¡®ç‡
print(u'cross_val_scoreå‡†ç¡®ç‡ä¸º %.4lf' % np.mean(cross_val_score(clf, train_features, train_labels, cv=10)))
```

è¿è¡Œç»“æœï¼š

```
cross_val_scoreå‡†ç¡®ç‡ä¸º 0.7835
```

ä½ å¯ä»¥çœ‹åˆ°ï¼Œscoreå‡½æ•°çš„å‡†ç¡®ç‡ä¸º0.9820ï¼Œcross\_val\_scoreå‡†ç¡®ç‡ä¸º 0.7835ã€‚

è¿™é‡Œå¾ˆæ˜æ˜¾ï¼Œå¯¹äºä¸çŸ¥é“æµ‹è¯•é›†å®é™…ç»“æœçš„ï¼Œè¦ä½¿ç”¨KæŠ˜äº¤å‰éªŒè¯æ‰èƒ½çŸ¥é“æ¨¡å‹çš„å‡†ç¡®ç‡ã€‚

**æ¨¡å—6ï¼šå†³ç­–æ ‘å¯è§†åŒ–**

sklearnçš„å†³ç­–æ ‘æ¨¡å‹å¯¹æˆ‘ä»¬æ¥è¯´ï¼Œè¿˜æ˜¯æ¯”è¾ƒæŠ½è±¡çš„ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Graphvizå¯è§†åŒ–å·¥å…·å¸®æˆ‘ä»¬æŠŠå†³ç­–æ ‘å‘ˆç°å‡ºæ¥ã€‚

![](https://static001.geekbang.org/resource/image/4a/a0/4ae6016c6c7d1371586c5be015247da0.png?wh=864%2A307)  
å®‰è£…Graphvizåº“éœ€è¦ä¸‹é¢çš„å‡ æ­¥ï¼š

1. å®‰è£…graphvizå·¥å…·ï¼Œè¿™é‡Œæ˜¯å®ƒçš„ä¸‹è½½åœ°å€ï¼›[http://www.graphviz.org/download/](http://www.graphviz.org/download/)
2. å°†Graphvizæ·»åŠ åˆ°ç¯å¢ƒå˜é‡PATHä¸­ï¼›
3. éœ€è¦Graphvizåº“ï¼Œå¦‚æœæ²¡æœ‰å¯ä»¥ä½¿ç”¨pip install graphvizè¿›è¡Œå®‰è£…ã€‚

è¿™æ ·ä½ å°±å¯ä»¥åœ¨ç¨‹åºé‡Œé¢ä½¿ç”¨Graphvizå¯¹å†³ç­–æ ‘æ¨¡å‹è¿›è¡Œå‘ˆç°ï¼Œæœ€åå¾—åˆ°ä¸€ä¸ªå†³ç­–æ ‘å¯è§†åŒ–çš„PDFæ–‡ä»¶ï¼Œå¯è§†åŒ–ç»“æœæ–‡ä»¶Source.gv.pdfä½ å¯ä»¥åœ¨GitHubä¸Šä¸‹è½½ï¼š[https://github.com/cystanford/Titanic\_Data](https://github.com/cystanford/Titanic_Data)

## å†³ç­–æ ‘æ¨¡å‹ä½¿ç”¨æŠ€å·§æ€»ç»“

ä»Šå¤©æˆ‘ç”¨æ³°å¦å°¼å…‹ä¹˜å®¢ç”Ÿå­˜é¢„æµ‹æ¡ˆä¾‹æŠŠå†³ç­–æ ‘æ¨¡å‹çš„æµç¨‹è·‘äº†ä¸€éã€‚åœ¨å®æˆ˜ä¸­ï¼Œä½ éœ€è¦æ³¨æ„ä¸€ä¸‹å‡ ç‚¹ï¼š

1. ç‰¹å¾é€‰æ‹©æ˜¯åˆ†ç±»æ¨¡å‹å¥½åçš„å…³é”®ã€‚é€‰æ‹©ä»€ä¹ˆæ ·çš„ç‰¹å¾ï¼Œä»¥åŠå¯¹åº”çš„ç‰¹å¾å€¼çŸ©é˜µï¼Œå†³å®šäº†åˆ†ç±»æ¨¡å‹çš„å¥½åã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œç‰¹å¾å€¼ä¸éƒ½æ˜¯æ•°å€¼ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨DictVectorizerç±»è¿›è¡Œè½¬åŒ–ï¼›
2. æ¨¡å‹å‡†ç¡®ç‡éœ€è¦è€ƒè™‘æ˜¯å¦æœ‰æµ‹è¯•é›†çš„å®é™…ç»“æœå¯ä»¥åšå¯¹æ¯”ï¼Œå½“æµ‹è¯•é›†æ²¡æœ‰çœŸå®ç»“æœå¯ä»¥å¯¹æ¯”æ—¶ï¼Œéœ€è¦ä½¿ç”¨KæŠ˜äº¤å‰éªŒè¯cross\_val\_scoreï¼›
3. Graphvizå¯è§†åŒ–å·¥å…·å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å°†å†³ç­–æ¨¡å‹å‘ˆç°å‡ºæ¥ï¼Œå¸®åŠ©ä½ æ›´å¥½ç†è§£å†³ç­–æ ‘çš„æ„å»ºã€‚

![](https://static001.geekbang.org/resource/image/f0/ea/f09fd3c8b1ce771624b803978f01c9ea.png?wh=1161%2A478)  
æˆ‘ä¸Šé¢è®²äº†æ³°å¦å°¼å…‹ä¹˜å®¢ç”Ÿå­˜é¢„æµ‹çš„å…­ä¸ªå…³é”®æ¨¡å—ï¼Œè¯·ä½ ç”¨sklearnä¸­çš„å†³ç­–æ ‘æ¨¡å‹ç‹¬ç«‹å®Œæˆè¿™ä¸ªé¡¹ç›®ï¼Œå¯¹æµ‹è¯•é›†ä¸­çš„ä¹˜å®¢æ˜¯å¦ç”Ÿå­˜è¿›è¡Œé¢„æµ‹ï¼Œå¹¶ç»™å‡ºæ¨¡å‹å‡†ç¡®ç‡è¯„ä¼°ã€‚æ•°æ®ä»GitHubä¸Šä¸‹è½½å³å¯ã€‚

æœ€åç»™ä½ ç•™ä¸€ä¸ªæ€è€ƒé¢˜å§ï¼Œæˆ‘åœ¨æ„é€ ç‰¹å¾å‘é‡æ—¶ä½¿ç”¨äº†DictVectorizerç±»ï¼Œä½¿ç”¨fit\_transformå‡½æ•°å°†ç‰¹å¾å‘é‡è½¬åŒ–ä¸ºç‰¹å¾å€¼çŸ©é˜µã€‚DictVectorizerç±»åŒæ—¶ä¹Ÿæä¾›transformå‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå‡½æ•°æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

æ¬¢è¿ä½ åœ¨è¯„è®ºåŒºç•™è¨€ä¸æˆ‘åˆ†äº«ä½ çš„ç­”æ¡ˆï¼Œä¹Ÿæ¬¢è¿ç‚¹å‡»â€œè¯·æœ‹å‹è¯»â€æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–è€…åŒäº‹ï¼Œä¸€èµ·äº¤æµä¸€ä¸‹ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ15ï¼‰</strong></div><ul>
<li><span>ä¸€åªçœ¼çœ‹ä¸–ç•Œ</span> ğŸ‘ï¼ˆ50ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è¿˜æœ‰ä¸ªé—®é¢˜ å†³ç­–æ ‘æ€ä¹ˆè¯»ï¼Ÿ  å°±æ˜¯æ¯ä¸ªæ–¹æ¡†å†…çš„æ•°æ®éƒ½ä»£è¡¨ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ</p>2019-07-03</li><br/><li><span>å°ç†ŠçŒ«</span> ğŸ‘ï¼ˆ29ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>fit ä»ä¸€ä¸ªè®­ç»ƒé›†ä¸­å­¦ä¹ æ¨¡å‹å‚æ•°ï¼Œå…¶ä¸­å°±åŒ…æ‹¬äº†å½’ä¸€åŒ–æ—¶ç”¨åˆ°çš„å‡å€¼ï¼Œæ ‡å‡†åå·®ç­‰ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªè®­ç»ƒè¿‡ç¨‹ã€‚
transform: åœ¨fitçš„åŸºç¡€ä¸Šï¼Œå¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ï¼Œé™ç»´ï¼Œå½’ä¸€åŒ–ç­‰æ•°æ®è½¬æ¢æ“ä½œ
fit_transform: å°†æ¨¡å‹è®­ç»ƒå’Œè½¬åŒ–åˆå¹¶åˆ°ä¸€èµ·ï¼Œè®­ç»ƒæ ·æœ¬å…ˆåšfitï¼Œå¾—åˆ°meanï¼Œstandard deviationï¼Œç„¶åå°†è¿™äº›å‚æ•°ç”¨äºtransformï¼ˆå½’ä¸€åŒ–è®­ç»ƒæ•°æ®ï¼‰ï¼Œä½¿å¾—åˆ°çš„è®­ç»ƒæ•°æ®æ˜¯å½’ä¸€åŒ–çš„ï¼Œè€Œæµ‹è¯•æ•°æ®åªéœ€è¦åœ¨åŸå…ˆfitå¾—åˆ°çš„meanï¼Œstdä¸Šæ¥åšå½’ä¸€åŒ–å°±è¡Œäº†ï¼Œæ‰€ä»¥ç”¨transformå°±è¡Œäº†ã€‚</p>2019-02-18</li><br/><li><span>æ¯å¤©æ™’ç™½ç‰™</span> ğŸ‘ï¼ˆ26ï¼‰ ğŸ’¬ï¼ˆ4ï¼‰<p># ä¾èµ–åŒ…ä» cmdä¸­ pip installå³å¯
import pandas as pd
import numpy as np
from sklearn.feature_extraction import DictVectorizer
from sklearn.tree import DecisionTreeClassifier
from sklearn.model_selection import cross_val_score
from sklearn import tree
import graphviz
# æ•°æ®åŠ è½½
train_data = pd.read_csv(&#39;D:&#47;workspace&#47;study&#47;python&#47;Titanic_Data&#47;train.csv&#39;)
test_data = pd.read_csv(&#39;D:&#47;workspace&#47;study&#47;python&#47;Titanic_Data&#47;test.csv&#39;)
# æ•°æ®æ¢ç´¢
print(train_data.info())
print(&#39;-&#39;*30)
print(train_data.describe())
print(&#39;-&#39;*30)
print(train_data.describe(include=[&#39;O&#39;]))
print(&#39;-&#39;*30)
print(train_data.head())
print(&#39;-&#39;*30)
print(train_data.tail())
# æ•°æ®æ¸…æ´—
# ä½¿ç”¨å¹³å‡å¹´é¾„æ¥å¡«å……å¹´é¾„ä¸­çš„ nan å€¼
train_data[&#39;Age&#39;].fillna(train_data[&#39;Age&#39;].mean(), inplace=True)
test_data[&#39;Age&#39;].fillna(test_data[&#39;Age&#39;].mean(), inplace=True)
# ä½¿ç”¨ç¥¨ä»·çš„å‡å€¼å¡«å……ç¥¨ä»·ä¸­çš„ nan å€¼
train_data[&#39;Fare&#39;].fillna(train_data[&#39;Fare&#39;].mean(), inplace=True)
test_data[&#39;Fare&#39;].fillna(test_data[&#39;Fare&#39;].mean(), inplace=True)
# ä½¿ç”¨ç™»å½•æœ€å¤šçš„æ¸¯å£æ¥å¡«å……ç™»å½•æ¸¯å£çš„ nan å€¼
train_data[&#39;Embarked&#39;].fillna(&#39;S&#39;, inplace=True)
test_data[&#39;Embarked&#39;].fillna(&#39;S&#39;, inplace=True)
# ç‰¹å¾é€‰æ‹©
features = [&#39;Pclass&#39;, &#39;Sex&#39;, &#39;Age&#39;, &#39;SibSp&#39;, &#39;Parch&#39;, &#39;Fare&#39;, &#39;Embarked&#39;]
train_features = train_data[features]
train_labels = train_data[&#39;Survived&#39;]
test_features = test_data[features]
dvec = DictVectorizer(sparse=False)
train_features = dvec.fit_transform(train_features.to_dict(orient=&#39;record&#39;))
print(dvec.feature_names_)
# å†³ç­–æ ‘æ¨¡å‹
# æ„é€  ID3 å†³ç­–æ ‘
clf = DecisionTreeClassifier(criterion=&#39;entropy&#39;)
# å†³ç­–æ ‘è®­ç»ƒ
clf.fit(train_features, train_labels)
# æ¨¡å‹é¢„æµ‹ &amp; è¯„ä¼°
test_features=dvec.transform(test_features.to_dict(orient=&#39;record&#39;))
# å†³ç­–æ ‘é¢„æµ‹
pred_labels = clf.predict(test_features)
# å†³ç­–æ ‘å‡†ç¡®ç‡
acc_decision_tree = round(clf.score(train_features, train_labels), 6)
print(u&#39;score å‡†ç¡®ç‡ä¸º %.4lf&#39; % acc_decision_tree)
#  K æŠ˜äº¤å‰éªŒè¯ç»Ÿè®¡å†³ç­–æ ‘å‡†ç¡®ç‡
print(u&#39;cross_val_score å‡†ç¡®ç‡ä¸º %.4lf&#39; % np.mean(cross_val_score(clf, train_features, train_labels, cv=10)))
# å†³ç­–æ ‘å¯è§†åŒ–
dot_data = tree.export_graphviz(clf, out_file=None)
graph = graphviz.Source(dot_data)
graph.view()</p>2019-01-30</li><br/><li><span>ä¸åšé”®ç›˜ä¾ </span> ğŸ‘ï¼ˆ17ï¼‰ ğŸ’¬ï¼ˆ4ï¼‰<p>Fareä¼¼ä¹æ²¡æœ‰ç¼ºå¤±å€¼ï¼Ÿ</p>2019-02-05</li><br/><li><span>Lambert</span> ğŸ‘ï¼ˆ9ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p># å†³ç­–æ ‘å¯è§†åŒ–
from sklearn import tree
import graphviz
dot_data = tree.export_graphviz(clf, out_file=None)
graph = graphviz.Source(dot_data)
graph.render(&quot;tree&quot;)
graph.view(&#39;graph&#39;)</p>2019-02-27</li><br/><li><span>æŸšå­</span> ğŸ‘ï¼ˆ8ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>å…³äºgraphvizï¼šæˆ‘ç”¨çš„æ˜¯anacondaï¼Œé€šè¿‡åœ¨anaconda promptç•Œé¢è¾“å…¥ conda install python-graphviz å¯ä»¥ç›´æ¥å®‰è£…graphviz</p>2019-02-19</li><br/><li><span>ä¸Šå®˜</span> ğŸ‘ï¼ˆ8ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>Carbinç¼ºå¤±ç‡åˆ†åˆ«ä¸º 77% å’Œ 78%ï¼Œ Age\Fareæœ‰ç¼ºå¤±å€¼ï¼Œè¿™éƒ½æ˜¯åœ¨å“ªå„¿åˆ¤æ–­å‡ºæ¥çš„ï¼Ÿ
</p>2019-01-25</li><br/><li><span>å¬å¦ˆå¦ˆçš„è¯</span> ğŸ‘ï¼ˆ7ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<p>https:&#47;&#47;github.com&#47;apachecn&#47;kaggle&#47;tree&#47;master&#47;competitions&#47;getting-started&#47;titanic
æˆ‘ä¸ªäººè®¤ä¸ºè¿™é‡Œçš„é¢„æµ‹æ–¹æ¡ˆå†™çš„æ›´åŠ è¯¦ç»†ä¸€ç‚¹ï¼Œå¤§å®¶å¯ä»¥å‚è€ƒä¸€ä¸‹</p>2019-03-21</li><br/><li><span>hh</span> ğŸ‘ï¼ˆ7ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆçš„è¯¾å¤ªå€¼äº†ï¼Œè¯·é—®è€å¸ˆè¿˜æœ‰å…¶ä»–è¯¾å—ï¼ŒçœŸæ˜¯å¹²è´§æ»¡æ»¡</p>2019-02-17</li><br/><li><span>å»ºå¼º</span> ğŸ‘ï¼ˆ5ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>      transform()å’Œfit_transform()äºŒè€…çš„åŠŸèƒ½éƒ½æ˜¯å¯¹æ•°æ®è¿›è¡ŒæŸç§ç»Ÿä¸€å¤„ç†ï¼ˆæ¯”å¦‚æ ‡å‡†åŒ–~N(0,1)ï¼Œå°†æ•°æ®ç¼©æ”¾(æ˜ å°„)åˆ°æŸä¸ªå›ºå®šåŒºé—´ï¼Œå½’ä¸€åŒ–ï¼Œæ­£åˆ™åŒ–ç­‰ï¼‰ã€‚
      fit_transform(trainData)å¯¹éƒ¨åˆ†è®­ç»ƒæ•°æ®å…ˆæ‹Ÿåˆfitï¼Œæ‰¾åˆ°éƒ¨åˆ†è®­ç»ƒæ•°æ®çš„æ•´ä½“æŒ‡æ ‡ï¼Œå¦‚å‡å€¼ã€æ–¹å·®ã€æœ€å¤§å€¼æœ€å°å€¼ç­‰ç­‰ï¼ˆæ ¹æ®å…·ä½“è½¬æ¢çš„ç›®çš„ï¼‰ï¼Œç„¶åå¯¹è®­ç»ƒæ•°æ®è¿›è¡Œè½¬æ¢transformï¼Œä»è€Œå®ç°æ•°æ®çš„æ ‡å‡†åŒ–ã€å½’ä¸€åŒ–ç­‰ç­‰ã€‚
       æ ¹æ®å¯¹ä¹‹å‰éƒ¨åˆ†è®­ç»ƒæ•°æ®è¿›è¡Œfitçš„æ•´ä½“æŒ‡æ ‡ï¼Œå¯¹æµ‹è¯•æ•°æ®é›†ä½¿ç”¨åŒæ ·çš„å‡å€¼ã€æ–¹å·®ã€æœ€å¤§ã€æœ€å°å€¼ç­‰æŒ‡æ ‡è¿›è¡Œè½¬æ¢transform(testData)ï¼Œä»è€Œä¿è¯trainã€testå¤„ç†æ–¹å¼ç›¸åŒã€‚
</p>2019-09-10</li><br/><li><span>ç¬”è½æƒŠé£é›¨</span> ğŸ‘ï¼ˆ5ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æˆ‘è¡¨ç¤ºçœŸçš„æ²¡çœ‹æ˜ç™½ æ¥å›æ¥çœ‹5éäº†</p>2019-02-26</li><br/><li><span>mickey</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p># encoding=utf-8
import pandas as pd
from sklearn.feature_extraction import DictVectorizer
from sklearn.tree import DecisionTreeClassifier
import numpy as np
from sklearn.model_selection import cross_val_score

# æ•°æ®åŠ è½½
train_data = pd.read_csv(&#39;.&#47;Titanic_Data&#47;train.csv&#39;)
test_data = pd.read_csv(&#39;.&#47;Titanic_Data&#47;test.csv&#39;)

# æ•°æ®æ¢ç´¢
print(train_data.info())
print(train_data.describe())
print(train_data.describe(include=[&#39;O&#39;]))
print(train_data.head())
print(train_data.tail())

# æ•°æ®æ¸…æ´—
# ä½¿ç”¨å¹³å‡å¹´é¾„æ¥å¡«å……å¹´é¾„ä¸­çš„Nanå€¼
train_data[&#39;Age&#39;].fillna(train_data[&#39;Age&#39;].mean(), inplace=True)
test_data[&#39;Age&#39;].fillna(test_data[&#39;Age&#39;].mean(),inplace=True)
# ä½¿ç”¨ç¥¨ä»·çš„å‡å€¼å¡«å……ç¥¨ä»·ä¸­çš„Nanå€¼
train_data[&#39;Fare&#39;].fillna(train_data[&#39;Fare&#39;].mean(), inplace=True)
test_data[&#39;Fare&#39;].fillna(test_data[&#39;Fare&#39;].mean(),inplace=True)

# ä½¿ç”¨ç™»å½•æœ€å¤šçš„æ¸¯å£æ¥å¡«å……ç™»å½•æ¸¯å£çš„nanå€¼
# print(train_data[&#39;Embarked&#39;].value_counts())
train_data[&#39;Embarked&#39;].fillna(&#39;S&#39;, inplace=True)
test_data[&#39;Embarked&#39;].fillna(&#39;S&#39;,inplace=True)

# ç‰¹å¾é€‰æ‹©
features = [&#39;Pclass&#39;, &#39;Sex&#39;, &#39;Age&#39;, &#39;SibSp&#39;, &#39;Parch&#39;, &#39;Fare&#39;, &#39;Embarked&#39;]
train_features = train_data[features]
train_labels = train_data[&#39;Survived&#39;]
test_features = test_data[features]

dvec = DictVectorizer(sparse=False)
train_features = dvec.fit_transform(train_features.to_dict(orient=&#39;record&#39;))

# æ„é€ ID3å†³ç­–æ ‘
clf = DecisionTreeClassifier(criterion=&#39;entropy&#39;)

# å†³ç­–æ ‘è®­ç»ƒ
clf.fit(train_features, train_labels)

# å¾—åˆ°å†³ç­–æ ‘å‡†ç¡®ç‡
acc_decision_tree = round(clf.score(train_features, train_labels), 6)
print(u&#39;scoreå‡†ç¡®ç‡ä¸º %.4lf&#39; % acc_decision_tree)

# ä½¿ç”¨KæŠ˜äº¤å‰éªŒè¯ ç»Ÿè®¡å†³ç­–æ ‘å‡†ç¡®ç‡
print(u&#39;cross_val_scoreå‡†ç¡®ç‡ä¸º %.4lf&#39; % np.mean(cross_val_score(clf, train_features, train_labels, cv=10)))</p>2019-01-25</li><br/><li><span>Python</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è¿™ä¸¤ä¸ªå‡½æ•°æœ€åå¾—å‡ºçš„ç»“æœå®Œå…¨ä¸€æ ·ï¼Œä½†å®é™…ä¸Šç”¨æ³•æœ‰æ‰€ä¸åŒã€‚å¦‚æœä¸€å®šè¦ä¸¤ä¸ªä¸€èµ·ç”¨ï¼Œé‚£è‚¯å®šæ˜¯å¾—å…ˆ
fit_transforms,å†transformsï¼Œä¸ç„¶å°±ä¼šæŠ¥é”™ã€‚fit_transformså®é™…ä¸Šæ˜¯fit()å’Œtransformsï¼ˆï¼‰è¿™ä¸¤ä¸ªå‡½æ•°çš„é›†åˆ</p>2019-01-25</li><br/><li><span>æ°¸é™ä¸æ¯ä¹‹é›¨</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è‡ªå·±å†™äº†ä¸€éä»£ç ï¼Œè¯´æ€ä¹ˆä¸€ç›´æŠ¥é”™ï¼ŒåŸæ¥æ˜¯æµ‹è¯•é›†çš„fareæœ‰ç¼ºå¤±å•Šï¼
</p>2019-06-28</li><br/><li><span>0256</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ä¸ºä»€ä¹ˆæœ€åç®—å‡†ç¡®ç‡çš„æ—¶å€™ï¼Œæ˜¯ç”¨çš„trainï¼Œè€Œä¸æ˜¯testå‘¢ï¼Ÿ</p>2020-09-12</li><br/>
</ul>