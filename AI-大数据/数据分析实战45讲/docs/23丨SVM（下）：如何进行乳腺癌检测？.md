è®²å®Œäº†SVMçš„åŸç†ä¹‹åï¼Œä»Šå¤©æˆ‘æ¥å¸¦ä½ è¿›è¡ŒSVMçš„å®æˆ˜ã€‚

åœ¨æ­¤ä¹‹å‰æˆ‘ä»¬å…ˆæ¥å›é¡¾ä¸€ä¸‹SVMçš„ç›¸å…³çŸ¥è¯†ç‚¹ã€‚SVMæ˜¯æœ‰ç›‘ç£çš„å­¦ä¹ æ¨¡å‹ï¼Œæˆ‘ä»¬éœ€è¦äº‹å…ˆå¯¹æ•°æ®æ‰“ä¸Šåˆ†ç±»æ ‡ç­¾ï¼Œé€šè¿‡æ±‚è§£æœ€å¤§åˆ†ç±»é—´éš”æ¥æ±‚è§£äºŒåˆ†ç±»é—®é¢˜ã€‚å¦‚æœè¦æ±‚è§£å¤šåˆ†ç±»é—®é¢˜ï¼Œå¯ä»¥å°†å¤šä¸ªäºŒåˆ†ç±»å™¨ç»„åˆèµ·æ¥å½¢æˆä¸€ä¸ªå¤šåˆ†ç±»å™¨ã€‚

ä¸Šä¸€èŠ‚ä¸­è®²åˆ°äº†ç¡¬é—´éš”ã€è½¯é—´éš”ã€éçº¿æ€§SVMï¼Œä»¥åŠåˆ†ç±»é—´éš”çš„å…¬å¼ï¼Œä½ å¯èƒ½ä¼šè§‰å¾—æ¯”è¾ƒæŠ½è±¡ã€‚è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬ä¼šåœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œè®²è§£å¯¹å·¥å…·çš„ä½¿ç”¨ï¼Œä»¥åŠç›¸å…³å‚æ•°çš„å«ä¹‰ã€‚

## å¦‚ä½•åœ¨sklearnä¸­ä½¿ç”¨SVM

åœ¨Pythonçš„sklearnå·¥å…·åŒ…ä¸­æœ‰SVMç®—æ³•ï¼Œé¦–å…ˆéœ€è¦å¼•ç”¨å·¥å…·åŒ…ï¼š

```
from sklearn import svm
```

SVMæ—¢å¯ä»¥åšå›å½’ï¼Œä¹Ÿå¯ä»¥åšåˆ†ç±»å™¨ã€‚

å½“ç”¨SVMåšå›å½’çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨SVRæˆ–LinearSVRã€‚SVRçš„è‹±æ–‡æ˜¯Support Vector Regressionã€‚è¿™ç¯‡æ–‡ç« åªè®²åˆ†ç±»ï¼Œè¿™é‡Œåªæ˜¯ç®€å•åœ°æä¸€ä¸‹ã€‚

å½“åšåˆ†ç±»å™¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯SVCæˆ–è€…LinearSVCã€‚SVCçš„è‹±æ–‡æ˜¯Support Vector Classificationã€‚

æˆ‘ç®€å•è¯´ä¸€ä¸‹è¿™ä¸¤è€…ä¹‹å‰çš„å·®åˆ«ã€‚

ä»åå­—ä¸Šä½ èƒ½çœ‹å‡ºLinearSVCæ˜¯ä¸ªçº¿æ€§åˆ†ç±»å™¨ï¼Œç”¨äºå¤„ç†çº¿æ€§å¯åˆ†çš„æ•°æ®ï¼Œåªèƒ½ä½¿ç”¨çº¿æ€§æ ¸å‡½æ•°ã€‚ä¸Šä¸€èŠ‚ï¼Œæˆ‘è®²åˆ°SVMæ˜¯é€šè¿‡æ ¸å‡½æ•°å°†æ ·æœ¬ä»åŸå§‹ç©ºé—´æ˜ å°„åˆ°ä¸€ä¸ªæ›´é«˜ç»´çš„ç‰¹è´¨ç©ºé—´ä¸­ï¼Œè¿™æ ·å°±ä½¿å¾—æ ·æœ¬åœ¨æ–°çš„ç©ºé—´ä¸­çº¿æ€§å¯åˆ†ã€‚

å¦‚æœæ˜¯é’ˆå¯¹éçº¿æ€§çš„æ•°æ®ï¼Œéœ€è¦ç”¨åˆ°SVCã€‚åœ¨SVCä¸­ï¼Œæˆ‘ä»¬æ—¢å¯ä»¥ä½¿ç”¨åˆ°çº¿æ€§æ ¸å‡½æ•°ï¼ˆè¿›è¡Œçº¿æ€§åˆ’åˆ†ï¼‰ï¼Œä¹Ÿèƒ½ä½¿ç”¨é«˜ç»´çš„æ ¸å‡½æ•°ï¼ˆè¿›è¡Œéçº¿æ€§åˆ’åˆ†ï¼‰ã€‚

å¦‚ä½•åˆ›å»ºä¸€ä¸ªSVMåˆ†ç±»å™¨å‘¢ï¼Ÿ

æˆ‘ä»¬é¦–å…ˆä½¿ç”¨SVCçš„æ„é€ å‡½æ•°ï¼šmodel = svm.SVC(kernel=â€˜rbfâ€™, C=1.0, gamma=â€˜autoâ€™)ï¼Œè¿™é‡Œæœ‰ä¸‰ä¸ªé‡è¦çš„å‚æ•°kernelã€Cå’Œgammaã€‚

kernelä»£è¡¨æ ¸å‡½æ•°çš„é€‰æ‹©ï¼Œå®ƒæœ‰å››ç§é€‰æ‹©ï¼Œåªä¸è¿‡é»˜è®¤æ˜¯rbfï¼Œå³é«˜æ–¯æ ¸å‡½æ•°ã€‚

1. linearï¼šçº¿æ€§æ ¸å‡½æ•°
2. polyï¼šå¤šé¡¹å¼æ ¸å‡½æ•°
3. rbfï¼šé«˜æ–¯æ ¸å‡½æ•°ï¼ˆé»˜è®¤ï¼‰
4. sigmoidï¼šsigmoidæ ¸å‡½æ•°

è¿™å››ç§å‡½æ•°ä»£è¡¨ä¸åŒçš„æ˜ å°„æ–¹å¼ï¼Œä½ å¯èƒ½ä¼šé—®ï¼Œåœ¨å®é™…å·¥ä½œä¸­ï¼Œå¦‚ä½•é€‰æ‹©è¿™4ç§æ ¸å‡½æ•°å‘¢ï¼Ÿæˆ‘æ¥ç»™ä½ è§£é‡Šä¸€ä¸‹ï¼š

çº¿æ€§æ ¸å‡½æ•°ï¼Œæ˜¯åœ¨æ•°æ®çº¿æ€§å¯åˆ†çš„æƒ…å†µä¸‹ä½¿ç”¨çš„ï¼Œè¿ç®—é€Ÿåº¦å¿«ï¼Œæ•ˆæœå¥½ã€‚ä¸è¶³åœ¨äºå®ƒä¸èƒ½å¤„ç†çº¿æ€§ä¸å¯åˆ†çš„æ•°æ®ã€‚

å¤šé¡¹å¼æ ¸å‡½æ•°å¯ä»¥å°†æ•°æ®ä»ä½ç»´ç©ºé—´æ˜ å°„åˆ°é«˜ç»´ç©ºé—´ï¼Œä½†å‚æ•°æ¯”è¾ƒå¤šï¼Œè®¡ç®—é‡å¤§ã€‚

é«˜æ–¯æ ¸å‡½æ•°åŒæ ·å¯ä»¥å°†æ ·æœ¬æ˜ å°„åˆ°é«˜ç»´ç©ºé—´ï¼Œä½†ç›¸æ¯”äºå¤šé¡¹å¼æ ¸å‡½æ•°æ¥è¯´æ‰€éœ€çš„å‚æ•°æ¯”è¾ƒå°‘ï¼Œé€šå¸¸æ€§èƒ½ä¸é”™ï¼Œæ‰€ä»¥æ˜¯é»˜è®¤ä½¿ç”¨çš„æ ¸å‡½æ•°ã€‚

äº†è§£æ·±åº¦å­¦ä¹ çš„åŒå­¦åº”è¯¥çŸ¥é“sigmoidç»å¸¸ç”¨åœ¨ç¥ç»ç½‘ç»œçš„æ˜ å°„ä¸­ã€‚å› æ­¤å½“é€‰ç”¨sigmoidæ ¸å‡½æ•°æ—¶ï¼ŒSVMå®ç°çš„æ˜¯å¤šå±‚ç¥ç»ç½‘ç»œã€‚

ä¸Šé¢ä»‹ç»çš„4ç§æ ¸å‡½æ•°ï¼Œé™¤äº†ç¬¬ä¸€ç§çº¿æ€§æ ¸å‡½æ•°å¤–ï¼Œå…¶ä½™3ç§éƒ½å¯ä»¥å¤„ç†çº¿æ€§ä¸å¯åˆ†çš„æ•°æ®ã€‚

å‚æ•°Cä»£è¡¨ç›®æ ‡å‡½æ•°çš„æƒ©ç½šç³»æ•°ï¼Œæƒ©ç½šç³»æ•°æŒ‡çš„æ˜¯åˆ†é”™æ ·æœ¬æ—¶çš„æƒ©ç½šç¨‹åº¦ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¸º1.0ã€‚å½“Cè¶Šå¤§çš„æ—¶å€™ï¼Œåˆ†ç±»å™¨çš„å‡†ç¡®æ€§è¶Šé«˜ï¼Œä½†åŒæ ·å®¹é”™ç‡ä¼šè¶Šä½ï¼Œæ³›åŒ–èƒ½åŠ›ä¼šå˜å·®ã€‚ç›¸åï¼ŒCè¶Šå°ï¼Œæ³›åŒ–èƒ½åŠ›è¶Šå¼ºï¼Œä½†æ˜¯å‡†ç¡®æ€§ä¼šé™ä½ã€‚

å‚æ•°gammaä»£è¡¨æ ¸å‡½æ•°çš„ç³»æ•°ï¼Œé»˜è®¤ä¸ºæ ·æœ¬ç‰¹å¾æ•°çš„å€’æ•°ï¼Œå³gamma = 1 / n\_featuresã€‚

åœ¨åˆ›å»ºSVMåˆ†ç±»å™¨ä¹‹åï¼Œå°±å¯ä»¥è¾“å…¥è®­ç»ƒé›†å¯¹å®ƒè¿›è¡Œè®­ç»ƒã€‚æˆ‘ä»¬ä½¿ç”¨model.fit(train\_X,train\_y)ï¼Œä¼ å…¥è®­ç»ƒé›†ä¸­çš„ç‰¹å¾å€¼çŸ©é˜µtrain\_Xå’Œåˆ†ç±»æ ‡è¯†train\_yã€‚ç‰¹å¾å€¼çŸ©é˜µå°±æ˜¯æˆ‘ä»¬åœ¨ç‰¹å¾é€‰æ‹©åæŠ½å–çš„ç‰¹å¾å€¼çŸ©é˜µï¼ˆå½“ç„¶ä½ ä¹Ÿå¯ä»¥ç”¨å…¨éƒ¨æ•°æ®ä½œä¸ºç‰¹å¾å€¼çŸ©é˜µï¼‰ï¼›åˆ†ç±»æ ‡è¯†å°±æ˜¯äººå·¥äº‹å…ˆé’ˆå¯¹æ¯ä¸ªæ ·æœ¬æ ‡è¯†çš„åˆ†ç±»ç»“æœã€‚è¿™æ ·æ¨¡å‹ä¼šè‡ªåŠ¨è¿›è¡Œåˆ†ç±»å™¨çš„è®­ç»ƒã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨prediction=model.predict(test\_X)æ¥å¯¹ç»“æœè¿›è¡Œé¢„æµ‹ï¼Œä¼ å…¥æµ‹è¯•é›†ä¸­çš„æ ·æœ¬ç‰¹å¾çŸ©é˜µtest\_Xï¼Œå¯ä»¥å¾—åˆ°æµ‹è¯•é›†çš„é¢„æµ‹åˆ†ç±»ç»“æœpredictionã€‚

åŒæ ·æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ›å»ºçº¿æ€§SVMåˆ†ç±»å™¨ï¼Œä½¿ç”¨model=svm.LinearSVC()ã€‚åœ¨LinearSVCä¸­æ²¡æœ‰kernelè¿™ä¸ªå‚æ•°ï¼Œé™åˆ¶æˆ‘ä»¬åªèƒ½ä½¿ç”¨çº¿æ€§æ ¸å‡½æ•°ã€‚ç”±äºLinearSVCå¯¹çº¿æ€§åˆ†ç±»åšäº†ä¼˜åŒ–ï¼Œå¯¹äºæ•°æ®é‡å¤§çš„çº¿æ€§å¯åˆ†é—®é¢˜ï¼Œä½¿ç”¨LinearSVCçš„æ•ˆç‡è¦é«˜äºSVCã€‚

å¦‚æœä½ ä¸çŸ¥é“æ•°æ®é›†æ˜¯å¦ä¸ºçº¿æ€§ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨SVCç±»åˆ›å»ºSVMåˆ†ç±»å™¨ã€‚

åœ¨è®­ç»ƒå’Œé¢„æµ‹ä¸­ï¼ŒLinearSVCå’ŒSVCä¸€æ ·ï¼Œéƒ½æ˜¯ä½¿ç”¨model.fit(train\_X,train\_y)å’Œmodel.predict(test\_X)ã€‚

## å¦‚ä½•ç”¨SVMè¿›è¡Œä¹³è…ºç™Œæ£€æµ‹

åœ¨äº†è§£äº†å¦‚ä½•åˆ›å»ºå’Œä½¿ç”¨SVMåˆ†ç±»å™¨åï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå®é™…çš„é¡¹ç›®ï¼Œæ•°æ®é›†æ¥è‡ªç¾å›½å¨æ–¯åº·æ˜Ÿå·çš„ä¹³è…ºç™Œè¯Šæ–­æ•°æ®é›†ï¼Œ[ç‚¹å‡»è¿™é‡Œè¿›è¡Œä¸‹è½½](https://github.com/cystanford/breast_cancer_data/)ã€‚

åŒ»ç–—äººå‘˜é‡‡é›†äº†æ‚£è€…ä¹³è…ºè‚¿å—ç»è¿‡ç»†é’ˆç©¿åˆº(FNA)åçš„æ•°å­—åŒ–å›¾åƒï¼Œå¹¶ä¸”å¯¹è¿™äº›æ•°å­—å›¾åƒè¿›è¡Œäº†ç‰¹å¾æå–ï¼Œè¿™äº›ç‰¹å¾å¯ä»¥æè¿°å›¾åƒä¸­çš„ç»†èƒæ ¸å‘ˆç°ã€‚è‚¿ç˜¤å¯ä»¥åˆ†æˆè‰¯æ€§å’Œæ¶æ€§ã€‚éƒ¨åˆ†æ•°æ®æˆªå±å¦‚ä¸‹æ‰€ç¤ºï¼š

![](https://static001.geekbang.org/resource/image/97/6a/97a33c5bfc182d571e9707db653eff6a.png?wh=864%2A326)  
æ•°æ®è¡¨ä¸€å…±åŒ…æ‹¬äº†32ä¸ªå­—æ®µï¼Œä»£è¡¨çš„å«ä¹‰å¦‚ä¸‹ï¼š

![](https://static001.geekbang.org/resource/image/1e/13/1e6af6fa8bebdfba10457c111b5e9c13.jpg?wh=622%2A1031)

ä¸Šé¢çš„è¡¨æ ¼ä¸­ï¼Œmeanä»£è¡¨å¹³å‡å€¼ï¼Œseä»£è¡¨æ ‡å‡†å·®ï¼Œworstä»£è¡¨æœ€å¤§å€¼ï¼ˆ3ä¸ªæœ€å¤§å€¼çš„å¹³å‡å€¼ï¼‰ã€‚æ¯å¼ å›¾åƒéƒ½è®¡ç®—äº†ç›¸åº”çš„ç‰¹å¾ï¼Œå¾—å‡ºäº†è¿™30ä¸ªç‰¹å¾å€¼ï¼ˆä¸åŒ…æ‹¬IDå­—æ®µå’Œåˆ†ç±»æ ‡è¯†ç»“æœå­—æ®µdiagnosisï¼‰ï¼Œå®é™…ä¸Šæ˜¯10ä¸ªç‰¹å¾å€¼ï¼ˆradiusã€textureã€perimeterã€areaã€smoothnessã€compactnessã€concavityã€concave pointsã€symmetryå’Œfractal\_dimension\_meanï¼‰çš„3ä¸ªç»´åº¦ï¼Œå¹³å‡ã€æ ‡å‡†å·®å’Œæœ€å¤§å€¼ã€‚è¿™äº›ç‰¹å¾å€¼éƒ½ä¿ç•™äº†4ä½æ•°å­—ã€‚å­—æ®µä¸­æ²¡æœ‰ç¼ºå¤±çš„å€¼ã€‚åœ¨569ä¸ªæ‚£è€…ä¸­ï¼Œä¸€å…±æœ‰357ä¸ªæ˜¯è‰¯æ€§ï¼Œ212ä¸ªæ˜¯æ¶æ€§ã€‚

å¥½äº†ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ç”Ÿæˆä¸€ä¸ªä¹³è…ºç™Œè¯Šæ–­çš„SVMåˆ†ç±»å™¨ï¼Œå¹¶è®¡ç®—è¿™ä¸ªåˆ†ç±»å™¨çš„å‡†ç¡®ç‡ã€‚é¦–å…ˆè®¾å®šé¡¹ç›®çš„æ‰§è¡Œæµç¨‹ï¼š

![](https://static001.geekbang.org/resource/image/97/f9/9768905bf3cf6d8946a64caa8575e1f9.png?wh=1216%2A558)

1. é¦–å…ˆæˆ‘ä»¬éœ€è¦åŠ è½½æ•°æ®æºï¼›
2. åœ¨å‡†å¤‡é˜¶æ®µï¼Œéœ€è¦å¯¹åŠ è½½çš„æ•°æ®æºè¿›è¡Œæ¢ç´¢ï¼ŒæŸ¥çœ‹æ ·æœ¬ç‰¹å¾å’Œç‰¹å¾å€¼ï¼Œè¿™ä¸ªè¿‡ç¨‹ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨æ•°æ®å¯è§†åŒ–ï¼Œå®ƒå¯ä»¥æ–¹ä¾¿æˆ‘ä»¬å¯¹æ•°æ®åŠæ•°æ®ä¹‹é—´çš„å…³ç³»è¿›ä¸€æ­¥åŠ æ·±äº†è§£ã€‚ç„¶åæŒ‰ç…§â€œå®Œå…¨åˆä¸€â€çš„å‡†åˆ™æ¥è¯„ä¼°æ•°æ®çš„è´¨é‡ï¼Œå¦‚æœæ•°æ®è´¨é‡ä¸é«˜å°±éœ€è¦åšæ•°æ®æ¸…æ´—ã€‚æ•°æ®æ¸…æ´—ä¹‹åï¼Œä½ å¯ä»¥åšç‰¹å¾é€‰æ‹©ï¼Œæ–¹ä¾¿åç»­çš„æ¨¡å‹è®­ç»ƒï¼›
3. åœ¨åˆ†ç±»é˜¶æ®µï¼Œé€‰æ‹©æ ¸å‡½æ•°è¿›è¡Œè®­ç»ƒï¼Œå¦‚æœä¸çŸ¥é“æ•°æ®æ˜¯å¦ä¸ºçº¿æ€§ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨SVC(kernel=â€˜rbfâ€™) ï¼Œä¹Ÿå°±æ˜¯é«˜æ–¯æ ¸å‡½æ•°çš„SVMåˆ†ç±»å™¨ã€‚ç„¶åå¯¹è®­ç»ƒå¥½çš„æ¨¡å‹ç”¨æµ‹è¯•é›†è¿›è¡Œè¯„ä¼°ã€‚

æŒ‰ç…§ä¸Šé¢çš„æµç¨‹ï¼Œæˆ‘ä»¬æ¥ç¼–å†™ä¸‹ä»£ç ï¼ŒåŠ è½½æ•°æ®å¹¶å¯¹æ•°æ®åšéƒ¨åˆ†çš„æ¢ç´¢ï¼š

```
# åŠ è½½æ•°æ®é›†ï¼Œä½ éœ€è¦æŠŠæ•°æ®æ”¾åˆ°ç›®å½•ä¸­
data = pd.read_csv("./data.csv")
# æ•°æ®æ¢ç´¢
# å› ä¸ºæ•°æ®é›†ä¸­åˆ—æ¯”è¾ƒå¤šï¼Œæˆ‘ä»¬éœ€è¦æŠŠdataframeä¸­çš„åˆ—å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥
pd.set_option('display.max_columns', None)
print(data.columns)
print(data.head(5))
print(data.describe())
```

è¿™æ˜¯éƒ¨åˆ†çš„è¿è¡Œç»“æœï¼Œå®Œæ•´ç»“æœä½ å¯ä»¥è‡ªå·±è·‘ä¸€ä¸‹ã€‚

```
Index(['id', 'diagnosis', 'radius_mean', 'texture_mean', 'perimeter_mean',
       'area_mean', 'smoothness_mean', 'compactness_mean', 'concavity_mean',
       'concave points_mean', 'symmetry_mean', 'fractal_dimension_mean',
       'radius_se', 'texture_se', 'perimeter_se', 'area_se', 'smoothness_se',
       'compactness_se', 'concavity_se', 'concave points_se', 'symmetry_se',
       'fractal_dimension_se', 'radius_worst', 'texture_worst',
       'perimeter_worst', 'area_worst', 'smoothness_worst',
       'compactness_worst', 'concavity_worst', 'concave points_worst',
       'symmetry_worst', 'fractal_dimension_worst'],
      dtype='object')
         id diagnosis  radius_mean  texture_mean  perimeter_mean  area_mean  \
0    842302         M        17.99         10.38          122.80     1001.0   
1    842517         M        20.57         17.77          132.90     1326.0   
2  84300903         M        19.69         21.25          130.00     1203.0   
3  84348301         M        11.42         20.38           77.58      386.1   
4  84358402         M        20.29         14.34          135.10     1297.0 
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±è¦å¯¹æ•°æ®è¿›è¡Œæ¸…æ´—äº†ã€‚

è¿è¡Œç»“æœä¸­ï¼Œä½ èƒ½çœ‹åˆ°32ä¸ªå­—æ®µé‡Œï¼Œidæ˜¯æ²¡æœ‰å®é™…å«ä¹‰çš„ï¼Œå¯ä»¥å»æ‰ã€‚diagnosiså­—æ®µçš„å–å€¼ä¸ºBæˆ–è€…Mï¼Œæˆ‘ä»¬å¯ä»¥ç”¨0å’Œ1æ¥æ›¿ä»£ã€‚å¦å¤–å…¶ä½™çš„30ä¸ªå­—æ®µï¼Œå…¶å®å¯ä»¥åˆ†æˆä¸‰ç»„å­—æ®µï¼Œä¸‹åˆ’çº¿åé¢çš„meanã€seå’Œworstä»£è¡¨äº†æ¯ç»„å­—æ®µä¸åŒçš„åº¦é‡æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯å¹³å‡å€¼ã€æ ‡å‡†å·®å’Œæœ€å¤§å€¼ã€‚

```
# å°†ç‰¹å¾å­—æ®µåˆ†æˆ3ç»„
features_mean= list(data.columns[2:12])
features_se= list(data.columns[12:22])
features_worst=list(data.columns[22:32])
# æ•°æ®æ¸…æ´—
# IDåˆ—æ²¡æœ‰ç”¨ï¼Œåˆ é™¤è¯¥åˆ—
data.drop("id",axis=1,inplace=True)
# å°†Bè‰¯æ€§æ›¿æ¢ä¸º0ï¼ŒMæ¶æ€§æ›¿æ¢ä¸º1
data['diagnosis']=data['diagnosis'].map({'M':1,'B':0})
```

ç„¶åæˆ‘ä»¬è¦åšç‰¹å¾å­—æ®µçš„ç­›é€‰ï¼Œé¦–å…ˆéœ€è¦è§‚å¯Ÿä¸‹features\_meanå„å˜é‡ä¹‹é—´çš„å…³ç³»ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨DataFrameçš„corr()å‡½æ•°ï¼Œç„¶åç”¨çƒ­åŠ›å›¾å¸®æˆ‘ä»¬å¯è§†åŒ–å‘ˆç°ã€‚åŒæ ·ï¼Œæˆ‘ä»¬ä¹Ÿä¼šçœ‹æ•´ä½“è‰¯æ€§ã€æ¶æ€§è‚¿ç˜¤çš„è¯Šæ–­æƒ…å†µã€‚

```
# å°†è‚¿ç˜¤è¯Šæ–­ç»“æœå¯è§†åŒ–
sns.countplot(data['diagnosis'],label="Count")
plt.show()
# ç”¨çƒ­åŠ›å›¾å‘ˆç°features_meanå­—æ®µä¹‹é—´çš„ç›¸å…³æ€§
corr = data[features_mean].corr()
plt.figure(figsize=(14,14))
# annot=Trueæ˜¾ç¤ºæ¯ä¸ªæ–¹æ ¼çš„æ•°æ®
sns.heatmap(corr, annot=True)
plt.show()
```

è¿™æ˜¯è¿è¡Œçš„ç»“æœï¼š

![](https://static001.geekbang.org/resource/image/a6/4d/a65435de48cee8091bd5f83d286ddb4d.png?wh=864%2A658)

![](https://static001.geekbang.org/resource/image/07/6e/0780e76fd3807759ab4881c2c39cb76e.png?wh=862%2A673)  
çƒ­åŠ›å›¾ä¸­å¯¹è§’çº¿ä¸Šçš„ä¸ºå•å˜é‡è‡ªèº«çš„ç›¸å…³ç³»æ•°æ˜¯1ã€‚é¢œè‰²è¶Šæµ…ä»£è¡¨ç›¸å…³æ€§è¶Šå¤§ã€‚æ‰€ä»¥ä½ èƒ½çœ‹å‡ºæ¥radius\_meanã€perimeter\_meanå’Œarea\_meanç›¸å…³æ€§éå¸¸å¤§ï¼Œcompactness\_meanã€concavity\_meanã€concave\_points\_meanè¿™ä¸‰ä¸ªå­—æ®µä¹Ÿæ˜¯ç›¸å…³çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å–å…¶ä¸­çš„ä¸€ä¸ªä½œä¸ºä»£è¡¨ã€‚

é‚£ä¹ˆå¦‚ä½•è¿›è¡Œç‰¹å¾é€‰æ‹©å‘¢ï¼Ÿ

ç‰¹å¾é€‰æ‹©çš„ç›®çš„æ˜¯é™ç»´ï¼Œç”¨å°‘é‡çš„ç‰¹å¾ä»£è¡¨æ•°æ®çš„ç‰¹æ€§ï¼Œè¿™æ ·ä¹Ÿå¯ä»¥å¢å¼ºåˆ†ç±»å™¨çš„æ³›åŒ–èƒ½åŠ›ï¼Œé¿å…æ•°æ®è¿‡æ‹Ÿåˆã€‚

æˆ‘ä»¬èƒ½çœ‹åˆ°meanã€seå’Œworstè¿™ä¸‰ç»„ç‰¹å¾æ˜¯å¯¹åŒä¸€ç»„å†…å®¹çš„ä¸åŒåº¦é‡æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä¿ç•™meanè¿™ç»„ç‰¹å¾ï¼Œåœ¨ç‰¹å¾é€‰æ‹©ä¸­å¿½ç•¥æ‰seå’Œworstã€‚åŒæ—¶æˆ‘ä»¬èƒ½çœ‹åˆ°meanè¿™ç»„ç‰¹å¾ä¸­ï¼Œradius\_meanã€perimeter\_meanã€area\_meanè¿™ä¸‰ä¸ªå±æ€§ç›¸å…³æ€§å¤§ï¼Œcompactness\_meanã€daconcavity\_meanã€concave points\_meanè¿™ä¸‰ä¸ªå±æ€§ç›¸å…³æ€§å¤§ã€‚æˆ‘ä»¬åˆ†åˆ«ä»è¿™2ç±»ä¸­é€‰æ‹©1ä¸ªå±æ€§ä½œä¸ºä»£è¡¨ï¼Œæ¯”å¦‚radius\_meanå’Œcompactness\_meanã€‚

è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŠŠåŸæ¥çš„10ä¸ªå±æ€§ç¼©å‡ä¸º6ä¸ªå±æ€§ï¼Œä»£ç å¦‚ä¸‹ï¼š

```
# ç‰¹å¾é€‰æ‹©
features_remain = ['radius_mean','texture_mean', 'smoothness_mean','compactness_mean','symmetry_mean', 'fractal_dimension_mean'] 
```

å¯¹ç‰¹å¾è¿›è¡Œé€‰æ‹©ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å‡†å¤‡è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼š

```
# æŠ½å–30%çš„æ•°æ®ä½œä¸ºæµ‹è¯•é›†ï¼Œå…¶ä½™ä½œä¸ºè®­ç»ƒé›†
train, test = train_test_split(data, test_size = 0.3)# in this our main data is splitted into train and test
# æŠ½å–ç‰¹å¾é€‰æ‹©çš„æ•°å€¼ä½œä¸ºè®­ç»ƒå’Œæµ‹è¯•æ•°æ®
train_X = train[features_remain]
train_y=train['diagnosis']
test_X= test[features_remain]
test_y =test['diagnosis']
```

åœ¨è®­ç»ƒä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ•°æ®è¿›è¡Œè§„èŒƒåŒ–ï¼Œè¿™æ ·è®©æ•°æ®åŒåœ¨åŒä¸€ä¸ªé‡çº§ä¸Šï¼Œé¿å…å› ä¸ºç»´åº¦é—®é¢˜é€ æˆæ•°æ®è¯¯å·®ï¼š

```
# é‡‡ç”¨Z-Scoreè§„èŒƒåŒ–æ•°æ®ï¼Œä¿è¯æ¯ä¸ªç‰¹å¾ç»´åº¦çš„æ•°æ®å‡å€¼ä¸º0ï¼Œæ–¹å·®ä¸º1
ss = StandardScaler()
train_X = ss.fit_transform(train_X)
test_X = ss.transform(test_X)
```

æœ€åæˆ‘ä»¬å¯ä»¥è®©SVMåšè®­ç»ƒå’Œé¢„æµ‹äº†ï¼š

```
# åˆ›å»ºSVMåˆ†ç±»å™¨
model = svm.SVC()
# ç”¨è®­ç»ƒé›†åšè®­ç»ƒ
model.fit(train_X,train_y)
# ç”¨æµ‹è¯•é›†åšé¢„æµ‹
prediction=model.predict(test_X)
print('å‡†ç¡®ç‡: ', metrics.accuracy_score(test_y,prediction))
```

è¿è¡Œç»“æœï¼š

```
å‡†ç¡®ç‡:  0.9181286549707602
```

å‡†ç¡®ç‡å¤§äº90%ï¼Œè¯´æ˜è®­ç»ƒç»“æœè¿˜ä¸é”™ã€‚å®Œæ•´çš„ä»£ç ä½ å¯ä»¥ä»[GitHub](https://github.com/cystanford/breast_cancer_data)ä¸Šä¸‹è½½ã€‚

## æ€»ç»“

ä»Šå¤©æˆ‘å¸¦ä½ ä¸€èµ·åšäº†ä¹³è…ºç™Œè¯Šæ–­åˆ†ç±»çš„SVMå®æˆ˜ï¼Œä»è¿™ä¸ªè¿‡ç¨‹ä¸­ä½ åº”è¯¥èƒ½ä½“ä¼šå‡ºæ¥æ•´ä¸ªæ‰§è¡Œçš„æµç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®åŠ è½½ã€æ•°æ®æ¢ç´¢ã€æ•°æ®æ¸…æ´—ã€ç‰¹å¾é€‰æ‹©ã€SVMè®­ç»ƒå’Œç»“æœè¯„ä¼°ç­‰ç¯èŠ‚ã€‚

sklearnå·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†å¾ˆå¥½çš„å·¥å…·ï¼Œå¯¹ä¸ŠèŠ‚è¯¾ä¸­è®²åˆ°çš„SVMçš„åˆ›å»ºå’Œè®­ç»ƒéƒ½è¿›è¡Œäº†å°è£…ï¼Œè®©æˆ‘ä»¬æ— éœ€å…³å¿ƒä¸­é—´çš„è¿ç®—ç»†èŠ‚ã€‚ä½†æ­£å› ä¸ºè¿™æ ·ï¼Œæˆ‘ä»¬æ›´éœ€è¦å¯¹æ¯ä¸ªæµç¨‹ç†Ÿç»ƒæŒæ¡ï¼Œé€šè¿‡å®æˆ˜é¡¹ç›®è®­ç»ƒæ•°æ®åŒ–æ€ç»´å’Œå¯¹æ•°æ®çš„æ•æ„Ÿåº¦ã€‚

![](https://static001.geekbang.org/resource/image/79/82/797fe646ae4668139600fca2c50c5282.png?wh=864%2A309)  
æœ€åç»™ä½ ç•™ä¸¤é“æ€è€ƒé¢˜å§ã€‚è¿˜æ˜¯è¿™ä¸ªä¹³è…ºç™Œè¯Šæ–­çš„æ•°æ®ï¼Œè¯·ä½ ç”¨LinearSVCï¼Œé€‰å–å…¨éƒ¨çš„ç‰¹å¾ï¼ˆé™¤äº†IDä»¥å¤–ï¼‰ä½œä¸ºè®­ç»ƒæ•°æ®ï¼Œçœ‹ä¸‹ä½ çš„åˆ†ç±»å™¨èƒ½å¾—åˆ°å¤šå°‘çš„å‡†ç¡®åº¦å‘¢ï¼Ÿå¦å¤–ä½ å¯¹sklearnä¸­SVMä½¿ç”¨åˆæœ‰ä»€ä¹ˆæ ·çš„ä½“ä¼šå‘¢ï¼Ÿ

æ¬¢è¿åœ¨è¯„è®ºåŒºä¸æˆ‘åˆ†äº«ä½ çš„ç­”æ¡ˆï¼Œä¹Ÿæ¬¢è¿ç‚¹å‡»â€œè¯·æœ‹å‹è¯»â€ï¼ŒæŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–è€…åŒäº‹ï¼Œä¸€èµ·æ¥äº¤æµï¼Œä¸€èµ·æ¥è¿›æ­¥ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ15ï¼‰</strong></div><ul>
<li><span>Geek_dancer</span> ğŸ‘ï¼ˆ46ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>é»˜è®¤SVCè®­ç»ƒæ¨¡å‹ï¼Œ6ä¸ªç‰¹å¾å˜é‡ï¼Œè®­ç»ƒé›†å‡†ç¡®ç‡ï¼š96.0%ï¼Œæµ‹è¯•é›†å‡†ç¡®ç‡ï¼š92.4%
é»˜è®¤SVCè®­ç»ƒæ¨¡å‹ï¼Œ10ä¸ªç‰¹å¾å˜é‡ï¼Œè®­ç»ƒé›†å‡†ç¡®ç‡ï¼š98.7% ï¼Œæµ‹è¯•é›†å‡†ç¡®ç‡ï¼š98.2%
LinearSVCè®­ç»ƒæ¨¡å‹ï¼Œ 6ä¸ªç‰¹å¾å˜é‡ï¼Œ è®­ç»ƒé›†å‡†ç¡®ç‡ï¼š93.9%ï¼Œæµ‹è¯•é›†å‡†ç¡®ç‡ï¼š92.3%
LinearSVCè®­ç»ƒæ¨¡å‹ï¼Œ 10ä¸ªç‰¹å¾å˜é‡ï¼Œ è®­ç»ƒé›†å‡†ç¡®ç‡ï¼š99.4%ï¼Œæµ‹è¯•é›†å‡†ç¡®ç‡ï¼š96.0%

ç»“è®ºï¼š
1. å¢åŠ ç‰¹å¾å˜é‡å¯ä»¥æé«˜å‡†ç¡®ç‡ï¼Œå¯èƒ½æ˜¯å› ä¸ºæ¨¡å‹ç»´åº¦å˜é«˜ï¼Œæ¨¡å‹å˜å¾—æ›´åŠ å¤æ‚ã€‚å¯ä»¥çœ‹å‡ºç‰¹å¾å˜é‡çš„é€‰å–å¾ˆé‡è¦ã€‚
2. è®­ç»ƒé›†æ‹Ÿåˆéƒ½æ¯”è¾ƒå¥½ï¼Œä½†æ˜¯æµ‹è¯•é›†å‡†ç¡®ç‡å‡ºç°ä¸åŒç¨‹åº¦çš„ä¸‹é™ã€‚
3. æ¨¡å‹è®­ç»ƒçš„å‡†ç¡®ç‡ä¸äººç±»æ°´å¹³ä¹‹é—´åå·®å¯ä»¥é€šè¿‡å¢åŠ ç‰¹å¾å˜é‡æˆ–é‡‡ç”¨æ–°çš„è®­ç»ƒæ¨¡å‹æ¥é™ä½ï¼›æ¨¡å‹è®­ç»ƒçš„å‡†ç¡®ç‡ä¸æµ‹è¯•é›†æµ‹è¯•çš„å‡†ç¡®ç‡ä¹‹é—´çš„æ–¹å·®å¯ä»¥é€šè¿‡æ­£åˆ™åŒ–ï¼Œæé«˜æ³›åŒ–æ€§èƒ½ç­‰æ–¹å¼æ¥é™ä½ã€‚</p>2019-02-27</li><br/><li><span>æ»¢</span> ğŸ‘ï¼ˆ14ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>åˆ©ç”¨SVMåšåˆ†ç±»ï¼Œç‰¹å¾é€‰æ‹©å½±å“åº¦å¤§ï¼Œè¦æƒ³SVMåˆ†ç±»å‡†ç¡®ï¼Œäººå·¥å¤„ç†æ•°æ®è¿™ä¸€æ­¥å¾ˆé‡è¦</p>2019-04-18</li><br/><li><span>hlz-123</span> ğŸ‘ï¼ˆ11ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>é¦–å…ˆè¦è¯´ï¼Œè€å¸ˆçš„è¯¾è®²å¾—éå¸¸å¥½ï¼Œæ·±å¥¥çš„ç®—æ³•å’Œç†è®ºé€šè¿‡ç”ŸåŠ¨æœ‰è¶£çš„ä¾‹å­è®©äººé€šä¿—æ˜“æ‡‚ï¼Œå…´è¶£ç›ç„¶ã€‚
è€å¸ˆçš„æœ¬è¯¾æ¡ˆä¾‹ä¸­ï¼Œå¯¹ç‰¹å¾æ•°æ®éƒ½åšäº†Z-Scoreè§„èŒƒåŒ–å¤„ç†ï¼ˆæ­£æ€åˆ†å¸ƒï¼‰ï¼Œå‡†ç¡®ç‡åœ¨90%ä»¥ä¸Šï¼Œå¦‚æœæ•°æ®ä¸åšè§„èŒƒåŒ–å¤„ç†ï¼Œå‡†ç¡®ç‡åœ¨88%å·¦å³ï¼Œæˆ‘çš„é—®é¢˜ï¼š
1ã€æ•°æ®è§„èŒƒåŒ–å¤„ç†ï¼Œæ˜¯ä¸æ˜¯äººä¸ºåœ°æä¾›äº†å‡†ç¡®ç‡ï¼Ÿå®é™…æƒ…å†µï¼Œæ•°æ®ä¸ä¸€å®šæ˜¯æ­£æ€åˆ†å¸ƒã€‚
2ã€æ¨¡å‹å»ºå¥½åï¼Œåœ¨å®é™…åº”ç”¨ä¸­å»è¯„ä¼°æŸä¸ªæ¡ˆä¾‹æ—¶ï¼Œè¯¥æ¡ˆä¾‹æ•°æ®æ˜¯ä¸æ˜¯ä¹Ÿè¦è§„èŒƒåŒ–ï¼Œè¿™æ ·åšæ˜¯ä¸æ˜¯å¾ˆéº»çƒ¦å¹¶ä¸”æ•°æ®å¯¹æ¯”ä¸æ˜¯å¾ˆç›´è§‚å‘¢ï¼Ÿ</p>2019-03-16</li><br/><li><span>Rickie</span> ğŸ‘ï¼ˆ7ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æ€è€ƒé¢˜ï¼š
ä½¿ç”¨å…¨éƒ¨æ•°æ®è¿›è¡Œè®­ç»ƒå¾—åˆ°çš„å‡†ç¡®ç‡ä¸º0.9766ï¼Œé«˜äºç¤ºä¾‹ä¸­çš„å‡†ç¡®ç‡ã€‚æ˜¯å¦æ˜¯ç”±äºå¤šé‡å…±çº¿æ€§ï¼Œä½¿å¾—æµ‹è¯•ç»“æœåé«˜ï¼Ÿ</p>2019-02-05</li><br/><li><span>æ˜ç¿¼</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<p>è€å¸ˆæˆ‘åˆ©ç”¨äº†ç»“æœå’Œç‰¹å¾çš„ç›¸å…³æ€§ï¼Œé€‰æ‹©ç‰¹å¾ï¼Œå‘ç°ç»“æœæ›´å¥½ï¼š
# ç‰¹å¾é€‰æ‹© æŒ‰ç…§ç»“æœå’Œæ•°æ®ç›¸å…³æ€§é€‰æ‹©ç‰¹å¾å‡†ç¡®ç‡0.9707602339181286
features_remain = [&#39;radius_mean&#39;,&#39;perimeter_mean&#39;,&#39;area_mean&#39;,&#39;concave points_mean&#39;,&#39;radius_worst&#39;,&#39;perimeter_worst&#39;,&#39;area_worst&#39;,&#39;concave points_worst&#39;]</p>2019-11-10</li><br/><li><span>Ricky</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è°¢è°¢ï¼Œæ2ä¸ªé—®é¢˜ï¼Œ
1ï¼‰åœ¨å®é™…åº”ç”¨ä¸­å¦‚ä½•å¹³è¡¡ç‰¹å¾å˜é‡å’Œå‡†ç¡®ç‡çš„å…³ç³»ï¼Ÿæœ‰æ²¡æœ‰æ–¹æ³•è®ºï¼Ÿ
å¢åŠ ç‰¹å¾å˜é‡æ„å‘³ç€å¢åŠ è¿ç®—æ—¶é—´ï¼Œæé«˜å‡†ç¡®ç‡ï¼Œä½†æ˜¯è¿™ä¸ªå¾—å¤±æ€ä¹ˆæŠŠæ¡ï¼ŸåŒæ—¶å¦‚ä½•è¯„ä¼°ä¼šå¢åŠ å¤šå°‘è¿ç®—æ—¶é—´ï¼Œä¸€ä¸ªä¸€ä¸ªå°è¯•ä¼¼ä¹æ¯”è¾ƒè´¹åŠ²å§
2ï¼‰æ­¤æ–‡çš„æ¡ˆä¾‹æ˜¯é€‰ç”¨å¹³å‡å€¼ï¼Œä¸¢å¼ƒäº†æœ€å¤§å€¼å’Œæ ‡å‡†å·®ï¼Œè¿™ä¸ªæ˜¯å¤šå°‘æ¡ˆä¾‹çš„é€šç”¨åšæ³•ä¹ˆï¼Ÿ

è°¢è°¢</p>2020-04-15</li><br/><li><span>æ¬æ¬</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>å¯¹æ¯”å‡ ç»„featureåï¼Œå‘ç°ç”¨feature_worstè¿›è¡Œè®­ç»ƒï¼Œæ•ˆæœæ›´å¥½ã€‚
1ï¼‰SVC(kernel=&#39;linear&#39;)çš„æµ‹è¯•é›†å‡†ç¡®ç‡ä¸ºï¼š99.42%ï¼›
2)  LinearSVC()çš„æµ‹è¯•é›†å‡†ç¡®ç‡ä¸ºï¼š97.07%
2ï¼‰SVC()çš„æµ‹è¯•é›†å‡†ç¡®ç‡ä¸ºï¼š96.49%
è§‰å¾—å»ºæ¨¡è¿‡ç¨‹ä¸­ï¼Œç‰¹å¾é€‰æ‹©å¾ˆé‡è¦ï¼Œä¸åŒçš„æ•°æ®é›†åˆ’åˆ†ï¼Œæ­£è´Ÿæ ·æœ¬æ˜¯å¦å¹³è¡¡ä¹Ÿä¼šå¯¹ç»“æœæœ‰ä¸€å®šçš„å½±å“ï¼Œæ‰€ä»¥æœ€å¥½æ˜¯å¯ä»¥é‡‡ç”¨äº¤å‰éªŒè¯æ¥è®­ç»ƒæ¨¡å‹ã€‚è¿™ä¸ªåœ°æ–¹å¤šæ¬¡æµ‹è¯•SVC(kernel=&#39;linear&#39;ï¼‰å’ŒLinearSVC()ï¼Œæ„Ÿè§‰è¿˜æ˜¯ä¼šå­˜åœ¨2ä¸ªç™¾åˆ†ç‚¹å·¦å³çš„å·®å¼‚ï¼Œè¿™ä¸¤ä¸ªéƒ½ç®—æ˜¯çº¿æ€§åˆ†ç±»ï¼Œæ˜¯å› ä¸ºé‡‡ç”¨äº†ä¸åŒçš„çº¿æ€§æ ¸å‡½æ•°å—ï¼Ÿè¿˜æ˜¯å…¶ä»–å‚æ•°æˆ–æ˜¯æ–¹æ³•å·®å¼‚çš„åŸå› å‘¢ï¼Ÿ</p>2020-03-31</li><br/><li><span>æ»¢</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è¯­è¨€Python3.6  æ²¡æœ‰z-scoreè§„èŒƒåŒ–æ•°æ®ä»¥åŠè§„èŒƒåŒ–åä¸¤ç§æƒ…å†µå‰æé¢„æµ‹å‡†ç¡®ç‡ï¼Œä½¿ç”¨LinearSVCï¼Œé€‰å–æ‰€æœ‰meanå±æ€§

import  pandas as  pd
import  matplotlib.pyplot as  plt
import  seaborn as  sns
from sklearn.model_selection import  train_test_split
from sklearn import  svm
from sklearn import  metrics
from sklearn.preprocessing import  StandardScaler

#å¯¼å…¥æ•°æ®
path = &#39;&#47;Users&#47;apple&#47;Desktop&#47;GitHubProject&#47;Read mark&#47;æ•°æ®åˆ†æ&#47;geekTime&#47;data&#47;&#39;
data = pd.read_csv(path + &#39;breast_cancer&#47;data.csv&#39;)

#æ•°æ®æ¢ç´¢
pd.set_option(&#39;display.max_columns&#39;, None)
print(data.columns)
print(data.head(5))
print(data.describe())

#å°†ç‰¹å¾å­—æ®µè¿›è¡Œåˆ†ç»„
features_mean = list(data.columns[2:12])
features_se = list(data.columns[12:22])
features_worst = list(data.columns[22:32])

#æ•°æ®æ¸…æ´—
#åˆ é™¤IDåˆ—
data.drop(&#39;id&#39;,axis=1,inplace=True)
#å°†è‰¯æ€§Bæ›¿æ¢ä¸º0ï¼Œå°†æ¶æ€§æ›¿æ¢ä¸º1
data[&#39;diagnosis&#39;] = data[&#39;diagnosis&#39;].map({&#39;B&#39;:0,&#39;M&#39;:1})

#å°†è‚¿ç˜¤è¯Šæ–­ç»“æœå¯è§†åŒ–
sns.countplot(data[&#39;diagnosis&#39;],label=&#39;count&#39;)
plt.show()
#è®¡ç®—ç›¸å…³ç³»æ•°
corr = data[features_mean].corr()
plt.figure(figsize=(14,14))

#ç”¨çƒ­åŠ›å›¾å‘ˆç°ç›¸å…³æ€§ï¼Œæ˜¾ç¤ºæ¯ä¸ªæ–¹æ ¼çš„æ•°æ®
sns.heatmap(corr,annot=True)
plt.show()

#ç‰¹å¾é€‰æ‹©ï¼Œé€‰æ‹©æ‰€æœ‰çš„meanæ•°æ®
feature_remain = [&#39;radius_mean&#39;, &#39;texture_mean&#39;, &#39;perimeter_mean&#39;,
       &#39;area_mean&#39;, &#39;smoothness_mean&#39;, &#39;compactness_mean&#39;, &#39;concavity_mean&#39;,
       &#39;concave points_mean&#39;, &#39;symmetry_mean&#39;, &#39;fractal_dimension_mean&#39;]

#æŠ½å–30%ç‰¹å¾é€‰æ‹©ä½œä¸ºæµ‹è¯•æ•°æ®ï¼Œå…¶ä½™ä½œä¸ºè®­ç»ƒé›†
train,test = train_test_split(data,test_size=0.3)
#æŠ½å–ç‰¹å¾é€‰æ‹©ä½œä¸ºè®­ç»ƒå’Œæµ‹è¯•æ•°æ®
train_data = train[feature_remain]
train_result = train[&#39;diagnosis&#39;]
test_data = test[feature_remain]
test_result = test[&#39;diagnosis&#39;]

#åˆ›å»ºSVMåˆ†ç±»å™¨
model = svm.LinearSVC()
#ç”¨è®­ç»ƒé›†åšè®­ç»ƒ
model.fit(train_data,train_result)
#ç”¨æµ‹è¯•é›†åšé¢„æµ‹
prediction = model.predict(test_data)
#å‡†ç¡®ç‡
print(&#39;å‡†ç¡®ç‡:&#39;, metrics.accuracy_score(prediction,test_result))

#è§„èŒƒåŒ–æ•°æ®ï¼Œå†é¢„ä¼°å‡†ç¡®ç‡
z_score = StandardScaler()
train_data = z_score.fit_transform(train_data)
test_data = z_score.transform(test_data)
#ç”¨æ–°æ•°æ®åšè®­ç»ƒ
new_model = svm.LinearSVC()
new_model.fit(train_data,train_result)
#é‡æ–°é¢„æµ‹
new_prediction = new_model.predict(test_data)
#å‡†ç¡®ç‡
print(&#39;å‡†ç¡®ç‡:&#39;,metrics.accuracy_score(new_prediction,test_result))</p>2019-04-18</li><br/><li><span>Ronnyz</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>é€‰å–å…¨éƒ¨ç‰¹å¾ï¼š
SVMåˆ†ç±»å™¨å‡†ç¡®ç‡ï¼š 0.9824561403508771
cross_val_scoreçš„å‡†ç¡®ç‡ä¸ºï¼š0.9727
linearSVMåˆ†ç±»å™¨çš„å‡†ç¡®ç‡ï¼š 0.9766081871345029
cross_val_scoreçš„å‡†ç¡®ç‡ä¸ºï¼š0.9652

é€‰å–meanç›¸å…³ç‰¹å¾ï¼š
SVMåˆ†ç±»å™¨å‡†ç¡®ç‡ï¼š 0.9239766081871345
cross_val_scoreçš„å‡†ç¡®ç‡ä¸ºï¼š0.9321
linearSVMåˆ†ç±»å™¨çš„å‡†ç¡®ç‡ï¼š 0.9298245614035088
cross_val_scoreçš„å‡†ç¡®ç‡ä¸ºï¼š0.9247

æ•°æ®ç»“æœä¸Šçœ‹ï¼š
SVMçš„ç»“æœè¦å¥½äºlinearSVM;
é€‰å–å¤šç‰¹å¾çš„ç»“æœè¦å¥½äºé€‰å–å°‘ç‰¹å¾çš„ç»“æœ</p>2019-11-14</li><br/><li><span>third</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ç¬¬äºŒä¸ªï¼Œå‡†ç¡®ç‡ 0.935672514619883ã€‚

æ„Ÿè§‰è¿˜è›®å¥½ç”¨çš„ï¼Œåªæ˜¯ä¸æ˜¯å¾ˆç†Ÿç»ƒçš„ä½¿ç”¨å„ä¸ªç®—æ³•åšåˆ†ç±»å’Œå›å½’</p>2019-02-18</li><br/><li><span>Python</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆå¯ä»¥ç”¨PCAè¿›è¡Œç‰¹å¾é€‰æ‹©å—ï¼Ÿå¦‚æœå¯ä»¥ï¼Œé‚£å’Œä½ è¿™ç§æ‰‹åŠ¨çš„æ–¹æ³•æ¯”æœ‰ä»€ä¹ˆå·®åˆ«</p>2019-02-04</li><br/><li><span>æ™¨æ›¦</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼Œå¦‚æœè¿™ä¸ªç—…ç—‡æ”¹ä¸ºä¸å¾—ç—…ï¼Œè½»ç—‡ï¼Œé‡ç—‡ä¸‰ä¸ªåˆ†ç±»ï¼Œä¸æ˜¯äºŒåˆ†ç±»é—®é¢˜ï¼Œå¯¹åº”æ”¹æˆåˆ†ç±»åºå·ï¼Œ0,1,2ã€‚é‚£ä¹ˆè¿™å¥—ç®—æ³•æ˜¯ä¸æ˜¯ä¹Ÿä¸ç®—é”™</p>2021-01-23</li><br/><li><span>é‚¹æ´²</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p># coding=utf-8
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
#å¯¼å…¥sklearnä¸­çš„SVMåº“
from sklearn import svm, metrics

#æ„é€ çº¿æ€§åˆ†ç±»æ¨¡å‹
model = svm.SVC(kernel=&quot;rbf&quot;,C=1.0,gamma=&quot;auto&quot;)
model2 = svm.LinearSVC()
&quot;&quot;&quot;
kernel :
    linear:çº¿æ€§æ¨¡å‹ï¼Œå½“æ¨¡å‹ä¸ºlinearsvmæ—¶ï¼Œå°±è¡¨æ˜æ²¡æœ‰kernelå‚æ•°
    polyï¼šå¤šé¡¹å¼æ¨¡å‹
    rbf:é«˜æ–¯å‡½æ•°
    sigmoid:sigmoidæ ¸å‡½æ•°
Cï¼šç›®æ ‡å‡½æ•°çš„æƒ©ç½šç³»æ•°
gamma :æ ¸å‡½æ•°ç³»æ•°
&quot;&quot;&quot;

#å®æˆ˜å¼€å§‹--åŠ è½½æ•°æ®
data = pd.read_csv(&#39;data.csv&#39;,engine=&#39;python&#39;)
# pd.set_option(&#39;display.max_columns&#39;,None)
#æŸ¥çœ‹ä¸€ä¸‹æ•°æ®ä¿¡æ¯
# print(data.columns)
# print(data.info())
# print(data.head(5))
# print(data[&#39;diagnosis&#39;].value_counts())

#æ•°æ®å¤„ç†
#idå­—æ®µå¯¹äºåˆ†ç±»æ— ç”¨ï¼Œåˆ é™¤å³å¯
data.drop(&#39;id&#39;,axis=1,inplace=True)
#diagnosiså­—æ®µä¸ºå­—ç¬¦å‹ï¼Œç»„éœ€è½¬æ¢ä¸ºæ•°å€¼å‹0 1
data[&#39;diagnosis&#39;] = data[&#39;diagnosis&#39;].map({&#39;M&#39;:1,&#39;B&#39;:0})

feature_mean = data.columns[1:11]
feature_se = data.columns[11:21]
feature_max = data.columns[21:31]


#ç»Ÿè®¡ä¸€ä¸‹è‚¿ç˜¤äººæ•°æƒ…å†µ
sns.countplot(data[&#39;diagnosis&#39;],label=&#39;Count&#39;)
# plt.show()

#æŸ¥çœ‹å„ä¸ªç‰¹å¾çš„ç›¸å…³åº¦
corr = data[feature_mean].corr()
plt.figure(figsize=(14,14))
sns.heatmap(corr,annot=True)
# plt.show()

feature_sel = [&#39;radius_mean&#39;,&#39;texture_mean&#39;,&#39;smoothness_mean&#39;,&#39;compactness_mean&#39;,&#39;symmetry_mean&#39;,&#39;fractal_dimension_mean&#39;]


train_data,test_data = train_test_split(data,test_size=0.3)

train_feature = train_data[feature_sel]
train_label = train_data[&#39;diagnosis&#39;]
test_feature = test_data[feature_sel]
test_label = test_data[&#39;diagnosis&#39;]

#å¼€å§‹è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®
#é‡‡ç”¨Z-Scoreè§„èŒƒåŒ–å¤„ç†ï¼Œä¿è¯æ¯ä¸€ä¸ªç‰¹å¾ç»´åº¦çš„æ•°æ®å‡å€¼ä¸º0ï¼Œæ–¹å·®ä¸º1
ss = StandardScaler()
train_feature = ss.fit_transform(train_feature)
test_feature = ss.transform(test_feature)

#å¼€å§‹é¢„æµ‹
model.fit(train_feature,train_label)
model2.fit(train_feature,train_label)
predict_label = model.predict(test_feature)
predict_label2 = model2.predict(test_feature)
#å‡†ç¡®åº¦ -- æ¯æ¬¡è¿è¡Œä¸ä¸€æ ·
print(&quot;é«˜æ–¯å‡†ç¡®ç‡ï¼š&quot;,metrics.accuracy_score(test_label,predict_label))
print(&quot;çº¿æ€§å‡†ç¡®åº¦ï¼š&quot;,metrics.accuracy_score(test_label,predict_label2))


</p>2020-08-26</li><br/><li><span>æœ±ä¸€æ±Ÿ</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æˆ‘ä»¬æ‰€æµ‹çš„å‡†ç¡®ç‡æ˜¯ä¸train_yè¿›è¡Œæ¯”è¾ƒçš„å—
</p>2020-08-22</li><br/><li><span>é±¼éå­</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn import svm
from sklearn import metrics


data = pd.read_csv(&quot;.&#47;data.csv&quot;)
pd.set_option(&#39;display.max_columns&#39;, None)
# print(data.head(5))
# print(data.columns)
# print(data.describe())

features_mean = list(data.columns[2:12])
features_se = list(data.columns[12:22])
features_worst = list(data.columns[22:32])

data.drop(&quot;id&quot;,axis=1,inplace=True)
data[&#39;diagnosis&#39;] = data[&#39;diagnosis&#39;].map({&#39;M&#39;:1,&#39;B&#39;:0})
# print(data.head(5))

sns.countplot(data[&#39;diagnosis&#39;],label=&quot;Count&quot;)
plt.show()

corr = data[features_mean].corr()
plt.figure(figsize=(14,14))
sns.heatmap(corr,annot=True)
plt.show()

features_remain = [&#39;radius_mean&#39;,&#39;texture_mean&#39;, &#39;smoothness_mean&#39;,&#39;compactness_mean&#39;,&#39;symmetry_mean&#39;, &#39;fractal_dimension_mean&#39;]
X_train, X_test, y_train, y_test = train_test_split(data[features_remain], data[&#39;diagnosis&#39;], test_size=0.3,random_state=0)

# é‡‡ç”¨Z-Scoreè§„èŒƒåŒ–æ•°æ®ï¼Œä¿è¯æ¯ä¸ªç‰¹å¾ç»´åº¦çš„æ•°æ®å‡å€¼ä¸º0ï¼Œæ–¹å·®ä¸º1
ss = StandardScaler()
X_train = ss.fit_transform(X_train)
X_test = ss.transform(X_test)

model = svm.SVC()
model.fit(X_train,y_train)

prediction = model.predict(X_test)
print(&quot;å‡†ç¡®ç‡ï¼š&quot;,metrics.accuracy_score(prediction,y_test))

å‡†ç¡®ç‡ï¼š 0.9239766081871345
</p>2020-03-04</li><br/>
</ul>