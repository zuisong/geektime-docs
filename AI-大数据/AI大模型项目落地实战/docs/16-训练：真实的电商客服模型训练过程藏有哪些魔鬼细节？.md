ä½ å¥½ï¼Œæˆ‘æ˜¯é‡‘ä¼Ÿã€‚

å¦‚æœæŠŠè®­ç»ƒæ•°æ®çœ‹ä½œä¸€ä¸ªç¨‹åºé‡Œçš„æ•°æ®ç»“æ„ï¼Œé‚£æ¨¡å‹è®­ç»ƒåˆ™å¯ä»¥çœ‹ä½œè¿™ä¸ªç¨‹åºçš„ç®—æ³•éƒ¨åˆ†ã€‚é€šè¿‡ä¸Šä¸€èŠ‚è¯¾ï¼Œæ•°æ®å·²ç»å‡†å¤‡å®Œæ¯•ï¼Œæ¥ä¸‹æ¥è¯·ä½ è·Ÿç€æˆ‘ä¸€èµ·æ¥å°è¯•å¤§æ¨¡å‹è®­ç»ƒã€‚

å¦‚æœä½ å·²ç»æ¥è§¦è¿‡ä¸€äº›å¤§æ¨¡å‹çš„èµ„æ–™ï¼Œå¯èƒ½ä¼šå‘ç°å¤§æ¨¡å‹è®­ç»ƒçš„æ ¸å¿ƒä»£ç éƒ½ç±»ä¼¼ä¸‹é¢è¿™ä¸€å°æ®µç¨‹åºï¼ˆ**ç¨‹åº1**ï¼‰ã€‚

```plain
#ç¨‹åº1
import torch
from transformers import Trainer, TrainingArguments


#å®šä¹‰è®­ç»ƒå‚æ•°
training_args = TrainingArguments(
    output_dir='./results',          #è¾“å‡ºç›®å½•
    evaluation_strategy="epoch",     #è¯„ä¼°ç­–ç•¥ï¼Œæ¯ä¸ªepochè¯„ä¼°ä¸€æ¬¡
    per_device_train_batch_size=8,   #è®­ç»ƒæ—¶æ¯ä¸ªè®¾å¤‡çš„æ‰¹é‡å¤§å°
    per_device_eval_batch_size=8,    #è¯„ä¼°æ—¶æ¯ä¸ªè®¾å¤‡çš„æ‰¹é‡å¤§å°
    num_train_epochs=50,             #æœ€å¤§è®­ç»ƒè½®æ¬¡
    save_steps=10_000,               #ä¿å­˜é—´éš”æ­¥æ•°
    eval_steps=500,                  #è¯„ä¼°é—´éš”æ­¥æ•°
    logging_steps=500,               #æ—¥å¿—è®°å½•é—´éš”æ­¥æ•°
    learning_rate=2e-5,              #å­¦ä¹ ç‡
    load_best_model_at_end=True,     #åœ¨ç»“æŸæ—¶åŠ è½½æœ€ä½³æ¨¡å‹
)


#åˆ›å»ºTrainerå®ä¾‹
trainer = Trainer(
    model=model,                         #ä½ çš„æ¨¡å‹
    args=training_args,                  #è®­ç»ƒå‚æ•°
    train_dataset=train_dataset,         #è®­ç»ƒæ•°æ®é›†
    eval_dataset=eval_dataset            #éªŒè¯æ•°æ®é›†
)


#å¼€å§‹è®­ç»ƒ
trainer.train()
```
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ3ï¼‰</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/11/59/51/4d0603cf.jpg" width="30px"><span>å›mo</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æ¯”è¾ƒå¹²è´§ï¼ŒğŸ‘</div>2024-09-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/a0/c3/c5db35df.jpg" width="30px"><span>çŸ³äº‘å‡</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>å¤§æ¨¡å‹è¾“å‡ºæœ¬æ¥å°±æ˜¯é»‘ç›’äº†ï¼Œå¦‚æœè¿å¾®è°ƒéƒ½å˜æˆé»‘ç›’ï¼Œé‚£ä¹ˆå…·ä½“å¤§æ¨¡å‹ä¼šè¾“å‡ºä»€ä¹ˆå°±å®Œå…¨ä¸å¯æ§äº†ï¼Œæ›´åˆ«è¯´è¦å¯¹é½äº†ã€‚</div>2024-09-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/28/b5/5f/4ac4d6c7.jpg" width="30px"><span>ä¸å€¼å¾—</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>æœ‰æºç å—</div>2024-12-20</li><br/>
</ul>