ä½ å¥½ï¼Œæˆ‘æ˜¯å¾æ–‡æµ©ã€‚

ä¸Šä¸€è®²æˆ‘ä»¬çœ‹åˆ°äº†ï¼Œå¤§å‹è¯­è¨€æ¨¡å‹çš„æ¥å£å…¶å®éå¸¸ç®€å•ã€‚åƒOpenAIå°±åªæä¾›äº†Completeå’ŒEmbeddingä¸¤ä¸ªæ¥å£ï¼Œå…¶ä¸­ï¼ŒCompleteå¯ä»¥è®©æ¨¡å‹æ ¹æ®ä½ çš„è¾“å…¥è¿›è¡Œè‡ªåŠ¨ç»­å†™ï¼ŒEmbeddingå¯ä»¥å°†ä½ è¾“å…¥çš„æ–‡æœ¬è½¬åŒ–æˆå‘é‡ã€‚

ä¸è¿‡åˆ°è¿™é‡Œï¼Œä½ çš„ç–‘é—®å¯èƒ½å°±æ¥äº†ã€‚ä¸æ˜¯è¯´ç°åœ¨çš„å¤§è¯­è¨€æ¨¡å‹å¾ˆå‰å®³å—ï¼Ÿä¼ ç»Ÿçš„è‡ªç„¶è¯­è¨€å¤„ç†é—®é¢˜éƒ½å¯ä»¥é€šè¿‡å¤§æ¨¡å‹è§£å†³ã€‚å¯æ˜¯ç”¨è¿™ä¹ˆç®€å•çš„ä¸¤ä¸ªAPIï¼Œèƒ½å¤Ÿå®ŒæˆåŸæ¥éœ€è¦é€šè¿‡å„ç§NLPæŠ€æœ¯è§£å†³çš„é—®é¢˜å—ï¼Ÿæ¯”å¦‚æƒ…æ„Ÿåˆ†æã€æ–‡æœ¬åˆ†ç±»ã€æ–‡ç« èšç±»ã€æ‘˜è¦æ’°å†™ã€æœç´¢ï¼Œè¿™ä¸€ç³»åˆ—é—®é¢˜æ€ä¹ˆé€šè¿‡è¿™ä¸¤ä¸ªæ¥å£è§£å†³å‘¢ï¼Ÿ

åˆ«æ€¥ï¼Œåœ¨æ¥ä¸‹æ¥çš„å‡ è®²é‡Œï¼Œæˆ‘ä¼šå‘Šè¯‰ä½ ï¼Œæ€ä¹ˆåˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹æä¾›çš„è¿™ä¸¤ä¸ªç®€å•çš„APIæ¥è§£å†³ä¼ ç»Ÿçš„è‡ªç„¶è¯­è¨€å¤„ç†é—®é¢˜ã€‚è¿™ä¸€è®²æˆ‘ä»¬å°±å…ˆä»ä¸€ä¸ªæœ€å¸¸è§çš„è‡ªç„¶è¯­è¨€å¤„ç†é—®é¢˜â€”â€”â€œæƒ…æ„Ÿåˆ†æâ€å¼€å§‹ï¼Œæ¥çœ‹çœ‹æˆ‘ä»¬æ€ä¹ˆæŠŠå¤§è¯­è¨€æ¨¡å‹ç”¨èµ·æ¥ã€‚

## ä¼ ç»Ÿçš„äºŒåˆ†ç±»æ–¹æ³•ï¼šæœ´ç´ è´å¶æ–¯ä¸é€»è¾‘å›å½’

â€œæƒ…æ„Ÿåˆ†æâ€é—®é¢˜ï¼Œæ˜¯æŒ‡æˆ‘ä»¬æ ¹æ®ä¸€æ®µæ–‡å­—ï¼Œå»åˆ¤æ–­å®ƒçš„æ€åº¦æ˜¯æ­£é¢çš„è¿˜æ˜¯è´Ÿé¢çš„ã€‚åœ¨ä¼ ç»Ÿçš„äº’è”ç½‘äº§å“é‡Œï¼Œç»å¸¸ä¼šè¢«ç”¨æ¥åˆ†æç”¨æˆ·å¯¹äº§å“ã€æœåŠ¡çš„è¯„ä»·ã€‚æ¯”å¦‚å¤§ä¼—ç‚¹è¯„é‡Œé¢ï¼Œä½ å¯¹é¤é¦†çš„è¯„è®ºï¼Œåœ¨äº¬ä¸œä¹°ä¸ªä¸œè¥¿ï¼Œä½ å¯¹å•†å“çš„è¯„è®ºï¼Œéƒ½ä¼šè¢«å¹³å°æ‹¿å»åˆ†æï¼Œç»™å•†å®¶æˆ–è€…é¤é¦†çš„è¯„åˆ†åšå‚è€ƒã€‚ä¹Ÿæœ‰äº›å“ç‰Œï¼Œä¼šä¸“é—¨æŠ“å–ç¤¾äº¤ç½‘ç»œé‡Œç”¨æˆ·å¯¹è‡ªå·±äº§å“çš„è¯„ä»·ï¼Œæ¥è¿›è¡Œæƒ…æ„Ÿåˆ†æï¼Œåˆ¤æ–­æ¶ˆè´¹è€…å¯¹è‡ªå·±çš„äº§å“è¯„ä»·æ˜¯æ­£é¢è¿˜æ˜¯è´Ÿé¢çš„ï¼Œå¹¶ä¸”ä¼šæ ¹æ®è¿™äº›è¯„ä»·æ¥æ”¹è¿›è‡ªå·±çš„äº§å“ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ30ï¼‰</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/12/08/ab/caec7bca.jpg" width="30px"><span>humor</span> ğŸ‘ï¼ˆ22ï¼‰ ğŸ’¬ï¼ˆ4ï¼‰<div>å¤§æ¨¡å‹æ˜¯æ€ä¹ˆçŸ¥é“å¥½è¯„å’Œå·®è¯„æ˜¯ä»£è¡¨ä»€ä¹ˆæ„æ€çš„å‘¢</div>2023-03-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/51/bc/c7514a30.jpg" width="30px"><span>Dev.lu</span> ğŸ‘ï¼ˆ21ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>conda install -c conda-forge matplotlib
conda install -c conda-forge plotly   
conda install -c anaconda scikit-learn
è·‘æƒ…æ„Ÿåˆ†æçš„éƒ¨åˆ†ï¼Œå¯èƒ½éœ€è¦é¢å¤–å®‰è£…è¿™äº›åŒ…</div>2023-04-15</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLLqPl9wGGaKWD8sXcB6oicibvUzBZ3zaPyicTVwZQnUQEYyhaGTf4YmVIWMX0oEcfKibZ0JlZsMZYvjw/132" width="30px"><span>Geek_035566</span> ğŸ‘ï¼ˆ19ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>çŸ¥ä¹ä¸Šå¼ ä¿Šæ—å¯¹GPTå¯¹NLPçš„å½±å“åšäº†å¾ˆå¥½è§£è¯»ï¼Œæˆ‘è¿™ä¸ªå°ç™½å¬äº†ä¹Ÿèƒ½æœ‰å¾ˆæ·±çš„ç†è§£ã€‚

ä»–æŠŠNLPè§£å†³çš„é—®é¢˜åˆ†ä¸ºä¸­é—´ä»»åŠ¡å’Œæœ€ç»ˆä»»åŠ¡ï¼Œå…ˆé˜è¿°ä¸­é—´ä»»åŠ¡å…¶å®æ˜¯äººç±»æ²¡æœ‰æ‰¾åˆ°æ›´å¥½åŠæ³•å¤„ç†è‡ªç„¶è¯­è¨€æ—¶æƒ³å‡ºæ¥çš„è¾…åŠ©å·¥å…·ï¼ŒGPTçš„å‡ºç°ä¸€ç¬é—´è®©è¿™äº›è„šæ‰‹æ¶éƒ½æ²¡äº†ç”¨å¤„ã€‚

å†è¿›ä¸€æ­¥ï¼Œä»–åˆæŠŠæœ€ç»ˆä»»åŠ¡åˆ†ä¸ºè‡ªç„¶è¯­è¨€ç†è§£å’Œè‡ªç„¶è¯­è¨€ç”Ÿæˆä»»åŠ¡ï¼Œè¿›ä¸€æ­¥åˆ†æGPTå¯¹è¿™ä¸¤ç±»ä»»åŠ¡çš„å½±å“ã€‚

å¾ˆç®€æ´ä¼˜ç¾çš„è®²æ¸…æ¥šäº†GPTå¯¹NLPçš„å†²å‡»ï¼ŒçŸ¥ä¹åœ°å€æˆ‘æ”¾ä¸‹é¢ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªå·±çœ‹ã€‚
https:&#47;&#47;zhuanlan.zhihu.com&#47;p&#47;597586623</div>2023-05-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/c3/71/e7990e80.jpg" width="30px"><span>jo</span> ğŸ‘ï¼ˆ15ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>â€œæˆ‘ä»¬æŠŠè¿™æ®µæ–‡æœ¬çš„ Embedding å’Œâ€œå¥½è¯„â€ä»¥åŠâ€œå·®è¯„â€é€šè¿‡ä½™å¼¦è·ç¦»ï¼ˆCosine Similarityï¼‰è®¡ç®—å‡ºå®ƒçš„ç›¸ä¼¼åº¦â€ï¼Œä¸å¤ªæ‡‚</div>2023-04-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/c4/92/338b5609.jpg" width="30px"><span>Roy Liang</span> ğŸ‘ï¼ˆ8ï¼‰ ğŸ’¬ï¼ˆ4ï¼‰<div>è¯¾åä½œä¸šï¼Œå…¨éƒ¨æ•°æ®é›†æ˜¯ä¸æ˜¯å¤ªå¤šï¼Œå‡ºä¸äº†ç»“æœï¼Œå‰33æ¡è®°å½•æ²¡é—®é¢˜ï¼Œæˆ‘æ˜¯ä¸æ˜¯è¯¥ç»™OpenAIå……å€¼ï¼Ÿ

              precision    recall  f1-score   support

    negative       0.81      0.93      0.87        14
    positive       0.92      0.79      0.85        14

    accuracy                           0.86        28
   macro avg       0.86      0.86      0.86        28
weighted avg       0.86      0.86      0.86        28

ä»£ç 
import pandas as pd
import numpy as np

from sklearn.metrics import classification_report,PrecisionRecallDisplay
from openai.embeddings_utils import cosine_similarity, get_embedding

EMBEDDING_MODEL = &quot;text-embedding-ada-002&quot;

#datafile_path = &quot;data&#47;AllProductReviews.csv&quot;
datafile_path = &quot;data&#47;test.csv&quot;
df = pd.read_csv(datafile_path)
df[&quot;embedding&quot;] = df.ReviewBody.apply(lambda x: get_embedding(x, engine=EMBEDDING_MODEL))

# convert 5-star rating to binary sentiment
df = df[df.ReviewStar != 3]
df[&quot;sentiment&quot;] = df.ReviewStar.replace({1: &quot;negative&quot;, 2: &quot;negative&quot;, 4: &quot;positive&quot;, 5: &quot;positive&quot;})

def evaluate_embeddings_approach(
    labels = [&#39;negative&#39;, &#39;positive&#39;],
    model = EMBEDDING_MODEL,
):
    label_embeddings = [get_embedding(label, engine=model) for label in labels]

    def label_score(review_embedding, label_embeddings):
        return cosine_similarity(review_embedding, label_embeddings[1]) - cosine_similarity(review_embedding, label_embeddings[0])

    probas = df[&quot;embedding&quot;].apply(lambda x: label_score(x, label_embeddings))
    preds = probas.apply(lambda x: &#39;positive&#39; if x&gt;0 else &#39;negative&#39;)

    report = classification_report(df.sentiment, preds)
    print(report)

    display = PrecisionRecallDisplay.from_predictions(df.sentiment, probas, pos_label=&#39;positive&#39;)
    _ = display.ax_.set_title(&quot;2-class Precision-Recall curve&quot;)

evaluate_embeddings_approach()</div>2023-03-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/36/82/30/d48e8135.jpg" width="30px"><span>pippo</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>æ–‡æœ¬å‘é‡positiveå’Œnegativeæ ‡ç­¾æ˜¯openaiè®­ç»ƒæ ‡æ³¨å¥½çš„ï¼Œé‚£è¿˜æœ‰å…¶ä»–ä»€ä¹ˆæ ‡ç­¾å—ï¼Ÿåªæœ‰è¿™ä¸¤ç§å—ï¼Ÿ</div>2023-03-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/21/60/ad/03351e6e.jpg" width="30px"><span>xbc</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>åç»­æ˜¯å¦ä¼šè®²è®²å¦‚ä½•ä½¿ç”¨openai apiå®ç°chatpdfè¿™æ ·çš„åŠŸèƒ½ã€‚ä»¥åŠä½¿ç”¨å…¬å¼€çš„å¼±ä¸€äº›çš„æ¨¡å‹ï¼Œæ¥å°½é‡å®ç°chatpdfçš„åŠŸèƒ½ã€‚</div>2023-03-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2d/20/df/55bacf31.jpg" width="30px"><span>Geek_b7449f</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>import pandas as pd 
import numpy as np 

from sklearn.metrics import classification_report , PrecisionRecallDisplay
from openai.embeddings_utils import cosine_similarity , get_embedding

# é€‰æ‹©ç”¨äºæƒ…æ„Ÿåˆ†æçš„æ¨¡å‹
EMBEDDING_MODEL = &quot;text-embedding-ada-002&quot;
# è®¾ç½®æ•°æ®é›†æ–‡ä»¶è·¯å¾„
datafile_path = &quot;data&#47;AllProductReviews.csv&quot;
# è¯»å– csv æ–‡ä»¶ åªå–å‰60è¡Œ
df = pd.read_csv(datafile_path,nrows=60)
# æ–°å¢ä¸€åˆ— embedding ç”¨äºè¡¨ç¤ºè·å–æ¯è¡Œçš„ReviewBodyå‘é‡å€¼
df[&quot;embedding&quot;] = df.ReviewBody.apply(lambda x:get_embedding(x,engine=EMBEDDING_MODEL))

# é™¤å»æ˜Ÿçº§ä¸º3çš„è¯„è®ºæ¥è¿›è¡Œåˆ’åˆ†å¥½è¯„è¿˜æ˜¯å·®è¯„ä¸¤ä¸ªæ ‡ç­¾
df = df[df.ReviewStar != 3]
df[&quot;sentiment&quot;] = df.ReviewStar.replace({1: &quot;negative&quot;, 2: &quot;negative&quot;, 4: &quot;positive&quot;, 5: &quot;positive&quot;})
# å‡½æ•° evaluate_embeddings_approach é»˜è®¤ä¼šæœ‰ä¸¤ä¸ªå‚æ•° label å’Œ model éƒ½æœ‰å¯¹åº”çš„é»˜è®¤å€¼
def evaluate_embeddings_approach(
    labels = [&#39;negative&#39;, &#39;positive&#39;],
    model = EMBEDDING_MODEL,
):
    # è®¡ç®—æ¯ä¸ª label çš„å‘é‡å€¼
    label_embeddings = [get_embedding(label, engine=model) for label in labels]
    # è¾…åŠ©å‡½æ•° ç”¨äºè®¡ç®—å¥½è¯„å’Œreview_embeddingä¸å·®è¯„å’Œreview_embeddingå‘é‡ä½™å¼¦å€¼å·®å€¼
    def label_score(review_embedding, label_embeddings):
        return cosine_similarity(review_embedding, label_embeddings[1]) - cosine_similarity(review_embedding, label_embeddings[0])
    # è¿™é‡Œæ›´æ–°ä¸‹ embedding åˆ— æ›´æ–°æˆå¯¹åº”çš„ åˆ†æ•°
    probas = df[&quot;embedding&quot;].apply(lambda x: label_score(x, label_embeddings))
    # é¢„æµ‹å€¼
    preds = probas.apply(lambda x: &#39;positive&#39; if x&gt;0 else &#39;negative&#39;)
    # ç”Ÿæˆä¸€ä¸ªåˆ†ç±»æŠ¥å‘Š
    report = classification_report(df.sentiment, preds)
    print(report)
    # è¿™ä¸ªå°±æ˜¯ç»˜åˆ¶äºŒåˆ†ç±»çš„å‡†ç¡®ç‡-å¬å›ç‡æ›²çº¿
    display = PrecisionRecallDisplay.from_predictions(df.sentiment, probas, pos_label=&#39;positive&#39;)
    _ = display.ax_.set_title(&quot;2-class Precision-Recall curve&quot;)
# æ— å‚æ•°é»˜è®¤å€¼è°ƒç”¨å‡½æ•°
evaluate_embeddings_approach()</div>2023-05-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/20/fb/92/0537ea08.jpg" width="30px"><span>æ¼«æ¸¸è€…</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>negative_example = get_embedding(&quot;éšæ„é™ä»·ï¼Œä¸äºˆä»·ä¿ï¼ŒæœåŠ¡æ€åº¦å·®&quot;)
å·®è¯„ä¾‹å­çš„è¯„åˆ† : -0.081472
negative_example = get_embedding(&quot;éšæ„é™ä»·ï¼Œä¸äºˆä»·ä¿ï¼ŒæœåŠ¡æ€åº¦å·®ï¼Œä½†æ˜¯åç»­æ¢äº†ä¸ªå®¢æœï¼ŒæœåŠ¡æ€åº¦å¥½å¤šäº†&quot;)
å·®è¯„ä¾‹å­çš„è¯„åˆ† : -0.048267
negative_example = get_embedding(&quot;éšæ„é™ä»·ï¼Œä¸äºˆä»·ä¿ï¼ŒæœåŠ¡æ€åº¦å·®ï¼Œä½†æ˜¯åç»­æ¢äº†ä¸ªå®¢æœï¼ŒæœåŠ¡æ€åº¦å¥½å¤šäº†ã€‚ç»è¿‡æ²Ÿé€šè§£å†³äº†æ‰€æœ‰é—®é¢˜ï¼Œå¥½è¯„ï¼&quot;)
å·®è¯„ä¾‹å­çš„è¯„åˆ† : -0.009858

é€šè¿‡ä¾‹å­çœ‹åˆ°ï¼Œç¬¬ä¸‰å¥è¯å¾ˆæ˜æ˜¾æˆ‘å·²ç»æ˜¯å¥½è¯„äº†ï¼Œä½†æ˜¯æ¨¡å‹è¿˜æ˜¯ç»™äº†å·®è¯„çš„ç»“è®ºã€‚æ˜¯ä¸æ˜¯æ’åœ¨å‰é¢çš„å¥å­æƒé‡æ›´å¤§å•Šï¼Ÿ</div>2023-05-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/36/a4/0c/796de5b6.jpg" width="30px"><span>é’±é›¨</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>ç»å†äº†æ— æ•°æ¬¡ä¸‹é¢çš„å¤±è´¥ï¼Œä¸åœé‡æ–°å®‰è£…pillowå’Œmatplotlibä¹‹åï¼Œç»ˆäºæˆåŠŸäº†ã€‚
è§£å†³æ–¹æ¡ˆæ˜¯ç‹ å¿ƒæŠŠminicondaã€pythonå…¨å¸è½½ï¼Œé‡æ–°å®‰è£…ã€‚
æ³¨æ„install openaiä»¥åï¼Œé»˜è®¤çš„pillowç‰ˆæœ¬æ˜¯9.4ï¼Œå¤ªé«˜äº†ï¼ŒæŠŠpillowå¸è½½ï¼Œå®‰è£…8.4ã€‚
è¿™ä¹ˆæ“ä½œä»¥åï¼Œæ–°çš„é—®é¢˜æ˜¯openaiåˆæ²¡äº†ï¼Œå°±æŠŠopenaié‡æ–°è£…å›æ¥ã€‚
å¾ˆå¼€å¿ƒçš„æ˜¯ï¼Œpillowå±…ç„¶è¿˜æ˜¯8.4.ç»“æœæ­£å¸¸äº†ã€‚

File ~\miniconda3\envs\py310\lib\site-packages\PIL\Image.py:103
     94 MAX_IMAGE_PIXELS = int(1024 * 1024 * 1024 &#47;&#47; 4 &#47;&#47; 3)
     97 try:
     98     # If the _imaging C module is not present, Pillow will not load.
     99     # Note that other modules should not refer to _imaging directly;
    100     # import Image and use the Image.core variable instead.
    101     # Also note that Image.core is not a publicly documented interface,
    102     # and should be considered private and subject to change.
--&gt; 103     from . import _imaging as core
    105     if __version__ != getattr(core, &quot;PILLOW_VERSION&quot;, None):
    106         msg = (
    107             &quot;The _imaging extension was built for another version of Pillow or PIL:\n&quot;
    108             f&quot;Core version: {getattr(core, &#39;PILLOW_VERSION&#39;, None)}\n&quot;
    109             f&quot;Pillow version: {__version__}&quot;
    110         )

ImportError: DLL load failed while importing _imaging: The specified module could not be found.</div>2023-04-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/29/c3/791d0f5e.jpg" width="30px"><span>æ¸£æ¸£è¾‰</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ä¸ºä»€ä¹ˆåŒæ ·æ˜¯ç”¨chatgptçš„å‡ºæ¥çš„ç»“æœè·Ÿè€å¸ˆçš„äº‹ä¾‹ç¨æœ‰ä¸åŒï¼Œæ˜¯å› ä¸ºchatgptè¿™ä¸ªæ¨¡å‹æ˜¯åœ¨å®æ—¶æ›´æ–°çš„å—</div>2023-04-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg" width="30px"><span>piboye</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>è€å¸ˆ, text complete å’Œ chat complete æ¥å£æœ‰ä»€ä¹ˆåŒºåˆ«å•Š, æˆ‘çœ‹èƒ½åŠ›æ²¡çœ‹å‡ºå¤§çš„å·®åˆ«</div>2023-03-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg" width="30px"><span>peter</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>è¯·æ•™è€å¸ˆå‡ ä¸ªé—®é¢˜ï¼š
Q1ï¼š01è¯¾ä¸­çš„Jupyter Labs å¼€å‘ç¯å¢ƒæ˜¯pythonçš„å¼€å‘ç¯å¢ƒå—ï¼Ÿï¼ˆå¯¹pythonä¸äº†è§£ï¼Œ0åŸºç¡€ï¼Œå°ç™½ï¼‰
Q2ï¼š01è¯¾ä¸­çš„Jupyter Labs å¼€å‘ç¯å¢ƒæ­å»ºï¼Œå¤æ‚å—ï¼Ÿå¦‚æœå¤æ‚çš„è¯ï¼Œèƒ½å¦éº»çƒ¦è€å¸ˆå†™ä¸€ä¸ªæ‰‹å†Œä¸€ç±»çš„æ–‡æ¡£ï¼Ÿæœ€å¥½è¯¦ç»†ä¸€ç‚¹ã€‚ï¼ˆä¸€ç›´è§‰å¾—æ­ç¯å¢ƒå¾ˆéº»çƒ¦ï¼›å°¤å…¶å¯¹ä¸ç†Ÿæ‚‰çš„pythonï¼Œå®¹æ˜“å‡ºé”™ï¼Œå®¹æ˜“æœ‰æŒ«æŠ˜æ„Ÿã€‚ï¼‰ã€‚ ç¯å¢ƒæ­ä¸å¥½ï¼Œåé¢çš„ä¾‹å­æ— æ³•å®è·µã€‚
Q3ï¼šCookbookä¾‹å­ï¼Œä¸ºä»€ä¹ˆç”¨Scikitä¼°è®¡ç»“æœï¼Œåº”è¯¥éƒ½ç”¨openaiæ¥å®Œæˆå•Šã€‚ä¾‹å­ä¸­ç”¨Scikitï¼Œé‚£ç›¸å½“äºâ€œopenai + Scikitâ€ç»“åˆæ¥åˆ¤æ–­å‡ºæœ€åçš„æ˜Ÿæ ‡äº†ï¼Œopenaiè¿™ä¹ˆå¼ºå¤§ï¼Œè¿˜éœ€è¦ç”¨Scikitå—ï¼Ÿ
Q4ï¼šchatGPTæœç´¢æˆ–ç”Ÿæˆpptçš„èƒ½åŠ›å¦‚ä½•ï¼Ÿ
æ¯”å¦‚æˆ‘è¦åšä¸€ä¸ªè½¯ä»¶çš„äº§å“ä»‹ç»æ€§è´¨çš„pptï¼Œç”¨æ¥ç»™å®¢æˆ·ä»‹ç»è¯¥è½¯ä»¶ã€‚ä»¥matlabä¸ºä¾‹ï¼Œæˆ‘æ‰˜å›½å¤–åŒäº‹è¿™æ ·æœâ€œmatlab äº§å“ä»‹ç» pptâ€ï¼Œå¹¶æ²¡æœ‰æœåˆ°åˆé€‚çš„pptï¼Œåæ¥åªå¥½åœ¨ç™¾åº¦ä¸Šæœç´¢äº†ã€‚è¯·é—®ï¼Œæ˜¯æˆ‘ä»¬çš„ä½¿ç”¨æ–¹æ³•ä¸å¯¹ï¼Ÿè¿˜æ˜¯è¯´chatGPTæ²¡æœ‰è¿™æ–¹é¢çš„èƒ½åŠ›ï¼Ÿ</div>2023-03-22</li><br/><li><img src="" width="30px"><span>Geek_a54b66</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æ²¡æœ‰æä¾› äºšé©¬é€Šé£Ÿç‰©è¯„ä»·çš„è¿æ¥ç½¢ï¼Œæœ€åé¢æä¾›çš„æ˜¯ è€³æœºçš„è¯„ä»·</div>2023-05-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/36/9c/ae/40e5b76d.jpg" width="30px"><span>EnzoîŒ°</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>ä¸çŸ¥é“æ€ä¹ˆä¸‹è½½æ•°æ®é›†ï¼Œåœ¨githubä¸Šç‚¹ä¸‹è½½åå´è¿”å›çš„æ˜¯æµè§ˆå™¨é‡Œä¸€ä¸ªrawåœ°å€ï¼Œå¥½å¥‡æ€ª</div>2023-04-21</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/1f/14/57cb7926.jpg" width="30px"><span>ShawnWu</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ4ï¼‰<div>è¿™ä¸ªæ–‡ä»¶ï¼šfine_food_reviews_with_embeddings_1k.csv
æˆ‘ä¸Šä¼ åˆ°colabäº‘ç›˜çš„åŒçº§ç›®å½•ä¸‹ï¼Œä¿®æ”¹pathè·¯å¾„ä¹Ÿè¯»å–ä¸åˆ°ï¼Œå•ç‹¬å»ºäº†ä¸€ä¸ªdataç›®å½•æ”¾è¿›å»ä¹Ÿè¯»ä¸åˆ°ã€‚</div>2023-04-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/1f/14/57cb7926.jpg" width="30px"><span>ShawnWu</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>æˆ‘ç”¨çš„æ˜¯åœ¨çº¿çš„colabè·‘çš„è¿™ä¸€è¯¾ç¤ºä¾‹ä»£ç ï¼Œæœ€åé‚£ä¸ªäºšé©¬é€Šçš„ç¤ºä¾‹è·‘ä¸é€šï¼Œä¸æ˜ç™½é‚£ä¸ªcsvåº”è¯¥æ”¾åˆ°åœ¨çº¿colabçš„ä»€ä¹ˆä½ç½®ä¸Šæ‰èƒ½è¯»åˆ°ï¼Œdatafile_pathè¿™ä¸ªåº”è¯¥åœ¨colabä¸Šå¦‚ä½•å¤„ç†ï¼š
datafile_path = &quot;data&#47;fine_food_reviews_with_embeddings_1k.csv&quot;
df = pd.read_csv(datafile_path)</div>2023-04-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/1b/6e/cd8fea9f.jpg" width="30px"><span>RecordLiu</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è¿™ä¸ªè°ƒopenapiæä¾›çš„apiè¿›è¡Œè®­ç»ƒæ•°æ®ï¼Œåº”è¯¥è¦è€ƒè™‘æ•°æ®å®‰å…¨é—®é¢˜å§?æ¯”å¦‚ç”¨å…¬å¸çœŸå®çš„ä¸šåŠ¡æ•°æ®è¿›è¡Œè®­ç»ƒï¼Œå¯èƒ½ä¼šå‘ç”Ÿæ•°æ®æ³„éœ²é—®é¢˜</div>2023-04-17</li><br/><li><img src="" width="30px"><span>Geek_9c83fd</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>```

import openai
import os
from openai.embeddings_utils import cosine_similarity, get_embedding

# è·å–è®¿é—®open aiçš„å¯†é’¥
openai.api_key = os.getenv(&quot;OPENAI_API_KEY&quot;)
# é€‰æ‹©ä½¿ç”¨æœ€å°çš„adaæ¨¡å‹
EMBEDDING_MODEL = &quot;text-embedding-ada-002&quot;

# è·å–&quot;å¥½è¯„&quot;å’Œ&quot;å·®è¯„&quot;çš„
positive_review = get_embedding(&quot;å¥½è¯„&quot;)
negative_review = get_embedding(&quot;å·®è¯„&quot;)

positive_example = get_embedding(&quot;ä¹°çš„é“¶è‰²ç‰ˆçœŸçš„å¾ˆå¥½çœ‹ï¼Œä¸€å¤©å°±åˆ°äº†ï¼Œæ™šä¸Šå°±å¼€å§‹æ‹¿èµ·æ¥å®Œç³»ç»Ÿå¾ˆä¸æ»‘æµç•…ï¼Œåšå·¥æ‰å®ï¼Œæ‰‹æ„Ÿç»†è…»ï¼Œå¾ˆç²¾è‡´å“¦è‹¹æœä¸€å¦‚æ—¢å¾€çš„å¥½å“è´¨&quot;)
negative_example = get_embedding(&quot;é™ä»·å‰å®³ï¼Œä¿ä»·ä¸åˆç†ï¼Œä¸æ¨è&quot;)

def get_score(sample_embedding):
  return cosine_similarity(sample_embedding, positive_review) - cosine_similarity(sample_embedding, negative_review)

positive_score = get_score(positive_example)
negative_score = get_score(negative_example)

print(&quot;å¥½è¯„ä¾‹å­çš„è¯„åˆ† : %f&quot; % (positive_score))
print(&quot;å·®è¯„ä¾‹å­çš„è¯„åˆ† : %f&quot; % (negative_score))
```
è¯¥æ®µä»£ç ä¸­ï¼Œå¹¶æ²¡æœ‰ç”¨åˆ° `text-embedding-ada-002`,æˆ‘çœ‹äº†åº“ï¼Œç”¨çš„æ˜¯`text-similarity-davinci-001`,è€Œä¸”æˆ‘å‘ç°æˆ‘å¦‚æœç”¨`text-embedding-ada-002`,é‚£ä¹ˆè¯„åˆ†éƒ½å¤§äº1ï¼Œè¿™æ˜¯ä¸ºä½•ï¼Ÿ</div>2023-04-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/6a/f2/db90fa96.jpg" width="30px"><span>Oliå¼ å¸†</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>è¯·æ•™è€å¸ˆï¼Œä¼¼ä¹chat completionçš„æˆæœ¬è¦ä½å¾ˆå¤šï¼Œåé¢ä¼šè®²åˆ°å¦‚ä½•åˆ©ç”¨OpenAIçš„æ¥å£æ¥æ­å»ºèƒ½ä½¿ç”¨è‡ªæœ‰çŸ¥è¯†åº“çš„æ–¹æ³•å—ï¼Ÿ</div>2023-03-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/83/77/e51624a1.jpg" width="30px"><span>ç ä¹ä¸»ä¹‰</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ä¹‹å‰æ‹…å¿ƒembeddingæ˜¯å¦ä¸­æ–‡æ”¯æŒçš„ä¸å¥½ã€‚çœ‹èµ·æ¥æ”¯æŒçš„è¿˜å¯ä»¥ï¼Œå›ç­”äº†æˆ‘çš„ä¸€ä¸ªç–‘é—®ã€‚ä¸çŸ¥é“embeddingå·¥å…·å›½å†…æ˜¯å¦æœ‰ç±»ä¼¼çš„ï¼Ÿæˆ‘ç›®å‰æ²¡èµ°åˆ°ã€‚è…¾è®¯å¥½åƒåšè¿‡ï¼Œä½†æ˜¯ç°åœ¨æ²¡æœ‰å¼€æ”¾ã€‚</div>2023-03-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/17/34/3f/4b6cd370.jpg" width="30px"><span>Viktor</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ5ï¼‰<div>è€å¸ˆï¼Œè¯·é—®ä¸€ä¸‹â€œæ›´å¤§çš„æ•°æ®é›†ä¸Šçš„çœŸå®æ¡ˆä¾‹â€è¿™ä¸ªæ¡ˆä¾‹çš„æ•°æ®é›†åœ¨å“ªé‡Œï¼Ÿè¯»æ–‡ç« ä¸çŸ¥é“æ•°æ®é›†é•¿ä»€ä¹ˆæ ·å­ï¼Œçœ‹ä»£ç æœ‰ç‚¹æ²¡æœ‰ç†è§£åˆ°ã€‚</div>2023-03-22</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/z3nIITkhzRj9WApibhic524lQSJmqUCerpuqpntEe06LE3lRGKr6rGwPpPJtZ5Xj0NBPyvTatKtIk0hfyAnl9Hsg/132" width="30px"><span>Geek_378f83</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>colabä¸Šæ‰§è¡ŒæŠ¥é”™ï¼Œåˆé‡åˆ°çš„å—ï¼Ÿæ€ä¹ˆè§£å†³çš„ï¼Ÿ

df = pd.read_csv(datafile_path)
df[&quot;embedding&quot;] = df.embedding.apply(eval).apply(np.array)

---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
&lt;ipython-input-33-6c8271aa31f7&gt; in &lt;cell line: 10&gt;()
      8 
      9 df = pd.read_csv(datafile_path)
---&gt; 10 df[&quot;embedding&quot;] = df.embedding.apply(eval).apply(np.array)
     11 
     12 # convert 5-star rating to binary sentiment

&#47;usr&#47;local&#47;lib&#47;python3.10&#47;dist-packages&#47;pandas&#47;core&#47;generic.py in __getattr__(self, name)
   5900         ):
   5901             return self[name]
-&gt; 5902         return object.__getattribute__(self, name)
   5903 
   5904     def __setattr__(self, name: str, value) -&gt; None:

AttributeError: &#39;DataFrame&#39; object has no attribute &#39;embedding&#39;</div>2023-05-21</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/z3nIITkhzRj9WApibhic524lQSJmqUCerpuqpntEe06LE3lRGKr6rGwPpPJtZ5Xj0NBPyvTatKtIk0hfyAnl9Hsg/132" width="30px"><span>Geek_378f83</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>df = pd.read_csv(datafile_path)
df[&quot;embedding&quot;] = df.embedding.apply(eval).apply(np.array)---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
&lt;ipython-input-33-6c8271aa31f7&gt; in &lt;cell line: 10&gt;()
      8 
      9 df = pd.read_csv(datafile_path)
---&gt; 10 df[&quot;embedding&quot;] = df.embedding.apply(eval).apply(np.array)
     11 
     12 # convert 5-star rating to binary sentiment

&#47;usr&#47;local&#47;lib&#47;python3.10&#47;dist-packages&#47;pandas&#47;core&#47;generic.py in __getattr__(self, name)
   5900         ):
   5901             return self[name]
-&gt; 5902         return object.__getattribute__(self, name)
   5903 
   5904     def __setattr__(self, name: str, value) -&gt; None:

AttributeError: &#39;DataFrame&#39; object has no attribute &#39;embedding&#39;</div>2023-05-21</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1f/68/44/791d0f5e.jpg" width="30px"><span>åºšå°åºš</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div> No API key provided. You can set your API key in code using &#39;openai.api_key = &lt;API-KEY&gt;&#39;, or you can set the environment variable OPENAI_API_KEY=&lt;API-KEY&gt;). If your API key is stored in a file, you can point the openai module at it with &#39;openai.api_key_path = &lt;PATH&gt;&#39;. You can generate API keys in the OpenAI web interface. See https:&#47;&#47;platform.openai.com&#47;account&#47;api-keys for details

ç”Ÿæˆäº†æ–°çš„å¯†é’¥ï¼Œæ”¾è¿›å»ï¼Œè¿˜æ˜¯æŠ¥è¿™ä¸ªé”™</div>2023-05-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/5f/81/1c614f4a.jpg" width="30px"><span>stg609</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>å¦‚æœä¸æ˜¯å¥½è¯„ï¼Œå°±æ˜¯å·®è¯„çš„å‰ææˆç«‹çš„è¯ï¼Œé‚£ä¹ˆæ˜¯å¦åªéœ€è¦è®¡ç®—ä¸ â€œå¥½è¯„â€ è¿™ä¸ªå‘é‡çš„ç›¸ä¼¼åº¦å°±å¥½äº†ï¼Ÿå¦‚æœå¤§äº 0 å°±è®¤ä¸ºæ˜¯å¥½è¯„ï¼Œåä¹‹åˆ™æ˜¯å·®è¯„ã€‚</div>2023-05-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/7d/3b/b7f9281e.jpg" width="30px"><span>å–»é¡ºæ­¦ æ—…æ¢¦å¼€å‘å›¢</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ModuleNotFoundError: No module named &#39;matplotlib&#39;   æ€ä¹ˆæ</div>2023-04-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/36/9c/ae/40e5b76d.jpg" width="30px"><span>EnzoîŒ°</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>ä¸€ç›´æŠ¥é”™ï¼Œæ— å¥ˆäº†ï¼šimport pandas as pd
import numpy as np

from sklearn.metrics import classification_report

datafile_path = &quot;&#47;content&#47;reviews_30.csv&quot;

df = pd.read_excel(datafile_path)
df[&quot;embedding&quot;] = df.embedding.apply(eval).apply(np.array)

# convert 5-star rating to binary sentiment
df = df[df.Score != 3]
df[&quot;sentiment&quot;] = df.Score.replace({1: &quot;negative&quot;, 2: &quot;negative&quot;, 4: &quot;positive&quot;, 5: &quot;positive&quot;})ValueError                                Traceback (most recent call last)
&lt;ipython-input-4-46968d0107d4&gt; in &lt;cell line: 8&gt;()
      6 datafile_path = &quot;&#47;content&#47;reviews_30.csv&quot;
      7 
----&gt; 8 df = pd.read_excel(datafile_path)
      9 df[&quot;embedding&quot;] = df.embedding.apply(eval).apply(np.array)
     10 

3 frames
&#47;usr&#47;local&#47;lib&#47;python3.9&#47;dist-packages&#47;pandas&#47;io&#47;excel&#47;_base.py in __init__(self, path_or_buffer, engine, storage_options)
   1654                 )
   1655                 if ext is None:
-&gt; 1656                     raise ValueError(
   1657                         &quot;Excel file format cannot be determined, you must specify &quot;
   1658                         &quot;an engine manually.&quot;

ValueError: Excel file format cannot be determined, you must specify an engine manually.</div>2023-04-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/29/fb/7d9d37ae.jpg" width="30px"><span>å¤šå¤š</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æ­å·åœ¨å“ªé‡Œï¼Ÿè¿™ä¸ªé—®é¢˜çš„å›ç­”ï¼Œæ˜¯æ€ä¹ˆä¸ªè¿è¡Œè¿‡ç¨‹ï¼Œè€å¸ˆæ–¹ä¾¿è§£é‡Šä¸‹ä¸ï¼Ÿ</div>2023-04-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/6f/8f/791d0f5e.jpg" width="30px"><span>Pochacco</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æ¥è‡ª OpenAI Cookbook é‡Œé¢çš„ä¸€ä¸ªä¾‹å­ã€‚å®ƒæ˜¯ç”¨åŒæ ·çš„æ–¹æ³•ï¼Œæ¥åˆ¤æ–­äºšé©¬é€Šæä¾›çš„ç”¨æˆ·å¯¹ä¸€äº›é£Ÿç‰©çš„è¯„ä»· -- è¿™é‡Œçš„ä»£ç æ˜¯ä¸æ˜¯ä¸å®Œå…¨å•Šï¼Ÿ æˆ‘åœ¨OpenAI Cookbookæ‰¾ä¸åˆ°è¿™ä¸ªä¾‹å­ï¼Œæ˜¯å¦å¯ä»¥æŠŠOpenAI Cookbookè¿™ä¸ªä¾‹å­çš„é“¾æ¥å‘ç»™æˆ‘ï¼Œè°¢è°¢ï¼</div>2023-04-19</li><br/>
</ul>