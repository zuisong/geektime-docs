ä½ å¥½ï¼Œæˆ‘æ˜¯å¾æ–‡æµ©ã€‚

ä¸Šä¸€è®²æˆ‘ä»¬çœ‹åˆ°äº†ï¼Œå¤§å‹è¯­è¨€æ¨¡å‹çš„æ¥å£å…¶å®éå¸¸ç®€å•ã€‚åƒOpenAIå°±åªæä¾›äº†Completeå’ŒEmbeddingä¸¤ä¸ªæ¥å£ï¼Œå…¶ä¸­ï¼ŒCompleteå¯ä»¥è®©æ¨¡å‹æ ¹æ®ä½ çš„è¾“å…¥è¿›è¡Œè‡ªåŠ¨ç»­å†™ï¼ŒEmbeddingå¯ä»¥å°†ä½ è¾“å…¥çš„æ–‡æœ¬è½¬åŒ–æˆå‘é‡ã€‚

ä¸è¿‡åˆ°è¿™é‡Œï¼Œä½ çš„ç–‘é—®å¯èƒ½å°±æ¥äº†ã€‚ä¸æ˜¯è¯´ç°åœ¨çš„å¤§è¯­è¨€æ¨¡å‹å¾ˆå‰å®³å—ï¼Ÿä¼ ç»Ÿçš„è‡ªç„¶è¯­è¨€å¤„ç†é—®é¢˜éƒ½å¯ä»¥é€šè¿‡å¤§æ¨¡å‹è§£å†³ã€‚å¯æ˜¯ç”¨è¿™ä¹ˆç®€å•çš„ä¸¤ä¸ªAPIï¼Œèƒ½å¤Ÿå®ŒæˆåŸæ¥éœ€è¦é€šè¿‡å„ç§NLPæŠ€æœ¯è§£å†³çš„é—®é¢˜å—ï¼Ÿæ¯”å¦‚æƒ…æ„Ÿåˆ†æã€æ–‡æœ¬åˆ†ç±»ã€æ–‡ç« èšç±»ã€æ‘˜è¦æ’°å†™ã€æœç´¢ï¼Œè¿™ä¸€ç³»åˆ—é—®é¢˜æ€ä¹ˆé€šè¿‡è¿™ä¸¤ä¸ªæ¥å£è§£å†³å‘¢ï¼Ÿ

åˆ«æ€¥ï¼Œåœ¨æ¥ä¸‹æ¥çš„å‡ è®²é‡Œï¼Œæˆ‘ä¼šå‘Šè¯‰ä½ ï¼Œæ€ä¹ˆåˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹æä¾›çš„è¿™ä¸¤ä¸ªç®€å•çš„APIæ¥è§£å†³ä¼ ç»Ÿçš„è‡ªç„¶è¯­è¨€å¤„ç†é—®é¢˜ã€‚è¿™ä¸€è®²æˆ‘ä»¬å°±å…ˆä»ä¸€ä¸ªæœ€å¸¸è§çš„è‡ªç„¶è¯­è¨€å¤„ç†é—®é¢˜â€”â€”â€œæƒ…æ„Ÿåˆ†æâ€å¼€å§‹ï¼Œæ¥çœ‹çœ‹æˆ‘ä»¬æ€ä¹ˆæŠŠå¤§è¯­è¨€æ¨¡å‹ç”¨èµ·æ¥ã€‚

## ä¼ ç»Ÿçš„äºŒåˆ†ç±»æ–¹æ³•ï¼šæœ´ç´ è´å¶æ–¯ä¸é€»è¾‘å›å½’

â€œæƒ…æ„Ÿåˆ†æâ€é—®é¢˜ï¼Œæ˜¯æŒ‡æˆ‘ä»¬æ ¹æ®ä¸€æ®µæ–‡å­—ï¼Œå»åˆ¤æ–­å®ƒçš„æ€åº¦æ˜¯æ­£é¢çš„è¿˜æ˜¯è´Ÿé¢çš„ã€‚åœ¨ä¼ ç»Ÿçš„äº’è”ç½‘äº§å“é‡Œï¼Œç»å¸¸ä¼šè¢«ç”¨æ¥åˆ†æç”¨æˆ·å¯¹äº§å“ã€æœåŠ¡çš„è¯„ä»·ã€‚æ¯”å¦‚å¤§ä¼—ç‚¹è¯„é‡Œé¢ï¼Œä½ å¯¹é¤é¦†çš„è¯„è®ºï¼Œåœ¨äº¬ä¸œä¹°ä¸ªä¸œè¥¿ï¼Œä½ å¯¹å•†å“çš„è¯„è®ºï¼Œéƒ½ä¼šè¢«å¹³å°æ‹¿å»åˆ†æï¼Œç»™å•†å®¶æˆ–è€…é¤é¦†çš„è¯„åˆ†åšå‚è€ƒã€‚ä¹Ÿæœ‰äº›å“ç‰Œï¼Œä¼šä¸“é—¨æŠ“å–ç¤¾äº¤ç½‘ç»œé‡Œç”¨æˆ·å¯¹è‡ªå·±äº§å“çš„è¯„ä»·ï¼Œæ¥è¿›è¡Œæƒ…æ„Ÿåˆ†æï¼Œåˆ¤æ–­æ¶ˆè´¹è€…å¯¹è‡ªå·±çš„äº§å“è¯„ä»·æ˜¯æ­£é¢è¿˜æ˜¯è´Ÿé¢çš„ï¼Œå¹¶ä¸”ä¼šæ ¹æ®è¿™äº›è¯„ä»·æ¥æ”¹è¿›è‡ªå·±çš„äº§å“ã€‚

å¯¹äºâ€œæƒ…æ„Ÿåˆ†æâ€ç±»å‹çš„é—®é¢˜ï¼Œä¼ ç»Ÿçš„è§£å†³æ–¹æ¡ˆå°±æ˜¯**æŠŠå®ƒå½“æˆæ˜¯ä¸€ä¸ªåˆ†ç±»é—®é¢˜**ï¼Œä¹Ÿå°±æ˜¯å…ˆæ‹¿ä¸€éƒ¨åˆ†è¯„è®ºæ•°æ®ï¼Œäººå·¥æ ‡æ³¨ä¸€ä¸‹è¿™äº›è¯„è®ºæ˜¯æ­£é¢è¿˜æ˜¯è´Ÿé¢çš„ã€‚å¦‚æœæœ‰ä¸ªç”¨æˆ·è¯´â€œè¿™å®¶é¤é¦†çœŸå¥½åƒâ€ï¼Œé‚£ä¹ˆå°±æ ‡æ³¨æˆâ€œæ­£é¢æƒ…æ„Ÿâ€ã€‚å¦‚æœæœ‰ä¸ªç”¨æˆ·è¯´â€œè¿™ä¸ªæ‰‹æœºè´¨é‡ä¸å¥½â€ï¼Œé‚£ä¹ˆå°±æŠŠå¯¹åº”çš„è¯„è®ºæ ‡æ³¨æˆè´Ÿé¢çš„ã€‚

æˆ‘ä»¬æŠŠæ ‡æ³¨å¥½çš„æ•°æ®ï¼Œå–‚ç»™ä¸€ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œè®­ç»ƒå‡ºä¸€ç»„å‚æ•°ã€‚ç„¶åæŠŠå‰©ä¸‹çš„æ²¡æœ‰äººå·¥æ ‡æ³¨è¿‡çš„æ•°æ®ä¹Ÿæ‹¿ç»™è®­ç»ƒå¥½çš„æ¨¡å‹è®¡ç®—ä¸€ä¸‹ã€‚æ¨¡å‹å°±ä¼šç»™ä½ ä¸€ä¸ªåˆ†æ•°æˆ–è€…æ¦‚ç‡ï¼Œå‘Šè¯‰ä½ è¿™ä¸€æ®µè¯„è®ºçš„æ„Ÿæƒ…æ˜¯æ­£é¢çš„ï¼Œè¿˜æ˜¯è´Ÿé¢çš„ã€‚

å¯ä»¥ç”¨æ¥åšæƒ…æ„Ÿåˆ†æçš„æ¨¡å‹æœ‰å¾ˆå¤šï¼Œè¿™äº›ç®—æ³•èƒŒåéƒ½æ˜¯åŸºäºæŸä¸€ä¸ªæ•°å­¦æ¨¡å‹ã€‚æ¯”å¦‚ï¼Œå¾ˆå¤šæ•™ç§‘ä¹¦é‡Œï¼Œå°±ä¼šæ•™ä½ ç”¨**æœ´ç´ è´å¶æ–¯ç®—æ³•**æ¥è¿›è¡Œåƒåœ¾é‚®ä»¶åˆ†ç±»ã€‚æœ´ç´ è´å¶æ–¯çš„æ¨¡å‹ï¼Œå°±æ˜¯ç®€å•åœ°ç»Ÿè®¡æ¯ä¸ªå•è¯å’Œå¥½è¯„å·®è¯„ä¹‹é—´çš„æ¡ä»¶æ¦‚ç‡ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœä¸€ä¸ªè¯è¯­åœ¨å·®è¯„é‡Œå‡ºç°çš„æ¦‚ç‡æ¯”å¥½è¯„é‡Œé«˜å¾—å¤šï¼Œé‚£è¿™ä¸ªè¯è¯­æ‰€åœ¨çš„è¯„è®ºï¼Œå°±æ›´æœ‰å¯èƒ½æ˜¯ä¸€ä¸ªå·®è¯„ã€‚

$$ P(c|x)=\\frac{P(x|c)PÂ©}{P(x)}$$

$$P(c|X) \\propto P(x\_{1}|c)\\times P(x\_{2}|c)\\times Â·Â·Â·\\times P(x\_{n}|c)\\times PÂ©$$

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªè®­ç»ƒé›†åŒ…å«4å°é‚®ä»¶ï¼Œå…¶ä¸­2å°æ˜¯åƒåœ¾é‚®ä»¶ï¼Œ2å°æ˜¯éåƒåœ¾é‚®ä»¶ã€‚è®­ç»ƒé›†é‡Œçš„é‚®ä»¶åŒ…å«è¿™äº›å•è¯ã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/d0/c5/d0d33ccd0c43603bb127fcb868b79ec5.png?wh=2123x840)

ç„¶åæ¥äº†ä¸€å°æ–°é‚®ä»¶ï¼Œé‡Œé¢çš„å•è¯æ˜¯ï¼šbuyã€moneyã€sellã€‚

é€šè¿‡è¿™äº›å•è¯å‡ºç°çš„æ¦‚ç‡ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±å¯ä»¥é¢„å…ˆç®—å‡ºè¿™å°é‚®ä»¶æ˜¯åƒåœ¾é‚®ä»¶è¿˜æ˜¯æ™®é€šé‚®ä»¶ã€‚

- $P(buy|åƒåœ¾) = 2 \\div 2 = 1$
- $P(money|åƒåœ¾) = 2 \\div 2 = 1$
- $P(sell|åƒåœ¾) = 1 \\div 2 = 0.5$
- $P(buy|æ™®é€š) = 0 \\div 2 =0$
- $P(money|æ™®é€š) = 0 \\div 2 =0$
- $P(sell|æ™®é€š) = 1 div 2 =0.5$

ç„¶åæˆ‘ä»¬æŠŠè¿™å°é‚®ä»¶é‡Œæ‰€æœ‰è¯è¯­çš„æ¡ä»¶æ¦‚ç‡ç”¨å…¨æ¦‚ç‡å…¬å¼ä¹˜èµ·æ¥ï¼Œå°±å¾—åˆ°äº†è¿™å°é‚®ä»¶æ˜¯åƒåœ¾é‚®ä»¶è¿˜æœ‰æ™®é€šé‚®ä»¶çš„æ¦‚ç‡ã€‚

$$P(åƒåœ¾|X) \\propto P(buy|åƒåœ¾) \\times P(money|åƒåœ¾) \\times P(sell|åƒåœ¾) \\times P(åƒåœ¾) = 1 \\times 1 \\times 0.5 \\times 0.5 = 0.25$$

$$P(æ™®é€š|X) \\propto P(buy|æ™®é€š) \\times P(money|æ™®é€š) \\times P(sell|æ™®é€š) \\times P(æ™®é€š) = 0 \\times 0 \\times 0.5 \\times 0.5 = 0$$

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å‘ç° $P(åƒåœ¾|X) &gt; P(æ™®é€š|X)$ï¼Œè€Œä¸” $P(æ™®é€š|X)$ å…¶å®ç­‰äº0ã€‚é‚£å¦‚æœç”¨æœ´ç´ è´å¶æ–¯ç®—æ³•ï¼Œæˆ‘ä»¬å°±ä¼šè®¤ä¸ºè¿™å°é‚®ä»¶100%æ˜¯åƒåœ¾é‚®ä»¶ã€‚å¦‚æœä½ è§‰å¾—è‡ªå·±æ•°å­¦ä¸å¤ªå¥½ï¼Œè¿™ä¸ªä¾‹å­æ²¡æœ‰çœ‹æ˜ç™½ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œå› ä¸ºæˆ‘ä»¬æ¥ä¸‹æ¥çš„AIåº”ç”¨å¼€å‘éƒ½ä¸éœ€è¦é¢„å…ˆæŒæ¡è¿™äº›æ•°å­¦çŸ¥è¯†ï¼Œæ‰€ä»¥ä¸è¦æœ‰å¿ƒç†è´Ÿæ‹…ã€‚

ç±»ä¼¼çš„ï¼Œåƒé€»è¾‘å›å½’ã€éšæœºæ£®æ—ç­‰æœºå™¨å­¦ä¹ ç®—æ³•éƒ½å¯ä»¥æ‹¿æ¥åšåˆ†ç±»ã€‚ä½ åœ¨ç½‘ä¸Šï¼Œç‰¹åˆ«æ˜¯ Kaggle è¿™ä¸ªæœºå™¨å­¦ä¹ æ¯”èµ›çš„ç½‘ç«™é‡Œï¼Œå¯ä»¥æœç´¢åˆ°å¾ˆå¤šå…¶ä»–äººä½¿ç”¨è¿™äº›ä¼ ç»Ÿæ–¹æ³•æ¥è®¾è®¡æƒ…æ„Ÿåˆ†æçš„è§£å†³æ–¹æ¡ˆã€‚è¿™äº›æ–¹æ¡ˆéƒ½ä»¥Jupyter Notebookçš„å½¢å¼å‡ºç°ï¼Œæˆ‘åœ¨è¿™é‡Œæ”¾ä¸ª[é“¾æ¥](https://www.kaggle.com/code/ankumagawa/sentimental-analysis-using-naive-bayes-classifier)ï¼Œä½ æœ‰å…´è¶£çš„è¯ä¹Ÿå¯ä»¥å»ç ”ç©¶ä¸€ä¸‹ã€‚

## ä¼ ç»Ÿæ–¹æ³•çš„æŒ‘æˆ˜ï¼šç‰¹å¾å·¥ç¨‹ä¸æ¨¡å‹è°ƒå‚

ä½†è¿™äº›ä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œæƒ³è¦å–å¾—å¥½çš„æ•ˆæœï¼Œè¿˜æ˜¯é¢‡æœ‰é—¨æ§›çš„ã€‚é™¤äº†è¦çŸ¥é“æœ‰å“ªäº›ç®—æ³•å¯ä»¥ç”¨ï¼Œè¿˜æœ‰ä¸¤æ–¹é¢çš„å·¥ä½œéå¸¸ä¾èµ–ç»éªŒã€‚

### ç‰¹å¾å·¥ç¨‹

ç¬¬ä¸€ä¸ªæ˜¯ç‰¹å¾å·¥ç¨‹ã€‚å¯¹äºå¾ˆå¤šè‡ªç„¶è¯­è¨€é—®é¢˜ï¼Œå¦‚æœæˆ‘ä»¬åªæ˜¯æ‹¿ä¸€æ®µè¯é‡Œé¢æ˜¯å¦å‡ºç°äº†ç‰¹å®šçš„è¯è¯­æ¥è®¡ç®—æ¦‚ç‡ï¼Œä¸ä¸€å®šæ˜¯æœ€åˆé€‚çš„ã€‚æ¯”å¦‚â€œè¿™å®¶é¤é¦†å¤ªç³Ÿç³•äº†ï¼Œä¸€ç‚¹éƒ½ä¸å¥½åƒâ€å’Œ â€œè¿™å®¶é¤é¦†å¤ªå¥½åƒäº†ï¼Œä¸€ç‚¹éƒ½ä¸ç³Ÿç³•â€è¿™æ ·ä¸¤å¥è¯ï¼Œä»æ„æ€ä¸Šæ˜¯å®Œå…¨ç›¸åçš„ã€‚ä½†æ˜¯é‡Œé¢å‡ºç°çš„è¯è¯­å…¶å®æ˜¯ç›¸åŒçš„ã€‚åœ¨ä¼ ç»Ÿçš„è‡ªç„¶è¯­è¨€å¤„ç†ä¸­ï¼Œæˆ‘ä»¬ä¼šé€šè¿‡ä¸€äº›ç‰¹å¾å·¥ç¨‹çš„æ–¹æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

æ¯”å¦‚ï¼Œæˆ‘ä»¬ä¸åªæ˜¯é‡‡ç”¨å•ä¸ªè¯è¯­å‡ºç°çš„æ¦‚ç‡ï¼Œè¿˜å¢åŠ å‰åä¸¤ä¸ªæˆ–è€…ä¸‰ä¸ªç›¸è¿è¯è¯­çš„ç»„åˆï¼Œä¹Ÿå°±æ˜¯é€šè¿‡æ‰€è°“çš„2-Gramï¼ˆBigramåŒå­—èŠ‚è¯ç»„ï¼‰å’Œ3-Gramï¼ˆTrigramä¸‰å­—èŠ‚è¯ç»„ï¼‰ä¹Ÿæ¥è®¡ç®—æ¦‚ç‡ã€‚åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­é‡Œï¼Œç¬¬ä¸€å¥å·®è¯„ï¼Œå°±ä¼šæœ‰â€œå¤ªâ€å’Œâ€œç³Ÿç³•â€ç»„åˆåœ¨ä¸€èµ·çš„â€œå¤ªç³Ÿç³•â€ï¼Œä»¥åŠâ€œä¸â€å’Œâ€œå¥½åƒâ€ç»„åˆåœ¨ä¸€èµ·çš„â€œä¸å¥½åƒâ€ã€‚è€Œåé¢ä¸€å¥é‡Œå°±æœ‰â€œå¤ªå¥½åƒâ€å’Œâ€œä¸ç³Ÿç³•â€ä¸¤ä¸ªç»„åˆã€‚æœ‰äº†è¿™æ ·çš„2-Gramçš„ç»„åˆï¼Œæˆ‘ä»¬åˆ¤æ–­ç”¨æˆ·å¥½è¯„å·®è¯„çš„åˆ¤æ–­èƒ½åŠ›å°±æ¯”å…‰ç”¨å•ä¸ªè¯è¯­æ˜¯å¦å‡ºç°è¦å¥½å¤šäº†ã€‚

è¿™æ ·çš„ç‰¹å¾å·¥ç¨‹çš„æ–¹å¼æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚**å»é™¤åœç”¨è¯**ï¼Œä¹Ÿå°±æ˜¯â€œçš„åœ°å¾—â€è¿™æ ·çš„è¯è¯­ï¼Œ**å»æ‰è¿‡äºä½é¢‘çš„è¯è¯­**ï¼Œæ¯”å¦‚ä¸€äº›å¶å°”å‡ºç°çš„ä¸“æœ‰åè¯ã€‚æˆ–è€…å¯¹äºæœ‰äº›è¯è¯­ç‰¹å¾é‡‡ç”¨ **TF-IDF**ï¼ˆè¯é¢‘-é€†æ–‡æ¡£é¢‘ç‡ï¼‰è¿™æ ·çš„ç»Ÿè®¡ç‰¹å¾ï¼Œè¿˜æœ‰åœ¨è‹±è¯­é‡Œé¢å¯¹ä¸åŒæ—¶æ€çš„å•è¯ç»Ÿä¸€æ¢æˆç°åœ¨æ—¶ã€‚

ä¸åŒçš„ç‰¹å¾å·¥ç¨‹æ–¹å¼ï¼Œåœ¨ä¸åŒçš„é—®é¢˜ä¸Šæ•ˆæœä¸ä¸€æ ·ï¼Œæ¯”å¦‚æˆ‘ä»¬åšæƒ…æ„Ÿåˆ†æï¼Œå¯èƒ½å°±éœ€è¦ä¿ç•™æ ‡ç‚¹ç¬¦å·ï¼Œå› ä¸ºåƒâ€œï¼â€è¿™æ ·çš„ç¬¦å·å¾€å¾€è•´å«ç€å¼ºçƒˆçš„æƒ…æ„Ÿç‰¹å¾ã€‚ä½†æ˜¯ï¼Œè¿™äº›ç§ç§ç»†å¾®çš„æŠ€å·§ï¼Œè®©æˆ‘ä»¬åœ¨æƒ³è¦è§£å†³ä¸€ä¸ªç®€å•çš„æƒ…æ„Ÿåˆ†æé—®é¢˜æ—¶ï¼Œä¹Ÿéœ€è¦æ’°å†™å¤§é‡æ–‡æœ¬å¤„ç†çš„ä»£ç ï¼Œè¿˜è¦äº†è§£é’ˆå¯¹å½“å‰ç‰¹å®šåœºæ™¯çš„æŠ€å·§ï¼Œè¿™éå¸¸ä¾èµ–å·¥ç¨‹å¸ˆçš„ç»éªŒã€‚

### æœºå™¨å­¦ä¹ ç›¸å…³ç»éªŒ

ç¬¬äºŒä¸ªå°±æ˜¯ä½ éœ€è¦æœ‰ç›¸å¯¹ä¸°å¯Œçš„æœºå™¨å­¦ä¹ ç»éªŒã€‚é™¤äº†é€šè¿‡ç‰¹å¾å·¥ç¨‹è®¾è®¡æ›´å¤šçš„ç‰¹å¾ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦äº†è§£å¾ˆå¤šæœºå™¨å­¦ä¹ é¢†åŸŸé‡Œå¸¸ç”¨çš„çŸ¥è¯†å’ŒæŠ€å·§ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬éœ€è¦å°†æ•°æ®é›†åˆ‡åˆ†æˆè®­ç»ƒï¼ˆTrainingï¼‰ã€éªŒè¯ï¼ˆValidationï¼‰ã€æµ‹è¯•ï¼ˆTestï¼‰ä¸‰ç»„æ•°æ®ï¼Œç„¶åé€šè¿‡AUCæˆ–è€…æ··æ·†çŸ©é˜µï¼ˆConfusion Matrixï¼‰æ¥è¡¡é‡æ•ˆæœã€‚å¦‚æœæ•°æ®é‡ä¸å¤Ÿå¤šï¼Œä¸ºäº†è®­ç»ƒæ•ˆæœçš„ç¨³å®šæ€§ï¼Œå¯èƒ½éœ€è¦é‡‡ç”¨ K-Fold çš„æ–¹å¼æ¥è¿›è¡Œè®­ç»ƒã€‚

å¦‚æœä½ æ²¡æœ‰æ¥è§¦è¿‡æœºå™¨å­¦ä¹ ï¼Œçœ‹åˆ°è¿™é‡Œï¼Œå¯èƒ½å·²ç»çœ‹æ‡µäº†ã€‚æ²¡å…³ç³»ï¼Œä¸Šé¢çš„å¤§éƒ¨åˆ†çŸ¥è¯†ä½ æœªæ¥å¯èƒ½éƒ½ä¸éœ€è¦äº†è§£äº†ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰äº†å¤§è¯­è¨€æ¨¡å‹ï¼Œå¯ä»¥é€šè¿‡å®ƒæä¾›çš„Completionå’ŒEmbeddingè¿™ä¸¤ä¸ªAPIï¼Œç”¨ä¸åˆ°10è¡Œä»£ç å°±èƒ½å®Œæˆæƒ…æ„Ÿåˆ†æï¼Œå¹¶ä¸”èƒ½è·å¾—éå¸¸å¥½çš„æ•ˆæœã€‚

## å¤§è¯­è¨€æ¨¡å‹ï¼š20è¡Œä»£ç çš„æƒ…æ„Ÿåˆ†æè§£å†³æ–¹æ¡ˆ

é€šè¿‡å¤§è¯­è¨€æ¨¡å‹æ¥è¿›è¡Œæƒ…æ„Ÿåˆ†æï¼Œæœ€ç®€å•çš„æ–¹å¼å°±æ˜¯åˆ©ç”¨å®ƒæä¾›çš„Embeddingè¿™ä¸ªAPIã€‚è¿™ä¸ªAPIå¯ä»¥æŠŠä»»ä½•ä½ æŒ‡å®šçš„ä¸€æ®µæ–‡æœ¬ï¼Œå˜æˆä¸€ä¸ªå¤§è¯­è¨€æ¨¡å‹ä¸‹çš„å‘é‡ï¼Œä¹Ÿå°±æ˜¯ç”¨ä¸€ç»„å›ºå®šé•¿åº¦çš„å‚æ•°æ¥ä»£è¡¨ä»»ä½•ä¸€æ®µæ–‡æœ¬ã€‚

æˆ‘ä»¬éœ€è¦æå‰è®¡ç®—â€œå¥½è¯„â€å’Œâ€œå·®è¯„â€è¿™ä¸¤ä¸ªå­—çš„Embeddingã€‚è€Œå¯¹äºä»»ä½•ä¸€æ®µæ–‡æœ¬è¯„è®ºï¼Œæˆ‘ä»¬ä¹Ÿéƒ½å¯ä»¥é€šè¿‡APIæ‹¿åˆ°å®ƒçš„Embeddingã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬æŠŠè¿™æ®µæ–‡æœ¬çš„Embeddingå’Œâ€œå¥½è¯„â€ä»¥åŠâ€œå·®è¯„â€é€šè¿‡ä½™å¼¦è·ç¦»ï¼ˆCosine Similarityï¼‰è®¡ç®—å‡ºå®ƒçš„ç›¸ä¼¼åº¦ã€‚ç„¶åæˆ‘ä»¬æ‹¿è¿™ä¸ªEmbeddingå’Œâ€œå¥½è¯„â€ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œå»å‡å»å’Œâ€œå·®è¯„â€ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œå°±ä¼šå¾—åˆ°ä¸€ä¸ªåˆ†æ•°ã€‚å¦‚æœè¿™ä¸ªåˆ†æ•°å¤§äº0ï¼Œé‚£ä¹ˆè¯´æ˜æˆ‘ä»¬çš„è¯„è®ºå’Œâ€œå¥½è¯„â€çš„è·ç¦»æ›´è¿‘ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ¤æ–­å®ƒä¸ºå¥½è¯„ã€‚å¦‚æœè¿™ä¸ªåˆ†æ•°å°äº0ï¼Œé‚£ä¹ˆå°±æ˜¯ç¦»å·®è¯„æ›´è¿‘ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ¤æ–­å®ƒä¸ºå·®è¯„ã€‚

ä¸‹é¢æˆ‘ä»¬å°±ç”¨è¿™ä¸ªæ–¹æ³•åˆ†æä¸€ä¸‹ä¸¤æ¡åœ¨äº¬ä¸œä¸Šè´­ä¹°äº†iPhoneç”¨æˆ·çš„è¯„è®ºã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/ff/7d/ff7a7da002113b2fd345dc598e1aeb7d.png?wh=1920x642)

è¿™ä¸ªä½¿ç”¨å¤§æ¨¡å‹çš„æ–¹æ³•ä¸€å…±ä¸åˆ°40è¡Œä»£ç ï¼Œæˆ‘ä»¬çœ‹çœ‹å®ƒèƒ½å¦å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿå¯¹è¿™ä¸¤æ¡è¯„è®ºè¿›è¡Œæƒ…æ„Ÿåˆ†æã€‚

```python
from openai import OpenAI
import numpy as np
import os

client = OpenAI(api_key=os.environ['OPENAI_API_KEY'])

EMBEDDING_MODEL = "text-embedding-ada-002"

def get_embedding(text, model=EMBEDDING_MODEL):
   text = text.replace("\n", " ")
   return client.embeddings.create(input = [text], model=model).data[0].embedding

def cosine_similarity(vector_a, vector_b):
  dot_product = np.dot(vector_a, vector_b)
  norm_a = np.linalg.norm(vector_a)
  norm_b = np.linalg.norm(vector_b)
  epsilon = 1e-10
  cosine_similarity = dot_product / (norm_a * norm_b + epsilon)
  return cosine_similarity

positive_review = get_embedding("å¥½è¯„")
negative_review = get_embedding("å·®è¯„")

positive_example = get_embedding("ä¹°çš„é“¶è‰²ç‰ˆçœŸçš„å¾ˆå¥½çœ‹ï¼Œä¸€å¤©å°±åˆ°äº†ï¼Œæ™šä¸Šå°±å¼€å§‹æ‹¿èµ·æ¥å®Œç³»ç»Ÿå¾ˆä¸æ»‘æµç•…ï¼Œåšå·¥æ‰å®ï¼Œæ‰‹æ„Ÿç»†è…»ï¼Œå¾ˆç²¾è‡´å“¦è‹¹æœä¸€å¦‚æ—¢å¾€çš„å¥½å“è´¨")
negative_example = get_embedding("éšæ„é™ä»·ï¼Œä¸äºˆä»·ä¿ï¼ŒæœåŠ¡æ€åº¦å·®")

def get_score(sample_embedding):
  return cosine_similarity(sample_embedding, positive_review) - cosine_similarity(sample_embedding, negative_review)

positive_score = get_score(positive_example)
negative_score = get_score(negative_example)

print("å¥½è¯„ä¾‹å­çš„è¯„åˆ† : %f" % (positive_score))
print("å·®è¯„ä¾‹å­çš„è¯„åˆ† : %f" % (negative_score))

```

è¾“å‡ºç»“æœï¼š

```python
å¥½è¯„ä¾‹å­çš„è¯„åˆ† : 0.070963
å·®è¯„ä¾‹å­çš„è¯„åˆ† : -0.081472
```

æ­£å¦‚æˆ‘ä»¬æ‰€æ–™ï¼Œäº¬ä¸œä¸Šçš„å¥½è¯„é€šè¿‡Embeddingç›¸ä¼¼åº¦è®¡ç®—å¾—åˆ°çš„åˆ†æ•°æ˜¯å¤§äº0çš„ï¼Œäº¬ä¸œä¸Šé¢çš„å·®è¯„ï¼Œè¿™ä¸ªåˆ†æ•°æ˜¯å°äº0çš„ã€‚

è¿™æ ·çš„æ–¹æ³•ï¼Œæ˜¯ä¸æ˜¯ç‰¹åˆ«ç®€å•ï¼Ÿæˆ‘ä»¬å†æ‹¿åˆšæ‰çš„ä¾‹å­è¯•ä¸€ä¸‹ï¼Œçœ‹çœ‹è¿™ä¸ªæ–¹æ³•æ˜¯ä¸æ˜¯å¯¹æ‰€æœ‰è¯è¯­éƒ½ç®¡ç”¨ï¼Œåªæ˜¯å‡ºç°çš„ä½ç½®ä¸åŒä½†å«ä¹‰æˆªç„¶ç›¸åçš„è¯„è®ºï¼Œèƒ½å¾—åˆ°ä»€ä¹ˆæ ·çš„ç»“æœã€‚

```python
good_restraurant = get_embedding("è¿™å®¶é¤é¦†å¤ªå¥½åƒäº†ï¼Œä¸€ç‚¹éƒ½ä¸ç³Ÿç³•")
bad_restraurant = get_embedding("è¿™å®¶é¤é¦†å¤ªç³Ÿç³•äº†ï¼Œä¸€ç‚¹éƒ½ä¸å¥½åƒ")

good_score = get_score(good_restraurant)
bad_score = get_score(bad_restraurant)
print("å¥½è¯„é¤é¦†çš„è¯„åˆ† : %f" % (good_score))
print("å·®è¯„é¤é¦†çš„è¯„åˆ† : %f" % (bad_score))
```

è¾“å‡ºç»“æœï¼š

```python
å¥½è¯„é¤é¦†çš„è¯„åˆ† : 0.062719
å·®è¯„é¤é¦†çš„è¯„åˆ† : -0.074591
```

å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶ä¸¤å¥è¯åˆ†åˆ«æ˜¯â€œå¤ªå¥½åƒâ€â€œä¸ç³Ÿç³•â€å’Œâ€œå¤ªç³Ÿç³•â€â€œä¸å¥½åƒâ€ï¼Œå…¶å®è¯è¯­éƒ½ä¸€æ ·ï¼Œä½†æ˜¯å¤§è¯­è¨€æ¨¡å‹ä¸€æ ·èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬åˆ¤æ–­å‡ºæ¥ä»–ä»¬çš„å«ä¹‰æ˜¯ä¸åŒçš„ï¼Œä¸€ä¸ªæ›´æ¥è¿‘å¥½è¯„ï¼Œä¸€ä¸ªæ›´æ¥è¿‘å·®è¯„ã€‚

## æ›´å¤§çš„æ•°æ®é›†ä¸Šçš„çœŸå®æ¡ˆä¾‹

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åªä¸¾äº†å‡ ä¸ªä¾‹å­ï¼Œçœ‹èµ·æ¥æ•ˆæœè¿˜ä¸é”™ã€‚è¿™ä¼šä¸ä¼šåªæ˜¯æˆ‘ä»¬è¿æ°”å¥½å‘¢ï¼Ÿæˆ‘ä»¬å†æ¥æ‹¿ä¸€ä¸ªçœŸå®çš„æ•°æ®é›†éªŒè¯ä¸€ä¸‹ï¼Œåˆ©ç”¨è¿™ç§æ–¹æ³•è¿›è¡Œæƒ…æ„Ÿåˆ†æçš„å‡†ç¡®ç‡èƒ½å¤Ÿåˆ°å¤šå°‘ã€‚

ä¸‹é¢è¿™æ®µä»£ç ï¼Œæ˜¯æ¥è‡ªOpenAI Cookbooké‡Œé¢çš„ä¸€ä¸ªä¾‹å­ã€‚å®ƒæ˜¯ç”¨åŒæ ·çš„æ–¹æ³•ï¼Œæ¥åˆ¤æ–­äºšé©¬é€Šæä¾›çš„ç”¨æˆ·å¯¹ä¸€äº›é£Ÿç‰©çš„è¯„ä»·ï¼Œè¿™ä¸ªè¯„ä»·æ•°æ®é‡Œé¢ï¼Œä¸åªæœ‰ç”¨æˆ·ç»™å‡ºçš„è¯„è®ºå†…å®¹ï¼Œè¿˜æœ‰ç”¨æˆ·ç»™è¿™äº›é£Ÿç‰©æ‰“äº†å‡ é¢—æ˜Ÿã€‚è¿™äº›å‡ é¢—æ˜Ÿçš„ä¿¡æ¯ï¼Œæ­£å¥½å¯ä»¥æ‹¿æ¥éªŒè¯æˆ‘ä»¬è¿™ä¸ªæ–¹æ³•æœ‰å¤šå‡†ã€‚å¯¹äºç”¨æˆ·æ‰“å‡º1ï½2æ˜Ÿçš„ï¼Œæˆ‘ä»¬è®¤ä¸ºæ˜¯å·®è¯„ï¼Œå¯¹äº4ï½5æ˜Ÿçš„ï¼Œæˆ‘ä»¬è®¤ä¸ºæ˜¯å¥½è¯„ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡Pandasï¼Œå°†è¿™ä¸ªCSVæ•°æ®è¯»å–åˆ°å†…å­˜é‡Œé¢ã€‚ä¸ºäº†é¿å…é‡æ–°è°ƒç”¨OpenAIçš„APIæµªè´¹é’±ï¼Œè¿™ä¸ªæ•°æ®é›†é‡Œï¼Œå·²ç»å°†è·å–åˆ°çš„Embeddingä¿¡æ¯ä¿å­˜ä¸‹æ¥äº†ï¼Œä¸éœ€è¦å†é‡æ–°è®¡ç®—ã€‚

```python
import pandas as pd
import numpy as np

from sklearn.metrics import classification_report

datafile_path = "data/fine_food_reviews_with_embeddings_1k.csv"

df = pd.read_csv(datafile_path)
df["embedding"] = df.embedding.apply(eval).apply(np.array)

# convert 5-star rating to binary sentiment
df = df[df.Score != 3]
df["sentiment"] = df.Score.replace({1: "negative", 2: "negative", 4: "positive", 5: "positive"})
```

æ¯ä¸€æ¡è¯„è®ºéƒ½ç”¨æˆ‘ä»¬ä¸Šé¢çš„æ–¹æ³•ï¼Œå’Œä¸€ä¸ªé¢„å…ˆè®¾å®šå¥½çš„å¥½è¯„å’Œå·®è¯„çš„æ–‡æœ¬å»åšå¯¹æ¯”ï¼Œç„¶åçœ‹å®ƒç¦»å“ªä¸ªè¿‘ä¸€äº›ã€‚è¿™é‡Œçš„å¥½è¯„å’Œå·®è¯„ï¼Œæˆ‘ä»¬å†™å¾—ç¨å¾®é•¿äº†ä¸€ç‚¹ï¼Œåˆ†åˆ«æ˜¯ â€œAn Amazon review with a negative sentiment.â€ å’Œ â€œAn Amazon review with a positive sentiment.â€ã€‚

åœ¨è®¡ç®—å®Œç»“æœä¹‹åï¼Œæˆ‘ä»¬åˆ©ç”¨Scikit-learnè¿™ä¸ªæœºå™¨å­¦ä¹ çš„åº“ï¼Œå°†æˆ‘ä»¬çš„é¢„æµ‹å€¼å’Œå®é™…ç”¨æˆ·æ‰“å‡ºçš„æ˜Ÿæ•°åšä¸ªå¯¹æ¯”ï¼Œç„¶åè¾“å‡ºå¯¹æ¯”ç»“æœã€‚éœ€è¦çš„ä»£ç ï¼Œä¹Ÿå°±ä¸åˆ°20è¡Œã€‚

```python
from sklearn.metrics import PrecisionRecallDisplay

def evaluate_embeddings_approach(
    labels = ['negative', 'positive'], 
    model = EMBEDDING_MODEL,
):
    label_embeddings = [get_embedding(label, engine=model) for label in labels]

    def label_score(review_embedding, label_embeddings):
        return cosine_similarity(review_embedding, label_embeddings[1]) - cosine_similarity(review_embedding, label_embeddings[0])

    probas = df["embedding"].apply(lambda x: label_score(x, label_embeddings))
    preds = probas.apply(lambda x: 'positive' if x>0 else 'negative')

    report = classification_report(df.sentiment, preds)
    print(report)

    display = PrecisionRecallDisplay.from_predictions(df.sentiment, probas, pos_label='positive')
    _ = display.ax_.set_title("2-class Precision-Recall curve")

evaluate_embeddings_approach(labels=['An Amazon review with a negative sentiment.', 'An Amazon review with a positive sentiment.'])
```

è¾“å‡ºç»“æœï¼š

```python
              precision    recall  f1-score   support
    negative       0.98      0.73      0.84       136
    positive       0.96      1.00      0.98       789
    accuracy                           0.96       925
   macro avg       0.97      0.86      0.91       925
weighted avg       0.96      0.96      0.96       925
```

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/0f/3b/0ffa4e45899cd50bc5ac7e5ea0f89c3b.png?wh=392x278)

åœ¨ç»“æœé‡Œé¢å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬è¿™ä¸ªç®€å•æ–¹æ³•åˆ¤å®šçš„å¥½è¯„å·®è¯„çš„ç²¾åº¦ï¼Œä¹Ÿå°±æ˜¯ precision åœ¨ negative å’Œ positiveé‡Œï¼Œåˆ†åˆ«æ˜¯0.98å’Œ0.96ï¼Œä¹Ÿå°±æ˜¯åœ¨95%ä»¥ä¸Šã€‚

è€Œå¬å›ç‡ï¼Œä¹Ÿå°±æ˜¯å›¾é‡Œçš„ recallï¼Œåœ¨å·®è¯„é‡Œç¨å¾®æ¬ ç¼ºä¸€ç‚¹ï¼Œåªæœ‰73%ï¼Œè¿™è¯´æ˜è¿˜æ˜¯æœ‰ä¸å°‘å·®è¯„è¢«è¯¯åˆ¤ä¸ºäº†å¥½è¯„ã€‚ä¸è¿‡åœ¨å¥½è¯„é‡Œï¼Œå¬å›ç‡åˆ™æ˜¯100%ï¼Œä¹Ÿå°±æ˜¯100%çš„å¥½è¯„éƒ½è¢«æ¨¡å‹æ‰¾åˆ°äº†ã€‚è¿™æ ·ç»¼åˆè€ƒè™‘ä¸‹æ¥çš„æ•´ä½“å‡†ç¡®ç‡ï¼Œé«˜è¾¾96%ã€‚è€Œè¦è¾¾åˆ°è¿™ä¹ˆå¥½çš„æ•ˆæœï¼Œæˆ‘ä»¬ä¸éœ€è¦è¿›è¡Œä»»ä½•æœºå™¨å­¦ä¹ è®­ç»ƒï¼Œåªéœ€è¦å‡ è¡Œä»£ç è°ƒç”¨ä¸€ä¸‹å¤§æ¨¡å‹çš„æ¥å£ï¼Œè®¡ç®—ä¸€ä¸‹å‡ ä¸ªå‘é‡çš„ç›¸ä¼¼åº¦å°±å¥½äº†ã€‚

## å°ç»“

è¿™ä¸€è®²ï¼Œæˆ‘ä»¬åˆ©ç”¨ä¸åŒæ–‡æœ¬åœ¨å¤§è¯­è¨€æ¨¡å‹é‡ŒEmbeddingä¹‹é—´çš„è·ç¦»ï¼Œæ¥è¿›è¡Œæƒ…æ„Ÿåˆ†æã€‚è¿™ç§ä½¿ç”¨å¤§è¯­è¨€æ¨¡å‹çš„æŠ€å·§ï¼Œä¸€èˆ¬è¢«ç§°åšé›¶æ ·æœ¬åˆ†ç±»ï¼ˆZero-Shot Classificationï¼‰ã€‚

æ‰€è°“é›¶æ ·æœ¬åˆ†ç±»ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸éœ€è¦ä»»ä½•æ–°çš„æ ·æœ¬æ¥è®­ç»ƒæœºå™¨å­¦ä¹ çš„æ¨¡å‹ï¼Œå°±èƒ½è¿›è¡Œåˆ†ç±»ã€‚æˆ‘ä»¬è®¤ä¸ºï¼Œä¹‹å‰ç»è¿‡é¢„è®­ç»ƒçš„å¤§è¯­è¨€æ¨¡å‹é‡Œé¢ï¼Œå·²ç»è•´å«äº†æƒ…æ„Ÿåˆ†æçš„çŸ¥è¯†ã€‚æˆ‘ä»¬åªéœ€è¦ç®€å•åˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹é‡Œé¢çŸ¥é“çš„â€œå¥½è¯„â€å’Œâ€œå·®è¯„â€çš„æ¦‚å¿µä¿¡æ¯ï¼Œå°±èƒ½åˆ¤æ–­å‡ºå®ƒä»æœªè§è¿‡çš„è¯„è®ºåˆ°åº•æ˜¯å¥½è¯„è¿˜æ˜¯å·®è¯„ã€‚

è¿™ä¸ªæ–¹æ³•ï¼Œåœ¨ä¸€äº›ç»å…¸çš„æ•°æ®é›†ä¸Šï¼Œè½»æ˜“å°±è¾¾åˆ°äº†95%ä»¥ä¸Šçš„å‡†ç¡®åº¦ã€‚åŒæ—¶ï¼Œä¹Ÿè®©ä¸€äº›åŸæœ¬éœ€è¦æœºå™¨å­¦ä¹ ç ”å‘ç»éªŒæ‰èƒ½å®Œæˆçš„ä»»åŠ¡å˜å¾—æ›´åŠ å®¹æ˜“ï¼Œä»è€Œå¤§å¤§é™ä½äº†é—¨æ§›ã€‚

å¦‚æœä½ æ‰€åœ¨çš„å…¬å¸ä»Šå¤©æƒ³è¦åšä¸€ä¸ªæ–‡æœ¬åˆ†ç±»çš„åº”ç”¨ï¼Œé€šè¿‡OpenAIçš„APIç”¨å‡ åˆ†é’Ÿæ—¶é—´å°±èƒ½å¾—åˆ°æƒ³è¦çš„ç»“æœã€‚

## è¯¾åç»ƒä¹ 

åˆ©ç”¨å¤§æ¨¡å‹æ¥è§£å†³é—®é¢˜ï¼Œä¸æ˜¯ä¸€ä¸ªç†è®ºé—®é¢˜ï¼Œè€Œæ˜¯ä¸€ä¸ªå®æˆ˜é—®é¢˜ã€‚è¯·ä½ å°è¯•å°†è¿™ä¸ªæ–¹æ³•è¿ç”¨åœ¨åˆ«çš„æ•°æ®é›†ä¸Šï¼Œçœ‹çœ‹æ˜¯å¦ä¹Ÿä¼šæœ‰å¾ˆå¥½çš„æ•ˆæœï¼Ÿæ¯”å¦‚ï¼Œä½ å¯ä»¥è¯•ç€ç”¨Kaggleæä¾›çš„äºšé©¬é€Šè€³æœºç±»å•†å“çš„è¯„è®ºæ•°æ®ï¼Œçœ‹çœ‹ç»“æœæ˜¯æ€æ ·çš„ï¼Ÿè¿™ä¸ªæ•°æ®é›†æ¯”è¾ƒå¤§ï¼Œä½ å¯ä»¥æŒ‘å‡ æ¡æ•°æ®è¯•ä¸€ä¸‹ã€‚å› ä¸ºOpenIAä¼šå¯¹ä½ çš„è°ƒç”¨é™é€Ÿï¼Œå…è´¹çš„Tokenæ•°é‡ä¹Ÿæ¯”è¾ƒæœ‰é™ã€‚å¯¹äºé™é€Ÿæƒ…å†µä¸‹çš„å¤§æ‰¹é‡æ•°æ®çš„å¤„ç†ï¼Œæˆ‘ä»¬ä¼šåœ¨ç¬¬04è®²è®²è§£ã€‚

æ•°æ®é›†é“¾æ¥ï¼š[https://www.kaggle.com/datasets/shitalkat/amazonearphonesreviews](https://www.kaggle.com/datasets/shitalkat/amazonearphonesreviews)

æ¬¢è¿ä½ æŠŠä½ çš„ç»“æœåˆ†äº«åˆ°è¯„è®ºåŒºï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾åˆ†äº«ç»™æ„Ÿå…´è¶£çš„æœ‹å‹ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ15ï¼‰</strong></div><ul>
<li><span>humor</span> ğŸ‘ï¼ˆ22ï¼‰ ğŸ’¬ï¼ˆ4ï¼‰<p>å¤§æ¨¡å‹æ˜¯æ€ä¹ˆçŸ¥é“å¥½è¯„å’Œå·®è¯„æ˜¯ä»£è¡¨ä»€ä¹ˆæ„æ€çš„å‘¢</p>2023-03-22</li><br/><li><span>Dev.lu</span> ğŸ‘ï¼ˆ21ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<p>conda install -c conda-forge matplotlib
conda install -c conda-forge plotly   
conda install -c anaconda scikit-learn
è·‘æƒ…æ„Ÿåˆ†æçš„éƒ¨åˆ†ï¼Œå¯èƒ½éœ€è¦é¢å¤–å®‰è£…è¿™äº›åŒ…</p>2023-04-15</li><br/><li><span>Geek_035566</span> ğŸ‘ï¼ˆ19ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>çŸ¥ä¹ä¸Šå¼ ä¿Šæ—å¯¹GPTå¯¹NLPçš„å½±å“åšäº†å¾ˆå¥½è§£è¯»ï¼Œæˆ‘è¿™ä¸ªå°ç™½å¬äº†ä¹Ÿèƒ½æœ‰å¾ˆæ·±çš„ç†è§£ã€‚

ä»–æŠŠNLPè§£å†³çš„é—®é¢˜åˆ†ä¸ºä¸­é—´ä»»åŠ¡å’Œæœ€ç»ˆä»»åŠ¡ï¼Œå…ˆé˜è¿°ä¸­é—´ä»»åŠ¡å…¶å®æ˜¯äººç±»æ²¡æœ‰æ‰¾åˆ°æ›´å¥½åŠæ³•å¤„ç†è‡ªç„¶è¯­è¨€æ—¶æƒ³å‡ºæ¥çš„è¾…åŠ©å·¥å…·ï¼ŒGPTçš„å‡ºç°ä¸€ç¬é—´è®©è¿™äº›è„šæ‰‹æ¶éƒ½æ²¡äº†ç”¨å¤„ã€‚

å†è¿›ä¸€æ­¥ï¼Œä»–åˆæŠŠæœ€ç»ˆä»»åŠ¡åˆ†ä¸ºè‡ªç„¶è¯­è¨€ç†è§£å’Œè‡ªç„¶è¯­è¨€ç”Ÿæˆä»»åŠ¡ï¼Œè¿›ä¸€æ­¥åˆ†æGPTå¯¹è¿™ä¸¤ç±»ä»»åŠ¡çš„å½±å“ã€‚

å¾ˆç®€æ´ä¼˜ç¾çš„è®²æ¸…æ¥šäº†GPTå¯¹NLPçš„å†²å‡»ï¼ŒçŸ¥ä¹åœ°å€æˆ‘æ”¾ä¸‹é¢ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªå·±çœ‹ã€‚
https:&#47;&#47;zhuanlan.zhihu.com&#47;p&#47;597586623</p>2023-05-08</li><br/><li><span>jo</span> ğŸ‘ï¼ˆ15ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>â€œæˆ‘ä»¬æŠŠè¿™æ®µæ–‡æœ¬çš„ Embedding å’Œâ€œå¥½è¯„â€ä»¥åŠâ€œå·®è¯„â€é€šè¿‡ä½™å¼¦è·ç¦»ï¼ˆCosine Similarityï¼‰è®¡ç®—å‡ºå®ƒçš„ç›¸ä¼¼åº¦â€ï¼Œä¸å¤ªæ‡‚</p>2023-04-07</li><br/><li><span>Roy Liang</span> ğŸ‘ï¼ˆ8ï¼‰ ğŸ’¬ï¼ˆ4ï¼‰<p>è¯¾åä½œä¸šï¼Œå…¨éƒ¨æ•°æ®é›†æ˜¯ä¸æ˜¯å¤ªå¤šï¼Œå‡ºä¸äº†ç»“æœï¼Œå‰33æ¡è®°å½•æ²¡é—®é¢˜ï¼Œæˆ‘æ˜¯ä¸æ˜¯è¯¥ç»™OpenAIå……å€¼ï¼Ÿ

              precision    recall  f1-score   support

    negative       0.81      0.93      0.87        14
    positive       0.92      0.79      0.85        14

    accuracy                           0.86        28
   macro avg       0.86      0.86      0.86        28
weighted avg       0.86      0.86      0.86        28

ä»£ç 
import pandas as pd
import numpy as np

from sklearn.metrics import classification_report,PrecisionRecallDisplay
from openai.embeddings_utils import cosine_similarity, get_embedding

EMBEDDING_MODEL = &quot;text-embedding-ada-002&quot;

#datafile_path = &quot;data&#47;AllProductReviews.csv&quot;
datafile_path = &quot;data&#47;test.csv&quot;
df = pd.read_csv(datafile_path)
df[&quot;embedding&quot;] = df.ReviewBody.apply(lambda x: get_embedding(x, engine=EMBEDDING_MODEL))

# convert 5-star rating to binary sentiment
df = df[df.ReviewStar != 3]
df[&quot;sentiment&quot;] = df.ReviewStar.replace({1: &quot;negative&quot;, 2: &quot;negative&quot;, 4: &quot;positive&quot;, 5: &quot;positive&quot;})

def evaluate_embeddings_approach(
    labels = [&#39;negative&#39;, &#39;positive&#39;],
    model = EMBEDDING_MODEL,
):
    label_embeddings = [get_embedding(label, engine=model) for label in labels]

    def label_score(review_embedding, label_embeddings):
        return cosine_similarity(review_embedding, label_embeddings[1]) - cosine_similarity(review_embedding, label_embeddings[0])

    probas = df[&quot;embedding&quot;].apply(lambda x: label_score(x, label_embeddings))
    preds = probas.apply(lambda x: &#39;positive&#39; if x&gt;0 else &#39;negative&#39;)

    report = classification_report(df.sentiment, preds)
    print(report)

    display = PrecisionRecallDisplay.from_predictions(df.sentiment, probas, pos_label=&#39;positive&#39;)
    _ = display.ax_.set_title(&quot;2-class Precision-Recall curve&quot;)

evaluate_embeddings_approach()</p>2023-03-22</li><br/><li><span>pippo</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<p>æ–‡æœ¬å‘é‡positiveå’Œnegativeæ ‡ç­¾æ˜¯openaiè®­ç»ƒæ ‡æ³¨å¥½çš„ï¼Œé‚£è¿˜æœ‰å…¶ä»–ä»€ä¹ˆæ ‡ç­¾å—ï¼Ÿåªæœ‰è¿™ä¸¤ç§å—ï¼Ÿ</p>2023-03-22</li><br/><li><span>xbc</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<p>åç»­æ˜¯å¦ä¼šè®²è®²å¦‚ä½•ä½¿ç”¨openai apiå®ç°chatpdfè¿™æ ·çš„åŠŸèƒ½ã€‚ä»¥åŠä½¿ç”¨å…¬å¼€çš„å¼±ä¸€äº›çš„æ¨¡å‹ï¼Œæ¥å°½é‡å®ç°chatpdfçš„åŠŸèƒ½ã€‚</p>2023-03-22</li><br/><li><span>Geek_b7449f</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>import pandas as pd 
import numpy as np 

from sklearn.metrics import classification_report , PrecisionRecallDisplay
from openai.embeddings_utils import cosine_similarity , get_embedding

# é€‰æ‹©ç”¨äºæƒ…æ„Ÿåˆ†æçš„æ¨¡å‹
EMBEDDING_MODEL = &quot;text-embedding-ada-002&quot;
# è®¾ç½®æ•°æ®é›†æ–‡ä»¶è·¯å¾„
datafile_path = &quot;data&#47;AllProductReviews.csv&quot;
# è¯»å– csv æ–‡ä»¶ åªå–å‰60è¡Œ
df = pd.read_csv(datafile_path,nrows=60)
# æ–°å¢ä¸€åˆ— embedding ç”¨äºè¡¨ç¤ºè·å–æ¯è¡Œçš„ReviewBodyå‘é‡å€¼
df[&quot;embedding&quot;] = df.ReviewBody.apply(lambda x:get_embedding(x,engine=EMBEDDING_MODEL))

# é™¤å»æ˜Ÿçº§ä¸º3çš„è¯„è®ºæ¥è¿›è¡Œåˆ’åˆ†å¥½è¯„è¿˜æ˜¯å·®è¯„ä¸¤ä¸ªæ ‡ç­¾
df = df[df.ReviewStar != 3]
df[&quot;sentiment&quot;] = df.ReviewStar.replace({1: &quot;negative&quot;, 2: &quot;negative&quot;, 4: &quot;positive&quot;, 5: &quot;positive&quot;})
# å‡½æ•° evaluate_embeddings_approach é»˜è®¤ä¼šæœ‰ä¸¤ä¸ªå‚æ•° label å’Œ model éƒ½æœ‰å¯¹åº”çš„é»˜è®¤å€¼
def evaluate_embeddings_approach(
    labels = [&#39;negative&#39;, &#39;positive&#39;],
    model = EMBEDDING_MODEL,
):
    # è®¡ç®—æ¯ä¸ª label çš„å‘é‡å€¼
    label_embeddings = [get_embedding(label, engine=model) for label in labels]
    # è¾…åŠ©å‡½æ•° ç”¨äºè®¡ç®—å¥½è¯„å’Œreview_embeddingä¸å·®è¯„å’Œreview_embeddingå‘é‡ä½™å¼¦å€¼å·®å€¼
    def label_score(review_embedding, label_embeddings):
        return cosine_similarity(review_embedding, label_embeddings[1]) - cosine_similarity(review_embedding, label_embeddings[0])
    # è¿™é‡Œæ›´æ–°ä¸‹ embedding åˆ— æ›´æ–°æˆå¯¹åº”çš„ åˆ†æ•°
    probas = df[&quot;embedding&quot;].apply(lambda x: label_score(x, label_embeddings))
    # é¢„æµ‹å€¼
    preds = probas.apply(lambda x: &#39;positive&#39; if x&gt;0 else &#39;negative&#39;)
    # ç”Ÿæˆä¸€ä¸ªåˆ†ç±»æŠ¥å‘Š
    report = classification_report(df.sentiment, preds)
    print(report)
    # è¿™ä¸ªå°±æ˜¯ç»˜åˆ¶äºŒåˆ†ç±»çš„å‡†ç¡®ç‡-å¬å›ç‡æ›²çº¿
    display = PrecisionRecallDisplay.from_predictions(df.sentiment, probas, pos_label=&#39;positive&#39;)
    _ = display.ax_.set_title(&quot;2-class Precision-Recall curve&quot;)
# æ— å‚æ•°é»˜è®¤å€¼è°ƒç”¨å‡½æ•°
evaluate_embeddings_approach()</p>2023-05-06</li><br/><li><span>æ¼«æ¸¸è€…</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>negative_example = get_embedding(&quot;éšæ„é™ä»·ï¼Œä¸äºˆä»·ä¿ï¼ŒæœåŠ¡æ€åº¦å·®&quot;)
å·®è¯„ä¾‹å­çš„è¯„åˆ† : -0.081472
negative_example = get_embedding(&quot;éšæ„é™ä»·ï¼Œä¸äºˆä»·ä¿ï¼ŒæœåŠ¡æ€åº¦å·®ï¼Œä½†æ˜¯åç»­æ¢äº†ä¸ªå®¢æœï¼ŒæœåŠ¡æ€åº¦å¥½å¤šäº†&quot;)
å·®è¯„ä¾‹å­çš„è¯„åˆ† : -0.048267
negative_example = get_embedding(&quot;éšæ„é™ä»·ï¼Œä¸äºˆä»·ä¿ï¼ŒæœåŠ¡æ€åº¦å·®ï¼Œä½†æ˜¯åç»­æ¢äº†ä¸ªå®¢æœï¼ŒæœåŠ¡æ€åº¦å¥½å¤šäº†ã€‚ç»è¿‡æ²Ÿé€šè§£å†³äº†æ‰€æœ‰é—®é¢˜ï¼Œå¥½è¯„ï¼&quot;)
å·®è¯„ä¾‹å­çš„è¯„åˆ† : -0.009858

é€šè¿‡ä¾‹å­çœ‹åˆ°ï¼Œç¬¬ä¸‰å¥è¯å¾ˆæ˜æ˜¾æˆ‘å·²ç»æ˜¯å¥½è¯„äº†ï¼Œä½†æ˜¯æ¨¡å‹è¿˜æ˜¯ç»™äº†å·®è¯„çš„ç»“è®ºã€‚æ˜¯ä¸æ˜¯æ’åœ¨å‰é¢çš„å¥å­æƒé‡æ›´å¤§å•Šï¼Ÿ</p>2023-05-05</li><br/><li><span>é’±é›¨</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>ç»å†äº†æ— æ•°æ¬¡ä¸‹é¢çš„å¤±è´¥ï¼Œä¸åœé‡æ–°å®‰è£…pillowå’Œmatplotlibä¹‹åï¼Œç»ˆäºæˆåŠŸäº†ã€‚
è§£å†³æ–¹æ¡ˆæ˜¯ç‹ å¿ƒæŠŠminicondaã€pythonå…¨å¸è½½ï¼Œé‡æ–°å®‰è£…ã€‚
æ³¨æ„install openaiä»¥åï¼Œé»˜è®¤çš„pillowç‰ˆæœ¬æ˜¯9.4ï¼Œå¤ªé«˜äº†ï¼ŒæŠŠpillowå¸è½½ï¼Œå®‰è£…8.4ã€‚
è¿™ä¹ˆæ“ä½œä»¥åï¼Œæ–°çš„é—®é¢˜æ˜¯openaiåˆæ²¡äº†ï¼Œå°±æŠŠopenaié‡æ–°è£…å›æ¥ã€‚
å¾ˆå¼€å¿ƒçš„æ˜¯ï¼Œpillowå±…ç„¶è¿˜æ˜¯8.4.ç»“æœæ­£å¸¸äº†ã€‚

File ~\miniconda3\envs\py310\lib\site-packages\PIL\Image.py:103
     94 MAX_IMAGE_PIXELS = int(1024 * 1024 * 1024 &#47;&#47; 4 &#47;&#47; 3)
     97 try:
     98     # If the _imaging C module is not present, Pillow will not load.
     99     # Note that other modules should not refer to _imaging directly;
    100     # import Image and use the Image.core variable instead.
    101     # Also note that Image.core is not a publicly documented interface,
    102     # and should be considered private and subject to change.
--&gt; 103     from . import _imaging as core
    105     if __version__ != getattr(core, &quot;PILLOW_VERSION&quot;, None):
    106         msg = (
    107             &quot;The _imaging extension was built for another version of Pillow or PIL:\n&quot;
    108             f&quot;Core version: {getattr(core, &#39;PILLOW_VERSION&#39;, None)}\n&quot;
    109             f&quot;Pillow version: {__version__}&quot;
    110         )

ImportError: DLL load failed while importing _imaging: The specified module could not be found.</p>2023-04-04</li><br/><li><span>æ¸£æ¸£è¾‰</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ä¸ºä»€ä¹ˆåŒæ ·æ˜¯ç”¨chatgptçš„å‡ºæ¥çš„ç»“æœè·Ÿè€å¸ˆçš„äº‹ä¾‹ç¨æœ‰ä¸åŒï¼Œæ˜¯å› ä¸ºchatgptè¿™ä¸ªæ¨¡å‹æ˜¯åœ¨å®æ—¶æ›´æ–°çš„å—</p>2023-04-02</li><br/><li><span>piboye</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<p>è€å¸ˆ, text complete å’Œ chat complete æ¥å£æœ‰ä»€ä¹ˆåŒºåˆ«å•Š, æˆ‘çœ‹èƒ½åŠ›æ²¡çœ‹å‡ºå¤§çš„å·®åˆ«</p>2023-03-22</li><br/><li><span>peter</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>è¯·æ•™è€å¸ˆå‡ ä¸ªé—®é¢˜ï¼š
Q1ï¼š01è¯¾ä¸­çš„Jupyter Labs å¼€å‘ç¯å¢ƒæ˜¯pythonçš„å¼€å‘ç¯å¢ƒå—ï¼Ÿï¼ˆå¯¹pythonä¸äº†è§£ï¼Œ0åŸºç¡€ï¼Œå°ç™½ï¼‰
Q2ï¼š01è¯¾ä¸­çš„Jupyter Labs å¼€å‘ç¯å¢ƒæ­å»ºï¼Œå¤æ‚å—ï¼Ÿå¦‚æœå¤æ‚çš„è¯ï¼Œèƒ½å¦éº»çƒ¦è€å¸ˆå†™ä¸€ä¸ªæ‰‹å†Œä¸€ç±»çš„æ–‡æ¡£ï¼Ÿæœ€å¥½è¯¦ç»†ä¸€ç‚¹ã€‚ï¼ˆä¸€ç›´è§‰å¾—æ­ç¯å¢ƒå¾ˆéº»çƒ¦ï¼›å°¤å…¶å¯¹ä¸ç†Ÿæ‚‰çš„pythonï¼Œå®¹æ˜“å‡ºé”™ï¼Œå®¹æ˜“æœ‰æŒ«æŠ˜æ„Ÿã€‚ï¼‰ã€‚ ç¯å¢ƒæ­ä¸å¥½ï¼Œåé¢çš„ä¾‹å­æ— æ³•å®è·µã€‚
Q3ï¼šCookbookä¾‹å­ï¼Œä¸ºä»€ä¹ˆç”¨Scikitä¼°è®¡ç»“æœï¼Œåº”è¯¥éƒ½ç”¨openaiæ¥å®Œæˆå•Šã€‚ä¾‹å­ä¸­ç”¨Scikitï¼Œé‚£ç›¸å½“äºâ€œopenai + Scikitâ€ç»“åˆæ¥åˆ¤æ–­å‡ºæœ€åçš„æ˜Ÿæ ‡äº†ï¼Œopenaiè¿™ä¹ˆå¼ºå¤§ï¼Œè¿˜éœ€è¦ç”¨Scikitå—ï¼Ÿ
Q4ï¼šchatGPTæœç´¢æˆ–ç”Ÿæˆpptçš„èƒ½åŠ›å¦‚ä½•ï¼Ÿ
æ¯”å¦‚æˆ‘è¦åšä¸€ä¸ªè½¯ä»¶çš„äº§å“ä»‹ç»æ€§è´¨çš„pptï¼Œç”¨æ¥ç»™å®¢æˆ·ä»‹ç»è¯¥è½¯ä»¶ã€‚ä»¥matlabä¸ºä¾‹ï¼Œæˆ‘æ‰˜å›½å¤–åŒäº‹è¿™æ ·æœâ€œmatlab äº§å“ä»‹ç» pptâ€ï¼Œå¹¶æ²¡æœ‰æœåˆ°åˆé€‚çš„pptï¼Œåæ¥åªå¥½åœ¨ç™¾åº¦ä¸Šæœç´¢äº†ã€‚è¯·é—®ï¼Œæ˜¯æˆ‘ä»¬çš„ä½¿ç”¨æ–¹æ³•ä¸å¯¹ï¼Ÿè¿˜æ˜¯è¯´chatGPTæ²¡æœ‰è¿™æ–¹é¢çš„èƒ½åŠ›ï¼Ÿ</p>2023-03-22</li><br/><li><span>Geek_a54b66</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æ²¡æœ‰æä¾› äºšé©¬é€Šé£Ÿç‰©è¯„ä»·çš„è¿æ¥ç½¢ï¼Œæœ€åé¢æä¾›çš„æ˜¯ è€³æœºçš„è¯„ä»·</p>2023-05-10</li><br/><li><span>EnzoîŒ°</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>ä¸çŸ¥é“æ€ä¹ˆä¸‹è½½æ•°æ®é›†ï¼Œåœ¨githubä¸Šç‚¹ä¸‹è½½åå´è¿”å›çš„æ˜¯æµè§ˆå™¨é‡Œä¸€ä¸ªrawåœ°å€ï¼Œå¥½å¥‡æ€ª</p>2023-04-21</li><br/>
</ul>