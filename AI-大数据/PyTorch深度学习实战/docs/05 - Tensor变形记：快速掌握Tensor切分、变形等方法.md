ä½ å¥½ï¼Œæˆ‘æ˜¯æ–¹è¿œã€‚

ä¸ŠèŠ‚è¯¾æˆ‘ä»¬ä¸€èµ·å­¦ä¹ äº†Tensorçš„åŸºç¡€æ¦‚å¿µï¼Œä¹Ÿç†Ÿæ‚‰äº†åˆ›å»ºã€è½¬æ¢ã€ç»´åº¦å˜æ¢ç­‰æ“ä½œï¼ŒæŒæ¡äº†è¿™äº›åŸºç¡€çŸ¥è¯†ï¼Œä½ å°±å¯ä»¥åšä¸€äº›ç®€å•çš„Tensorç›¸å…³çš„æ“ä½œäº†ã€‚

ä¸è¿‡ï¼Œè¦æƒ³åœ¨å®é™…çš„åº”ç”¨ä¸­æ›´çµæ´»åœ°ç”¨å¥½Tensorï¼ŒTensorçš„è¿æ¥ã€åˆ‡åˆ†ç­‰æ“ä½œä¹Ÿæ˜¯å¿…ä¸å¯å°‘çš„ã€‚ä»Šå¤©è¿™èŠ‚è¯¾ï¼Œå’±ä»¬å°±é€šè¿‡ä¸€äº›ä¾‹å­å’Œå›¾ç‰‡æ¥ä¸€å—å­¦ä¹ ä¸‹ã€‚è™½ç„¶è¿™å‡ ä¸ªæ“ä½œæ¯”è¾ƒæœ‰éš¾åº¦ï¼Œä½†åªè¦ä½ è€å¿ƒå¬æˆ‘è®²è§£ï¼Œç„¶åä¸Šæ‰‹ç»ƒä¹ ï¼Œè¿˜æ˜¯å¯ä»¥æ‹¿ä¸‹çš„ã€‚

## Tensorçš„è¿æ¥æ“ä½œ

åœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œæ·±åº¦å­¦ä¹ æŸä¸€å±‚ç¥ç»å…ƒçš„æ•°æ®å¯èƒ½æœ‰å¤šä¸ªä¸åŒçš„æ¥æºï¼Œé‚£ä¹ˆå°±éœ€è¦å°†æ•°æ®è¿›è¡Œç»„åˆï¼Œè¿™ä¸ªç»„åˆçš„æ“ä½œï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º**è¿æ¥**ã€‚

### cat

è¿æ¥çš„æ“ä½œå‡½æ•°å¦‚ä¸‹ã€‚

```python
torch.cat(tensors, dim = 0, out = None)
```

catæ˜¯concatnateçš„æ„æ€ï¼Œä¹Ÿå°±æ˜¯æ‹¼æ¥ã€è”ç³»çš„æ„æ€ã€‚è¯¥å‡½æ•°æœ‰ä¸¤ä¸ªé‡è¦çš„å‚æ•°éœ€è¦ä½ æŒæ¡ã€‚

ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯tensorsï¼Œå®ƒå¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯è‹¥å¹²ä¸ªæˆ‘ä»¬å‡†å¤‡è¿›è¡Œæ‹¼æ¥çš„Tensorã€‚

ç¬¬äºŒä¸ªå‚æ•°æ˜¯dimï¼Œæˆ‘ä»¬å›å¿†ä¸€ä¸‹Tensorçš„å®šä¹‰ï¼ŒTensorçš„ç»´åº¦ï¼ˆç§©ï¼‰æ˜¯æœ‰å¤šç§æƒ…å†µçš„ã€‚æ¯”å¦‚æœ‰ä¸¤ä¸ª3ç»´çš„Tensorï¼Œå¯ä»¥æœ‰å‡ ç§ä¸åŒçš„æ‹¼æ¥æ–¹å¼ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œdimå‚æ•°å°±å¯ä»¥å¯¹æ­¤ä½œå‡ºçº¦å®šã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/61/3c/61bd88f3yy8d0ca07799f36540d3473c.jpg?wh=1285x862)

çœ‹åˆ°è¿™é‡Œï¼Œä½ å¯èƒ½è§‰å¾—ä¸Šé¢ç”»çš„å›¾æ˜¯ä¸‰ç»´çš„ï¼Œçœ‹èµ·æ¥æ¯”è¾ƒæ™¦æ¶©ï¼Œæ‰€ä»¥å’±ä»¬å…ˆä»ç®€å•çš„äºŒç»´çš„æƒ…å†µè¯´èµ·ï¼Œæˆ‘ä»¬å…ˆå£°æ˜ä¸¤ä¸ª3x3çš„çŸ©é˜µï¼Œä»£ç å¦‚ä¸‹ï¼š

```python
>>> A=torch.ones(3,3)
>>> B=2*torch.ones(3,3)
>>> A
tensor([[1., 1., 1.],
Â  Â  Â  Â  [1., 1., 1.],
Â  Â  Â  Â  [1., 1., 1.]])
>>> B
tensor([[2., 2., 2.],
Â  Â  Â  Â  [2., 2., 2.],
Â  Â  Â  Â  [2., 2., 2.]])
```

æˆ‘ä»¬å…ˆçœ‹çœ‹dim=0çš„æƒ…å†µï¼Œæ‹¼æ¥çš„ç»“æœæ˜¯æ€æ ·çš„ï¼š

```python
>>> C=torch.cat((A,B),0)
>>> C
tensor([[1., 1., 1.],
Â  Â  Â  Â  [1., 1., 1.],
Â  Â  Â  Â  [1., 1., 1.],
Â  Â  Â  Â  [2., 2., 2.],
Â  Â  Â  Â  [2., 2., 2.],
Â  Â  Â  Â  [2., 2., 2.]])

```

ä½ ä¼šå‘ç°ï¼Œä¸¤ä¸ªçŸ©é˜µæ˜¯æŒ‰ç…§â€œè¡Œâ€çš„æ–¹å‘æ‹¼æ¥çš„ã€‚

æˆ‘ä»¬æ¥ä¸‹æ¥å†çœ‹çœ‹ï¼Œdim=1çš„æƒ…å†µæ˜¯æ€æ ·çš„ï¼š

```python
>>> D=torch.cat((A,B),1)
>>> D
tensor([[1., 1., 1., 2., 2., 2.],
Â  Â  Â  Â  [1., 1., 1., 2., 2., 2.],
Â  Â  Â  Â  [1., 1., 1., 2., 2., 2.]])
```

æ˜¾ç„¶ï¼Œä¸¤ä¸ªçŸ©é˜µï¼Œæ˜¯æŒ‰ç…§â€œåˆ—â€çš„æ–¹å‘æ‹¼æ¥çš„ã€‚é‚£å¦‚æœTensoræ˜¯ä¸‰ç»´ç”šè‡³æ›´é«˜ç»´åº¦çš„å‘¢ï¼Ÿå…¶å®é“ç†ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œdimçš„æ•°å€¼æ˜¯å¤šå°‘ï¼Œä¸¤ä¸ªçŸ©é˜µå°±ä¼šæŒ‰ç…§ç›¸åº”ç»´åº¦çš„æ–¹å‘é“¾æ¥ä¸¤ä¸ªTensorã€‚

çœ‹åˆ°è¿™é‡Œä½ å¯èƒ½ä¼šé—®äº†ï¼Œcatå®é™…ä¸Šæ˜¯å°†å¤šä¸ªTensoråœ¨å·²æœ‰çš„ç»´åº¦ä¸Šè¿›è¡Œè¿æ¥ï¼Œé‚£å¦‚æœæƒ³å¢åŠ æ–°çš„ç»´åº¦è¿›è¡Œè¿æ¥ï¼Œåˆè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿè¿™æ—¶å€™å°±éœ€è¦stackå‡½æ•°ç™»åœºäº†ã€‚

### stack

ä¸ºäº†è®©ä½ åŠ æ·±ç†è§£ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç»“åˆå…·ä½“ä¾‹å­æ¥çœ‹çœ‹ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªäºŒç»´çŸ©é˜µTensorï¼ŒæŠŠå®ƒä»¬â€œå †å â€æ”¾åœ¨ä¸€èµ·ï¼Œæ„æˆä¸€ä¸ªä¸‰ç»´çš„Tensorï¼Œå¦‚ä¸‹å›¾ï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/9d/66/9d991a0d571e2733ba15d67566f65166.jpg?wh=1160x770)

è¿™ç›¸å½“äºåŸæ¥çš„ç»´åº¦ï¼ˆç§©ï¼‰æ˜¯2ï¼Œç°åœ¨å˜æˆäº†3ï¼Œå˜æˆäº†ä¸€ä¸ªç«‹ä½“çš„ç»“æ„ï¼Œå¢åŠ äº†ä¸€ä¸ªç»´åº¦ã€‚ä½ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™è·Ÿå‰é¢çš„catä¸åŒï¼Œcatä¸­ç¤ºæ„å›¾çš„ä¾‹å­ï¼ŒåŸæ¥å°±æ˜¯3ç»´çš„ï¼Œcatä¹‹åä»æ—§æ˜¯3ç»´çš„ï¼Œè€Œç°åœ¨å’±ä»¬æ˜¯**ä»2ç»´å˜æˆäº†3ç»´**ã€‚

åœ¨å®é™…å›¾åƒç®—æ³•å¼€å‘ä¸­ï¼Œå’±ä»¬æœ‰æ—¶å€™éœ€è¦å°†å¤šä¸ªå•é€šé“Tensorï¼ˆ2ç»´ï¼‰åˆå¹¶ï¼Œå¾—åˆ°å¤šé€šé“çš„ç»“æœï¼ˆ3ç»´ï¼‰ã€‚è€Œå®ç°è¿™ç§å¢åŠ ç»´åº¦æ‹¼æ¥çš„æ–¹æ³•ï¼Œæˆ‘ä»¬æŠŠå®ƒå«åšstackã€‚

stackå‡½æ•°çš„å®šä¹‰å¦‚ä¸‹ï¼š

```python
torch.stack(inputs, dim=0)
```

å…¶ä¸­ï¼Œinputsè¡¨ç¤ºéœ€è¦æ‹¼æ¥çš„Tensorï¼Œdimè¡¨ç¤ºæ–°å»ºç«‹ç»´åº¦çš„æ–¹å‘ã€‚

é‚£stackå¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿæˆ‘ä»¬ä¸€å—æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š

```python
>>> A=torch.arange(0,4)
>>> A
tensor([0, 1, 2, 3])
>>> B=torch.arange(5,9)
>>> B
tensor([5, 6, 7, 8])
>>> C=torch.stack((A,B),0)
>>> C
tensor([[0, 1, 2, 3],
        [5, 6, 7, 8]])
>>> D=torch.stack((A,B),1)
>>> D
tensor([[0, 5],
        [1, 6],
        [2, 7],
        [3, 8]])
```

ç»“åˆä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œé¦–å…ˆæˆ‘ä»¬æ„å»ºäº†ä¸¤ä¸ª4å…ƒç´ å‘é‡Aå’ŒBï¼Œå®ƒä»¬çš„ç»´åº¦æ˜¯1ã€‚ç„¶åï¼Œæˆ‘ä»¬åœ¨dim=0ï¼Œä¹Ÿå°±æ˜¯â€œè¡Œâ€çš„æ–¹å‘ä¸Šæ–°å»ºä¸€ä¸ªç»´åº¦ï¼Œè¿™æ ·ç»´åº¦å°±æˆäº†2ï¼Œä¹Ÿå°±å¾—åˆ°äº†Cã€‚è€Œå¯¹äºDï¼Œæˆ‘ä»¬åˆ™æ˜¯åœ¨dim=1ï¼Œä¹Ÿå°±æ˜¯â€œåˆ—â€çš„æ–¹å‘ä¸Šæ–°å»ºç»´åº¦ã€‚

## Tensorçš„åˆ‡åˆ†æ“ä½œ

å­¦å®Œäº†è¿æ¥æ“ä½œä¹‹åï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹è¿æ¥çš„é€†æ“ä½œï¼š**åˆ‡åˆ†**ã€‚

åˆ‡åˆ†å°±æ˜¯è¿æ¥çš„é€†è¿‡ç¨‹ï¼Œæœ‰äº†åˆšæ‰çš„ç»éªŒï¼Œä½ å¾ˆå®¹æ˜“å°±ä¼šæƒ³åˆ°ï¼Œåˆ‡åˆ†çš„æ“ä½œä¹Ÿåº”è¯¥æœ‰å¾ˆå¤šç§ï¼Œæ¯”å¦‚åˆ‡ç‰‡ã€åˆ‡å—ç­‰ã€‚æ²¡é”™ï¼Œåˆ‡åˆ†çš„æ“ä½œä¸»è¦åˆ†ä¸ºä¸‰ç§ç±»å‹ï¼šchunkã€splitã€unbindã€‚

ä¹ä¸€çœ‹æœ‰ä¸å°‘ï¼Œå…¶å®æ˜¯å› ä¸ºå®ƒä»¬å„æœ‰ç‰¹ç‚¹ï¼Œé€‚ç”¨äºä¸åŒçš„ä½¿ç”¨æƒ…æ™¯ï¼Œè®©æˆ‘ä»¬ä¸€èµ·çœ‹ä¸€ä¸‹ã€‚

### chunk

chunkçš„ä½œç”¨å°±æ˜¯å°†TensoræŒ‰ç…§å£°æ˜çš„dimï¼Œè¿›è¡Œå°½å¯èƒ½å¹³å‡çš„åˆ’åˆ†ã€‚

æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª32channelçš„ç‰¹å¾ï¼Œéœ€è¦å°†å…¶æŒ‰ç…§channelå‡åŒ€åˆ†æˆ4ç»„ï¼Œæ¯ç»„8ä¸ªchannelï¼Œè¿™ä¸ªåˆ‡åˆ†å°±å¯ä»¥é€šè¿‡chunkå‡½æ•°æ¥å®ç°ã€‚å…·ä½“å‡½æ•°å¦‚ä¸‹ï¼š

```python
torch.chunk(input, chunks, dim=0)
```

æˆ‘ä»¬æŒ¨ä¸ªæ¥çœ‹çœ‹å‡½æ•°ä¸­æ¶‰åŠåˆ°çš„ä¸‰ä¸ªå‚æ•°ï¼š

é¦–å…ˆæ˜¯inputï¼Œå®ƒè¡¨ç¤ºè¦åšchunkæ“ä½œçš„Tensorã€‚

æ¥ç€ï¼Œæˆ‘ä»¬çœ‹ä¸‹chunksï¼Œå®ƒä»£è¡¨å°†è¦è¢«åˆ’åˆ†çš„å—çš„æ•°é‡ï¼Œè€Œä¸æ˜¯æ¯ç»„çš„æ•°é‡ã€‚è¯·æ³¨æ„ï¼Œ**chunkså¿…é¡»æ˜¯æ•´å‹**ã€‚

æœ€åæ˜¯dimï¼Œæƒ³æƒ³è¿™ä¸ªå‚æ•°æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå¯¹ï¼Œå°±æ˜¯æŒ‰ç…§å“ªä¸ªç»´åº¦æ¥è¿›è¡Œchunkã€‚

è¿˜æ˜¯è·Ÿä¹‹å‰ä¸€æ ·ï¼Œæˆ‘ä»¬é€šè¿‡å‡ ä¸ªä»£ç ä¾‹å­ç›´è§‚æ„Ÿå—ä¸€ä¸‹ã€‚æˆ‘ä»¬ä»ä¸€ä¸ªç®€å•çš„ä¸€ç»´å‘é‡å¼€å§‹ï¼š

```python
>>> A=torch.tensor([1,2,3,4,5,6,7,8,9,10])
>>> B = torch.chunk(A, 2, 0)
>>> B
(tensor([1, 2, 3, 4, 5]), tensor([ 6,Â  7,Â  8,Â  9, 10]))
```

è¿™é‡Œæˆ‘ä»¬é€šè¿‡chunkå‡½æ•°ï¼Œå°†åŸæ¥10ä½é•¿åº¦çš„Tensor Aï¼Œåˆ‡åˆ†æˆäº†ä¸¤ä¸ªä¸€æ ·5ä½é•¿åº¦çš„å‘é‡ã€‚ï¼ˆæ³¨æ„ï¼ŒBæ˜¯ä¸¤ä¸ªåˆ‡åˆ†ç»“æœç»„æˆçš„tupleï¼‰ã€‚

é‚£å¦‚æœchunkå‚æ•°ä¸èƒ½å¤Ÿæ•´é™¤çš„è¯ï¼Œç»“æœä¼šæ˜¯æ€æ ·çš„å‘¢ï¼Ÿæˆ‘ä»¬æ¥ç€å¾€ä¸‹çœ‹ï¼š

```python
>>> B = torch.chunk(A, 3, 0)
>>> B
(tensor([1, 2, 3, 4]), tensor([5, 6, 7, 8]), tensor([ 9, 10]))
```

æˆ‘ä»¬å‘ç°ï¼Œ10ä½é•¿åº¦çš„Tensor Aï¼Œåˆ‡åˆ†æˆäº†ä¸‰ä¸ªå‘é‡ï¼Œé•¿åº¦åˆ†åˆ«æ˜¯4ï¼Œ4ï¼Œ2ä½ã€‚è¿™æ˜¯æ€ä¹ˆåˆ†çš„å‘¢ï¼Œä¸åº”è¯¥æ˜¯3ï¼Œ3ï¼Œ4è¿™æ ·æ›´ä¸ºå¹³å‡çš„æ–¹å¼ä¹ˆï¼Ÿ

æƒ³è¦è§£å†³é—®é¢˜ï¼Œå°±å¾—æ‰¾åˆ°è§„å¾‹ã€‚è®©æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªæ›´å¤§ä¸€ç‚¹çš„ä¾‹å­ï¼Œå°†Aæ”¹ä¸º17ä½é•¿åº¦ã€‚

```python
>>> A=torch.tensor([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17])
>>> B = torch.chunk(A, 4, 0)
>>> B
(tensor([1, 2, 3, 4, 5]), tensor([ 6,Â  7,Â  8,Â  9, 10]), tensor([11, 12, 13, 14, 15]), tensor([16, 17]))
```

17ä½é•¿åº¦çš„Tensor Aï¼Œåˆ‡åˆ†æˆäº†å››ä¸ªåˆ†åˆ«ä¸º5ï¼Œ5ï¼Œ5ï¼Œ2ä½é•¿åº¦çš„å‘é‡ã€‚è¿™æ—¶å€™ä½ å°±ä¼šå‘ç°ï¼Œå…¶å®åœ¨è®¡ç®—æ¯ä¸ªç»“æœå…ƒç´ ä¸ªæ•°çš„æ—¶å€™ï¼Œchunkå‡½æ•°æ˜¯å…ˆåšé™¤æ³•ï¼Œç„¶åå†å‘ä¸Šå–æ•´å¾—åˆ°æ¯ç»„çš„æ•°é‡ã€‚

æ¯”å¦‚ä¸Šé¢è¿™ä¸ªä¾‹å­ï¼Œ17/4=4.25ï¼Œå‘ä¸Šå–æ•´å°±æ˜¯5ï¼Œé‚£å°±å…ˆé€ä¸ªç”Ÿæˆè‹¥å¹²ä¸ªé•¿åº¦ä¸º5çš„å‘é‡ï¼Œæœ€åä¸å¤Ÿçš„å°±æ”¾åœ¨ä¸€å—ï¼Œä½œä¸ºæœ€åä¸€ä¸ªå‘é‡ï¼ˆé•¿åº¦2ï¼‰ã€‚

é‚£å¦‚æœchunkå‚æ•°å¤§äºTensorå¯ä»¥åˆ‡åˆ†çš„é•¿åº¦ï¼Œåˆè¦æ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬å®é™…æ“ä½œä¸€ä¸‹ï¼Œä»£ç å¦‚ä¸‹ï¼š

```python
>>> A=torch.tensor([1,2,3])
>>> B = torch.chunk(A, 5, 0)
>>> B
(tensor([1]), tensor([2]), tensor([3]))
```

æ˜¾ç„¶ï¼Œè¢«åˆ‡åˆ†çš„Tensoråªèƒ½åˆ†æˆè‹¥å¹²ä¸ªé•¿åº¦ä¸º1çš„å‘é‡ã€‚

ç”±æ­¤å¯ä»¥æ¨è®ºå‡ºäºŒç»´çš„æƒ…å†µï¼Œæˆ‘ä»¬å†ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œ çœ‹çœ‹äºŒç»´çŸ©é˜µTensorçš„æƒ…å†µ ï¼š

```python
>>> A=torch.ones(4,4)
>>> A
tensor([[1., 1., 1., 1.],
Â  Â  Â  Â  [1., 1., 1., 1.],
Â  Â  Â  Â  [1., 1., 1., 1.],
Â  Â  Â  Â  [1., 1., 1., 1.]])
>>> B = torch.chunk(A, 2, 0)
>>> B
(tensor([[1., 1., 1., 1.],
Â  Â  Â  Â  [1., 1., 1., 1.]]), 
tensor([[1., 1., 1., 1.],
Â  Â  Â  Â  [1., 1., 1., 1.]]))
```

è¿˜æ˜¯è·Ÿå‰é¢çš„catä¸€æ ·ï¼Œè¿™é‡Œçš„dimå‚æ•°ï¼Œè¡¨ç¤ºçš„æ˜¯ç¬¬dimç»´åº¦æ–¹å‘ä¸Šè¿›è¡Œåˆ‡åˆ†ã€‚

åˆšæ‰ä»‹ç»çš„chunkå‡½æ•°ï¼Œæ˜¯æŒ‰ç…§â€œåˆ‡åˆ†æˆç¡®å®šçš„ä»½æ•°â€æ¥è¿›è¡Œåˆ‡åˆ†çš„ï¼Œé‚£å¦‚æœæƒ³æŒ‰ç…§â€œæ¯ä»½æŒ‰ç…§ç¡®å®šçš„å¤§å°â€æ¥è¿›è¡Œåˆ‡åˆ†ï¼Œè¯¥æ€æ ·åšå‘¢ï¼ŸPyTorchä¹Ÿæä¾›äº†ç›¸åº”çš„æ–¹æ³•ï¼Œå«åšsplitã€‚

### split

splitçš„å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼Œè·Ÿå‰é¢ä¸€æ ·ï¼Œæˆ‘ä»¬è¿˜æ˜¯åˆ†åˆ«çœ‹çœ‹è¿™é‡Œæ¶‰åŠçš„å‚æ•°ã€‚

```python
torch.split(tensor, split_size_or_sections, dim=0)
```

é¦–å…ˆæ˜¯tensorï¼Œä¹Ÿå°±æ˜¯å¾…åˆ‡åˆ†çš„Tensorã€‚

ç„¶åæ˜¯split\_size\_or\_sectionsè¿™ä¸ªå‚æ•°ã€‚å½“å®ƒä¸ºæ•´æ•°æ—¶ï¼Œè¡¨ç¤ºå°†tensoræŒ‰ç…§æ¯å—å¤§å°ä¸ºè¿™ä¸ªæ•´æ•°çš„æ•°å€¼æ¥åˆ‡å‰²ï¼›å½“è¿™ä¸ªå‚æ•°ä¸ºåˆ—è¡¨æ—¶ï¼Œåˆ™è¡¨ç¤ºå°†æ­¤tensoråˆ‡æˆå’Œåˆ—è¡¨ä¸­å…ƒç´ ä¸€æ ·å¤§å°çš„å—ã€‚

æœ€ååŒæ ·æ˜¯dimï¼Œå®ƒå®šä¹‰äº†è¦æŒ‰å“ªä¸ªç»´åº¦åˆ‡åˆ†ã€‚

åŒæ ·çš„ï¼Œæˆ‘ä»¬ä¸¾å‡ ä¸ªä¾‹å­æ¥çœ‹ä¸€ä¸‹splitçš„å…·ä½“æ“ä½œã€‚é¦–å…ˆæ˜¯split\_size\_or\_sectionsæ˜¯æ•´æ•°çš„æƒ…å†µã€‚

```python
>>> A=torch.rand(4,4)
>>> A
tensor([[0.6418, 0.4171, 0.7372, 0.0733],
Â  Â  Â  Â  [0.0935, 0.2372, 0.6912, 0.8677],
Â  Â  Â  Â  [0.5263, 0.4145, 0.9292, 0.5671],
Â  Â  Â  Â  [0.2284, 0.6938, 0.0956, 0.3823]])
>>> B=torch.split(A, 2, 0)
>>> B
(tensor([[0.6418, 0.4171, 0.7372, 0.0733],
Â  Â  Â  Â  [0.0935, 0.2372, 0.6912, 0.8677]]), 
tensor([[0.5263, 0.4145, 0.9292, 0.5671],
Â  Â  Â  Â  [0.2284, 0.6938, 0.0956, 0.3823]]))
```

åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼ŒåŸæ¥4x4å¤§å°çš„Tensor Aï¼Œæ²¿ç€ç¬¬0ç»´åº¦ï¼Œä¹Ÿå°±æ˜¯æ²¿â€œè¡Œâ€çš„æ–¹å‘ï¼ŒæŒ‰ç…§æ¯ç»„2â€œè¡Œâ€çš„å¤§å°è¿›è¡Œåˆ‡åˆ†ï¼Œå¾—åˆ°äº†ä¸¤ä¸ª2x4å¤§å°çš„Tensorã€‚

é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚æœsplit\_size\_or\_sectionsä¸èƒ½æ•´é™¤å¯¹åº”æ–¹å‘çš„å¤§å°çš„è¯ï¼Œä¼šæœ‰æ€æ ·çš„ç»“æœå‘¢ï¼Ÿæˆ‘ä»¬å°†ä»£ç ç¨ä½œä¿®æ”¹å°±å¥½äº†ï¼š

```python
>>> C=torch.split(A, 3, 0)
>>> C
(tensor([[0.6418, 0.4171, 0.7372, 0.0733],
Â  Â  Â  Â  [0.0935, 0.2372, 0.6912, 0.8677],
Â  Â  Â  Â  [0.5263, 0.4145, 0.9292, 0.5671]]), 
tensor([[0.2284, 0.6938, 0.0956, 0.3823]]))
```

æ ¹æ®åˆšæ‰çš„ä»£ç æˆ‘ä»¬å°±èƒ½å‘ç°ï¼ŒåŸæ¥ï¼ŒPyTorchä¼šå°½å¯èƒ½å‡‘å¤Ÿæ¯ä¸€ä¸ªç»“æœï¼Œä½¿å¾—å…¶å¯¹åº”dimçš„æ•°æ®å¤§å°ç­‰äºsplit\_size\_or\_sectionsã€‚å¦‚æœæœ€åå‰©ä¸‹çš„ä¸å¤Ÿï¼Œé‚£å°±æŠŠå‰©ä¸‹çš„å†…å®¹æ”¾åˆ°ä¸€å—ï¼Œä½œä¸ºæœ€åä¸€ä¸ªç»“æœã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†çœ‹ä¸€ä¸‹split\_size\_or\_sectionsæ˜¯åˆ—è¡¨æ—¶çš„æƒ…å†µã€‚åˆšæ‰æåˆ°äº†ï¼Œå½“split\_size\_or\_sectionsä¸ºåˆ—è¡¨çš„æ—¶å€™ï¼Œè¡¨ç¤ºå°†æ­¤tensoråˆ‡æˆå’Œåˆ—è¡¨ä¸­å…ƒç´ å¤§å°ä¸€æ ·çš„å¤§å°çš„å—ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€æ®µå¯¹åº”çš„ä»£ç ï¼š

```python
>>> A=torch.rand(5,4)
>>> A
tensor([[0.1005, 0.9666, 0.5322, 0.6775],
Â  Â  Â  Â  [0.4990, 0.8725, 0.5627, 0.8360],
Â  Â  Â  Â  [0.3427, 0.9351, 0.7291, 0.7306],
Â  Â  Â  Â  [0.7939, 0.3007, 0.7258, 0.9482],
Â  Â  Â  Â  [0.7249, 0.7534, 0.0027, 0.7793]])
>>> B=torch.split(A,(2,3),0)
>>> B
(tensor([[0.1005, 0.9666, 0.5322, 0.6775],
Â  Â  Â  Â  [0.4990, 0.8725, 0.5627, 0.8360]]), 
tensor([[0.3427, 0.9351, 0.7291, 0.7306],
Â  Â  Â  Â  [0.7939, 0.3007, 0.7258, 0.9482],
Â  Â  Â  Â  [0.7249, 0.7534, 0.0027, 0.7793]]))
```

è¿™éƒ¨åˆ†ä»£ç æ€ä¹ˆè§£é‡Šå‘¢ï¼Ÿå…¶å®ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯å°†Tensor Aï¼Œæ²¿ç€ç¬¬0ç»´è¿›è¡Œåˆ‡åˆ†ï¼Œæ¯ä¸€ä¸ªç»“æœå¯¹åº”ç»´åº¦ä¸Šçš„å°ºå¯¸æˆ–è€…è¯´å¤§å°ï¼Œåˆ†åˆ«æ˜¯2ï¼ˆè¡Œï¼‰ï¼Œ3ï¼ˆè¡Œï¼‰ã€‚

### unbind

é€šè¿‡å­¦ä¹ å‰é¢çš„å‡ ä¸ªå‡½æ•°ï¼Œå’±ä»¬çŸ¥é“äº†æ€ä¹ˆæŒ‰å›ºå®šå¤§å°åšåˆ‡åˆ†ï¼Œæˆ–è€…æŒ‰ç…§ç´¢å¼•indexæ¥è¿›è¡Œé€‰æ‹©ã€‚ç°åœ¨æˆ‘ä»¬æƒ³è±¡ä¸€ä¸ªåº”ç”¨åœºæ™¯ï¼Œå¦‚æœæˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ª3 channelå›¾åƒçš„Tensorï¼Œæƒ³è¦é€ä¸ªè·å–æ¯ä¸ªchannelçš„æ•°æ®ï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ

å‡å¦‚ç”¨chunkçš„è¯ï¼Œæˆ‘ä»¬éœ€è¦å°†chunksè®¾ä¸º3ï¼›å¦‚æœç”¨splitçš„è¯ï¼Œéœ€è¦å°†split\_size\_or\_sectionsè®¾ä¸º1ã€‚

è™½ç„¶å®ƒä»¬éƒ½å¯ä»¥å®ç°ç›¸åŒçš„ç›®çš„ï¼Œä½†æ˜¯å¦‚æœchannelæ•°é‡å¾ˆå¤§ï¼Œé€ä¸ªå»å–ä¹Ÿæ¯”è¾ƒæŠ˜è…¾ã€‚è¿™æ—¶å€™ï¼Œå°±éœ€è¦ç”¨åˆ°å¦ä¸€ä¸ªå‡½æ•°ï¼šunbindï¼Œå®ƒçš„å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š

```python
torch.unbind(input, dim=0)
```

å…¶ä¸­ï¼Œinputè¡¨ç¤ºå¾…å¤„ç†çš„Tensorï¼Œdimè¿˜æ˜¯è·Ÿå‰é¢çš„å‡½æ•°ä¸€æ ·ï¼Œè¡¨ç¤ºåˆ‡ç‰‡çš„æ–¹å‘ã€‚

æˆ‘ä»¬ç»“åˆä¾‹å­æ¥ç†è§£ï¼š

```python
>>> A=torch.arange(0,16).view(4,4)
>>> A
tensor([[ 0,Â  1,Â  2,Â  3],
Â  Â  Â  Â  [ 4,Â  5,Â  6,Â  7],
Â  Â  Â  Â  [ 8,Â  9, 10, 11],
Â  Â  Â  Â  [12, 13, 14, 15]])
>>> b=torch.unbind(A, 0)
>>> b
(tensor([0, 1, 2, 3]), 
tensor([4, 5, 6, 7]), 
tensor([ 8,Â  9, 10, 11]), 
tensor([12, 13, 14, 15]))
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ª4x4çš„äºŒç»´çŸ©é˜µTensorï¼Œéšåæˆ‘ä»¬ä»ç¬¬0ç»´ï¼Œä¹Ÿå°±æ˜¯â€œè¡Œâ€çš„æ–¹å‘è¿›è¡Œåˆ‡åˆ† ï¼Œå› ä¸ºçŸ©é˜µæœ‰4è¡Œï¼Œæ‰€ä»¥å°±ä¼šå¾—åˆ°4ä¸ªç»“æœã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼šå¦‚æœä»ç¬¬1ç»´ï¼Œä¹Ÿå°±æ˜¯â€œåˆ—â€çš„æ–¹å‘è¿›è¡Œåˆ‡åˆ†ï¼Œä¼šæ˜¯æ€æ ·çš„ç»“æœå‘¢ï¼š

```python
>>> b=torch.unbind(A, 1)
>>> b
(tensor([ 0,Â  4,Â  8, 12]), 
tensor([ 1,Â  5,Â  9, 13]), 
tensor([ 2,Â  6, 10, 14]), 
tensor([ 3,Â  7, 11, 15]))
```

ä¸éš¾å‘ç°ï¼Œè¿™é‡Œæ˜¯æŒ‰ç…§â€œåˆ—â€çš„æ–¹å‘è¿›è¡Œæ‹†è§£çš„ã€‚æ‰€ä»¥ï¼Œ**unbindæ˜¯ä¸€ç§é™ç»´åˆ‡åˆ†çš„æ–¹å¼**ï¼Œç›¸å½“äºåˆ é™¤ä¸€ä¸ªç»´åº¦ä¹‹åçš„ç»“æœã€‚

## Tensorçš„ç´¢å¼•æ“ä½œ

ä½ æœ‰æ²¡æœ‰å‘ç°ï¼Œåˆšæ‰æˆ‘ä»¬è®²çš„chunkå’Œsplitæ“ä½œï¼Œæˆ‘ä»¬éƒ½æ˜¯å°†æ•°æ®æ•´ä½“è¿›è¡Œåˆ‡åˆ†ï¼Œå¹¶è·å¾—å…¨éƒ¨ç»“æœã€‚ä½†æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦å…¶ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œè¿™è¦æ€ä¹ˆåšå‘¢ï¼Ÿä¸€ä¸ªå¾ˆè‡ªç„¶çš„æƒ³æ³•å°±æ˜¯ï¼Œç›´æ¥å‘Šè¯‰Tensoræˆ‘æƒ³è¦å“ªäº›éƒ¨åˆ†ï¼Œè¿™ç§æ–¹æ³•æˆ‘ä»¬ç§°ä¸ºç´¢å¼•æ“ä½œã€‚

ç´¢å¼•æ“ä½œæœ‰å¾ˆå¤šæ–¹å¼ï¼Œæœ‰æä¾›å¥½ç°æˆAPIçš„ï¼Œä¹Ÿæœ‰ç”¨æˆ·è‡ªè¡Œå®šåˆ¶çš„æ“ä½œï¼Œå…¶ä¸­æœ€å¸¸ç”¨çš„ä¸¤ä¸ªæ“ä½œå°±æ˜¯index\_selectå’Œmasked\_selectï¼Œæˆ‘ä»¬åˆ†åˆ«å»çœ‹çœ‹ç”¨æ³•ã€‚

### index\_select

è¿™é‡Œå°±éœ€è¦index\_selectè¿™ä¸ªå‡½æ•°äº†ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š

```python
torch.index_select(tensor, dim, index)
```

è¿™é‡Œçš„tensorã€dimè·Ÿå‰é¢å‡½æ•°é‡Œçš„ä¸€æ ·ï¼Œä¸å†èµ˜è¿°ã€‚æˆ‘ä»¬é‡ç‚¹çœ‹ä¸€çœ‹indexï¼Œå®ƒè¡¨ç¤ºä»dimç»´åº¦ä¸­çš„å“ªäº›ä½ç½®é€‰æ‹©æ•°æ®ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ï¼Œindex**æ˜¯torch.Tensorç±»å‹**ã€‚

è¿˜æ˜¯è·Ÿä¹‹å‰ä¸€æ ·ï¼Œæˆ‘ä»¬æ¥çœ‹å‡ ä¸ªç¤ºä¾‹ä»£ç ï¼š

```python
>>> A=torch.arange(0,16).view(4,4)
>>> A
tensor([[ 0,Â  1,Â  2,Â  3],
Â  Â  Â  Â  [ 4,Â  5,Â  6,Â  7],
Â  Â  Â  Â  [ 8,Â  9, 10, 11],
Â  Â  Â  Â  [12, 13, 14, 15]])
>>> B=torch.index_select(A,0,torch.tensor([1,3]))
>>> B
tensor([[ 4,Â  5,Â  6,Â  7],
Â  Â  Â  Â  [12, 13, 14, 15]])
>>> C=torch.index_select(A,1,torch.tensor([0,3]))
>>> C
tensor([[ 0,Â  3],
Â  Â  Â  Â  [ 4,Â  7],
Â  Â  Â  Â  [ 8, 11],
Â  Â  Â  Â  [12, 15]])
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å…ˆåˆ›å»ºäº†ä¸€ä¸ª4x4å¤§å°çš„çŸ©é˜µTensor Aã€‚ç„¶åï¼Œæˆ‘ä»¬ä»ç¬¬0ç»´é€‰æ‹©ç¬¬1ï¼ˆè¡Œï¼‰å’Œ3ï¼ˆè¡Œï¼‰çš„æ•°æ®ï¼Œå¹¶å¾—åˆ°äº†æœ€ç»ˆçš„Tensor Bï¼Œå…¶å¤§å°ä¸º2x4ã€‚éšåæˆ‘ä»¬ä»Tensor Aä¸­é€‰æ‹©ç¬¬0ï¼ˆåˆ—ï¼‰å’Œ3ï¼ˆåˆ—ï¼‰çš„æ•°æ®ï¼Œå¾—åˆ°äº†æœ€ç»ˆçš„Tensor Cï¼Œå…¶å¤§å°ä¸º4x2ã€‚

æ€ä¹ˆæ ·ï¼Œæ˜¯ä¸æ˜¯éå¸¸ç®€å•ï¼Ÿ

### masked\_select

åˆšæ‰ä»‹ç»çš„indexed\_selectï¼Œå®ƒæ˜¯åŸºäºç»™å®šçš„ç´¢å¼•æ¥è¿›è¡Œæ•°æ®æå–çš„ã€‚ä½†æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜æƒ³é€šè¿‡ä¸€äº›åˆ¤æ–­æ¡ä»¶æ¥è¿›è¡Œé€‰æ‹©ï¼Œæ¯”å¦‚æå–æ·±åº¦å­¦ä¹ ç½‘ç»œä¸­æŸä¸€å±‚ä¸­æ•°å€¼å¤§äº0çš„å‚æ•°ã€‚

è¿™æ—¶å€™ï¼Œå°±éœ€è¦ç”¨åˆ°PyTorchæä¾›çš„masked\_selectå‡½æ•°äº†ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹å®ƒçš„å®šä¹‰ï¼š

```python
torch.masked_select(input, mask, out=None)Â 
```

è¿™é‡Œæˆ‘ä»¬åªéœ€è¦å…³å¿ƒå‰ä¸¤ä¸ªå‚æ•°ï¼Œinputå’Œmaskã€‚

inputè¡¨ç¤ºå¾…å¤„ç†çš„Tensorã€‚maskä»£è¡¨æ©ç å¼ é‡ï¼Œä¹Ÿå°±æ˜¯æ»¡è¶³æ¡ä»¶çš„ç‰¹å¾æ©ç ã€‚è¿™é‡Œä½ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œmaské¡»è·Ÿinputå¼ é‡æœ‰ç›¸åŒæ•°é‡çš„å…ƒç´ æ•°ç›®ï¼Œä½†å½¢çŠ¶æˆ–ç»´åº¦ä¸éœ€è¦ç›¸åŒã€‚

ä½ æ˜¯ä¸æ˜¯è¿˜æ„Ÿè§‰æœ‰äº›äº‘é‡Œé›¾é‡Œï¼Ÿè®©æˆ‘æ¥ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œä½ çœ‹äº†ä¹‹åï¼Œä¸€ä¸‹å­å°±èƒ½æ˜ç™½ã€‚

ä½ åœ¨å¹³æ—¶çš„ç»ƒä¹ ä¸­æœ‰æ²¡æœ‰æƒ³è¿‡ï¼Œå¦‚æœæˆ‘ä»¬è®©Tensorå’Œæ•°å­—åšæ¯”è¾ƒï¼Œä¼šæœ‰ä»€ä¹ˆæ ·çš„ç»“æœï¼Ÿæ¯”å¦‚åé¢è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬éšæœºç”Ÿæˆä¸€ä¸ª5ä½é•¿åº¦çš„Tensor Aï¼š

```
>>> A=torch.rand(5)
>>> A
tensor([0.3731, 0.4826, 0.3579, 0.4215, 0.2285])
>>> B=A>0.3
>>> B
tensor([ True,Â  True,Â  True,Â  True, False])
```

åœ¨è¿™æ®µä»£ç é‡Œï¼Œæˆ‘ä»¬è®©Aè·Ÿ0.3åšæ¯”è¾ƒï¼Œå¾—åˆ°äº†ä¸€ä¸ªæ–°çš„Tensorï¼Œå†…éƒ¨æ¯ä¸€ä¸ªæ•°å€¼è¡¨ç¤ºçš„æ˜¯Aä¸­å¯¹åº”æ•°å€¼æ˜¯å¦å¤§äº0.3ã€‚

æ¯”å¦‚ç¬¬ä¸€ä¸ªæ•°å€¼åŸæ¥æ˜¯0.3731ï¼Œå¤§äº0.3ï¼Œæ‰€ä»¥æ˜¯Trueï¼›æœ€åä¸€ä¸ªæ•°å€¼0.2285å°äº0.3ï¼Œæ‰€ä»¥æ˜¯Falseã€‚

è¿™ä¸ªæ–°çš„Tensorå…¶å®å°±æ˜¯ä¸€ä¸ªæ©ç å¼ é‡ï¼Œå®ƒçš„æ¯ä¸€ä½è¡¨ç¤ºäº†ä¸€ä¸ªåˆ¤æ–­æ¡ä»¶æ˜¯å¦æˆç«‹çš„ç»“æœã€‚

ç„¶åï¼Œæˆ‘ä»¬ç»§ç»­å†™ä¸€æ®µä»£ç ï¼Œçœ‹çœ‹åŸºäºæ©ç Bçš„é€‰æ‹©æ˜¯æ€æ ·çš„ç»“æœ ï¼š

```python
>>> C=torch.masked_select(A, B)
>>> C
tensor([0.3731, 0.4826, 0.3579, 0.4215])
```

ä½ ä¼šå‘ç°ï¼ŒCå®é™…ä¸Šå¾—åˆ°çš„å°±æ˜¯ï¼šAä¸­â€œ**æ»¡è¶³Bé‡Œé¢å…ƒç´ å€¼ä¸ºTrueçš„â€**å¯¹åº”ä½ç½®çš„æ•°æ®ã€‚

å¥½äº†ï¼Œè¿™ä¸‹ä½ åº”è¯¥çŸ¥é“äº†masked\_selectçš„ä½œç”¨äº†å§ï¼Ÿå…¶å®å°±æ˜¯æˆ‘ä»¬æ ¹æ®è¦ç­›é€‰çš„æ¡ä»¶ï¼Œå¾—åˆ°ä¸€ä¸ªæ©ç å¼ é‡ï¼Œç„¶åç”¨è¿™ä¸ªå¼ é‡å»æå–Tensorä¸­çš„æ•°æ®ã€‚

æ ¹æ®è¿™ä¸ªæ€è·¯ï¼Œä¸Šé¢çš„ä¾‹å­å°±å¯ä»¥ç®€åŒ–ä¸ºï¼š

```python
>>> A=torch.rand(5)
>>> A
tensor([0.3731, 0.4826, 0.3579, 0.4215, 0.2285])
>>> C=torch.masked_select(A, A>0.3)
>>> C
tensor([0.3731, 0.4826, 0.3579, 0.4215])
```

æ˜¯ä¸æ˜¯éå¸¸ç®€å•å‘¢ï¼Ÿ

## å°ç»“

æ­å–œä½ å®Œæˆäº†è¿™èŠ‚è¯¾çš„å­¦ä¹ ã€‚è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬ä¸€åŒå­¦ä¹ äº†Tensoré‡Œæ›´åŠ é«˜çº§çš„æ“ä½œï¼ŒåŒ…æ‹¬Tensorä¹‹é—´çš„è¿æ¥æ“ä½œï¼ŒTensorå†…éƒ¨çš„åˆ‡åˆ†æ“ä½œï¼Œä»¥åŠåŸºäºç´¢å¼•æˆ–è€…ç­›é€‰æ¡ä»¶çš„æ•°æ®é€‰æ‹©æ“ä½œã€‚

å½“ç„¶äº†ï¼Œåœ¨ä½¿ç”¨è¿™äº›å‡½æ•°çš„æ—¶å€™ï¼Œä½ æœ€éœ€è¦å…³æ³¨çš„å°±æ˜¯è¾¹ç•Œçš„æ•°å€¼å¤§å°ï¼Œå…·ä½“æ¥è¯´å°±æ˜¯ç»´åº¦å’Œå¤§å°ç›¸å…³çš„å‚æ•°ï¼Œä¸€å®šè¦æå‰ä»”ç»†è®¡ç®—å¥½ï¼Œè¦ä¸ç„¶å°±ä¼šäº§ç”Ÿé”™è¯¯çš„ç»“æœã€‚

ç»“åˆä¼—å¤šçš„ä¾‹å­ï¼Œæˆ‘ç›¸ä¿¡ä½ ä¸€å®šå¯ä»¥æ‹¿ä¸‹è¿™äº›æ“ä½œã€‚

è¿™é‡Œæˆ‘ç‰¹æ„ç»™ä½ æ¢³ç†äº†ä¸€å¼ è¡¨æ ¼ï¼Œæ€»ç»“å½’çº³äº†Tensorä¸­çš„ä¸»è¦å‡½æ•°è·Ÿç”¨æ³•ã€‚ä¸è¿‡è¿™äº›å‚æ•°å’±ä»¬ä¹Ÿä¸ç”¨æ­»è®°ç¡¬èƒŒï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œæ ¹æ®éœ€è¦çµæ´»æŸ¥è¯¢ç›¸å…³çš„å‚æ•°åˆ—è¡¨å³å¯ã€‚  
![](https://static001.geekbang.org/resource/image/d1/ba/d195706087f784c8e1e1c7c7b25a22ba.jpg?wh=3020x2455)  
é€šè¿‡è¿™ä¸¤èŠ‚è¯¾ï¼Œæˆ‘ä»¬ææ‡‚äº†Tensorçš„ä¸€ç³»åˆ—æ“ä½œï¼Œåœ¨ä»¥åçš„é¡¹ç›®ä¸­ï¼Œä½ å°±å¯ä»¥æ¸¸åˆƒæœ‰ä½™åœ°å¯¹Tensorè¿›è¡Œå„ç§èŠ±å¼æ“ä½œäº†ï¼ŒåŠ æ²¹!

## æ¯è¯¾ä¸€ç»ƒ

ç°åœ¨æœ‰ä¸ªTensorï¼Œå¦‚ä¸‹ï¼š

```python
>>> A=torch.tensor([[4,5,7], [3,9,8],[2,3,4]])
>>> A
tensor([[4, 5, 7],
Â  Â  Â  Â  [3, 9, 8],
Â  Â  Â  Â  [2, 3, 4]])
```

æˆ‘ä»¬æƒ³æå–å‡ºå…¶ä¸­ç¬¬ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªï¼Œç¬¬äºŒè¡Œçš„ç¬¬ä¸€ã€ç¬¬äºŒä¸ªï¼Œç¬¬ä¸‰è¡Œçš„æœ€åä¸€ä¸ªï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ

æ¬¢è¿ä½ åœ¨ç•™è¨€åŒºè·Ÿæˆ‘äº¤æµäº’åŠ¨ï¼Œä¹Ÿæ¨èä½ æŠŠè¿™èŠ‚è¯¾åˆ†äº«ç»™æ›´å¤šåŒäº‹ã€æœ‹å‹ï¼
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ15ï¼‰</strong></div><ul>
<li><span>lwg0452</span> ğŸ‘ï¼ˆ28ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>æ›´æ­£ğŸ˜€
mask = torch.tensor([[1, 0, 0], [1, 1, 0], [0, 0, 1]])
B = torch.masked_select(A, mask&gt;0)</p>2021-10-20</li><br/><li><span>optimus</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>eye  = torch.eye(3)
torch.masked_select(A,eye&gt;0)</p>2022-03-24</li><br/><li><span>Geek_fc975d</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æŠ„ä½œä¸š

# æ‰‹åŠ¨æ„å»ºäº†ä¸€ä¸ªTrue&#47;False
A = torch.tensor([[4,5,7],[4,9,8],[2,3,4]])
masked_index = torch.tensor( [[True,False,False], [True,True,False], [False,False,True] ])
torch.masked_select(A, masked_index) 

#  è¿™ç¯‡è¯¾ç¨‹ï¼Œä¸ªäººè§‰å¾—é‡è¦çš„å‡ ä¸ªçŸ¥è¯†ç‚¹
1. index_selectè¿”å›çš„ç»“æœå’Œè¾“å…¥æ˜¯ä¸€ä¸ªç»´åº¦ï¼Œè€Œmasked_selectè¿”å›ä¸€ç»´è¾“å‡º
2. splitè·å–çš„æ˜¯åŸè¾“å…¥çš„è§†å›¾ï¼Œä¹Ÿå°±æ˜¯å¯¹splitçš„ç»“æœçš„æ“ä½œä¼šå½±å“åŸæ¥çš„æ•°æ®
3. stackå’Œcatçš„ä¸€ä¸ªä¸åŒç‚¹åœ¨äºï¼Œstackä¼šå‡ç»´ï¼Œè€Œcatä¸ä¼šã€‚</p>2022-04-07</li><br/><li><span>ifelse</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>å­¦ä¹ æ‰“å¡</p>2023-11-23</li><br/><li><span>sugar</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>a = torch.tensor([[4, 5, 7], [3, 9, 8], [2, 3, 4]])
mask = torch.tensor([[True, False, False], [True, True, False], [False, False, True]])
torch.masked_select(a, mask)
åŠ æ²¹ï¼Œå†²å“‡</p>2024-05-18</li><br/><li><span>AğŸ´@ä¼¯ä¹</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>import torch
A=torch.tensor([[4,5,7], [3,9,8],[2,3,4]])
B=torch.tensor([[1,0,0],[1,1,0],[1,0,0]])
C=torch.masked_select(A, A*B!=0)
print(C)</p>2022-09-07</li><br/><li><span>äºšæ—</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è¿™æ˜¯ä¸ªmaskæ˜¯ä¸æ˜¯å°±æ˜¯ä¼ è¯´ä¸­çš„æ•°æ®æ‰“æ ‡</p>2022-05-09</li><br/><li><span>Geek_a95f0e</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>a=tc.tensor([[4,5,7],[3,9,8],[2,3,4]])
b=tc.tensor([1,0,0,1,1,0,0,0,1],dtype=tc.bool).reshape(3,3)
c=tc.masked_select(a,b)</p>2021-10-29</li><br/><li><span>ç‹éª¥</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>input è¡¨ç¤ºå¾…å¤„ç†çš„ Tensorã€‚mask ä»£è¡¨æ©ç å¼ é‡ï¼Œä¹Ÿå°±æ˜¯æ»¡è¶³æ¡ä»¶çš„ç‰¹å¾æ©ç ã€‚è¿™é‡Œä½ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œmask é¡»è·Ÿ input å¼ é‡æœ‰ç›¸åŒæ•°é‡çš„å…ƒç´ æ•°ç›®ï¼Œä½†å½¢çŠ¶æˆ–ç»´åº¦ä¸éœ€è¦ç›¸åŒã€‚

è€å¸ˆï¼Œmask é¡»è·Ÿ input å¼ é‡æœ‰ç›¸åŒæ•°é‡çš„å…ƒç´ æ•°ç›®ï¼Œä½†å½¢çŠ¶æˆ–ç»´åº¦ä¸éœ€è¦ç›¸åŒ è¿™å¥è¯è¯¥æ€ä¹ˆç†è§£ï¼Ÿ

  A = torch.tensor([[4, 5, 7], [3, 9, 8], [2, 3, 4]])
  B = torch.masked_select(A, torch.tensor([[1, 0, 0], [1, 1, 0], [0, 0, 1]]) &gt; 0)
  # B = torch.masked_select(A, torch.tensor([1, 0, 0, 1, 1, 0, 0, 0, 1]) &gt; 0)

æˆ‘å°è¯•ä¸‹é¢ä¸€ç§å°±ä¼šæŠ¥é”™ã€‚</p>2021-10-24</li><br/><li><span>æé›„</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>å–œæ¬¢è¿™èŠ‚çš„å†…å®¹ã€‚</p>2021-10-23</li><br/><li><span>vcjmhg</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>A = torch.tensor([[4, 5, 7], [3, 9, 8], [2, 3, 4]])
mask_matrix = torch.tensor([[1, 0, 0], [1, 1, 0], [0, 0, 1]])
B = torch.masked_select(A, mask == 1)</p>2021-10-21</li><br/><li><span>æ —ç™½</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>A=torch.tensor([[4,5,7], [3,9,8],[2,3,4]])
B=torch.tensor([[1,0,0],[1,1,0],[0,0,1]])
C=torch.masked_select(A,B&gt;0)</p>2021-10-20</li><br/><li><span>narsilçš„æ¢¦</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>ç»ƒä¹ ï¼š
    A = torch.tensor([[4, 5, 7], [3, 9, 8], [2, 3, 4]])

    # æå–å‡ºå…¶ä¸­ç¬¬ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªï¼Œç¬¬äºŒè¡Œçš„ç¬¬ä¸€ã€ç¬¬äºŒä¸ªï¼Œç¬¬ä¸‰è¡Œçš„æœ€åä¸€ä¸ª
    B = torch.chunk(A, 3, dim=0)

    A00 = torch.index_select(B[0], 1, torch.tensor([0]))
    A1011 = torch.index_select(B[1], 1, torch.tensor([0, 1]))
    A22 = torch.index_select(B[2], 1, torch.tensor([2]))

PSï¼šé¢˜ç›®åº”è¯¥è¯´æ˜è¾“å‡ºæ˜¯ä»€ä¹ˆæ ¼å¼çš„ï¼Œè¦ä¸åŒå­¦ä»¬ä¸çŸ¥é“åšåˆ°å“ªä¸€æ­¥ç®—å®Œäº‹</p>2021-10-20</li><br/><li><span>å¾æ´²æ›´</span> ğŸ‘ï¼ˆ7ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<p># æ‰‹åŠ¨æ„å»ºäº†ä¸€ä¸ªTrue&#47;False
A = torch.tensor([[4,5,7],[4,9,8],[2,3,4]])
masked_index = torch.tensor( [[True,False,False], [True,True,False], [False,False,True] ])
torch.masked_select(A, masked_index) 

#  è¿™ç¯‡è¯¾ç¨‹ï¼Œä¸ªäººè§‰å¾—é‡è¦çš„å‡ ä¸ªçŸ¥è¯†ç‚¹
1. index_selectè¿”å›çš„ç»“æœå’Œè¾“å…¥æ˜¯ä¸€ä¸ªç»´åº¦ï¼Œè€Œmasked_selectè¿”å›ä¸€ç»´è¾“å‡º
2. splitè·å–çš„æ˜¯åŸè¾“å…¥çš„è§†å›¾ï¼Œä¹Ÿå°±æ˜¯å¯¹splitçš„ç»“æœçš„æ“ä½œä¼šå½±å“åŸæ¥çš„æ•°æ®
3. stackå’Œcatçš„ä¸€ä¸ªä¸åŒç‚¹åœ¨äºï¼Œstackä¼šå‡ç»´ï¼Œè€Œcatä¸ä¼šã€‚
</p>2021-12-08</li><br/><li><span>GEEKBANG_9421399</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<p>å…¶å®å¦‚æœtensorå’Œmaskçš„ç»´åº¦ç›¸åŒçš„è¯ï¼Œç›´æ¥tensor[mask]å°±æ˜¯torch.masked_select(tensor, mask)çš„æ•ˆæœäº†ã€‚</p>2022-01-05</li><br/>
</ul>