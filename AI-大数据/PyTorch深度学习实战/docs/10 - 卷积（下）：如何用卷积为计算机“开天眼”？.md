ä½ å¥½ï¼Œæˆ‘æ˜¯æ–¹è¿œã€‚

ç»è¿‡ä¸Šä¸€èŠ‚è¯¾çš„å­¦ä¹ ï¼Œç›¸ä¿¡ä½ å·²ç»å¯¹æ ‡å‡†çš„å·ç§¯è®¡ç®—æœ‰æ‰€äº†è§£ã€‚è™½ç„¶æ ‡å‡†å·ç§¯åŸºæœ¬ä¸Šå¯ä»¥ä½œä¸ºä¸»åŠ›Carryå…¨åœºï¼Œä½†æ˜¯äººä»¬è¿˜æ˜¯åŸºäºæ ‡å‡†å·ç§¯ï¼Œæå‡ºäº†ä¸€äº›å…¶å®ƒçš„å·ç§¯æ–¹å¼ï¼Œè¿™äº›å·ç§¯æ–¹å¼åœ¨åº”å¯¹ä¸åŒé—®é¢˜æ—¶èƒ½å¤Ÿå‘æŒ¥ä¸åŒçš„ä½œç”¨ï¼Œè¿™é‡Œæˆ‘ä¸ºä½ åˆ—ä¸¾äº†ä¸€äº›ã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/8a/4b/8a3f6bba138f36c1b31e52aeb3e2604b.jpg?wh=1920x977)

åœ¨ä¸Šä¸€èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†conv2dçš„in\_channelsã€out\_channelsã€kernel\_sizeã€strideã€paddingä¸biaså‚æ•°ã€‚

å…¶ä¸­ï¼ŒPyTorchä¸­conv2dä¸­å‰©ä½™çš„ä¸¤ä¸ªå‚æ•°ï¼Œå®ƒä»¬åˆ†åˆ«å¯¹åº”ç€ä¸¤ç§ä¸åŒçš„å·ç§¯ï¼Œåˆ†åˆ«æ˜¯æ·±åº¦å¯åˆ†ç¦»å·ç§¯å’Œç©ºæ´å·ç§¯ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹ã€‚

## æ·±åº¦å¯åˆ†ç¦»å·ç§¯ï¼ˆDepthwise Separable Convolutionï¼‰

æˆ‘ä»¬é¦–å…ˆçœ‹çœ‹ä¾æ‰˜groupså‚æ•°å®ç°çš„æ·±åº¦å¯åˆ†ç¦»å·ç§¯ã€‚

éšç€æ·±åº¦å­¦ä¹ æŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼Œè®¸å¤šå¾ˆæ·±ã€å¾ˆå®½çš„ç½‘ç»œæ¨¡å‹è¢«æå‡ºï¼Œä¾‹å¦‚ï¼ŒVGGã€ResNetã€SENetã€DenseNetç­‰ï¼Œè¿™äº›ç½‘ç»œåˆ©ç”¨å…¶å¤æ‚çš„ç»“æ„ï¼Œå¯ä»¥æ›´åŠ ç²¾ç¡®åœ°æå–å‡ºæœ‰ç”¨çš„ä¿¡æ¯ã€‚åŒæ—¶ä¹Ÿä¼´éšç€ç¡¬ä»¶ç®—åŠ›çš„ä¸æ–­å¢å¼ºï¼Œå¯ä»¥å°†è¿™äº›å¤æ‚çš„æ¨¡å‹ç›´æ¥éƒ¨ç½²åœ¨æœåŠ¡å™¨ç«¯ï¼Œåœ¨å·¥ä¸šä¸­å¯ä»¥è½åœ°çš„é¡¹ç›®ä¸­éƒ½å–å¾—äº†éå¸¸ä¼˜ç§€çš„æ•ˆæœã€‚

ä½†è¿™äº›æ¨¡å‹å…·æœ‰ä¸€ä¸ªé€šç—…ï¼Œå°±æ˜¯é€Ÿåº¦è¾ƒæ…¢ã€å‚æ•°é‡å¤§ï¼Œè¿™ä¸¤ä¸ªé—®é¢˜ä½¿å¾—è¿™äº›æ¨¡å‹æ— æ³•è¢«ç›´æ¥éƒ¨ç½²åˆ°ç§»åŠ¨ç»ˆç«¯ä¸Šã€‚è€Œç§»åŠ¨ç«¯çš„å„ç§åº”ç”¨æ— ç–‘æ˜¯å½“ä»Šæœ€ç«çƒ­çš„ä¸€ä¸ªå¸‚åœºï¼Œè¿™ç§æƒ…å†µä¸‹è¿™äº›æ·±è€Œå®½çš„å¤æ‚ç½‘ç»œæ¨¡å‹å°±ä¸é€‚ç”¨äº†ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ21ï¼‰</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/27/fc/ca/c1b8d9ca.jpg" width="30px"><span>IUniverse</span> ğŸ‘ï¼ˆ5ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>x=torch.rand((3,128,128)).unsqueeze(0)
print(x.shape)

in_channel_DW=x.shape[1]
out_channel_DW=x.shape[1]
kernel_size=3
DW=nn.Conv2d(in_channel_DW,out_channel_DW,kernel_size,groups=in_channel_DW)

in_channels_PW=out_channel_DW
out_channels_PW=10
PW=nn.Conv2d(in_channels_PW,out_channels_PW,1)
output=PW(DW(x))
print(output.shape)</div>2021-11-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/af/fa/5714677b.jpg" width="30px"><span>sonald</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>æˆ‘è§‰å¾—æ²¡æœ‰è§£é‡Šæ¸…æ¥šâ€œå®ƒæœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯ä¸éœ€è¦ç¼©å°ç‰¹å¾å›¾ï¼Œä¹Ÿå¯ä»¥è·å¾—æ›´å¤§çš„æ„Ÿå—é‡ã€‚â€ï¼Œæ„Ÿå—é‡æ˜¯å¢å¤§äº†ï¼Œç‰¹å¾å›¾æ²¡ç¼©å°å—ï¼Ÿ</div>2022-02-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/29/5d/3f/ad1fed4a.jpg" width="30px"><span>é»‘æš—éª‘å£«</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>è€å¸ˆå¥½ï¼Œè¯·é—®ä¸ºä»€ä¹ˆin_channel_DW=x.shape[1]ï¼Œx.shape[0]æ‰æ˜¯é€šé“å•Šï¼Ÿ</div>2022-02-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2e/e3/c4/68bf7e23.jpg" width="30px"><span>é†’ç‹®</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆï¼Œæˆ‘å¦å¤–æœ‰ä¸€ä¸ªé—®é¢˜æ²¡æƒ³æ˜ç™½ï¼Œå°±æ˜¯è¿™ä¸ªâ€œgroupsâ€åˆ°åº•æ˜¯æ€ä¹ˆä¸€å›äº‹ï¼Ÿgroupsçš„å®šä¹‰æ˜¯éœ€è¦outå’Œin_channelséƒ½èƒ½æ•´é™¤groupså—ï¼Ÿæˆ‘çš„ç†è§£æ˜¯æŠŠè¾“å…¥å’Œè¾“å‡ºçš„é€šé“é™¤groupsä¹‹åè¿›è¡Œé…å¯¹ï¼Œå„è‡ªç»„æˆå°çš„åŸºæœ¬å·ç§¯ï¼ˆæ¯”å¦‚é™¤å®Œä¹‹ååˆ2ç»„inï¼Œå°±å°†è¿™ä¸¤ç»„inå½“åšä¸¤ä¸ªé€šé“ï¼Œè®©åoutå¤„å®Œä¹‹åæœ‰3ç»„ï¼Œå°±å½“åšä¸€ä¸ªå·ç§¯æ ¸çš„3ä¸ªé€šé“ï¼Œå†è¿›è¡ŒåŸºæœ¬å·ç§¯ï¼‰è®©åå†æŠŠè¿™groupsè¿™ä¹ˆå¤šç»„å¾—å‡ºçš„ç»“æœåŠ å’Œåœ¨ä¸€èµ·ç»„æˆæ–°çš„å•ç‹¬çš„ä¸€ä¸ªè¾“å‡ºç‰¹å¾å›¾ï¼Œå¤§æ¦‚æ˜¯è¿™ä¸ªæ„æ€å—ï¼Ÿè°¢è°¢è€å¸ˆï¼Œæ‚¨è¾›è‹¦äº†ï¼</div>2022-08-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/c2/df/e619d023.jpg" width="30px"><span>ç¡•æŒæŸœ</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆæ‚¨å¥½ï¼Œå½“æˆ‘ä»åŸç†ä¸ŠçŸ¥é“ä¸€ä¸ªConv2dçš„è®¡ç®—é‡æ˜¯m * n * k * k * h&#39; * w&#39; åï¼Œpytorchæ˜¯å¦æä¾›äº†å‡½æ•°å¯ä»¥æŸ¥çœ‹ï¼Œå½“ç»™å®šä¸€ä¸ªbatchæ•°æ®æ—¶ &#47; batchsize = 1æ—¶çš„è®¡ç®—é‡ï¼ˆç†è§£ä¸ºè¿ç®—çš„æ¬¡æ•°ï¼‰å‘¢</div>2022-11-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/02/2a/90e38b94.jpg" width="30px"><span>John(æ˜“ç­‹)</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>import torch
import torch.nn as nn
# ç”Ÿæˆä¸€ä¸ªä¸‰é€šé“çš„128x128ç‰¹å¾å›¾
x = torch.rand((3,128,128)).unsqueeze(0)
print(x.shape)

# è¯·æ³¨æ„DWä¸­ï¼Œè¾“å…¥ç‰¹å¾é€šé“æ•°ä¸è¾“å‡ºé€šé“æ•°æ˜¯ä¸€æ ·çš„
in_channels_dw = x.shape[1]
out_channels_dw = x.shape[1]

# ä¸€èˆ¬æ¥è®²DWå·ç§¯çš„kernel sizeä¸º3
kernel_size = 3
stride = 1

# DWå·ç§¯groupså‚æ•°ä¸è¾“å…¥é€šé“æ•°ä¸€æ ·
dw = nn.Conv2d(in_channels_dw, out_channels_dw, kernel_size, stride, groups=in_channels_dw)

in_channels_pw = out_channels_dw
out_channels_pw = 10

pw = nn.Conv2d(in_channels_pw, out_channels_pw, kernel_size_pw, stride)
output = pw(dw(x))
print(output.shape)

# Output
torch.Size([1, 3, 128, 128])
torch.Size([1, 10, 126, 126])</div>2022-08-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2e/e3/c4/68bf7e23.jpg" width="30px"><span>é†’ç‹®</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>import torch
import torch.nn as nn
a = torch.rand(3,128,128)       # æ³¨ï¼štorch.tensorçš„åˆ†ç±»æ˜¯ï¼ˆbatch_size,channelsï¼Œwï¼Œhï¼‰
a = torch.unsqueeze(a,0)
print(a.shape)

dw = nn.Conv2d(3,3,(3,3),stride=(3,3),groups=3)
dw = dw(a)
pw = nn.Conv2d(3,10,(1,1))
b = pw(dw)
print(b)

è€å¸ˆå¥½ï¼Œè¯·æ‚¨æ£€æŸ¥ä¸€ä¸‹ï¼Œè°¢è°¢æ‚¨ï¼</div>2022-08-04</li><br/><li><img src="" width="30px"><span>Geek_622508</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>è¯·é—®ï¼Œæ‚¨è¿™ç§åŠ¨æ€å›¾æ˜¯ç”¨ä»€ä¹ˆç”»çš„å‘¢ï¼Ÿ</div>2022-06-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/8c/5c/3f164f66.jpg" width="30px"><span>äºšæ—</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>import torch
import torch.nn as nn
# ç”Ÿæˆä¸€ä¸ªä¸‰é€šé“çš„128x128ç‰¹å¾å›¾
x = torch.rand((3, 128, 128)).unsqueeze(0)
print(x.shape)

# è¯·æ³¨æ„DWä¸­ï¼Œè¾“å…¥ç‰¹å¾é€šé“æ•°ä¸è¾“å‡ºé€šé“æ•°æ˜¯ä¸€æ ·çš„
in_channels_dw = x.shape[1]
out_channels_dw = x.shape[1]
# ä¸€èˆ¬æ¥è®²DWå·ç§¯çš„kernel sizeä¸º3
kernel_size = 3
stride = 1
# DWå·ç§¯groupså‚æ•°ä¸è¾“å…¥é€šé“æ•°ä¸€æ ·
dw = nn.Conv2d(in_channels_dw, out_channels_dw, kernel_size, stride, groups=in_channels_dw)

in_channels_pw = out_channels_dw
out_channels_pw = 10
kernel_size_pw = 1
pw = nn.Conv2d(in_channels_pw, out_channels_pw, kernel_size_pw, stride)
out = pw(dw(x))
print(out.shape)</div>2022-05-17</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/ajNVdqHZLLDm5eHbw1fuicJiaXercgBI48O0Idt2mHUElmZyBM4o119NkndU1SNpsv8rZzKFibj8z1FibFAdNEO3zw/132" width="30px"><span>zhangting</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è¯·é—®ä¸‹ï¼Œæ„Ÿå—é‡=è¾“å…¥ç‰¹å¾å›¾ä¸­è“è‰²åŠ æ©˜é»„è‰²éƒ¨åˆ†ï¼Œä½†æ˜¯ä¸ºå•¥ä¸è®¡ç®—åŸå›¾ä¸­å³è¾¹å’Œä¸‹è¾¹çš„ç™½è‰²æ ¼å­ï¼Ÿç„¶åå°±æ˜¯åŸå›¾æ˜¯6X6ä¸æ˜¯5X5</div>2022-05-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2d/0c/1f/fcc777e1.jpg" width="30px"><span>ä¹å‘µçš„hehe</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>import torch
import torch.nn


in_feature = torch.randn([8,3,128,128])
print(in_feature.shape)
model = torch.nn.Sequential(torch.nn.Conv2d(3, 3, (3,3), stride=1, padding=1, bias=True, groups=3), torch.nn.Conv2d(3, 10, (1,1), stride=1, padding=0, bias=True))
out_feature = model(in_feature)
print(out_feature.shape)</div>2022-04-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2d/0c/1f/fcc777e1.jpg" width="30px"><span>ä¹å‘µçš„hehe</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>import torch
import torch.nn


in_feature = torch.randn([10,3,128,128])
print(in_feature.shape)
conv2d = torch.nn.Conv2d(3, 3, (3,3), stride=1, padding=1, bias=True, groups=3)
out_feature = conv2d(in_feature)
print(out_feature.shape)</div>2022-04-28</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/8MZhBkm8kAJGVbhOr64n0Dd2Q6wDpjKwDcQyibN91qlWQRGDeeIuAGe7FzaBrcPB58uibJaF04bHyvIiadWHgG6Ig/132" width="30px"><span>æ—¶å…‰ä¸è´Ÿæœ‰å¿ƒäºº</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>æ„Ÿå—é‡çš„æ¦‚å¿µè¿˜ä¸æ˜¯å¤ªæ˜ç™½ï¼Œä¸ºå•¥è¯´åŸå›¾æ˜¯ 5x5 çš„å›¾åƒï¼Ÿä¸æ˜¯6x6å—ï¼Ÿ</div>2022-02-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/27/12/55/f8d607c6.jpg" width="30px"><span>è–›å®šè°”çš„å–µ~</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>è¯·é—®ä¸‹è€å¸ˆï¼Œä¸ºå•¥è¦å¯¹xè¿›è¡Œunsqueeze(0)å‘¢ï¼Ÿ</div>2021-12-23</li><br/><li><img src="" width="30px"><span>clee</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>x = torch.rand((3, 128, 128)).unsqueeze(0)
in_channels_dw = x.shape[1]
out_channels_dw = x.shape[1]
kernel_size = 3
stride = 1
dw = nn.Conv2d(in_channels_dw, out_channels_dw, kernel_size, stride, groups=in_channels_dw)
in_channels_pw = out_channels_dw
out_channels_pw = 10
kernel_size_pw = 3
pw = nn.Conv2d(in_channels_pw, out_channels_pw, kernel_size_pw, stride)
out = pw(dw(x))
print(out.shape)</div>2021-11-08</li><br/><li><img src="" width="30px"><span>Geek_a95f0e</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>import torch
input_feat=torch.randint(0,100,(1,3,128,128),dtype=torch.float32)
dw=torch.nn.Conv2d(3,3,3,groups=3)
pw=torch.nn.Conv2d(3,10,1)
result=pw(dw(input_feat))
print(result)</div>2021-11-04</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/j24oyxHcpB5AMR9pMO6fITqnOFVOncnk2T1vdu1rYLfq1cN6Sj7xVrBVbCvHXUad2MpfyBcE4neBguxmjIxyiaQ/132" width="30px"><span>vcjmhg</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>import torch
import torch.nn as nn

# ç”Ÿæˆä¸€ä¸ªä¸‰é€šé“çš„128x128ç‰¹å¾å›¾
x = torch.rand((3, 128, 128)).unsqueeze(0)
print(x.shape)
# è¾“å‡ºï¼š
torch.Size([1, 3, 5, 5])
# è¯·æ³¨æ„DWä¸­ï¼Œè¾“å…¥ç‰¹å¾é€šé“æ•°ä¸è¾“å‡ºé€šé“æ•°æ˜¯ä¸€æ ·çš„
in_channels_dw = x.shape[1]

out_channels_dw = x.shape[1]
# è®¾ç½®sizeä¸º3
kernel_size = 3
stride = 1
# DWå·ç§¯groupså‚æ•°ä¸è¾“å…¥é€šé“æ•°ä¸€æ ·
dw = nn.Conv2d(in_channels_dw, out_channels_dw, kernel_size, stride, groups=in_channels_dw)

in_channels_pw = out_channels_dw
# å·ç§¯å’Œä¸ªæ•°ä¸º10
out_channels_pw = 10
kernel_size_pw = 1
pw = nn.Conv2d(in_channels_pw, out_channels_pw, kernel_size_pw, stride)
out = pw(dw(x))
print(out.shape)</div>2021-11-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2b/e0/ca/adfaa551.jpg" width="30px"><span>å­™æ–°</span> ğŸ‘ï¼ˆ10ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>æ„Ÿå—é‡é‚£ä¸ªåœ°æ–¹æˆ‘ç›´æ¥çœ‹æ‡µäº†ï¼Œå»å…¶ä»–åœ°æ–¹æŸ¥äº†æ‰æ˜ç™½ã€‚å¦‚æœä¸çŸ¥é“æ¦‚å¿µç›´æ¥çœ‹é‚£ä¸ªå›¾ç‰‡ç¤ºä¾‹çš„æ–‡å­—è¯´æ˜ç¨å¾®æœ‰ç‚¹ä¸å¥½ç†è§£ã€‚ä¸ªäººè§‰å¾—é‚£å—çš„è¡¨è¾¾å¯ä»¥ä¼˜åŒ–ä¸€ä¸‹ã€‚æˆ‘æƒ³äº†ä¸€ä¸‹é—®é¢˜å‡ºåœ¨å“ªï¼Œå› ä¸ºå‰é¢æ²¡æœ‰æ˜ç¡®è¯´æ„Ÿå—é‡æ˜¯å•¥ã€‚
ä¸ªäººæ„Ÿè§‰å‰è¾¹å¯ä»¥åŠ ä¸€å¥é€šä¿—è§£é‡Šï¼š
æ„Ÿå—é‡æŒ‡çš„æ˜¯ï¼Œå·ç§¯è¾“å‡ºæ—¶ä¸€ä¸ªå•å…ƒåœ¨è¾“å…¥ç‰¹å¾å›¾ä¸­ä»£è¡¨çš„å•å…ƒæ•°ã€‚
ç¬¬ä¸€å±‚å·ç§¯è¾“å‡ºçš„ä¸€ä¸ªå•å…ƒå°±æ˜¯åŸå§‹ç‰¹å¾å›¾çš„3*3å•å…ƒä¿¡æ¯ï¼Œæ„Ÿå—é‡ä¸º3ï¼Œ
ç¬¬äºŒå±‚å·ç§¯è¾“å‡ºçš„ä¸€ä¸ªå•å…ƒå°±æ˜¯åŸå§‹ç‰¹å¾å›¾çš„5*5å•å…ƒä¿¡æ¯ï¼Œæ„Ÿå—é‡ä¸º5ã€‚

</div>2022-09-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/b8/6e/0aae08d6.jpg" width="30px"><span>VincentQ</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>dilation æ‰©å¼ ç‡ï¼Ÿ </div>2024-06-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/26/eb/d7/90391376.jpg" width="30px"><span>ifelse</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>å­¦ä¹ æ‰“å¡</div>2023-11-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2a/cd/4d/b0cd5bca.jpg" width="30px"><span>æ²¡æœ‰åä¸‡ä¼ç‰¹çš„çš®å¡ä¸˜ğŸ‘¿</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>import torch
import torch.nn as nn
input_features = torch.randn(3,128,128),unsqueeze(0)
kernel_size_dw = 3
in_channels_dw = input_features.shape[1]
out_channels_dw = input_features.shape[1]l
dw = nn.Conv2d(in_channels_dw,out_channels_dw,kernel_size_dw,stride, groups=in_channels_dw)
in_channels_pw = in_channels_dw
out_channels_pw = 10
kernel_size_pw = 1
stride = 1
pw = nn.Conv2d(in_channels_pw,out_channels_pw,kernel_size_pw,stride)
out_features = pw(dw(input_feaures))
print(out_features.shape)</div>2021-12-05</li><br/>
</ul>