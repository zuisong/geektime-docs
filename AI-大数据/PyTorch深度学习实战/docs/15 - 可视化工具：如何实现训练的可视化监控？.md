ä½ å¥½ï¼Œæˆ‘æ˜¯æ–¹è¿œã€‚æ¬¢è¿æ¥åˆ°ç¬¬15èŠ‚è¯¾çš„å­¦ä¹ ã€‚

ä¸ŠèŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬ä»¥çº¿æ€§å›å½’æ¨¡å‹ä¸ºä¾‹ï¼Œå­¦ä¹ äº†æ¨¡å‹ä»æ­å»ºåˆ°è®­ç»ƒçš„å…¨éƒ¨è¿‡ç¨‹ã€‚åœ¨æ·±åº¦å­¦ä¹ é¢†åŸŸï¼Œæ¨¡å‹è®­ç»ƒæ˜¯ä¸€ä¸ªå¿…é¡»çš„ç¯èŠ‚ï¼Œè€Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦å¯¹æ¨¡å‹çš„å‚æ•°ã€è¯„ä»·æŒ‡æ ‡ç­‰ä¿¡æ¯è¿›è¡Œå¯è§†åŒ–ç›‘æ§ã€‚

ä»Šå¤©æˆ‘ä»¬ä¸»è¦ä¼šå­¦ä¹ ä¸¤ç§å¯è§†åŒ–å·¥å…·ï¼Œå¹¶åˆ©ç”¨å®ƒä»¬å®ç°è®­ç»ƒè¿‡ç¨‹çš„å¯è§†åŒ–ç›‘æ§ã€‚

åœ¨TensorFlowä¸­ï¼Œæœ€å¸¸ä½¿ç”¨çš„å¯è§†åŒ–å·¥å…·éTensorboardè«å±ï¼Œè€ŒTensorboardXå·¥å…·ä½¿å¾—PyTorchä¹Ÿäº«å—åˆ°Tensorboardçš„ä¾¿æ·åŠŸèƒ½ã€‚å¦å¤–ï¼ŒFaceBookä¹Ÿä¸ºPyTorchå¼€å‘äº†ä¸€æ¬¾äº¤äº’å¼å¯è§†åŒ–å·¥å…·Visdomï¼Œå®ƒå¯ä»¥å¯¹å®æ—¶æ•°æ®è¿›è¡Œä¸°å¯Œçš„å¯è§†åŒ–ï¼Œå¸®åŠ©æˆ‘ä»¬å®æ—¶ç›‘æ§å®éªŒè¿‡ç¨‹ã€‚

è®©æˆ‘ä»¬å…ˆä»TensorboardXè¯´èµ·ã€‚

## TensorboardX

Tensorboardæ˜¯TensorFlowçš„ä¸€ä¸ªé™„åŠ å·¥å…·ï¼Œç”¨äºè®°å½•è®­ç»ƒè¿‡ç¨‹çš„æ¨¡å‹çš„å‚æ•°ã€è¯„ä»·æŒ‡æ ‡ä¸å›¾åƒç­‰ç»†èŠ‚å†…å®¹ï¼Œå¹¶é€šè¿‡Webé¡µé¢æä¾›æŸ¥çœ‹ç»†èŠ‚ä¸è¿‡ç¨‹çš„åŠŸèƒ½ï¼Œç”¨æµè§ˆå™¨å¯è§†åŒ–çš„å½¢å¼å±•ç°ï¼Œå¸®åŠ©æˆ‘ä»¬åœ¨å®éªŒæ—¶è§‚å¯Ÿç¥ç»ç½‘ç»œçš„è®­ç»ƒè¿‡ç¨‹ï¼ŒæŠŠæ¡è®­ç»ƒè¶‹åŠ¿ã€‚

æ—¢ç„¶Tensorboardå·¥å…·è¿™ä¹ˆæ–¹ä¾¿ï¼ŒTensorFlowå¤–çš„å…¶å®ƒæ·±åº¦å­¦ä¹ æ¡†æ¶è‡ªç„¶ä¹Ÿæƒ³è·å–Tensorboardçš„ä¾¿æ·åŠŸèƒ½ï¼Œäºæ˜¯ï¼ŒTensorboardXåº”è¿è€Œç”Ÿã€‚

### å®‰è£…

å®‰è£… Tensorboardå¾ˆå®¹æ˜“ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨pipè¿›è¡Œå®‰è£…ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š

```python
pip install tensorboard
```

å¦‚æœä½ å·²ç»å®‰è£…è¿‡TensorFlowï¼Œé‚£ä¹ˆå°±æ— éœ€é¢å¤–å®‰è£…Tensorboardäº†ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£… TensorboardXã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPyTorch 1.8ä¹‹åçš„ç‰ˆæœ¬è‡ªå¸¦TensorboardXï¼Œå®ƒè¢«æ”¾åœ¨`torch.utils.tensorboard`ä¸­ï¼Œå› æ­¤æ— éœ€å¤šä½™é…ç½®ã€‚

å¦‚æœä½ ç”¨çš„æ˜¯PyTorch 1.8ä¹‹å‰çš„ç‰ˆæœ¬ï¼ŒTensorboardXå®‰è£…èµ·æ¥ä¹Ÿéå¸¸ç®€å•ã€‚æˆ‘ä»¬ä¾ç„¶ä½¿ç”¨pipå‘½ä»¤å®‰è£…ï¼š

```plain
pip install tensorboardX
```

### ä½¿ç”¨ä¸å¯åŠ¨

ä¸ºäº†ä½¿ç”¨TensorboardXï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªSummaryWriterçš„å®ä¾‹ï¼Œç„¶åå†ä½¿ç”¨`add_scalar`æ–¹æ³•æˆ–`add_image`æ–¹æ³•ï¼Œå°†æ•°å­—æˆ–å›¾ç‰‡è®°å½•åˆ°SummaryWriterå®ä¾‹ä¸­ã€‚

SummaryWriterç±»çš„å®šä¹‰å¦‚ä¸‹ï¼š

```python
torch.utils.tensorboard.writer.SummaryWriter(log_dir=None)
```

å…¶ä¸­çš„log\_dirè¡¨ç¤ºä¿å­˜æ—¥å¿—çš„è·¯å¾„ï¼Œé»˜è®¤ä¼šä¿å­˜åœ¨â€œruns/å½“å‰æ—¶é—´\_ä¸»æœºåâ€æ–‡ä»¶å¤¹ä¸­ã€‚

å®ä¾‹åˆ›å»ºå¥½ä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹`add_scalar`æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ç”¨æ¥è®°å½•**æ•°å­—å¸¸é‡**ï¼Œå®ƒçš„å®šä¹‰å¦‚ä¸‹ï¼š

```python
add_scalar(tag, scalar_value, global_step=None, walltime=None)
```

æ ¹æ®å®šä¹‰ï¼Œæˆ‘ä»¬ä¾æ¬¡è¯´è¯´å…¶ä¸­çš„å‚æ•°ï¼š

- tagï¼šå­—ç¬¦ä¸²ç±»å‹ï¼Œè¡¨ç¤ºæ•°æ®çš„åç§°ï¼Œä¸åŒåç§°çš„æ•°æ®ä¼šä½¿ç”¨ä¸åŒæ›²çº¿å±•ç¤ºï¼›
- scalar\_valueï¼šæµ®ç‚¹å‹ï¼Œè¡¨ç¤ºè¦ä¿å­˜çš„æ•°å€¼ï¼›
- global\_stepï¼šæ•´å‹ï¼Œè¡¨ç¤ºè®­ç»ƒçš„stepæ•°ï¼›
- walltimeï¼šæµ®ç‚¹å‹ï¼Œè¡¨ç¤ºè®°å½•å‘ç”Ÿçš„æ—¶é—´ï¼Œé»˜è®¤ä¸ºtime.time()ã€‚

æˆ‘ä»¬ä¸€èˆ¬ä¼šä½¿ç”¨`add_scalar`æ–¹æ³•æ¥è®°å½•è®­ç»ƒè¿‡ç¨‹çš„lossã€accuracyã€learning rateç­‰æ•°å€¼çš„å˜åŒ–ï¼Œè¿™æ ·å°±èƒ½ç›´è§‚åœ°ç›‘æ§è®­ç»ƒè¿‡ç¨‹ã€‚

`add_image`æ–¹æ³•ç”¨æ¥è®°å½•å•ä¸ªå›¾åƒæ•°æ®ï¼ˆéœ€è¦Pillowåº“çš„æ”¯æŒï¼‰ï¼Œå®ƒçš„å®šä¹‰å¦‚ä¸‹ï¼š

```python
add_image(tag, img_tensor, global_step=None, walltime=None, dataformats='CHW')
```

tagã€global\_stepå’Œwalltimeçš„å«ä¹‰è·Ÿ`add_scalar`æ–¹æ³•é‡Œä¸€æ ·ï¼Œæ‰€ä»¥ä¸å†èµ˜è¿°ï¼Œæˆ‘ä»¬çœ‹çœ‹å…¶ä»–æ–°å¢çš„å‚æ•°éƒ½æ˜¯ä»€ä¹ˆå«ä¹‰ã€‚

- img\_tensorï¼šPyTorchçš„Tensorç±»å‹æˆ–NumPyçš„arrayç±»å‹ï¼Œè¡¨ç¤ºå›¾åƒæ•°æ®ï¼›
- dataformatsï¼šå­—ç¬¦ä¸²ç±»å‹ï¼Œè¡¨ç¤ºå›¾åƒæ•°æ®çš„æ ¼å¼ï¼Œé»˜è®¤ä¸ºâ€œCHWâ€ï¼Œå³Channel x Height x Widthï¼Œè¿˜å¯ä»¥æ˜¯â€œCHWâ€ã€â€œHWCâ€æˆ–â€œHWâ€ç­‰ã€‚

æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­åŠ æ·±ç†è§£ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ã€‚

```python
from torch.utils.tensorboard import SummaryWriter
# PyTorch 1.8ä¹‹å‰çš„ç‰ˆæœ¬è¯·ä½¿ç”¨ï¼š
# from tensorboardX import SummaryWriter
import numpy as np

# åˆ›å»ºä¸€ä¸ªSummaryWriterçš„å®ä¾‹
writer = SummaryWriter()

for n_iter in range(100):
    writer.add_scalar('Loss/train', np.random.random(), n_iter)
    writer.add_scalar('Loss/test', np.random.random(), n_iter)
    writer.add_scalar('Accuracy/train', np.random.random(), n_iter)
    writer.add_scalar('Accuracy/test', np.random.random(), n_iter)
    
img = np.zeros((3, 100, 100))
img[0] = np.arange(0, 10000).reshape(100, 100) / 10000
img[1] = 1 - np.arange(0, 10000).reshape(100, 100) / 10000

writer.add_image('my_image', img, 0)
writer.close()
```

æˆ‘ç»™ä½ æ¢³ç†ä¸€ä¸‹è¿™æ®µä»£ç éƒ½åšäº†ä»€ä¹ˆã€‚

é¦–å…ˆåˆ›å»ºä¸€ä¸ªSummaryWriterçš„å®ä¾‹ï¼Œè¿™é‡Œæ³¨æ„ï¼ŒPyTorch 1.8ä¹‹å‰çš„ç‰ˆæœ¬è¯·ä½¿ç”¨â€œfrom tensorboardX import SummaryWriterâ€ï¼ŒPyTorch 1.8ä¹‹åçš„ç‰ˆæœ¬è¯·ä½¿ç”¨â€œfrom torch.utils.tensorboard import SummaryWriterâ€ã€‚

ç„¶åï¼Œæˆ‘ä»¬éšæœºç”Ÿæˆä¸€äº›éšæœºæ•°ï¼Œç”¨æ¥æ¨¡æ‹Ÿè®­ç»ƒä¸é¢„æµ‹è¿‡ç¨‹ä¸­çš„Losså’ŒAccuracyï¼Œå¹¶ä¸”ç”¨`add_scalar`æ–¹æ³•è¿›è¡Œè®°å½•ã€‚æœ€åç”Ÿæˆäº†ä¸€ä¸ªå›¾åƒï¼Œç”¨`add_image`æ–¹æ³•æ¥è®°å½•ã€‚

ä¸Šè¿°ä»£ç è¿è¡Œåï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªâ€œrunsâ€æ–‡ä»¶å¤¹ï¼Œé‡Œé¢å­˜å‚¨äº†æˆ‘ä»¬éœ€è¦è®°å½•çš„æ•°æ®ã€‚

ç„¶åï¼Œæˆ‘ä»¬åœ¨å½“å‰ç›®å½•ä¸‹æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå³å¯å¯åŠ¨Tensoboardã€‚

```python
tensorboard --logdir=runs
```

å¯åŠ¨åï¼Œåœ¨æµè§ˆå™¨ä¸­è¾“å…¥â€œ[http://127.0.0.1:6006/](http://127.0.0.1:6006/)â€ï¼ˆTensorboardçš„é»˜è®¤ç«¯å£ä¸º6006ï¼‰ï¼Œå³å¯å¯¹åˆšæ‰æˆ‘ä»¬è®°å½•çš„æ•°æ®è¿›è¡Œå¯è§†åŒ–ã€‚

Tensorboardçš„ç•Œé¢å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å›¾ç‰‡ä¸­å³ä¾§éƒ¨åˆ†å°±æ˜¯åˆšåˆšç”¨`add_scalar`æ–¹æ³•è®°å½•çš„Losså’ŒAccuracyã€‚ä½ çœ‹ï¼ŒTensorboardå·²ç»å¸®æˆ‘ä»¬æŒ‰ç…§è¿­ä»£stepç»˜åˆ¶æˆäº†æ›²çº¿å›¾ï¼Œå¯ä»¥éå¸¸ç›´è§‚åœ°ç›‘æ§è®­ç»ƒè¿‡ç¨‹ã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/33/e8/3393e81d9a34c51cdecd4a99e460dde8.png?wh=1920x1360)

åœ¨â€œIMAGESâ€çš„æ ‡ç­¾é¡µä¸­ï¼Œå¯ä»¥æ˜¾ç¤ºåˆšåˆšç”¨`add_image`æ–¹æ³•è®°å½•çš„å›¾åƒæ•°æ®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/86/3a/86bcefa7e732ccceef230a888b3f3a3a.png?wh=1432x1114)

### è®­ç»ƒè¿‡ç¨‹å¯è§†åŒ–

å¥½ï¼Œè¿›è¡Œåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»è£…å¥½äº†TensorboardXå¹¶å¯åŠ¨ï¼Œè¿˜æ¼”ç¤ºäº†è¿™ä¸ªå·¥å…·å¦‚ä½•ä½¿ç”¨ã€‚

é‚£ä¹ˆå¦‚ä½•åœ¨æˆ‘ä»¬å®é™…çš„è®­ç»ƒè¿‡ç¨‹ä¸­æ¥è¿›è¡Œå¯è§†åŒ–ç›‘æ§å‘¢ï¼Ÿæˆ‘ä»¬ç”¨ä¸ŠèŠ‚è¯¾æ„å»ºå¹¶è®­ç»ƒçš„çº¿æ€§å›å½’æ¨¡å‹ä¸ºä¾‹ï¼Œæ¥è¿›è¡Œå®è·µã€‚

ä¸‹é¢çš„ä»£ç ä¸ŠèŠ‚è¯¾è®²è¿‡ï¼Œä½œç”¨æ˜¯å®šä¹‰ä¸€ä¸ªçº¿æ€§å›å½’æ¨¡å‹ï¼Œå¹¶éšæœºç”Ÿæˆè®­ç»ƒé›†Xä¸å¯¹åº”çš„æ ‡ç­¾Yã€‚

```python
import random
import numpy as np
import torch
from torch import nn

# æ¨¡å‹å®šä¹‰
class LinearModel(nn.Module):
Â  def __init__(self):
Â  Â  super().__init__()
Â  Â  self.weight = nn.Parameter(torch.randn(1))
Â  Â  self.bias = nn.Parameter(torch.randn(1))

Â  def forward(self, input):
Â  Â  return (input * self.weight) + self.bias

# æ•°æ®
w = 2
b = 3
xlim = [-10, 10]
x_train = np.random.randint(low=xlim[0], high=xlim[1], size=30)
y_train = [w * x + b + random.randint(0,2) for x in x_train]
```

ç„¶åæˆ‘ä»¬åœ¨è®­ç»ƒçš„è¿‡ç¨‹ä¸­ï¼ŒåŠ å…¥åˆšæ‰è®²è¿‡çš„SummaryWriterå®ä¾‹ä¸`add_scalar`æ–¹æ³•ï¼Œå…·ä½“çš„ä»£ç å¦‚ä¸‹ã€‚

```python
# Tensorboard
from torch.utils.tensorboard import SummaryWriter

# è®­ç»ƒ
model = LinearModel()
optimizer = torch.optim.SGD(model.parameters(), lr=1e-4, weight_decay=1e-2, momentum=0.9)
y_train = torch.tensor(y_train, dtype=torch.float32)

writer = SummaryWriter()

for n_iter in range(500):
    input = torch.from_numpy(x_train)
    output = model(input)
    loss = nn.MSELoss()(output, y_train)
    model.zero_grad()
    loss.backward()
    optimizer.step()
    writer.add_scalar('Loss/train', loss, n_iter)
```

é€šè¿‡ä¸Šé¢è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬è®°å½•äº†è®­ç»ƒè¿‡ç¨‹ä¸­çš„Lossçš„å˜æ¢è¿‡ç¨‹ã€‚å…·ä½“çš„è¶‹åŠ¿å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/df/48/df021d742b09180fb267652fca440d48.png?wh=750x656)

å¯ä»¥çœ‹åˆ°Lossæ˜¯ä¸€ä¸ªä¸‹é™çš„è¶‹åŠ¿ï¼Œè¯´æ˜éšç€è®­ç»ƒè¿‡ç¨‹ï¼Œæ¨¡å‹è¶Šæ¥è¶Šæ‹Ÿåˆæˆ‘ä»¬çš„è®­ç»ƒæ•°æ®äº†ã€‚è¿›è¡Œåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»èµ°å®Œäº†åˆ©ç”¨TensorboardXå·¥å…·ï¼Œå®ç°è®­ç»ƒå¯è§†åŒ–ç›‘æ§çš„æ•´ä¸ªè¿‡ç¨‹ã€‚

TensorboardXé™¤äº†åŒ…æ‹¬ä¸Šè¿°çš„å¸¸ç”¨æ–¹æ³•ä¹‹å¤–ï¼Œè¿˜æœ‰è®¸å¤šå…¶ä»–æ–¹æ³•å¦‚`add_histogram`ã€`add_graph`ã€`add_embedding`ã€`add_audio` ç­‰ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å‚è€ƒ[\[å®˜æ–¹æ–‡æ¡£\]](https://pytorch.org/docs/stable/tensorboard.html)ã€‚ç›¸ä¿¡å‚è€ƒå·²ç»å­¦ä¹ è¿‡çš„ä¸¤ä¸ªaddæ–¹æ³•ï¼Œä½ ä¸€å®šèƒ½å¤Ÿä¸¾ä¸€åä¸‰ï¼Œå¾ˆå¿«ç†Ÿç»ƒè°ƒç”¨å…¶å®ƒçš„æ–¹æ³•ã€‚

## Visdom

Visdomæ˜¯Facebookå¼€æºçš„ä¸€ä¸ªä¸“é—¨ç”¨äºPyTorchçš„äº¤äº’å¼å¯è§†åŒ–å·¥å…·ã€‚å®ƒä¸ºå®æ—¶æ•°æ®æä¾›äº†ä¸°å¯Œçš„å¯è§†åŒ–ç§ç±»ï¼Œå¯ä»¥åœ¨æµè§ˆå™¨ä¸­è¿›è¡ŒæŸ¥çœ‹ï¼Œå¹¶ä¸”å¯ä»¥å¾ˆå®¹æ˜“åœ°ä¸å…¶ä»–äººå…±äº«å¯è§†åŒ–ç»“æœï¼Œå¸®åŠ©æˆ‘ä»¬å®æ—¶ç›‘æ§åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šè¿›è¡Œçš„ç§‘å­¦å®éªŒã€‚

### å®‰è£…ä¸å¯åŠ¨

Visdomçš„å®‰è£…éå¸¸ç®€å•ï¼Œå¯ç›´æ¥ä½¿ç”¨pipè¿›è¡Œå®‰è£…ï¼Œå…·ä½“çš„å‘½ä»¤å¦‚ä¸‹ï¼š

```python
pip install visdom
```

æ‰§è¡Œå®‰è£…å‘½ä»¤åï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨Visdomï¼š

```python
python -m visdom.server
```

Visdomçš„é»˜è®¤ç«¯å£æ˜¯8097ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹ï¼Œå¯ä»¥ä½¿ç”¨-pé€‰é¡¹ã€‚

å¯åŠ¨æˆåŠŸåï¼Œåœ¨æµè§ˆå™¨ä¸­è¾“å…¥â€œ[http://127.0.0.1:8097/](http://127.0.0.1:8097/)â€ï¼Œè¿›å…¥Visdomçš„ä¸»ç•Œé¢ã€‚

Visdomçš„ä¸»ç•Œé¢å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/99/a8/99d3a7d1ayya17cb625a6f8a567e2aa8.jpg?wh=1920x460)

è¯·ä½ æ³¨æ„ï¼ŒVisdomçš„ä½¿ç”¨ä¸Tensorboardç¨æœ‰ä¸åŒã€‚Tensorboardæ˜¯åœ¨ç”Ÿæˆè®°å½•æ–‡ä»¶åï¼Œå¯åŠ¨å¯è§†åŒ–ç•Œé¢ã€‚è€ŒVisdomæ˜¯å…ˆå¯åŠ¨å¯è§†åŒ–ç•Œé¢ï¼Œå½“æœ‰æ•°æ®è¿›å…¥Visdomçš„çª—å£æ—¶ï¼Œä¼šå®æ—¶åŠ¨æ€åœ°æ›´æ–°å¹¶ç»˜åˆ¶æ•°æ®ã€‚

### å¿«é€Ÿä¸Šæ‰‹

ä¸‹é¢æˆ‘ä»¬å°±æ¥åŠ¨æ‰‹è¯•ä¸€ä¸‹ï¼Œçœ‹çœ‹Visdomå¦‚ä½•ç»˜åˆ¶æ•°æ®ã€‚

å…·ä½“è¿‡ç¨‹åˆ†å››æ­¥èµ°ï¼šé¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å°†çª—å£ç±»Visdomå®ä¾‹åŒ–ï¼›ç„¶åï¼Œåˆ©ç”¨line()æ–¹æ³•åˆ›å»ºä¸€ä¸ªçº¿å›¾çª—å£å¹¶åˆå§‹åŒ–ï¼›æ¥ç€ï¼Œåˆ©ç”¨ç”Ÿæˆçš„ä¸€ç»„éšæœºæ•°æ•°æ®æ¥æ›´æ–°çº¿å›¾çª—å£ã€‚æœ€åï¼Œé€šè¿‡image()æ–¹æ³•æ¥ç»˜åˆ¶ä¸€å¼ å›¾ç‰‡ã€‚

ä¸Šè¿°è¿‡ç¨‹çš„å…·ä½“ä»£ç å¦‚ä¸‹ã€‚

```python
from visdom import Visdom
import numpy as np
import time

# å°†çª—å£ç±»å®ä¾‹åŒ–
viz = Visdom()Â 
# åˆ›å»ºçª—å£å¹¶åˆå§‹åŒ–
viz.line([0.], [0], win='train_loss', opts=dict(title='train_loss'))

for n_iter in range(10):
Â  Â  # éšæœºè·å–losså€¼
Â  Â  loss = 0.2 * np.random.randn() + 1
Â  Â  # æ›´æ–°çª—å£å›¾åƒ
Â  Â  viz.line([loss], [n_iter], win='train_loss', update='append')
Â  Â  time.sleep(0.5)

img = np.zeros((3, 100, 100))
img[0] = np.arange(0, 10000).reshape(100, 100) / 10000
img[1] = 1 - np.arange(0, 10000).reshape(100, 100) / 10000
# å¯è§†åŒ–å›¾åƒ
viz.image(img)
```

å¯ä»¥çœ‹å‡ºï¼Œä½¿ç”¨è¿‡ç¨‹ä¸TensorboardåŸºæœ¬ä¸€è‡´ï¼Œåªæ˜¯å‡½æ•°è°ƒç”¨ä¸Šçš„ä¸åŒã€‚  
ç»˜åˆ¶çº¿å›¾çš„ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/c0/13/c0057dd5935b0ed2f6606a8c148f4f13.gif?wh=368x336)

å¯¹åº”çš„ç»˜åˆ¶å›¾ç‰‡ç»“æœå¦‚ä¸‹ã€‚å¯ä»¥çœ‹å‡ºï¼ŒVisodmç»˜åˆ¶æ•°æ®æ—¶ï¼Œæ˜¯åŠ¨æ€æ›´æ–°çš„ã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/a6/88/a66f16a1be56456c009da3873c949888.jpg?wh=676x482)

### è®­ç»ƒå¯è§†åŒ–ç›‘æ§

åŒæ ·åœ°ï¼Œæˆ‘ä»¬å­¦ä¹ å¯è§†åŒ–å·¥å…·çš„ä½¿ç”¨ä¸»è¦æ˜¯ä¸ºäº†ç›‘æ§æˆ‘ä»¬çš„è®­ç»ƒè¿‡ç¨‹ã€‚æˆ‘ä»¬è¿˜æ˜¯ä»¥æ„å»ºå¹¶è®­ç»ƒçš„çº¿æ€§å›å½’æ¨¡å‹ä¸ºä¾‹ï¼Œæ¥è¿›è¡Œå®è·µã€‚

Visdomç›‘æ§è®­ç»ƒè¿‡ç¨‹å¤§è‡´åˆ†ä¸ºä¸‰æ­¥ï¼š

- å®ä¾‹åŒ–ä¸€ä¸ªçª—å£ï¼›
- åˆå§‹åŒ–çª—å£çš„ä¿¡æ¯ï¼›
- æ›´æ–°ç›‘å¬çš„ä¿¡æ¯ã€‚

å®šä¹‰æ¨¡å‹ä¸ç”Ÿæˆè®­ç»ƒæ•°æ®çš„è¿‡ç¨‹è·Ÿå‰é¢ä¸€æ ·ï¼Œæˆ‘å°±ä¸å†é‡å¤äº†ã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å®ä¾‹åŒ–å¹¶åˆå§‹åŒ–Visdomçª—å£ã€å®æ—¶è®°å½•Lossçš„ä»£ç å¦‚ä¸‹ã€‚

```python
# Visdom
from visdom import Visdom
import numpy as np

# è®­ç»ƒ
model = LinearModel()
optimizer = torch.optim.SGD(model.parameters(), lr=1e-4, weight_decay=1e-2, momentum=0.9)
y_train = torch.tensor(y_train, dtype=torch.float32)

# å®ä¾‹åŒ–ä¸€ä¸ªçª—å£
viz = Visdom(port=8097)
# åˆå§‹åŒ–çª—å£çš„ä¿¡æ¯
viz.line([0.], [0.], win='train_loss', opts=dict(title='train loss'))

for n_iter in range(500):
    input = torch.from_numpy(x_train)
    output = model(input)
    loss = nn.MSELoss()(output, y_train)
    model.zero_grad()
    loss.backward()
    optimizer.step()
    # æ›´æ–°ç›‘å¬çš„ä¿¡æ¯
    viz.line([loss.item()], [n_iter], win='train_loss', update='append')
```

åœ¨Visdomçš„ç•Œé¢ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°Lossçš„å˜åŒ–è¶‹åŠ¿å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚Visdomä¸ä¼šåƒTensorboardè‡ªåŠ¨å¯¹æ›²çº¿è¿›è¡Œç¼©æ”¾æˆ–å¹³æ»‘ï¼Œå› æ­¤å¯ä»¥çœ‹åˆ°50è½®ä¹‹åï¼Œç”±äºLosså€¼å˜åŒ–èŒƒå›´æ¯”è¾ƒå°ï¼Œå›¾åƒçš„æŠ–åŠ¨è¶‹åŠ¿è¢«å‹ç¼©å¾—éå¸¸ä¸æ˜æ˜¾ã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/54/e0/54665114801a49e36a0211b5b3dbdce0.jpg?wh=1007x763)

## å°ç»“

è¿™èŠ‚è¯¾æˆ‘å¸¦ä½ å­¦ä¹ äº†ä¸¤ç§å¯è§†åŒ–å·¥å…·ï¼šTensorboardXå’ŒVisdomã€‚

ç›¸ä¿¡é€šè¿‡ä¸€èŠ‚è¯¾çš„è®²è§£å’Œç»ƒä¹ ï¼Œè¿™ä¸¤ç§å¯è§†åŒ–å·¥å…·å¦‚ä½•å®‰è£…ã€å¯åŠ¨ï¼Œè¿˜æœ‰å¦‚ä½•ç”¨å®ƒä»¬ç»˜åˆ¶çº¿å›¾å’Œå›¾ç‰‡è¿™äº›åŸºæœ¬çš„æ“ä½œï¼Œç›¸ä¿¡ä½ éƒ½å·²ç»æŒæ¡äº†ã€‚

å­¦ä¹ ä½¿ç”¨å¯è§†åŒ–å·¥å…·çš„ä¸»è¦ç›®çš„ï¼Œ**æ˜¯ä¸ºäº†å¸®åŠ©æˆ‘ä»¬åœ¨æ·±åº¦å­¦ä¹ æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå®æ—¶ç›‘æ§ä¸€äº›æ•°æ®ï¼Œä¾‹å¦‚æŸå¤±å€¼ã€è¯„ä»·æŒ‡æ ‡ç­‰ç­‰**ã€‚å¯¹è¿™äº›æ•°æ®è¿›è¡Œå¯è§†åŒ–ç›‘æ§ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ„ŸçŸ¥å„ä¸ªå‚æ•°ä¸æŒ‡æ ‡çš„å˜åŒ–ï¼Œå®æ—¶æŠŠæ¡è®­ç»ƒè¶‹åŠ¿ã€‚å› æ­¤ï¼Œå¦‚ä½•å°†å¯è§†åŒ–å·¥å…·åº”ç”¨äºæ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ˜¯æˆ‘ä»¬å­¦ä¹ çš„é‡ç‚¹ã€‚

TensorboardXå’ŒVisdomè¿˜æœ‰å…¶å®ƒè¯¸å¦‚ç»˜åˆ¶æ•£ç‚¹å›¾ã€æŸ±çŠ¶å›¾ã€çƒ­åŠ›å›¾ç­‰ç­‰å¤šç§å¤šæ ·çš„åŠŸèƒ½ï¼Œå¦‚æœä½ æ„Ÿå…´è¶£ï¼Œå¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼Œç±»æ¯”æˆ‘ä»¬ä»Šå¤©å­¦ä¹ çš„æ–¹æ³•åŠ¨æ‰‹è¯•ä¸€è¯•ï¼Œç»è¿‡ç»ƒä¹ ï¼Œä¸€å®šå¯ä»¥ç†Ÿç»ƒä½¿ç”¨å®ƒä»¬ã€‚

## æ¯è¯¾ä¸€ç»ƒ

å‚è€ƒVisdomå¿«é€Ÿä¸Šæ‰‹ä¸­çš„ä¾‹å­ï¼Œç°åœ¨éœ€è¦ç”Ÿæˆä¸¤ç»„éšæœºæ•°ï¼Œåˆ†åˆ«è¡¨ç¤ºLosså’ŒAccuracyã€‚åœ¨è¿­ä»£çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚ä½•ç”¨ä»£ç åŒæ—¶ç»˜åˆ¶å‡ºLosså’ŒAccuracyä¸¤ç»„æ•°æ®å‘¢ï¼Ÿ

æ¬¢è¿è®°å½•ä½ çš„æ€è€ƒæˆ–ç–‘æƒ‘ï¼Œä¹Ÿæ¨èä½ æŠŠä»Šå¤©å­¦åˆ°çš„å¯è§†åŒ–å·¥å…·åˆ†äº«ç»™æ›´å¤šåŒäº‹ã€æœ‹å‹ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ14ï¼‰</strong></div><ul>
<li><span>å’ªè¥¿å°æ‚ </span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>viz = Visdom()
viz.line([[0., 0.]], [0], win=&#39;train&#39;, opts=dict(title=&#39;loss_accuracy&#39;, legend=[&#39;loss&#39;, &#39;acc&#39;]))

for n_iter in range(10):
    loss = 0.2 * np.random.randn() + 1
    accuracy = 0.1 * np.random.randn() + 1
    viz.line([[loss, accuracy]], [n_iter], win=&#39;train&#39;, update=&#39;append&#39;)
    time.sleep(0.5)</p>2021-11-15</li><br/><li><span>John(æ˜“ç­‹)</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è¿è¡Œä¸‹é¢æŒ‡ä»¤æŠ¥é”™: Error while finding module specification for &#39;visdom.server&#39;
python -m visdom.server

è§£å†³æ–¹æ¡ˆï¼š
Upgrade pip,

python -m pip install --upgrade pip
They try,

python -m pip install visdom

å†æ¬¡è¿è¡Œæœ€å¼€å§‹çš„å‘½ä»¤å³å¯ã€‚ 
ref: https:&#47;&#47;stackoverflow.com&#47;questions&#47;60623224&#47;modulenotfounderror-no-module-named-visdom-when-importing-visdom</p>2022-08-07</li><br/><li><span>é™å¿ƒ</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>MacOSä¸Šè¿è¡Œtensorboardå‘½ä»¤å¯åŠ¨æœåŠ¡æ—¶ï¼Œé‡åˆ°ä»¥ä¸‹é”™è¯¯ï¼š
ValueError: Duplicate plugins for name projector

é€šè¿‡ä»¥ä¸‹å¸è½½é‡å®‰è£…åŠæ³•ç­‰åˆ°è§£å†³ï¼š
pip uninstall tb-nightly tensorboardX tensorboard
pip install tensorboard</p>2023-12-28</li><br/><li><span>John(æ˜“ç­‹)</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šï¼Œå‘ç°Visdom åœ¨chromeä¸Šè¿è¡Œæ­£å¸¸ï¼ŒSafari ä¸åŠ¨ã€‚

from visdom import Visdom
import numpy as np
import time

# å°†çª—å£ç±»å®ä¾‹åŒ–
viz = Visdom()
# åˆ›å»ºçª—å£å¹¶åˆå§‹åŒ–
viz.line([[0., 0.]], [0], win=&#39;loss and accuracy&#39;, opts=dict(title=&#39;train_loss&#39;))

for n_iter in range(10):
     # éšæœºè·å–losså€¼
    loss = 0.2 * np.random.randn() + 1
    # éšæœºäº§ç”Ÿaccuracy
    accuracy = 0.1 * np.random.randn()
    # æ›´æ–°çª—å£å›¾åƒ,åŒæ—¶æ›´æ–°losså’Œaccuracy
    viz.line(Y=[[loss, accuracy]], X=[n_iter], win=&#39;loss and accuracy&#39;, update=&#39;append&#39;)
    time.sleep(0.5)</p>2022-08-08</li><br/><li><span>ç‘¾ç‘œå®</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>
è€å¸ˆæ‚¨å¥½ï¼Œåœ¨tensorboard --logdir=runs  è¿™ä¸€æ­¥å‡ºç°äº†é—®é¢˜ï¼Œæ±‚è§£
File &quot;C:\Users\86189\AppData\Local\Temp&#47;ipykernel_82416&#47;59224237.py&quot;, line 1
    tensorboard --logdir=runs
    ^
SyntaxError: cannot assign to operator
</p>2022-07-04</li><br/><li><span>Merlyn</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>è€å¸ˆæ‚¨å¥½ï¼Œä¸ºä»€ä¹ˆæˆ‘åœ¨å¯åŠ¨tensorboardåï¼Œè¿è¡Œç¨‹åºä»¥åæŠ¥äº†å¦‚ä¸‹é”™è¯¯å‘¢ï¼Œæ˜¯ä»€ä¹ˆåŸå› é€ æˆçš„å‘¢ï¼Ÿ
[WinError 10061] ç”±äºç›®æ ‡è®¡ç®—æœºç§¯ææ‹’ç»ï¼Œæ— æ³•è¿æ¥ã€‚
on_close() takes 1 positional argument but 3 were given</p>2022-05-16</li><br/><li><span>ä¹å‘µçš„hehe</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼Œæˆ‘çš„ç¯å¢ƒé‡Œæœ‰tensorboardxï¼Œå¯æ˜¯ä¸ºä»€ä¹ˆæ— æ³•å¯¼å…¥å‘¢ï¼ŸæŠ¥é”™å¦‚ä¸‹ï¼š

ModuleNotFoundError                       Traceback (most recent call last)
Input In [7], in &lt;module&gt;
----&gt; 1 from torch.utils.tensorboard import SummaryWriter
      2 # PyTorch 1.8ä¹‹å‰çš„ç‰ˆæœ¬è¯·ä½¿ç”¨ï¼š
      3 # from tensorboardX import SummaryWriter
      4 import numpy as np

File D:\Anaconda3\envs\PythonEnvironment1\lib\site-packages\torch\utils\tensorboard\__init__.py:1, in &lt;module&gt;
----&gt; 1 import tensorboard
      2 from setuptools import distutils
      4 LooseVersion = distutils.version.LooseVersion

ModuleNotFoundError: No module named &#39;tensorboard&#39;</p>2022-05-15</li><br/><li><span>å°æ—å­</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆæ¨èä½¿ç”¨å“ªç§å¯è§†åŒ–å·¥å…·äº†ï¼Ÿ</p>2022-05-09</li><br/><li><span>vcjmhg</span> ğŸ‘ï¼ˆ6ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<p># å°†çª—å£ç±»å®ä¾‹åŒ–
viz = Visdom()
# åˆ›å»ºçª—å£å¹¶åˆå§‹åŒ–
viz.line([0.], [0], win=&#39;loss and accuracy&#39;, opts=dict(title=&#39;train_loss&#39;))

for n_iter in range(10):
    # éšæœºè·å–losså€¼
    loss = 0.2 * np.random.randn() + 1
    # éšæœºäº§ç”Ÿaccuracy
    accuracy = 0.1 * np.random.randn()
    # æ›´æ–°çª—å£å›¾åƒ,åŒæ—¶æ›´æ–°losså’Œaccuracy
    viz.line(Y=[loss, accuracy], X=[n_iter], win=&#39;loss and accuracy&#39;, update=&#39;append&#39;)
    time.sleep(0.5)</p>2021-11-16</li><br/><li><span>ifelse</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<p>å­¦ä¹ æ‰“å¡</p>2023-12-04</li><br/><li><span>å˜Ÿå˜Ÿå˜Ÿå˜Ÿå˜Ÿå®å„¿</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<p>å·²ç»å®‰è£…äº†Tensorboardï¼Œä½†æ˜¯è¿è¡Œè¿‡ç¨‹ä»ç„¶æ˜¾ç¤ºæ‰¾ä¸åˆ°è¿™ä¸ªæ¨¡å‹ã€‚å¹¶ä¸”æ˜¯1.13.0çš„ç‰ˆæœ¬ï¼Œè¯·é—®é—®é¢˜æ˜¯å‡ºåœ¨å“ªé‡Œå‘¢ã€‚æ˜¯å®‰è£…ä¸æˆåŠŸå˜›ï¼Œä½†æ˜¯è¿è¡Œå‘½ä»¤è¡Œçš„æ—¶å€™æ˜¾ç¤ºéƒ½æ˜¯æ»¡è¶³çš„
</p>2023-09-07</li><br/><li><span>äºšæ—</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<p>ä½¿ç”¨visdomï¼Œä¸Šä¸€èŠ‚è®­ç»ƒæ¨¡å‹æ”¶ä¼åœ¨2é™„è¿‘äº†</p>2022-05-23</li><br/><li><span>äºšæ—</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<p>def cifar10_go():
    # å®ä¾‹åŒ–ä¸€ä¸ªçª—å£
    viz = Visdom(port=8097)
    # åˆå§‹åŒ–çª—å£çš„ä¿¡æ¯
    viz.line([0.], [0.], win=&#39;train_loss&#39;, opts=dict(title=&#39;train loss&#39;))

    transform = transforms.Compose([
        transforms.RandomResizedCrop((224, 224)),
        transforms.ToTensor(),
        transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
    ])
    cifar10_dataset = torchvision.datasets.CIFAR10(root=&#39;.&#47;data&#39;,
                                                   train=False,
                                                   transform=transform,
                                                   target_transform=None,
                                                   download=True)
    dataloader = DataLoader(dataset=cifar10_dataset,  # ä¼ å…¥çš„æ•°æ®é›†, å¿…é¡»å‚æ•°
                            batch_size=32,  # è¾“å‡ºçš„batchå¤§å°
                            shuffle=True,  # æ•°æ®æ˜¯å¦æ‰“ä¹±
                            num_workers=4)  # è¿›ç¨‹æ•°, 0è¡¨ç¤ºåªæœ‰ä¸»è¿›ç¨‹
    model = MyCNN()
    # äº¤å‰ç†µæŸå¤±å‡½æ•°
    criterion = nn.CrossEntropyLoss()
    # å®šä¹‰ä¼˜åŒ–å™¨
    optimizer = torch.optim.SGD(model.parameters(), lr=1e-4, weight_decay=1e-2, momentum=0.9)
    # ä¸‹é¢å¼€å§‹è®­ç»ƒ
    start = time.time()  # è®°æ—¶å¼€å§‹
    for epoch in range(3):  # è®¾ç½®è¦åœ¨å…¨éƒ¨æ•°æ®ä¸Šè®­ç»ƒçš„æ¬¡æ•°

        for i, data in enumerate(dataloader):
            # dataå°±æ˜¯æˆ‘ä»¬è·å–çš„ä¸€ä¸ªbatch sizeå¤§å°çš„æ•°æ®

            inputs, labels = data
            optimizer.zero_grad()
            # è·å¾—æ¨¡å‹çš„è¾“å‡ºç»“æœï¼Œä¹Ÿå³æ˜¯å½“å‰æ¨¡å‹å­¦åˆ°çš„æ•ˆæœ
            outputs = model(inputs)
            # è·å¾—è¾“å‡ºç»“æœå’Œæ•°æ®çœŸæ­£ç±»åˆ«çš„æŸå¤±å‡½æ•°
            loss = criterion(outputs, labels)
            print(&#39;Epoch {}, Loss {}&#39;.format(epoch + 1, loss))
            loss.backward()
            optimizer.step()
            viz.line([loss.item()], [i], win=&#39;train_loss&#39;, update=&#39;append&#39;)
    end = time.time()  # è®¡æ—¶ç»“æŸ
    print(&#39;ä½¿ç”¨æ—¶é—´: {:.5f} s&#39;.format(end - start))
    torch.save(model, &#39;.&#47;MyCNN_model_23.pth&#39;)</p>2022-05-23</li><br/><li><span>ä¹å‘µçš„hehe</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<p>from visdom import Visdom
import numpy as np
import time

# å°†çª—å£ç±»å®ä¾‹åŒ–
viz = Visdom()
# åˆ›å»ºçª—å£å¹¶åˆå§‹åŒ–
viz.line([0.], [0], win=&#39;loss&#39;, opts=dict(title=&#39;loss&#39;))
viz.line([0.], [0], win=&#39;accuracy&#39;, opts=dict(title=&#39;accuracy&#39;))

for n_iter in range(100):
    # éšæœºè·å–losså€¼
    loss = 0.2 * np.random.randn() + 1
    accuracy = 0.2 * np.random.randn() + 1
    # æ›´æ–°çª—å£å›¾åƒ
    viz.line([loss], [n_iter], win=&#39;loss&#39;, update=&#39;append&#39;)
    viz.line([accuracy], [n_iter], win=&#39;accuracy&#39;, update=&#39;append&#39;)
    time.sleep(0.5)</p>2022-05-16</li><br/>
</ul>