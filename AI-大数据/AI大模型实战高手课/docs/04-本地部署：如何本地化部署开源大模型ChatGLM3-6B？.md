ä½ å¥½ï¼Œæˆ‘æ˜¯ç‹¬è¡Œã€‚

å‰é¢å¬æˆ‘è®²äº†è¿™ä¹ˆå¤šï¼Œç›¸ä¿¡ä½ ä¹Ÿå¾ˆæƒ³ä¸Šæ‰‹è¯•ä¸€è¯•äº†ã€‚ä»è¿™èŠ‚è¯¾å¼€å§‹ï¼Œæˆ‘ä»¬è¿›å…¥ä¸€ä¸ªæ–°çš„ç« èŠ‚ï¼Œè¿™éƒ¨åˆ†æˆ‘ä»¬ä¼šå­¦ä¹ å¦‚ä½•éƒ¨ç½²å¼€æºå¤§æ¨¡å‹ChatGLM3-6Bï¼Œæœ¬åœ°æ­å»ºå‘é‡åº“å¹¶ç»“åˆLangChainåšæ£€ç´¢å¢å¼ºï¼ˆRAGï¼‰ï¼Œå¹¶ä¸”æˆ‘ä¼šå¸¦ä½ åšä¸€æ¬¡å¾®è°ƒï¼Œä»å¤´å­¦ä¹ **å¤§æ¨¡å‹çš„éƒ¨ç½²ã€å¾®è°ƒã€æ¨ç†**ç­‰è¿‡ç¨‹ã€‚

è¿™èŠ‚è¯¾æˆ‘ä»¬å°±æ¥è®²ä¸€ä¸‹å¦‚ä½•æœ¬åœ°åŒ–éƒ¨ç½²ChatGLM3-6Bï¼ˆåé¢æˆ‘ä»¬ç®€ç§°ä¸º6Bï¼‰ã€‚è®²6Bä¹‹å‰æˆ‘ä»¬å…ˆæ•´ä½“çœ‹ä¸€ä¸‹ç›®å‰å›½å†…å¤–å¤§æ¨¡å‹çš„å‘å±•çŠ¶å†µï¼Œä»¥ä¾¿æˆ‘ä»¬è¿›è¡ŒæŠ€æœ¯é€‰å‹ã€‚

## å¤§æ¨¡å‹çš„é€‰æ‹©

å½“å‰ç¯å¢ƒä¸‹ï¼Œå¤§æ¨¡å‹ç™¾èŠ±é½æ”¾ã€‚æˆ‘ç­›é€‰å‡ºäº†ä¸€äº›æ ¸å¿ƒç©å®¶ï¼Œä½ å¯ä»¥çœ‹ä¸€ä¸‹è¡¨æ ¼ã€‚éæ ¸å¿ƒçš„å…¶å®è¿˜æœ‰å¾ˆå¤šï¼Œè¿™é‡Œæˆ‘å°±ä¸ä¸€ä¸€åˆ—ä¸¾äº†ã€‚å‚å•†è™½ç„¶å¾ˆå¤šï¼Œä½†çœŸæ­£åœ¨ç ”ç©¶æŠ€æœ¯çš„æ²¡å¤šå°‘ï¼Œæ¯•ç«Ÿå‰é¢æˆ‘ä»¬è®²è¿‡ï¼Œç©å¤§æ¨¡å‹æŠ•å…¥éå¸¸å¤§ï¼Œå…‰çœ‹å¾—è§çš„æˆæœ¬ï¼ŒåŒ…æ‹¬äººæ‰ã€è®­ç»ƒå’Œç¡¬ä»¶è´¹ç”¨ï¼Œä¸€å¹´å°±å¾—æŠ•å…¥å‡ ä¸ªäº¿ï¼Œä¸æ˜¯ä¸€èˆ¬ç©å®¶èƒ½ç©å¾—èµ·çš„ã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/a4/a0/a4e540e0b41d3d58e2cec92ae15d38a0.png?wh=2532x1340)

å½“ç„¶ï¼Œä¹Ÿæœ‰ä¸å°‘å‚å•†æ˜¯åŸºäºLLaMAçˆ†æ”¹çš„ï¼Œæˆ–è€…å«å¥—å£³ï¼Œä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„è‡ªç ”å¤§æ¨¡å‹ã€‚

ChatGLM-6Bå’ŒLLaMA2æ˜¯ç›®å‰å¼€æºé¡¹ç›®æ¯”è¾ƒçƒ­çš„ä¸¤ä¸ªï¼Œæ—©åœ¨2023å¹´å¹´åˆï¼Œå›½å†…åˆšå…´èµ·å¤§æ¨¡å‹çƒ­æ½®æ—¶ï¼Œæ™ºè°±AIå°±å¼€æºäº†ChatGLM-6Bï¼Œå½“ç„¶130Bä¹Ÿå¯ä»¥æ‹¿è¿‡æ¥è·‘ï¼Œåªä¸è¿‡æ¨¡å‹å¤ªå¤§ï¼Œéœ€è¦æ¯”è¾ƒå¤šçš„æ˜¾å¡ï¼Œæ‰€ä»¥å¾ˆå¤šäººå°±éƒ¨ç½²6Bè¯•ç©ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ30ï¼‰</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/0f/ce/6d/530df0dd.jpg" width="30px"><span>å¾çŸ³å¤´</span> ğŸ‘ï¼ˆ15ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>1. ç½‘ç»œé—®é¢˜ï¼Œå¯ä»¥ç”¨å›½å†…çš„åœ°å€ï¼Œhttps:&#47;&#47;gitee.com&#47;mirrors&#47;chatglm3å’Œ https:&#47;&#47;www.modelscope.cn&#47;ZhipuAI&#47;chatglm3-6b.gitï¼Œæ³¨æ„ä¸è¦ç”¨ hf çš„ï¼Œæ¨¡å‹ä¸å…¨æŠ¥é”™
2. æ˜¾å¡é©±åŠ¨é—®é¢˜ï¼Œéœ€è¦æŠŠN å¡é©±åŠ¨æœ€ä½å‡çº§åˆ°11.8ï¼Œè¦å…ˆå¸è½½å¹²å‡€æ—§é©±åŠ¨ï¼Œå†å‡çº§ã€‚
3. chatglm å¦‚æœæ²¡æœ‰æ‰¾åˆ° GPUï¼Œå°±ä¼šä½¿ç”¨ CPU è¿ç®—ï¼Œå“åº”é€Ÿåº¦ä¼šéå¸¸æ…¢ï¼Œç”¨ TOP æŸ¥çœ‹ CPU ä½¿ç”¨ç‡
4. æ³¨æ„ cuda ç‰ˆæœ¬å’Œpytorchçš„ç‰ˆæœ¬ä¸€å®šè¦åŒ¹é…ï¼Œè¿™é‡Œæˆ‘è¸©äº†å‘</div>2024-06-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/3b/dd/f2/3513c633.jpg" width="30px"><span>å¼  Â·ä¸‡å²ï¼</span> ğŸ‘ï¼ˆ8ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ç°åœ¨æ˜¯24å¹´7æœˆ15ï¼Œåˆšåˆšç»“æŸè¿™ä¸ªæ¨¡å‹éƒ¨ç½²æ¨¡å—ã€‚æˆ‘ä½¿ç”¨çš„æ˜¯é˜¿é‡Œäº‘çš„PAIå¹³å°ï¼Œå¦‚æœæœ‰äººå’Œæˆ‘ä¸€æ ·å¸Œæœ›æˆ‘èƒ½å¸®åˆ°ä½ ä»¬ã€‚
1.git clone https:&#47;&#47;github.com&#47;THUDM&#47;ChatGLM3æ¢æˆgit clone https:&#47;&#47;gitee.com&#47;mirrors&#47;chatglm3ã€‚å› ä¸ºé˜¿é‡Œäº‘ä¸æ”¯æŒHF
2.ä¸‹è½½æ¨¡å‹ä¸è¦ç”¨git clone https:&#47;&#47;huggingface.co&#47;THUDM&#47;chatglm3-6bï¼Œæˆ‘å°è¯•è¿‡å„ç§å„æ ·çš„lfsï¼Œéƒ½ä¸å¥½ç”¨ã€‚å…ˆpip install modelscopeï¼Œç„¶åä½¿ç”¨pythonä»£ç from modelscope import snapshot_download
model_dir = snapshot_download(&quot;ZhipuAI&#47;chatglm3-6b&quot;, revision = &quot;v1.0.0&quot;)ï¼Œä»–ä¼šä¸‹è½½åˆ°cacheåŒºï¼Œä½¿ç”¨linuxåŸºæœ¬æŒ‡ä»¤ç§»è¿‡æ¥å°±å¥½
3.MODEL_PATH = os.environ.get(&#39;MODEL_PATH&#39;, &#39;..&#47;model&#39;)è¿™é‡Œï¼Œä¸€å®šè¦ç”¨ç»å¯¹åœ°å€ï¼ï¼ï¼ï¼
4.UnicodeDecodeError: &#39;utf-8&#39; codec can&#39;t decode byte 0xe8 in position 24: invalid continuation byteå¦‚æœæœ‰ç¼–ç é—®é¢˜ï¼Œå‘½ä»¤è¡Œæ”¹ç¼–ç export LANGUAGE=en_US.UTF-8ï¼Œå› ä¸ºä»–ä¸€å¼€å§‹æ˜¯zh_CN.UTF-8ï¼Œä¸€å®šè¦æ”¹æˆen_US.UTF-8ã€‚è¾“å…¥localeæ£€æŸ¥ä¸€ä¸‹ï¼Œç¡®ä¿éƒ½æ˜¯en_US.UTF-8
5.ä½¿ç”¨ç»¼åˆwebé‚£ä¸ªæ¡ˆä¾‹ä¸­ï¼Œè®°å¾—å»clientä¸­æ”¹ä¸€ä¸‹# MODEL_PATH = os.environ.get(&#39;MODEL_PATH&#39;, &#39;THUDM&#47;chatglm3-6b&#39;)
MODEL_PATH = os.environ.get(&#39;MODEL_PATH&#39;, &#39;&#47;mnt&#47;workspace&#47;modelscope&#47;hub&#47;ZhipuAI&#47;chatglm3-6b&#39;)
è€Œä¸”ï¼Œè¿™é‡Œtransformerså’Œhuggingface_hubç‰ˆæœ¬ä¸èƒ½å¤ªé«˜ï¼Œæˆ‘çš„transformeræ˜¯4.30.2ï¼Œhuggingface_hubæ˜¯0.19.0</div>2024-07-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/c5/8f/80443115.jpg" width="30px"><span>å¾®ç¬‘çš„å‘æ—¥è‘µ</span> ğŸ‘ï¼ˆ5ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>æˆ‘æœ¬åœ°è·‘èµ·æ¥äº†   redmi G 2020  Windows ç¯å¢ƒ ï¼Œ  æ˜¾å¡ï¼š RTX 3060 laptop  å‚è€ƒ çš„æ˜¯ 
https:&#47;&#47;www.bilibili.com&#47;video&#47;BV1ce411J7nZ&#47;?p=33&amp;spm_id_from=pageDriver&amp;vd_source=c16aa13fad5b13a7c51efcfcad58e883

https:&#47;&#47;www.bilibili.com&#47;read&#47;cv29866295&#47;

å¾ˆè¯¦ç»† </div>2024-07-06</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/xfclWEPQ7szTZnKqnX9icSbgDWV0VAib3Cyo8Vg0OG3Usby88ic7ZgO2ho5lj0icOWI4JeJ70zUBiaTW1xh1UCFRPqA/132" width="30px"><span>Geek_6bdb4e</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>å›½äº§ä¹Ÿèƒ½æˆä¸ºæ¨èç†ç”±å—</div>2024-06-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/d4/44/0ec958f4.jpg" width="30px"><span>Eleven</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>å¤§æ¨¡å‹çš„å‚æ•°æŒ‡çš„æ˜¯åœ¨æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­éœ€è¦å­¦ä¹ å’Œç¡®å®šçš„å˜é‡æˆ–æ•°å€¼ã€‚è¿™äº›å‚æ•°å†³å®šäº†æ¨¡å‹å¦‚ä½•å¤„ç†è¾“å…¥æ•°æ®å¹¶ç”Ÿæˆç›¸åº”çš„è¾“å‡ºã€‚åœ¨æ·±åº¦å­¦ä¹ å’Œè‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸï¼Œæ¨¡å‹çš„å‚æ•°æ•°é‡é€šå¸¸ä¸æ¨¡å‹çš„å¤æ‚æ€§å’ŒåŠŸèƒ½å¼ºå¤§ç¨‹åº¦æœ‰å…³ã€‚</div>2024-06-12</li><br/><li><img src="" width="30px"><span>Geek_5203b4</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>å­¦ä¹ æ‰“å¡~æƒ³è¯·æ•™è€å¸ˆä¸€ä¸ªé—®é¢˜ï¼Œtemperatureå’Œtop_på¯¹ç”Ÿæˆçš„ç»“æœå½±å“å¤§å—ï¼Ÿå¦‚ä½•æµ‹è¯•åˆ°æœ€ä½³çš„æ•°å€¼å‘¢ï¼Ÿè°¢è°¢è€å¸ˆï¼</div>2024-06-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/96/23/a5cd0e1b.jpg" width="30px"><span>go home</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>çˆ²ä»€éº½ä¸ç”¨LLaMA3å‘¢ï¼Œå®ƒåœ¨æ¨ç†ä¸Šé¢æ›´åŠ å…·æœ‰å„ªå‹¢ã€‚</div>2024-08-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/a0/a4/b060c723.jpg" width="30px"><span>é˜¿æ–¯è’‚èŠ¬</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ã€Œå¦‚æœä½ çš„ç”µè„‘æœ‰ GPUï¼Œä½†æ˜¯æ˜¾å­˜ä¸å¤Ÿï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹æ¨¡å‹åŠ è½½è„šæœ¬ï¼Œåœ¨ 4-bit é‡åŒ–ä¸‹è¿è¡Œï¼Œåªéœ€è¦ 6GB å·¦å³çš„æ˜¾å­˜å°±å¯ä»¥è¿›è¡Œæµç¨‹æ¨ç†ã€‚ã€å¦‚æœæ²¡æœ‰GPUå‘¢ï¼Œæ€ä¹ˆè·‘é‡åŒ–ï¼Ÿ

winæœ¬ï¼Œ32G memï¼Œçº¯cpu è·‘è¿˜æ˜¯æŒºåƒåŠ›çš„ï¼Œé€Ÿåº¦æ…¢åˆ°æ€€ç–‘äººç”Ÿã€‚ä»Šå¤©æŠ˜è…¾äº†ä¸‹ä½¿ç”¨ chatglm.cpp æˆåŠŸéƒ¨ç½²äº†é‡åŒ–ç‰ˆï¼Œé€Ÿåº¦æ æ æ»´ã€‚</div>2024-07-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/d4/44/0ec958f4.jpg" width="30px"><span>Eleven</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ5ï¼‰<div>RuntimeError: Internal: could not parse ModelProto from ..&#47;model&#47;tokenizer.model</div>2024-06-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg" width="30px"><span>å¼ ç”³å‚²</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ç¬¬4è®²æ‰“å¡~
å…³äºæ€è€ƒé¢˜ï¼Œé—®äº†ä¸‹ChatGPTï¼Œå›ç­”å¦‚ä¸‹ï¼š
å¤§æ¨¡å‹çš„å‚æ•°æŒ‡çš„æ˜¯æ¨¡å‹ä¸­çš„å¯è°ƒæ•´çš„å˜é‡ï¼Œè¿™äº›å˜é‡å†³å®šäº†æ¨¡å‹å¦‚ä½•å¤„ç†è¾“å…¥æ•°æ®å¹¶ç”Ÿæˆè¾“å‡ºã€‚åœ¨äººå·¥æ™ºèƒ½å’Œæœºå™¨å­¦ä¹ ä¸­ï¼Œå‚æ•°æ˜¯æ¨¡å‹å­¦ä¹ å’Œé€‚åº”æ–°æ•°æ®çš„å…³é”®éƒ¨åˆ†ã€‚å¸¸è§çš„å‚æ•°å¦‚æƒé‡ï¼ˆwï¼‰å’Œåç½®ï¼ˆbï¼‰ã€‚</div>2024-06-12</li><br/><li><img src="" width="30px"><span>Geek_0a4616</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆ å¤§æ¨¡å‹ æœ€ç»ˆæ¨ç†å‡ºæ¥çš„æ˜¯ä¸ªæ•°å­—ï¼Œæ•°å­—å’Œè¯æ±‡çš„æ˜ å°„å…³ç³» æ˜¯å­˜åœ¨æƒé‡æ–‡ä»¶ https:&#47;&#47;huggingface.co&#47;THUDM&#47;chatglm3-6b é‡Œé¢çš„å—ï¼Ÿ</div>2024-09-22</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEJVo4SoLPrD4iauzuPMy4F63fsUhicZTeGbYrQTc9rB1kkMgoSGgTgxkLCRSKbFc0GicXBwq4hU9tH4EClnwWIYrp6ARalcvayQiauzWlZrQS0GAA/132" width="30px"><span>èµµé¹</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>pip3 install -r requirements.txt æ‰§è¡ŒæŠ¥é”™ï¼Œæ—¥å¿—å¦‚ä¸‹ï¼Œè¯·é—®å¦‚ä½•è§£å†³ï¼Ÿè°¢è°¢ï¼

  ERROR: Command errored out with exit status 1:
   command: &#47;Library&#47;Developer&#47;CommandLineTools&#47;usr&#47;bin&#47;python3 &#47;Library&#47;Developer&#47;CommandLineTools&#47;Library&#47;Frameworks&#47;Python3.framework&#47;Versions&#47;3.9&#47;lib&#47;python3.9&#47;site-packages&#47;pip&#47;_vendor&#47;pep517&#47;in_process&#47;_in_process.py get_requires_for_build_wheel &#47;var&#47;folders&#47;d_&#47;zyrnlk3j65l1rrm5vlz_khnm0000gn&#47;T&#47;tmpi1loqnkg
       cwd: &#47;private&#47;var&#47;folders&#47;d_&#47;zyrnlk3j65l1rrm5vlz_khnm0000gn&#47;T&#47;pip-install-axuijjbp&#47;vllm_bde8e7d4069844fcbf5e5312fb56958f
  Complete output (20 lines):
  fatal: not a git repository (or any of the parent directories): .git
  setup.py:56: RuntimeWarning: Failed to get commit hash:
  Command &#39;[&#39;git&#39;, &#39;rev-parse&#39;, &#39;HEAD&#39;]&#39; returned non-zero exit status 128.
    embed_commit_hash()
  Traceback (most recent call last):
    File &quot;&#47;Library&#47;Developer&#47;CommandLineTools&#47;Library&#47;Frameworks&#47;Python3.framework&#47;Versions&#47;3.9&#47;lib&#47;python3.9&#47;site-packages&#47;pip&#47;_vendor&#47;pep517&#47;in_process&#47;_in_process.py&quot;, line 349, in &lt;module&gt;
      main()
    File &quot;&#47;Library&#47;Developer&#47;CommandLineTools&#47;Library&#47;Frameworks&#47;Python3.framework&#47;Versions&#47;3.9&#47;lib&#47;python3.9&#47;site-packages&#47;pip&#47;_vendor&#47;pep517&#47;in_process&#47;_in_process.py&quot;, line 331, in main
      json_out[&#39;return_val&#39;] = hook(**hook_input[&#39;kwargs&#39;])
    File &quot;&#47;Library&#47;Developer&#47;CommandLineTools&#47;Library&#47;Frameworks&#47;Python3.framework&#47;Versions&#47;3.9&#47;lib&#47;python3.9&#47;site-packages&#47;pip&#47;_vendor&#47;pep517&#47;in_process&#47;_in_process.py&quot;, line 117, in get_requires_for_build_wheel
      return hook(config_settings)
    File &quot;&#47;Library&#47;Developer&#47;CommandLineTools&#47;Library&#47;Frameworks&#47;Python3.framework&#47;Versions&#47;3.9&#47;lib&#47;python3.9&#47;site-packages&#47;setuptools&#47;build_meta.py&quot;, line 154, in get_requires_for_build_wheel
      return self._get_build_requires(
    File &quot;&#47;Library&#47;Developer&#47;CommandLineTools&#47;Library&#47;Frameworks&#47;Python3.framework&#47;Versions&#47;3.9&#47;lib&#47;python3.9&#47;site-packages&#47;setuptools&#47;build_meta.py&quot;, line 135, in _get_build_requires</div>2024-08-02</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM4Tkl5dibyG2Wriah2P5FR2dib3KiarXOmoVONicO2yGkoDwLtC0XIjYCiaziaEjYTte3cOuAdxAv5xkCNGdYq841DZePI/132" width="30px"><span>åºŸç‰©ç‚¹å¿ƒçš„é»„é‡‘æ—¶ä»£</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ä¸ºå•¥ä¸ç›´æ¥ç”¨ollamaéƒ¨ç½²æœ¬åœ°æ¨¡å‹å‘¢ï¼Ÿ</div>2024-07-27</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/1G2rlRgNalXbcUnHibRNMibAeHQhWoKNl4e4EgkiawDynZZiaO4W3vSSMtlYEKrt6e7GW4mcu1sjcs7bGKjl0vRhWQ/132" width="30px"><span>Twein</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æ‰§è¡Œpip install -r requirements.txtæŠ¥é”™ï¼šGetting requirements to build wheel ... error
  error: subprocess-exited-with-error
  Ã— Getting requirements to build wheel did not run successfully.
  â”‚ exit code: 1
  â•°â”€&gt; [20 lines of output]
      Traceback (most recent call last):
        File &quot;D:\tools\python\Lib\site-packages\pip\_vendor\pyproject_hooks\_in_process\_in_process.py&quot;, line 353, in &lt;module&gt;
          main()
        File &quot;D:\tools\python\Lib\site-packages\pip\_vendor\pyproject_hooks\_in_process\_in_process.py&quot;, line 335, in main
          json_out[&#39;return_val&#39;] = hook(**hook_input[&#39;kwargs&#39;])
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File &quot;D:\tools\python\Lib\site-packages\pip\_vendor\pyproject_hooks\_in_process\_in_process.py&quot;, line 118, in get_requires_for_build_wheel
          return hook(config_settings)
                 ^^^^^^^^^^^^^^^^^^^^^
        File &quot;C:\Users\twein\AppData\Local\Temp\pip-build-env-y57aktmf\overlay\Lib\site-packages\setuptools\build_meta.py&quot;, line 327, in get_requires_for_build_wheel
          return self._get_build_requires(config_settings, requirements=[])
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File &quot;C:\Users\twein\AppData\Local\Temp\pip-build-env-y57aktmf\overlay\Lib\site-packages\setuptools\build_meta.py&quot;, line 297, in _get_build_requires
          self.run_setup()
        File &quot;C:\Users\twein\AppData\Local\Temp\pip-build-env-y57aktmf\overlay\Lib\site-packages\setuptools\build_meta.py&quot;, line 313, in run_setup
          exec(code, locals())
        File &quot;&lt;string&gt;&quot;, line 12, in &lt;module&gt;
        File &quot;C:\Users\twein\AppData\Local\Temp\pip-build-env-y57aktmf\overlay\Lib\site-packages\torch\__init__.py&quot;, line 143, in &lt;module&gt;
          raise err
      OSError: [WinError 126] æ‰¾ä¸åˆ°æŒ‡å®šçš„æ¨¡å—ã€‚ Error loading &quot;C:\Users\twein\AppData\Local\Temp\pip-build-env-y57aktmf\overlay\Lib\site-packages\torch\lib\fbgemm.dll&quot; or one of its dependencies.
</div>2024-07-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/c6/d9/9058e13c.jpg" width="30px"><span>é»„è“‰ Jessie</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>MAC M2 proçš„ç”µè„‘å®‰è£…ChatGLM3çš„ä¾èµ–æŠ¥é”™ï¼Œ AssertionError: vLLM only supports Linux platform (including WSL).åº”è¯¥æ˜¯vllmè¿™ä¸ªåŒ…ä¸æ”¯æŒ</div>2024-07-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/c5/8f/80443115.jpg" width="30px"><span>å¾®ç¬‘çš„å‘æ—¥è‘µ</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æˆ‘çš„ç”µè„‘æ˜¯ redmi G 2020  RTX 3060 laptop  </div>2024-07-06</li><br/><li><img src="" width="30px"><span>Geek_e9e5f5</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆè¯·æ•™æ‚¨ä¸ªé—®é¢˜ï¼Œå¤§æ¨¡å‹æœ¬åœ°éƒ¨ç½²çš„æƒ…å†µï¼Œå†éƒ¨ç½²åŠ¨ä½œç»“æŸåï¼Œåªæ˜¯éƒ¨ç½²äº†å¤§æ¨¡å‹ä»£ç å‘¢ï¼Ÿè¿˜æ˜¯ä¹ŸåŒ…æ‹¬å¤§æ¨¡å‹è®­ç»ƒä¹‹åå®ƒæ‹¥æœ‰çš„æ‰€æœ‰è®°å¿†çŸ¥è¯†èŠ‚ç‚¹ï¼ˆè¿™å—ä¸çŸ¥é“è¿™ä¹ˆæè¿°æ˜¯ä¸æ˜¯å‡†ç¡®ï¼‰</div>2024-07-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/33/74/d9d143fa.jpg" width="30px"><span>silentyears</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è¯·é—®ä¸‹è½½çš„æ¨¡å‹å’Œä¸‹è½½çš„ä»£ç æœ‰ä»€ä¹ˆåŒºåˆ«</div>2024-07-02</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erG6I79WlHDjs51JOff9GBibD4Fh2PhITQMvmh2aTUVzH2BKia1tFLLoQr7VFeZddywwRoZlVUyhDDQ/132" width="30px"><span>Geek_frank</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æ‰“å¡ç¬¬å››è¯¾ã€‚ å¤§æ¨¡å‹çš„æœ¬åœ°éƒ¨ç½²ä½¿ç”¨æºç æœ¬åœ°éƒ¨ç½²å¯ä»¥æ˜¯å¯ä»¥ï¼Œä½†æ˜¯æ„Ÿè§‰å°±æ˜¯å¤ªéº»çƒ¦ã€‚æ˜¯ä¸æ˜¯å¯ä»¥ç”¨ollamaè¿™ç§å·¥å…·æ¥æ‰˜ç®¡å¤§æ¨¡å‹ï¼Œéƒ¨ç½²å’Œè¿è¡Œéƒ½ç”±ollamaæ¥å®ç°ã€‚è€Œä¸”å¯ä»¥å®ç°ä¸åŒæ¨¡å‹çš„åˆ‡æ¢</div>2024-07-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/38/24/14/4b9add72.jpg" width="30px"><span>å¤é¾™é£</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>å®‰è£…æ¨¡å‹ä¹‹åï¼Œè¿™ä¸ªæŠ¥é”™å’‹æå•Š
root@autodl-container-966c4d9eb4-c83428bd:~&#47;chatglm&#47;chatglm3&#47;basic_demo# python cli_demo.py
Traceback (most recent call last):
  File &quot;cli_demo.py&quot;, line 8, in &lt;module&gt;
    tokenizer = AutoTokenizer.from_pretrained(TOKENIZER_PATH, trust_remote_code=True)
  File &quot;&#47;root&#47;miniconda3&#47;lib&#47;python3.8&#47;site-packages&#47;transformers&#47;models&#47;auto&#47;tokenization_auto.py&quot;, line 847, in from_pretrained
    return tokenizer_class.from_pretrained(
  File &quot;&#47;root&#47;miniconda3&#47;lib&#47;python3.8&#47;site-packages&#47;transformers&#47;tokenization_utils_base.py&quot;, line 2089, in from_pretrained
    return cls._from_pretrained(
  File &quot;&#47;root&#47;miniconda3&#47;lib&#47;python3.8&#47;site-packages&#47;transformers&#47;tokenization_utils_base.py&quot;, line 2311, in _from_pretrained
    tokenizer = cls(*init_inputs, **init_kwargs)
  File &quot;&#47;root&#47;.cache&#47;huggingface&#47;modules&#47;transformers_modules&#47;chatglm3-6b&#47;tokenization_chatglm.py&quot;, line 109, in __init__    self.tokenizer = SPTokenizer(vocab_file)
  File &quot;&#47;root&#47;.cache&#47;huggingface&#47;modules&#47;transformers_modules&#47;chatglm3-6b&#47;tokenization_chatglm.py&quot;, line 18, in __init__
    self.sp_model = SentencePieceProcessor(model_file=model_path)
  File &quot;&#47;root&#47;miniconda3&#47;lib&#47;python3.8&#47;site-packages&#47;sentencepiece&#47;__init__.py&quot;, line 468, in Init
    self.Load(model_file=model_file, model_proto=model_proto)
  File &quot;&#47;root&#47;miniconda3&#47;lib&#47;python3.8&#47;site-packages&#47;sentencepiece&#47;__init__.py&quot;, line 961, in Load
    return self.LoadFromFile(model_file)
  File &quot;&#47;root&#47;miniconda3&#47;lib&#47;python3.8&#47;site-packages&#47;sentencepiece&#47;__init__.py&quot;, line 316, in LoadFromFile
    return _sentencepiece.SentencePieceProcessor_LoadFromFile(self, arg)
RuntimeError: Internal: could not parse ModelProto from ..&#47;chatglm3-6b&#47;tokenizer.model</div>2024-06-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/92/ab/7ba4218a.jpg" width="30px"><span>JACOB</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æœ¬æ–‡ä»‹ç»äº†å•æœºéƒ¨ç½²éå¸¸å¥½ï¼Œè¯·é—®åˆ†å¸ƒå¼éƒ¨ç½²æ€ä¹ˆæï¼Œå¤šæœºå¤šGPU</div>2024-06-26</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELtOO0HKrj5SI5JSlmwiaCvaF6GLiaTmf5NX88OZaO3HymTAGTeIoicBUjqzmMF6sF5raPFjuqLFibrrw/132" width="30px"><span>gesanri</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è¯·é—®ä¸‹ï¼Œè¿™ç¯‡æ–‡ç« é‡Œä¸¾çš„ä¾‹å­ï¼Œå’Œgptè¿›è¡Œå¯¹è¯ä¹Ÿéœ€è¦gpuå—ï¼Ÿè¿˜æ˜¯è¯´è®­ç»ƒå’Œå¾®è°ƒçš„æ—¶å€™æ‰éœ€è¦gpuå‘¢ï¼Ÿ</div>2024-06-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/20/02/6f/7e125dd5.jpg" width="30px"><span>å…ƒæ°”ğŸ£ ğŸ‡¨ğŸ‡³</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ5ï¼‰<div>æ“ä½œç³»ç»Ÿå¿…é¡»æ˜¯Linux ç¯å¢ƒå—ï¼Ÿwindows è¡Œä¸è¡Œï¼Ÿ</div>2024-06-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/6a/a2/f9efd9dc.jpg" width="30px"><span>æ˜¥å’Œæ™¯æ˜</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>root@eais-bjeg6jkdvfi9w77spgwf-cc9d4cd9f-9n8q6:&#47;mnt&#47;workspace&#47;ChatGLM3# python basic_demo&#47;cli_demo.py 
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 7&#47;7 [00:03&lt;00:00,  2.01it&#47;s]
æ¬¢è¿ä½¿ç”¨ ChatGLM3-6B æ¨¡å‹ï¼Œè¾“å…¥å†…å®¹å³å¯è¿›è¡Œå¯¹è¯ï¼Œclear æ¸…ç©ºå¯¹è¯å†å²ï¼Œstop ç»ˆæ­¢ç¨‹åº

ç”¨æˆ·ï¼šä½ æ˜¯è°

ChatGLMï¼š2024-06-21 17:02:25.171267: I tensorflow&#47;core&#47;platform&#47;cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-06-21 17:02:26.264294: W tensorflow&#47;compiler&#47;tf2tensorrt&#47;utils&#47;py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Traceback (most recent call last):
  File &quot;&#47;mnt&#47;workspace&#47;ChatGLM3&#47;basic_demo&#47;cli_demo.py&quot;, line 59, in &lt;module&gt;
    main()
  File &quot;&#47;mnt&#47;workspace&#47;ChatGLM3&#47;basic_demo&#47;cli_demo.py&quot;, line 45, in main
    for response, history, past_key_values in model.stream_chat(tokenizer, query, history=history, top_p=1,
  File &quot;&#47;usr&#47;local&#47;lib&#47;python3.10&#47;site-packages&#47;torch&#47;utils&#47;_contextlib.py&quot;, line 35, in generator_context
    response = gen.send(None)
  File &quot;&#47;root&#47;.cache&#47;huggingface&#47;modules&#47;transformers_modules&#47;chatglm3-6b&#47;modeling_chatglm.py&quot;, line 1075, in stream_chat
    response = tokenizer.decode(outputs)
  File &quot;&#47;usr&#47;local&#47;lib&#47;python3.10&#47;site-packages&#47;transformers&#47;tokenization_utils_base.py&quot;, line 3809, in decode
.....
UnicodeDecodeError: &#39;ascii&#39; codec can&#39;t decode byte 0xe6 in position 0: ordinal not in range(128)</div>2024-06-21</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/19/29/4a8214b7.jpg" width="30px"><span>Bug Killer</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>æ‰§è¡Œpip install -r requirements.txt ä¸€ç›´æŠ¥é”™
Installing build dependencies ... done
  Getting requirements to build wheel ... error
  error: subprocess-exited-with-error
  
  Ã— Getting requirements to build wheel did not run successfully.
  â”‚ exit code: 1
  â•°â”€&gt; [18 lines of output]
      Traceback (most recent call last):
        File &quot;&#47;Users&#47;liuga&#47;ai&#47;ChatGLM3&#47;path&#47;to&#47;venv&#47;lib&#47;python3.12&#47;site-packages&#47;pip&#47;_vendor&#47;pyproject_hooks&#47;_in_process&#47;_in_process.py&quot;, line 353, in &lt;module&gt;
          main()
        File &quot;&#47;Users&#47;liuga&#47;ai&#47;ChatGLM3&#47;path&#47;to&#47;venv&#47;lib&#47;python3.12&#47;site-packages&#47;pip&#47;_vendor&#47;pyproject_hooks&#47;_in_process&#47;_in_process.py&quot;, line 335, in main
          json_out[&#39;return_val&#39;] = hook(**hook_input[&#39;kwargs&#39;])
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File &quot;&#47;Users&#47;liuga&#47;ai&#47;ChatGLM3&#47;path&#47;to&#47;venv&#47;lib&#47;python3.12&#47;site-packages&#47;pip&#47;_vendor&#47;pyproject_hooks&#47;_in_process&#47;_in_process.py&quot;, line 118, in get_requires_for_build_wheel
          return hook(config_settings)
                 ^^^^^^^^^^^^^^^^^^^^^
        File &quot;&#47;private&#47;var&#47;folders&#47;nb&#47;kdvtrmzj52q1c5pq4brf50y00000gp&#47;T&#47;pip-build-env-arr1_sd0&#47;overlay&#47;lib&#47;python3.12&#47;site-packages&#47;setuptools&#47;build_meta.py&quot;, line 325, in get_requires_for_build_wheel
          return self._get_build_requires(config_settings, requirements=[&#39;wheel&#39;])
</div>2024-06-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/4f/f2/41f3907d.jpg" width="30px"><span>jimmy</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>ä¸æ”¯æŒMAC M3Proæœ¬åœ°éƒ¨ç½²,å®‰è£…ä¾èµ–æ—¶é”™è¯¯ä¿¡æ¯ AssertionError: vLLM only supports Linux platform (including WSL).</div>2024-06-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1b/16/65/ae88c7ad.jpg" width="30px"><span>ä»»å¸…å…µ</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>requirements.txt ä¸­æœ‰ä¸€ä¸ª vllm&gt;=0.4.2ï¼Œè¿™ä¸ªåŒ…å®‰è£…æ—¶æŠ¥é”™ï¼š

AssertionError: vLLM only supports Linux platform (including WSL).

æœç´¢äº†ä¸€ä¸‹è¿™ä¸ªåŒ…ç›®å‰ä¸æ”¯æŒwindowsç¯å¢ƒï¼Œè¯·é—®ä¸€ä¸‹è¿™ä¸ªè¯¥å¦‚ä½•è§£å†³å•Šï¼Ÿ</div>2024-11-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1e/5d/b4/9d2c2e03.jpg" width="30px"><span>Percy Hon</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æˆ‘åœ¨AWSçš„EC2ä¸Šéƒ¨ç½²çš„ï¼Œå®ä¾‹è§„æ ¼æ˜¯16æ ¸ï¼Œ64GiBå†…å­˜ï¼Œæ˜¾å¡æ˜¯NVIDIA T4 Tensor Core GPUsã€‚éƒ¨ç½²æ²¡é—®é¢˜ï¼Œä½†æ˜¯æ•´ä¸ªåº”ç­”è¿‡ç¨‹éå¸¸æ…¢ï¼Œå¤§æ¦‚ä¸€åˆ†é’Ÿç”Ÿæˆä¸€ä¸ªå­—</div>2025-02-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/07/2c/180075e0.jpg" width="30px"><span>å°è±ª</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>æˆ‘æ˜¯4070sçš„æ˜¾å¡
ç¬¬ä¸€æ¬¡è·‘çš„æ—¶å€™ï¼Œæ¨¡å‹åŠ è½½ä»£ç å¦‚ä¸‹ï¼š
AutoModel.from_pretrained(MODEL_PATH, trust_remote_code=True, device_map=&quot;auto&quot;).eval()
è¿è¡Œèµ·æ¥åï¼Œç»ˆç«¯ä¼šæ˜¾ç¤ºï¼šâ€œSome parameters are on the meta device because they were offloaded to the cpuâ€, å¹¶ä¸”æ¨ç†é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œæ€€ç–‘æ˜¯åœ¨ç”¨CPUè¿›è¡Œæ¨ç†ã€‚
ç¬¬äºŒæ¬¡æŠŠdevice_mapæ”¹æˆäº†&quot;cuda&quot;ï¼š
AutoModel.from_pretrained(MODEL_PATH, trust_remote_code=True, device_map=&quot;cuda&quot;).eval()
æ¨ç†é€Ÿåº¦æ˜æ˜¾åŠ å¿«äº†
è¿™æ˜¯ä»€ä¹ˆåŸå› å‘¢</div>2025-02-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/0c/ca/6173350b.jpg" width="30px"><span>ç¥å¥‡å°æ‡’æ‡’</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>ä½¿ç”¨glm-4-9b-chatæ¨¡å‹ã€‚éœ€è¦10Gæ˜¾å­˜ã€‚
åœ¨Intel(R) Core(TM) i5-10500 CPU
32gå†…å­˜
3060 12Gæ˜¾å¡çš„æƒ…å†µä¸‹å¼‚å¸¸å¡é¡¿</div>2025-01-16</li><br/>
</ul>