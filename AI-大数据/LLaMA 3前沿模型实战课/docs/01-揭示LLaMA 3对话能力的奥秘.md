ä½ å¥½ï¼Œæˆ‘æ˜¯Tylerã€‚ä»Šå¤©æˆ‘ä»¬æ­£å¼å¼€å§‹å­¦ä¹ LLaMA 3çš„èƒ½åŠ›æ¨¡å‹ã€‚

è¿‡å»çš„ä¸€å¹´ä¸­ï¼Œå¤§æ¨¡å‹æŠ€æœ¯å¾—åˆ°äº†å¹¿æ³›è®¤å¯ï¼Œå…¨è¡Œä¸šå¯¹å¤§æ¨¡å‹çš„æŠ•å…¥ä¹Ÿåœ¨ä¸æ–­å¢åŠ ã€‚å¼€æºç¤¾åŒºæ¶Œç°äº†è®¸å¤šä¼˜ç§€çš„æ¨¡å‹å’Œæ¡†æ¶ï¼Œæ¨åŠ¨äº†å¤§æ¨¡å‹æŠ€æœ¯çš„æ™®åŠå’Œåº”ç”¨ã€‚åœ¨è¿™ä¸€å¹´çš„æ—¶é—´é‡Œï¼ŒLLaMA ç³»åˆ—æ¨¡å‹ä¹Ÿç»å†äº†å¿«é€Ÿçš„å‘å±•ï¼Œä» LLaMA 2 åˆ° LLaMA 3ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†æ€§èƒ½å’Œåº”ç”¨ä¸Šçš„æ˜¾è‘—æå‡ã€‚

æœ¬å­£ä¸“æ ä¸­ï¼Œæˆ‘å°†é‡‡ç”¨â€œLearn by doingâ€çš„æ–¹æ³•ï¼Œé€šè¿‡ç®€æ´çš„ç¤ºä¾‹ï¼Œæ·±å…¥å‰–æå¤§æ¨¡å‹æŠ€æœ¯çš„æœ¬è´¨ã€‚æˆ‘ä»¬å°†æ¢è®¨LLaMA 3çš„èƒ½åŠ›æ¨¡å‹ï¼Œè¯¦ç»†è§£æå¤§æ¨¡å‹æŠ€æœ¯çš„å„ä¸ªæ–¹é¢ï¼Œå¹¶æ·±å…¥åˆ°ä½ åœ¨ä½¿ç”¨LLaMA 3è¿‡ç¨‹ä¸­ä¼šé‡åˆ°çš„å„ç§ç»†èŠ‚ã€‚

åœ¨ç¬¬ä¸€è®²ä¸­ï¼Œæˆ‘å°†è¯¦ç»†ä»‹ç»LLaMA 3æ¨¡å‹çš„æ ¸å¿ƒèƒ½åŠ›â€”â€”å¯¹è¯ç”Ÿæˆï¼Œå¹¶å±•ç¤ºå®ƒåœ¨æ–‡æœ¬ç”Ÿæˆæ–¹é¢çš„å¼ºå¤§æ½œåŠ›ã€‚

## åŸºæœ¬æ“ä½œï¼šç”Ÿæˆå†…å®¹

é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹LLaMA 3çš„æ ¸å¿ƒèƒ½åŠ›ã€‚LLaMA 3ä¸»è¦ä¾èµ–äºNext Token Predictionï¼ˆä¸‹ä¸€ä¸ªè¯é¢„æµ‹ï¼‰æœºåˆ¶ï¼Œé€šè¿‡é¢„æµ‹ä¸‹ä¸€ä¸ªè¯æ¥ç”Ÿæˆè¿è´¯çš„å¯¹è¯ã€‚è¿™ç§æœºåˆ¶åŸºäºæµ·é‡æ–‡æœ¬æ•°æ®çš„è®­ç»ƒï¼Œä½¿æ¨¡å‹èƒ½å¤Ÿæ•æ‰è¯­è¨€çš„æ¨¡å¼å’Œè§„å¾‹ï¼Œç”Ÿæˆç¬¦åˆä¸Šä¸‹æ–‡é€»è¾‘çš„æ–‡æœ¬å†…å®¹ã€‚

### Next Token Prediction

Next Token Predictionæ˜¯å¤§è¯­è¨€æ¨¡å‹ç”Ÿæˆæ–‡æœ¬çš„åŸºç¡€ã€‚æ¨¡å‹å¤„ç†è¾“å…¥æ–‡æœ¬çš„æ­¥éª¤å¦‚ä¸‹ï¼š
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ15ï¼‰</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/0f/86/fb/4add1a52.jpg" width="30px"><span>å…µæˆˆ</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>Typlerè€å¸ˆçš„è¯¾ç¨‹ä»£ç åœ°å€ï¼šhttps:&#47;&#47;github.com&#47;tylerelyt&#47;llamaã€‚ä¸è¿‡å½“å‰å·¥ç¨‹ç›®å½•ä¸‹ç¼ºå°‘requirements.txtï¼Œå¯èƒ½ä¼šè®©è®¸å¤šè·‘ä»£ç çš„åŒå­¦é‡åˆ°åŒ…ä¾èµ–ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œæˆ‘æäº†ä¸€ä¸ªissueï¼š
https:&#47;&#47;github.com&#47;tylerelyt&#47;llama&#47;issues&#47;1
å¸Œæœ›Typerè€å¸ˆæœ‰ç©ºè¡¥å……ä¸‹ :ï¼‰</div>2024-10-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/86/fb/4add1a52.jpg" width="30px"><span>å…µæˆˆ</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>Tylerè€å¸ˆæä¾›ç¤ºä¾‹å¾ˆä¸é”™ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªç¤ºä¾‹ï¼Œæœ€å¥½åŠ ä¸Šmax_lengthå‚æ•°ï¼Œå¦åˆ™å¯èƒ½ä¼šä¸€ç›´è¿è¡Œåœä¸ä¸‹æ¥ï¼Œå¦‚ä¸‹ï¼š
with torch.no_grad():
    outputs = model.generate(**inputs, max_length=100)</div>2024-10-17</li><br/><li><img src="" width="30px"><span>edward</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>è¯·é—®è€å¸ˆ å®éªŒç¯å¢ƒéœ€è¦ä»€ä¹ˆæ ·çš„æœºå™¨é…ç½®ï¼Ÿ</div>2024-10-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/da/72/2feef236.jpg" width="30px"><span>keep move</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ç¤ºä¾‹ä»£ç å¦‚ä½•èƒ½è¿è¡Œèµ·æ¥ï¼Œèƒ½å¦å†™ä¸ªç®€è¦çš„æ­¥éª¤å‘¢</div>2024-10-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/51/65/35f711a1.jpg" width="30px"><span>J Sun</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æ¨¡å‹æ€ä¹ˆä¸‹è½½
</div>2024-10-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/ee/44/324e3cd6.jpg" width="30px"><span>Sï¼</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>m2ç³»åˆ—çš„mac proè¿è¡Œdemoä¸€ç›´æ²¡æœ‰è¾“å‡ºç»“æœï¼Œconsoleè¾“å‡ºå¦‚ä¸‹ï¼š
import sys; print(&#39;Python %s on %s&#39; % (sys.version, sys.platform))
&#47;usr&#47;local&#47;bin&#47;python3.10 -X pycache_prefix=&#47;Users&#47;salesonlee&#47;Library&#47;Caches&#47;JetBrains&#47;PyCharm2024.1&#47;cpython-cache &#47;Applications&#47;PyCharm.app&#47;Contents&#47;plugins&#47;python&#47;helpers&#47;pydev&#47;pydevd.py --multiprocess --qt-support=auto --client 127.0.0.1 --port 57101 --file &#47;Users&#47;salesonlee&#47;IT&#47;dev_codes&#47;PythonProjects&#47;tylerelyt-llama&#47;chapter1&#47;lesson1&#47;example1.py 
Connected to pydev debugger (build 241.17890.14)
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4&#47;4 [01:00&lt;00:00, 15.10s&#47;it]
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)


è¯·é—®æ˜¯å› ä¸ºæ²¡æœ‰ä½¿ç”¨gpuä¹ˆï¼Œæ˜¯ç¡¬ä»¶é…ç½®çš„åŸå› ï¼Ÿè¿˜æ˜¯å…¶å®ƒåŸå› ï¼Ÿ </div>2024-11-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/ee/44/324e3cd6.jpg" width="30px"><span>Sï¼</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>import sys; print(&#39;Python %s on %s&#39; % (sys.version, sys.platform))
&#47;usr&#47;local&#47;bin&#47;python3.10 -X pycache_prefix=&#47;Users&#47;salesonlee&#47;Library&#47;Caches&#47;JetBrains&#47;PyCharm2024.1&#47;cpython-cache &#47;Applications&#47;PyCharm.app&#47;Contents&#47;plugins&#47;python&#47;helpers&#47;pydev&#47;pydevd.py --multiprocess --qt-support=auto --client 127.0.0.1 --port 57101 --file &#47;Users&#47;salesonlee&#47;IT&#47;dev_codes&#47;PythonProjects&#47;tylerelyt-llama&#47;chapter1&#47;lesson1&#47;example1.py 
Connected to pydev debugger (build 241.17890.14)
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4&#47;4 [01:00&lt;00:00, 15.10s&#47;it]
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
</div>2024-11-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/ee/44/324e3cd6.jpg" width="30px"><span>Sï¼</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>m2ç³»åˆ—mac pro è¿è¡Œdemoä¸€ç›´æ²¡æœ‰è¾“å‡ºç»“æœï¼Œconsoleè¾“å‡ºå¦‚ä¸‹ï¼š</div>2024-11-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/ee/44/324e3cd6.jpg" width="30px"><span>Sï¼</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>è¿è¡Œè¯¾ç¨‹demoéœ€è¦ä»€ä¹ˆæ ·çš„ç¢ç¡¬ä»¶èµ„æºï¼Ÿ</div>2024-11-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/ee/44/324e3cd6.jpg" width="30px"><span>Sï¼</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>Mac proå¯ä»¥è¿è¡Œllama3ä¹ˆ</div>2024-11-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/da/72/2feef236.jpg" width="30px"><span>keep move</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>pythonå­¦ä¹ é‚£ä¸ªæ–¹å‘ pytorchå—</div>2024-10-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/36/9a/cb/53af3dc6.jpg" width="30px"><span>Orson</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div># agent_a.py
from common import create_app

app = create_app(&quot;system: ä½ æ˜¯ä¸€ä¸ªç†Ÿæ‚‰äººå·¥æ™ºèƒ½æŠ€æœ¯çš„è®¡ç®—æœºç§‘å­¦å®¶ã€‚&quot;)

if __name__ == &#39;__main__&#39;:
    app.run(port=5000)
è¯·é—®ï¼Œåœ¨ç”¨AutoDLè¿™æ ·çš„äº‘æœåŠ¡çš„æ—¶å€™ï¼Œapp.run(port=5000ï¼‰éœ€è¦æ€ä¹ˆä¿®æ”¹ã€‚æˆ–è€…ï¼Œagent_aã€bã€cå’Œcommonæ–‡ä»¶éœ€è¦åšå“ªäº›ä¿®æ”¹ï¼Ÿ</div>2024-10-21</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/d3/89/fcf95d32.jpg" width="30px"><span>Allen</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>ä½ å¥½ï¼Œè¯·é—®åœ¨è°ƒç”¨æ¨¡å‹æ—¶with torch.no_grad():ä¸ºå•¥åé¢å‡ æ®µé‡Œæ²¡æœ‰åŠ ï¼Ÿä¼šå½±å“æ€§èƒ½å—ï¼Ÿè°¢è°¢ã€‚</div>2024-10-20</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLCrJQ4AZe8VrDkR6IO03V4Tda9WexVT4zZiahBjLSYOnZb1Y49JvD2f70uQwYSMibUMQvib9NmGxEiag/132" width="30px"><span>Dowen Liu</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>ä¸ç”¨python èƒ½ä¸èƒ½åšåŒæ ·çš„è°ƒç”¨å‘¢ï¼Ÿæ¯”å¦‚ç›´æ¥è°ƒç”¨æ¥å£ã€spring ai </div>2024-10-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/51/65/35f711a1.jpg" width="30px"><span>J Sun</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æ¨¡å‹åœ¨å“ªé‡Œä¸‹è½½</div>2024-10-18</li><br/>
</ul>