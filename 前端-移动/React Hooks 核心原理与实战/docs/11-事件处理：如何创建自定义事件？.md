ä½ å¥½ï¼Œæˆ‘æ˜¯ç‹æ²›ã€‚ä»Šå¤©æˆ‘ä»¬æ¥èŠèŠ React ä¸­çš„äº‹ä»¶å¤„ç†ã€‚

æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ React ä¸­ï¼Œçˆ¶å­ç»„ä»¶çš„äº¤äº’æ˜¯é€šè¿‡ propsã€‚è¿™ä¸ªæœºåˆ¶å…¶å®æ˜¯åŒå‘çš„ï¼Œçˆ¶ç»„ä»¶é€šè¿‡ props æŠŠå€¼ä¼ é€’ç»™å­ç»„ä»¶ï¼Œè€Œå­ç»„ä»¶åˆ™é€šè¿‡æš´éœ²ä¸€äº›äº‹ä»¶ï¼Œç»™çˆ¶ç»„ä»¶åé¦ˆåˆ°ä¸€äº›çŠ¶æ€æˆ–æ•°æ®ã€‚è¿™ä¸¤ä¸ªç¯èŠ‚æ˜¯**ç»„ä»¶ä¹‹é—´é€šä¿¡çš„åŸºç¡€**ï¼Œæ‰€ä»¥éƒ½éœ€è¦ç†Ÿç»ƒæŒæ¡ã€‚

æˆ‘ä»¬å‰é¢çš„è¯¾ç¨‹å·²ç»æœ‰å¾ˆå¤šé€šè¿‡ props ä»çˆ¶ç»„ä»¶ä¼ é€’å‚æ•°çš„å­ç»„ä»¶çš„åœºæ™¯äº†ï¼Œé‚£ä¹ˆä»Šå¤©è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°±æ¥çœ‹çœ‹åœ¨ React ä¸­äº‹ä»¶çš„æœºåˆ¶æ˜¯æ€æ ·çš„ï¼Œä»åŸç†å‡ºå‘ï¼Œå¸®åŠ©ä½ æ·±å…¥ç†è§£ã€‚åŒæ—¶å‘¢ï¼Œä¹Ÿæ¥å­¦ä¹ ä¸€ä¸‹å¯¹äºè‡ªå®šä¹‰äº‹ä»¶ï¼Œä¸€èˆ¬éƒ½æœ‰å“ªäº›å…¸å‹çš„åº”ç”¨åœºæ™¯ï¼Œå¸®åŠ©ä½ å­¦ä»¥è‡´ç”¨ã€‚

## åœ¨ React ä¸­ä½¿ç”¨åŸç”Ÿäº‹ä»¶

åœ¨ React ä¸­è¿›è¡Œäº‹ä»¶ç›‘å¬çš„è¯­æ³•ï¼Œå’ŒåŸç”Ÿ DOM äº‹ä»¶çš„å†™æ³•æ˜¯éå¸¸ç±»ä¼¼çš„ï¼Œéƒ½æ˜¯åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸ŠåŠ ä¸€ä¸ªå›è°ƒå‡½æ•°çš„å±æ€§æ¥å®ç°ã€‚æ¯”å¦‚ä¸‹é¢çš„æ–¹å¼ï¼š

```
<button onClick={handler}>Hello</button> 

```

åœ¨å‰é¢çš„è¯¾ç¨‹ä¸­æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†å¾ˆå¤šç±»ä¼¼çš„ä¾‹å­ã€‚ä¸è¿‡è¿˜è¦ç‰¹åˆ«è¯´æ˜ä¸€ç‚¹ï¼Œå¯¹äºåŸç”Ÿ DOM çš„äº‹ä»¶ï¼Œæ ‡å‡†çš„çš„å†™æ³•å¯èƒ½æ˜¯éƒ½å°å†™ï¼Œæ¯”å¦‚ onclickã€‚ä½†æ˜¯åœ¨ React ä¸­ï¼Œéƒ½æ˜¯**çº¦å®šä½¿ç”¨éª†é©¼ä½“**ï¼ˆCamel Caseï¼‰ã€‚

é€šè¿‡è¿™ä¸ªè§„å¾‹ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šä¸ç”¨åˆ»æ„å»è®°äº‹ä»¶çš„åç§°ã€‚æˆ‘ä»¬è¦å§‹ç»ˆè®°å¾—ï¼Œ**åªè¦åŸç”Ÿ DOM æœ‰çš„äº‹ä»¶ï¼Œåœ¨ React ä¸­åŸºæœ¬éƒ½å¯ä»¥ä½¿ç”¨ï¼Œåªæ˜¯å†™æ³•ä¸Šé‡‡ç”¨éª†é©¼ä½“å°±å¯ä»¥äº†**ï¼Œæ¯”å¦‚ onMouseOverã€onChange ç­‰ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ15ï¼‰</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/15/08/e2/138689a8.jpg" width="30px"><span>lugusliu</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>â€é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦åœ¨ useEffect é‡Œå»åš window.addEventListnerï¼Œç„¶ååœ¨è¿”å›çš„å›è°ƒå‡½æ•°é‡Œå» window.removeEventListnerï¼Œå®ç°èµ·æ¥å°±å¾ˆéº»çƒ¦â€œ
è¿™é‡Œæœ‰ä¸¤å¤„ç¬”è¯¯
addEventListner -&gt; addEventListener
removeEventListner -&gt; removeEventListener</div>2021-08-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/02/12/ce3dc4c8.jpg" width="30px"><span>å–µå’ªçˆ±åƒè‚‰</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è¿½ç•ªï½</div>2021-06-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1a/ec/4d/1551ed5f.jpg" width="30px"><span>å‰ç«¯å°çŒª</span> ğŸ‘ï¼ˆ12ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>å› ä¸ºç‚¹å‡»äº†ä¸¤ä¸ªæŒ‰é’®ä¼šè§¦å‘ä¸¤ä¸ªäº‹ä»¶ï¼Œæ‰€ä»¥æˆ‘çš„æƒ³æ³•æ˜¯ï¼šä½¿ç”¨æ•°ç»„çš„æ–¹å¼å­˜å‚¨keyå€¼,keyupçš„æ—¶å€™æ¸…ç©ºæ•°ç»„å°±è¡Œäº†ï¼š
const useKeyPress = (domNode = document.body) =&gt; {
    const [keys, setKeys] = useState([])
    useEffect(() =&gt; {
      const handleKeyPress = evt =&gt; {
        setKeys(prevKeys =&gt; {
          if (prevKeys.length !== 2) {
            return [...prevKeys, evt.keyCode]
          } else {
            return prevKeys
          }
        })
      }
      domNode.addEventListener(&#39;keypress&#39;, handleKeyPress)
      return () =&gt; {
        domNode.removeEventListener(&#39;keypress&#39;, handleKeyPress)
      }
    }, [domNode])
    return keys
  }</div>2021-06-20</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqz5X60ickyQOBejQZOiaunoQkgJo82jFDkXQosdCkHLpoe6YibL8uup10udh303eyCpROkia40xXkHSw/132" width="30px"><span>Geek_9ab0c7</span> ğŸ‘ï¼ˆ11ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>åŸºæœ¬æ€è·¯ï¼š 1. ä½¿ç”¨æ•°ç»„å­˜å€¼ï¼›2. keydownå­˜å€¼ï¼› 3. å½“keyupè¡¨ç¤ºå•é”®æˆ–è€…ç»„åˆé”®æŒ‰é”®ç»“æŸï¼Œæ¸…ç©ºæ•°ç»„ï¼›4.å½“é•¿æŒ‰é”®ä¸æ”¾ä¼šå¤šæ¬¡è§¦å‘äº‹ä»¶ï¼Œæ‰€ä»¥setKeyæ—¶éœ€è¦å»é‡

export default function useKeyPress (dom = document.body) {
  const [key, setKey] = useState([])
  const isNext = useRef(true) &#47;&#47; å½“keyupä¹‹åï¼ŒisNextç½®ä¸ºtrueè¡¨ç¤ºåˆæ˜¯æ–°ä¸€è½®çš„æŒ‰é”®ç›‘å¬
  useEffect(() =&gt; {
    const handleKeyPress = (e) =&gt; {
      if (e.type === &#39;keydown&#39;) {
        if (isNext.current) setKey([])
        setKey(keys =&gt; [...new Set([...keys, e.key])]) &#47;&#47; å»é‡
        isNext.current = false
      } else {
        isNext.current = true
      }
    }
    dom.addEventListener(&#39;keydown&#39;, handleKeyPress)
    dom.addEventListener(&#39;keyup&#39;, handleKeyPress)
    return () =&gt; {
      dom.removeEventListener(&#39;keydown&#39;, handleKeyPress)
      dom.removeEventListener(&#39;keydown&#39;, handleKeyPress)
    }
  }, [dom])
  return key.join(&#39;,&#39;)
}</div>2021-07-14</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJlZSBIXmp6PVpCXnicMR1dD4K4u2FWt4LQhicf9mJiaFOHUntft5nTzAptb8gzF4M8Yvs6gocykf22w/132" width="30px"><span>çŸ¥æ•…</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>æˆ‘ä»¬å¯ä»¥åˆ†åˆ«å»ºç«‹2ä¸ªæŒ‰ä¸‹çš„hooksï¼Œä»¥åŠ2ä¸ªå¼¹èµ·çš„hooks, ä½œä¸ºæ•°æ®æºï¼Œç”¨ä¸€ä¸ªuseMemoæ¥ç›‘æ§è¿™2ä¸ªé”®åŒæ—¶æŒ‰ä¸‹çš„çŠ¶æ€</div>2021-08-29</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJVpGfkkH8rqNia2V5xib71YaHn1bpCV9BNJn6ONPfGJGs2Giceoibn6ArNauJvjvHhtCNob8HCUDs7kA/132" width="30px"><span>ç½—å¤§æ˜</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>è€å¸ˆï¼Œè¿™æ ·æ‹¿åˆ°çš„keyCodeå…¶å®æ˜¯ä¸Šä¸€æ¬¡çš„å§ï¼ˆä¹Ÿå°±æ˜¯ä¸Šä¸€ä¸ªæŒ‰ä¸‹çš„é”®ç›˜ï¼‰è¿™æ ·ç›‘å¬æ²¡ä»€ä¹ˆæ„ä¹‰å•Š</div>2021-08-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/fc/c3/0991edfc.jpg" width="30px"><span>é—²é—²</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆæˆ‘æœ‰ä¸¤ä¸ªé—®é¢˜ï¼Œéº»çƒ¦å¸®å¿™è§£ç­”ä¸‹ï¼š
1ã€ä¸Šé¢ç»‘å®šçš„é”®ç›˜äº‹ä»¶ï¼Œhooké‡Œé¢å…·ä½“ä»€ä¹ˆæ—¶å€™å›æ³¨é”€è¿™ä¸ªäº‹ä»¶å‘¢ï¼Œä»£ç æ˜¯åœ¨useEffect returné‡Œé¢æ³¨é”€äº‹ä»¶çš„ï¼Œé‚£å…·ä½“ä»€ä¹ˆæ—¶å€™ä¼šèµ°åˆ°è¿™ä»£ç é‡Œé¢å‘¢ï¼Ÿ
2ã€çœ‹åˆ°è¿™èŠ‚è¯¾å†…å®¹æˆ‘æƒ³èµ·æ¥ä¹‹å‰å°è£…ç»„ä»¶é‡åˆ°çš„ä¸€ä¸ªé—®é¢˜ï¼Œåœºæ™¯æ˜¯è¿™æ ·ï¼Œéœ€è¦å°è£…ä¸€ä¸ªå…¬å…±ç»„ä»¶ï¼Œå¯¹äºåŸç”Ÿdomäº‹ä»¶éœ€è¦éƒ½èƒ½æ¥å—ï¼Œå…¶ä»–çš„æ— ç”¨çš„propsä¸æƒ³æ¥å—ï¼Œreactæœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥åˆ¤æ–­å½“å‰çš„äº‹ä»¶æ˜¯ä¸æ˜¯åŸç”Ÿdomæ”¯æŒçš„å—ï¼Ÿè¿˜æ˜¯è¯´æˆ‘éœ€è¦å…·ä½“çš„ä¸€ä¸€ç½—åˆ—ï¼Ÿ</div>2021-06-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/30/f7/3b/b94f06bb.jpg" width="30px"><span>23568</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>const useKeyPress = (domNode = document.body) =&gt; {
  const [key, setKey] = useState([]);
  useEffect(() =&gt; {
    const handleKeyPress = (evt) =&gt; {
      if (key.length === 2) {
        const tmpKey = [...key];
        tmpKey.shift();
        tmpKey.push(evt.key);
        setKey(tmpKey);
      } else {
        setKey((prev) =&gt; {
          return [...prev, evt.key];
        });
      }
    };
    domNode.addEventListener(&quot;keypress&quot;, handleKeyPress);
    return () =&gt; {
      domNode.removeEventListener(&quot;keypress&quot;, handleKeyPress);
    };
  }, [domNode, key]);
  return key;
};</div>2022-11-28</li><br/><li><img src="" width="30px"><span>INFRA_UEX</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>React åº”è¯¥ä¹Ÿå¯ä»¥åœ¨æ•è·é˜¶æ®µç›‘å¬äº‹ä»¶ã€‚ä¾‹å¦‚ `onClickCapture`ã€‚</div>2022-11-07</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/icyrQvzWBjcTzEhYrP62pImJSwSwxDh7X3VX87oTtIeSsMg3aSDMZKnKicynN9UBBsDeWaK3vzibD8ibHhrg2b5Cpg/132" width="30px"><span>Geek_d15b65</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>const useKeyPress = (domNode = document.body ) =&gt; {
  const [key1, setKey1] = useState(null);
  const [key2, setKey2] = useState(null);
  const [flag, setFlag] = useState(0);
  useEffect(() =&gt; {
    const handleKeyPress = (evt) =&gt; {
      &#47;&#47; è®¾ç½®ä¸¤ç§çŠ¶æ€ï¼Œ 0 æ˜¯key1ï¼Œ1æ˜¯key2
      if(flag === 0){
        setKey1(evt.keyCode);
        setKey2(null);
        setFlag(1);
      }else if (flag === 1){
        setKey2(evt.keyCode);
        setFlag(0);
      }

    };
    &#47;&#47; ç›‘å¬æŒ‰é”®äº‹ä»¶
    domNode.addEventListener(&#39;keypress&#39;, handleKeyPress);
    return () =&gt; {
      domNode.removeEventListener(&#39;keypress&#39;, handleKeyPress);
    }
  },[domNode, flag]);
  return { key1, key2 };
}
</div>2022-06-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/51/3f/d11288e4.jpg" width="30px"><span>æˆ‘æ˜¯æµ‹è¯•å°è¾¾äºº</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>const useKeyboard = (domNode = document.body) =&gt; {
  const [keys, setKeys] = useState([]);
  useEffect(() =&gt; {
    const handleKeyPress = evt =&gt; setKeys(keys =&gt; [...keys, evt.keyCode]);
    const handleKeyUp = evt =&gt; setKeys(keys =&gt; keys.filter(k =&gt; k !== evt.keyCode));
    domNode.addEventListener(&quot;keypress&quot;, handleKeyPress); &#47;&#47; æŒ‰ä¸‹
    domNode.addEventListener(&quot;keyup&quot;, handleKeyUp); &#47;&#47; æŒ‰ä¸‹
    return () =&gt; {
      &#47;&#47; æ¥è§¦ç›‘å¬æŒ‰é”®äº‹ä»¶
      domNode.removeEventListener(&quot;keypress&quot;, handleKeyPress);
      domNode.removeEventListener(&quot;keyup&quot;, handleKeyUp);
    };
  }, [domNode]);
  return keys;
}</div>2021-07-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/ee/e2/23e44221.jpg" width="30px"><span>ä½™ç†™</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>â€œå¦‚æœä½ çš„äº‹ä»¶å¤„ç†å‡½æ•°æ˜¯ä¼ é€’ç»™åŸç”ŸèŠ‚ç‚¹ï¼Œé‚£ä¹ˆä¸å†™ callbackï¼Œä¹Ÿå‡ ä¹ä¸ä¼šæœ‰ä»»ä½•æ€§èƒ½çš„å½±å“ã€‚â€
ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Œæ˜¯ä¸æ˜¯å› ä¸ºåŸç”ŸèŠ‚ç‚¹ï¼Œæœ¬æ¥å°±è¦ä¸æ–­æ¸²æŸ“</div>2021-06-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/28/65/f8/e68e8786.jpg" width="30px"><span>å´å°ä¸½</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ä¸å¤ªç†è§£[domNode]æœ‰å•¥ä½œç”¨ï¼Œä¸ç”¨å®ƒï¼Œä¾‹å­ä¹Ÿèƒ½æˆ</div>2021-06-21</li><br/><li><img src="" width="30px"><span>Free fall</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>å¯ä»¥æŒ‰å¤šä¸ª
const useKeypress = (node = document.body) =&gt; {
  const [key, setKey] = useState(null)

  function reset() {
    setKey(null)
  }

  useEffect(() =&gt; {
    function handleKeypress(e) {
      setKey((key) =&gt; key + &#39;,&#39; + e.keyCode)
    }

    node &amp;&amp; node.addEventListener(&#39;keypress&#39;, handleKeypress)

    return () =&gt; {
      node.removeEventListener(&#39;keypress&#39;, handleKeypress)
    }
  }, [node])

  return [key, reset]
}</div>2021-06-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/65/d7/4eda752c.jpg" width="30px"><span>é”™è¯¯ä»£ç 0000</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆï¼Œä¼šæœ‰è‡ªå®šä¹‰hookå˜›ã€‚ã€‚ æƒ³å¯¹å…¶åœºæ™¯å’Œå°è£…åŠ æ·±ç†è§£</div>2021-06-20</li><br/>
</ul>