ä½ å¥½ï¼Œæˆ‘æ˜¯é™ˆèˆªã€‚

åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å¸¦ä½ ä¸€èµ·å­¦ä¹ äº†Dartä¸­å¼‚æ­¥ä¸å¹¶å‘çš„æœºåˆ¶åŠå®ç°åŸç†ã€‚ä¸å…¶ä»–è¯­è¨€ç±»ä¼¼ï¼ŒDartçš„å¼‚æ­¥æ˜¯é€šè¿‡äº‹ä»¶å¾ªç¯ä¸é˜Ÿåˆ—å®ç°çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Futureæ¥å°è£…å¼‚æ­¥ä»»åŠ¡ã€‚è€Œå¦ä¸€æ–¹é¢ï¼Œå°½ç®¡Dartæ˜¯åŸºäºå•çº¿ç¨‹æ¨¡å‹çš„ï¼Œä½†ä¹Ÿæä¾›äº†Isolateè¿™æ ·çš„â€œå¤šçº¿ç¨‹â€èƒ½åŠ›ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥å……åˆ†åˆ©ç”¨ç³»ç»Ÿèµ„æºï¼Œåœ¨å¹¶å‘Isolateä¸­æå®šCPUå¯†é›†å‹çš„ä»»åŠ¡ï¼Œå¹¶é€šè¿‡æ¶ˆæ¯æœºåˆ¶é€šçŸ¥ä¸»Isolateè¿è¡Œç»“æœã€‚

å¼‚æ­¥ä¸å¹¶å‘çš„ä¸€ä¸ªå…¸å‹åº”ç”¨åœºæ™¯ï¼Œå°±æ˜¯ç½‘ç»œç¼–ç¨‹ã€‚ä¸€ä¸ªå¥½çš„ç§»åŠ¨åº”ç”¨ï¼Œä¸ä»…éœ€è¦æœ‰è‰¯å¥½çš„ç•Œé¢å’Œæ˜“ç”¨çš„äº¤äº’ä½“éªŒï¼Œä¹Ÿéœ€è¦å…·å¤‡å’Œå¤–ç•Œè¿›è¡Œä¿¡æ¯äº¤äº’çš„èƒ½åŠ›ã€‚è€Œé€šè¿‡ç½‘ç»œï¼Œä¿¡æ¯éš”ç¦»çš„å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯é—´å¯ä»¥å»ºç«‹ä¸€ä¸ªåŒå‘çš„é€šä¿¡é€šé“ï¼Œä»è€Œå®ç°èµ„æºè®¿é—®ã€æ¥å£æ•°æ®è¯·æ±‚å’Œæäº¤ã€ä¸Šä¼ ä¸‹è½½æ–‡ä»¶ç­‰æ“ä½œã€‚

ä¸ºäº†ä¾¿äºæˆ‘ä»¬å¿«é€Ÿå®ç°åŸºäºç½‘ç»œé€šé“çš„ä¿¡æ¯äº¤æ¢å®æ—¶æ›´æ–°Appæ•°æ®ï¼ŒFlutterä¹Ÿæä¾›äº†ä¸€ç³»åˆ—çš„ç½‘ç»œç¼–ç¨‹ç±»åº“å’Œå·¥å…·ã€‚å› æ­¤åœ¨ä»Šå¤©çš„åˆ†äº«ä¸­ï¼Œæˆ‘ä¼šé€šè¿‡ä¸€äº›å°ä¾‹å­ä¸ä½ è®²è¿°åœ¨Flutteråº”ç”¨ä¸­ï¼Œå¦‚ä½•å®ç°ä¸æœåŠ¡ç«¯çš„æ•°æ®äº¤äº’ï¼Œä»¥åŠå¦‚ä½•å°†äº¤äº’å“åº”çš„æ•°æ®æ ¼å¼åŒ–ã€‚

## Httpç½‘ç»œç¼–ç¨‹

æˆ‘ä»¬åœ¨é€šè¿‡ç½‘ç»œä¸æœåŠ¡ç«¯æ•°æ®äº¤äº’æ—¶ï¼Œä¸å¯é¿å…åœ°éœ€è¦ç”¨åˆ°ä¸‰ä¸ªæ¦‚å¿µï¼šå®šä½ã€ä¼ è¾“ä¸åº”ç”¨ã€‚

å…¶ä¸­ï¼Œ**å®šä½**ï¼Œå®šä¹‰äº†å¦‚ä½•å‡†ç¡®åœ°æ‰¾åˆ°ç½‘ç»œä¸Šçš„ä¸€å°æˆ–è€…å¤šå°ä¸»æœºï¼ˆå³IPåœ°å€ï¼‰ï¼›**ä¼ è¾“**ï¼Œåˆ™ä¸»è¦è´Ÿè´£åœ¨æ‰¾åˆ°ä¸»æœºåå¦‚ä½•é«˜æ•ˆä¸”å¯é åœ°è¿›è¡Œæ•°æ®é€šä¿¡ï¼ˆå³TCPã€UDPåè®®ï¼‰ï¼›è€Œ**åº”ç”¨**ï¼Œåˆ™è´Ÿè´£è¯†åˆ«åŒæ–¹é€šä¿¡çš„å†…å®¹ï¼ˆå³HTTPåè®®ï¼‰ã€‚

æˆ‘ä»¬åœ¨è¿›è¡Œæ•°æ®é€šä¿¡æ—¶ï¼Œå¯ä»¥åªä½¿ç”¨ä¼ è¾“å±‚åè®®ã€‚ä½†ä¼ è¾“å±‚ä¼ é€’çš„æ•°æ®æ˜¯äºŒè¿›åˆ¶æµï¼Œå¦‚æœæ²¡æœ‰åº”ç”¨å±‚ï¼Œæˆ‘ä»¬æ— æ³•è¯†åˆ«æ•°æ®å†…å®¹ã€‚å¦‚æœæƒ³è¦ä½¿ä¼ è¾“çš„æ•°æ®æœ‰æ„ä¹‰ï¼Œåˆ™å¿…é¡»è¦ç”¨åˆ°åº”ç”¨å±‚åè®®ã€‚ç§»åŠ¨åº”ç”¨é€šå¸¸ä½¿ç”¨HTTPåè®®ä½œåº”ç”¨å±‚åè®®ï¼Œæ¥å°è£…HTTPä¿¡æ¯ã€‚

åœ¨ç¼–ç¨‹æ¡†æ¶ä¸­ï¼Œä¸€æ¬¡HTTPç½‘ç»œè°ƒç”¨é€šå¸¸å¯ä»¥æ‹†è§£ä¸ºä»¥ä¸‹æ­¥éª¤ï¼š

1. åˆ›å»ºç½‘ç»œè°ƒç”¨å®ä¾‹clientï¼Œè®¾ç½®é€šç”¨è¯·æ±‚è¡Œä¸ºï¼ˆå¦‚è¶…æ—¶æ—¶é—´ï¼‰ï¼›
2. æ„é€ URIï¼Œè®¾ç½®è¯·æ±‚headerã€bodyï¼›
3. å‘èµ·è¯·æ±‚, ç­‰å¾…å“åº”ï¼›
4. è§£ç å“åº”çš„å†…å®¹ã€‚

å½“ç„¶ï¼ŒFlutterä¹Ÿä¸ä¾‹å¤–ã€‚åœ¨Flutterä¸­ï¼ŒHttpç½‘ç»œç¼–ç¨‹çš„å®ç°æ–¹å¼ä¸»è¦åˆ†ä¸ºä¸‰ç§ï¼šdart:ioé‡Œçš„HttpClientå®ç°ã€DartåŸç”Ÿhttpè¯·æ±‚åº“å®ç°ã€ç¬¬ä¸‰æ–¹åº“dioå®ç°ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä¾æ¬¡ä¸ºä½ è®²è§£è¿™ä¸‰ç§æ–¹å¼ã€‚

### HttpClient

HttpClientæ˜¯dart:ioåº“ä¸­æä¾›çš„ç½‘ç»œè¯·æ±‚ç±»ï¼Œå®ç°äº†åŸºæœ¬çš„ç½‘ç»œç¼–ç¨‹åŠŸèƒ½ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘å°†å’Œä½ åˆ†äº«ä¸€ä¸ªå®ä¾‹ï¼Œå¯¹ç…§ç€ä¸Šé¢æåˆ°çš„ç½‘ç»œè°ƒç”¨æ­¥éª¤ï¼Œæ¥æ¼”ç¤ºHttpClientå¦‚ä½•ä½¿ç”¨ã€‚

åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªHttpClienç½‘ç»œè°ƒç”¨å®ä¾‹ï¼Œè®¾ç½®äº†å…¶è¶…æ—¶æ—¶é—´ä¸º5ç§’ã€‚éšåæ„é€ äº†Flutterå®˜ç½‘çš„URIï¼Œå¹¶è®¾ç½®äº†è¯·æ±‚Headerçš„user-agentä¸ºCustom-UAã€‚ç„¶åå‘èµ·è¯·æ±‚ï¼Œç­‰å¾…Flutterå®˜ç½‘å“åº”ã€‚æœ€ååœ¨æ”¶åˆ°å“åº”åï¼Œæ‰“å°å‡ºè¿”å›ç»“æœï¼š

```
get() async {
  //åˆ›å»ºç½‘ç»œè°ƒç”¨ç¤ºä¾‹ï¼Œè®¾ç½®é€šç”¨è¯·æ±‚è¡Œä¸º(è¶…æ—¶æ—¶é—´)
  var httpClient = HttpClient();
  httpClient.idleTimeout = Duration(seconds: 5);
  
  //æ„é€ URIï¼Œè®¾ç½®user-agentä¸º"Custom-UA"
  var uri = Uri.parse("https://flutter.dev");
  var request = await httpClient.getUrl(uri);
  request.headers.add("user-agent", "Custom-UA");
  
  //å‘èµ·è¯·æ±‚ï¼Œç­‰å¾…å“åº”
  var response = await request.close();
  
  //æ”¶åˆ°å“åº”ï¼Œæ‰“å°ç»“æœ
  if (response.statusCode == HttpStatus.ok) {
    print(await response.transform(utf8.decoder).join());
  } else {
    print('Error: \nHttp status ${response.statusCode}');
  }
}
```

å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨HttpClientæ¥å‘èµ·ç½‘ç»œè°ƒç”¨è¿˜æ˜¯ç›¸å¯¹æ¯”è¾ƒç®€å•çš„ã€‚

è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºç½‘ç»œè¯·æ±‚æ˜¯å¼‚æ­¥è¡Œä¸ºï¼Œå› æ­¤**åœ¨Flutterä¸­ï¼Œæ‰€æœ‰ç½‘ç»œç¼–ç¨‹æ¡†æ¶éƒ½æ˜¯ä»¥Futureä½œä¸ºå¼‚æ­¥è¯·æ±‚çš„åŒ…è£…**ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨awaitä¸asyncè¿›è¡Œéé˜»å¡çš„ç­‰å¾…ã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥æ³¨å†Œthenï¼Œä»¥å›è°ƒçš„æ–¹å¼è¿›è¡Œç›¸åº”çš„äº‹ä»¶å¤„ç†ã€‚

### http

HttpClientä½¿ç”¨æ–¹å¼è™½ç„¶ç®€å•ï¼Œä½†å…¶æ¥å£å´æš´éœ²äº†ä¸å°‘å†…éƒ¨å®ç°ç»†èŠ‚ã€‚æ¯”å¦‚ï¼Œå¼‚æ­¥è°ƒç”¨æ‹†åˆ†å¾—è¿‡ç»†ï¼Œé“¾æ¥éœ€è¦è°ƒç”¨æ–¹ä¸»åŠ¨å…³é—­ï¼Œè¯·æ±‚ç»“æœæ˜¯å­—ç¬¦ä¸²ä½†å´éœ€è¦æ‰‹åŠ¨è§£ç ç­‰ã€‚

httpæ˜¯Dartå®˜æ–¹æä¾›çš„å¦ä¸€ä¸ªç½‘ç»œè¯·æ±‚ç±»ï¼Œç›¸æ¯”äºHttpClientï¼Œæ˜“ç”¨æ€§æå‡äº†ä¸å°‘ã€‚åŒæ ·ï¼Œæˆ‘ä»¬ä»¥ä¸€ä¸ªä¾‹å­æ¥ä»‹ç»httpçš„ä½¿ç”¨æ–¹æ³•ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å°†httpåŠ å…¥åˆ°pubspecä¸­çš„ä¾èµ–é‡Œï¼š

```
dependencies:
  http: '>=0.11.3+12'
```

åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œä¸HttpClientçš„ä¾‹å­ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬ä¹Ÿæ˜¯å…ˆåæ„é€ äº†httpç½‘ç»œè°ƒç”¨å®ä¾‹å’ŒFlutterå®˜ç½‘URIï¼Œåœ¨è®¾ç½®user-agentä¸ºCustom-UAåï¼Œå‘å‡ºè¯·æ±‚ï¼Œæœ€åæ‰“å°è¯·æ±‚ç»“æœï¼š

```
httpGet() async {
  //åˆ›å»ºç½‘ç»œè°ƒç”¨ç¤ºä¾‹
  var client = http.Client();

  //æ„é€ URI
  var uri = Uri.parse("https://flutter.dev");
  
  //è®¾ç½®user-agentä¸º"Custom-UA"ï¼Œéšåç«‹å³å‘å‡ºè¯·æ±‚
  http.Response response = await client.get(uri, headers : {"user-agent" : "Custom-UA"});

  //æ‰“å°è¯·æ±‚ç»“æœ
  if(response.statusCode == HttpStatus.ok) {
    print(response.body);
  } else {
    print("Error: ${response.statusCode}");
  }
}
```

å¯ä»¥çœ‹åˆ°ï¼Œç›¸æ¯”äºHttpClientï¼Œhttpçš„ä½¿ç”¨æ–¹å¼æ›´åŠ ç®€å•ï¼Œä»…éœ€ä¸€æ¬¡å¼‚æ­¥è°ƒç”¨å°±å¯ä»¥å®ç°åŸºæœ¬çš„ç½‘ç»œé€šä¿¡ã€‚

### dio

HttpClientå’Œhttpä½¿ç”¨æ–¹å¼è™½ç„¶ç®€å•ï¼Œä½†å…¶æš´éœ²çš„å®šåˆ¶åŒ–èƒ½åŠ›éƒ½ç›¸å¯¹è¾ƒå¼±ï¼Œå¾ˆå¤šå¸¸ç”¨çš„åŠŸèƒ½éƒ½ä¸æ”¯æŒï¼ˆæˆ–è€…å®ç°å¼‚å¸¸ç¹çï¼‰ï¼Œæ¯”å¦‚å–æ¶ˆè¯·æ±‚ã€å®šåˆ¶æ‹¦æˆªå™¨ã€Cookieç®¡ç†ç­‰ã€‚å› æ­¤å¯¹äºå¤æ‚çš„ç½‘ç»œè¯·æ±‚è¡Œä¸ºï¼Œæˆ‘æ¨èä½¿ç”¨ç›®å‰åœ¨Dartç¤¾åŒºäººæ°”è¾ƒé«˜çš„ç¬¬ä¸‰æ–¹dioæ¥å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘é€šè¿‡å‡ ä¸ªä¾‹å­æ¥å’Œä½ ä»‹ç»dioçš„ä½¿ç”¨æ–¹æ³•ã€‚ä¸httpç±»ä¼¼çš„ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æŠŠdioåŠ åˆ°pubspecä¸­çš„ä¾èµ–é‡Œï¼š

```
dependencies:
  dio: '>2.1.3'
```

åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œä¸å‰é¢HttpClientä¸httpä¾‹å­ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬ä¹Ÿæ˜¯å…ˆååˆ›å»ºäº†dioç½‘ç»œè°ƒç”¨å®ä¾‹ã€åˆ›å»ºURIã€è®¾ç½®Headerã€å‘å‡ºè¯·æ±‚ï¼Œæœ€åç­‰å¾…è¯·æ±‚ç»“æœï¼š

```
void getRequest() async {
  //åˆ›å»ºç½‘ç»œè°ƒç”¨ç¤ºä¾‹
  Dio dio = new Dio();
  
  //è®¾ç½®URIåŠè¯·æ±‚user-agentåå‘èµ·è¯·æ±‚
  var response = await dio.get("https://flutter.dev", options:Options(headers: {"user-agent" : "Custom-UA"}));
  
 //æ‰“å°è¯·æ±‚ç»“æœ
  if(response.statusCode == HttpStatus.ok) {
    print(response.data.toString());
  } else {
    print("Error: ${response.statusCode}");
  }
}
```

> è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåˆ›å»ºURIã€è®¾ç½®HeaderåŠå‘å‡ºè¯·æ±‚çš„è¡Œä¸ºï¼Œéƒ½æ˜¯é€šè¿‡dio.getæ–¹æ³•å®ç°çš„ã€‚è¿™ä¸ªæ–¹æ³•çš„optionså‚æ•°æä¾›äº†ç²¾ç»†åŒ–æ§åˆ¶ç½‘ç»œè¯·æ±‚çš„èƒ½åŠ›ï¼Œå¯ä»¥æ”¯æŒè®¾ç½®Headerã€è¶…æ—¶æ—¶é—´ã€Cookieã€è¯·æ±‚æ–¹æ³•ç­‰ã€‚è¿™éƒ¨åˆ†å†…å®¹ä¸æ˜¯ä»Šå¤©åˆ†äº«çš„é‡ç‚¹ï¼Œå¦‚æœä½ æƒ³æ·±å…¥ç†è§£çš„è¯ï¼Œå¯ä»¥è®¿é—®å…¶[APIæ–‡æ¡£](https://github.com/flutterchina/dio#dio-apis)å­¦ä¹ å…·ä½“ä½¿ç”¨æ–¹æ³•ã€‚

å¯¹äºå¸¸è§çš„ä¸Šä¼ åŠä¸‹è½½æ–‡ä»¶éœ€æ±‚ï¼Œdioä¹Ÿæä¾›äº†è‰¯å¥½çš„æ”¯æŒï¼šæ–‡ä»¶ä¸Šä¼ å¯ä»¥é€šè¿‡æ„å»ºè¡¨å•FormDataå®ç°ï¼Œè€Œæ–‡ä»¶ä¸‹è½½åˆ™å¯ä»¥ä½¿ç”¨downloadæ–¹æ³•æå®šã€‚

åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡FormDataåˆ›å»ºäº†ä¸¤ä¸ªå¾…ä¸Šä¼ çš„æ–‡ä»¶ï¼Œé€šè¿‡postæ–¹æ³•å‘é€è‡³æœåŠ¡ç«¯ã€‚downloadçš„ä½¿ç”¨æ–¹æ³•åˆ™æ›´ä¸ºç®€å•ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨è¯·æ±‚å‚æ•°ä¸­ï¼ŒæŠŠå¾…ä¸‹è½½çš„æ–‡ä»¶åœ°å€å’Œæœ¬åœ°æ–‡ä»¶åæä¾›ç»™dioå³å¯ã€‚å¦‚æœæˆ‘ä»¬éœ€è¦æ„ŸçŸ¥ä¸‹è½½è¿›åº¦ï¼Œå¯ä»¥å¢åŠ onReceiveProgresså›è°ƒå‡½æ•°ï¼š

```
//ä½¿ç”¨FormDataè¡¨å•æ„å»ºå¾…ä¸Šä¼ æ–‡ä»¶
FormData formData = FormData.from({
  "file1": UploadFileInfo(File("./file1.txt"), "file1.txt"),
  "file2": UploadFileInfo(File("./file2.txt"), "file1.txt"),

});
//é€šè¿‡postæ–¹æ³•å‘é€è‡³æœåŠ¡ç«¯
var responseY = await dio.post("https://xxx.com/upload", data: formData);
print(responseY.toString());

//ä½¿ç”¨downloadæ–¹æ³•ä¸‹è½½æ–‡ä»¶
dio.download("https://xxx.com/file1", "xx1.zip");

//å¢åŠ ä¸‹è½½è¿›åº¦å›è°ƒå‡½æ•°
dio.download("https://xxx.com/file1", "xx2.zip", onReceiveProgress: (count, total) {
	//do something      
});
```

æœ‰æ—¶ï¼Œæˆ‘ä»¬çš„é¡µé¢ç”±å¤šä¸ªå¹¶è¡Œçš„è¯·æ±‚å“åº”ç»“æœæ„æˆï¼Œè¿™å°±éœ€è¦ç­‰å¾…è¿™äº›è¯·æ±‚éƒ½è¿”å›åæ‰èƒ½åˆ·æ–°ç•Œé¢ã€‚åœ¨dioä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç»“åˆFuture.waitæ–¹æ³•è½»æ¾å®ç°ï¼š

```
//åŒæ—¶å‘èµ·ä¸¤ä¸ªå¹¶è¡Œè¯·æ±‚
List<Response> responseX= await Future.wait([dio.get("https://flutter.dev"),dio.get("https://pub.dev/packages/dio")]);

//æ‰“å°è¯·æ±‚1å“åº”ç»“æœ
print("Response1: ${responseX[0].toString()}");
//æ‰“å°è¯·æ±‚2å“åº”ç»“æœ
print("Response2: ${responseX[1].toString()}");
```

æ­¤å¤–ï¼Œä¸Androidçš„okHttpä¸€æ ·ï¼Œdioè¿˜æä¾›äº†è¯·æ±‚æ‹¦æˆªå™¨ï¼Œé€šè¿‡æ‹¦æˆªå™¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¯·æ±‚ä¹‹å‰ï¼Œæˆ–å“åº”ä¹‹ååšä¸€äº›ç‰¹æ®Šçš„æ“ä½œã€‚æ¯”å¦‚å¯ä»¥ä¸ºè¯·æ±‚optionç»Ÿä¸€å¢åŠ ä¸€ä¸ªheaderï¼Œæˆ–æ˜¯è¿”å›ç¼“å­˜æ•°æ®ï¼Œæˆ–æ˜¯å¢åŠ æœ¬åœ°æ ¡éªŒå¤„ç†ç­‰ç­‰ã€‚

åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¸ºdioå¢åŠ äº†ä¸€ä¸ªæ‹¦æˆªå™¨ã€‚åœ¨è¯·æ±‚å‘é€ä¹‹å‰ï¼Œä¸ä»…ä¸ºæ¯ä¸ªè¯·æ±‚å¤´éƒ½åŠ ä¸Šäº†è‡ªå®šä¹‰çš„user-agentï¼Œè¿˜å®ç°äº†åŸºæœ¬çš„tokenè®¤è¯ä¿¡æ¯æ£€æŸ¥åŠŸèƒ½ã€‚è€Œå¯¹äºæœ¬åœ°å·²ç»ç¼“å­˜äº†è¯·æ±‚urièµ„æºçš„åœºæ™¯ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¿”å›ç¼“å­˜æ•°æ®ï¼Œé¿å…å†æ¬¡ä¸‹è½½ï¼š

```
//å¢åŠ æ‹¦æˆªå™¨
dio.interceptors.add(InterceptorsWrapper(
    onRequest: (RequestOptions options){
      //ä¸ºæ¯ä¸ªè¯·æ±‚å¤´éƒ½å¢åŠ user-agent
      options.headers["user-agent"] = "Custom-UA";
      //æ£€æŸ¥æ˜¯å¦æœ‰tokenï¼Œæ²¡æœ‰åˆ™ç›´æ¥æŠ¥é”™
      if(options.headers['token'] == null) {
        return dio.reject("Error:è¯·å…ˆç™»å½•");
      } 
      //æ£€æŸ¥ç¼“å­˜æ˜¯å¦æœ‰æ•°æ®
      if(options.uri == Uri.parse('http://xxx.com/file1')) {
        return dio.resolve("è¿”å›ç¼“å­˜æ•°æ®");
      }
      //æ”¾è¡Œè¯·æ±‚
      return options;
    }
));

//å¢åŠ try catchï¼Œé˜²æ­¢è¯·æ±‚æŠ¥é”™
try {
  var response = await dio.get("https://xxx.com/xxx.zip");
  print(response.data.toString());
}catch(e) {
  print(e);
}
```

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºç½‘ç»œé€šä¿¡æœŸé—´æœ‰å¯èƒ½ä¼šå‡ºç°å¼‚å¸¸ï¼ˆæ¯”å¦‚ï¼ŒåŸŸåæ— æ³•è§£æã€è¶…æ—¶ç­‰ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä½¿ç”¨try-catchæ¥æ•è·è¿™äº›æœªçŸ¥é”™è¯¯ï¼Œé˜²æ­¢ç¨‹åºå‡ºç°å¼‚å¸¸ã€‚

é™¤äº†è¿™äº›åŸºæœ¬çš„ç”¨æ³•ï¼Œdioè¿˜æ”¯æŒè¯·æ±‚å–æ¶ˆã€è®¾ç½®ä»£ç†ï¼Œè¯ä¹¦æ ¡éªŒç­‰åŠŸèƒ½ã€‚ä¸è¿‡ï¼Œè¿™äº›é«˜çº§ç‰¹æ€§ä¸å±äºæœ¬æ¬¡åˆ†äº«çš„é‡ç‚¹ï¼Œæ•…ä¸å†èµ˜è¿°ï¼Œè¯¦æƒ…å¯ä»¥å‚è€ƒdioçš„[GitHubä¸»é¡µ](https://github.com/flutterchina/dio/blob/master/README-ZH.md)äº†è§£å…·ä½“ç”¨æ³•ã€‚

## JSONè§£æ

ç§»åŠ¨åº”ç”¨ä¸WebæœåŠ¡å™¨å»ºç«‹å¥½äº†è¿æ¥ä¹‹åï¼Œæ¥ä¸‹æ¥çš„ä¸¤ä¸ªé‡è¦å·¥ä½œåˆ†åˆ«æ˜¯ï¼šæœåŠ¡å™¨å¦‚ä½•ç»“æ„åŒ–åœ°å»æè¿°è¿”å›çš„é€šä¿¡ä¿¡æ¯ï¼Œä»¥åŠç§»åŠ¨åº”ç”¨å¦‚ä½•è§£æè¿™äº›æ ¼å¼åŒ–çš„ä¿¡æ¯ã€‚

### å¦‚ä½•ç»“æ„åŒ–åœ°æè¿°è¿”å›çš„é€šä¿¡ä¿¡æ¯ï¼Ÿ

åœ¨å¦‚ä½•ç»“æ„åŒ–åœ°å»è¡¨è¾¾ä¿¡æ¯ä¸Šï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°JSONã€‚JSONæ˜¯ä¸€ç§è½»é‡çº§çš„ã€ç”¨äºè¡¨è¾¾ç”±å±æ€§å€¼å’Œå­—é¢é‡ç»„æˆå¯¹è±¡çš„æ•°æ®äº¤æ¢è¯­è¨€ã€‚

ä¸€ä¸ªç®€å•çš„è¡¨ç¤ºå­¦ç”Ÿæˆç»©çš„JSONç»“æ„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```
String jsonString = '''
{
  "id":"123",
  "name":"å¼ ä¸‰",
  "score" : 95
}
''';
```

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºFlutterä¸æ”¯æŒè¿è¡Œæ—¶åå°„ï¼Œå› æ­¤å¹¶æ²¡æœ‰æä¾›åƒGsonã€Mantleè¿™æ ·è‡ªåŠ¨è§£æJSONçš„åº“æ¥é™ä½è§£ææˆæœ¬ã€‚åœ¨Flutterä¸­ï¼ŒJSONè§£æå®Œå…¨æ˜¯æ‰‹åŠ¨çš„ï¼Œå¼€å‘è€…è¦åšçš„äº‹æƒ…å¤šäº†ä¸€äº›ï¼Œä½†ä½¿ç”¨èµ·æ¥å€’ä¹Ÿç›¸å¯¹çµæ´»ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±çœ‹çœ‹Flutteråº”ç”¨æ˜¯å¦‚ä½•è§£æè¿™äº›æ ¼å¼åŒ–çš„ä¿¡æ¯ã€‚

### å¦‚ä½•è§£ææ ¼å¼åŒ–çš„ä¿¡æ¯ï¼Ÿ

æ‰€è°“æ‰‹åŠ¨è§£æï¼Œæ˜¯æŒ‡ä½¿ç”¨dart:convertåº“ä¸­å†…ç½®çš„JSONè§£ç å™¨ï¼Œå°†JSONå­—ç¬¦ä¸²è§£ææˆè‡ªå®šä¹‰å¯¹è±¡çš„è¿‡ç¨‹ã€‚ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå°†JSONå­—ç¬¦ä¸²ä¼ é€’ç»™JSON.decodeæ–¹æ³•è§£ææˆä¸€ä¸ªMapï¼Œç„¶åæŠŠè¿™ä¸ªMapä¼ ç»™è‡ªå®šä¹‰çš„ç±»ï¼Œè¿›è¡Œç›¸å…³å±æ€§çš„èµ‹å€¼ã€‚

ä»¥ä¸Šé¢è¡¨ç¤ºå­¦ç”Ÿæˆç»©çš„JSONç»“æ„ä¸ºä¾‹ï¼Œæˆ‘æ¥å’Œä½ æ¼”ç¤ºæ‰‹åŠ¨è§£æçš„ä½¿ç”¨æ–¹æ³•ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬æ ¹æ®JSONç»“æ„å®šä¹‰Studentç±»ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªå·¥å‚ç±»ï¼Œæ¥å¤„ç†Studentç±»å±æ€§æˆå‘˜ä¸JSONå­—å…¸å¯¹è±¡çš„å€¼ä¹‹é—´çš„æ˜ å°„å…³ç³»ï¼š

```
class Student{
  //å±æ€§idï¼Œåå­—ä¸æˆç»©
  String id;
  String name;
  int score;
  //æ„é€ æ–¹æ³•  
  Student({
    this.id,
    this.name,
    this.score
  });
  //JSONè§£æå·¥å‚ç±»ï¼Œä½¿ç”¨å­—å…¸æ•°æ®ä¸ºå¯¹è±¡åˆå§‹åŒ–èµ‹å€¼
  factory Student.fromJson(Map<String, dynamic> parsedJson){
    return Student(
        id: parsedJson['id'],
        name : parsedJson['name'],
        score : parsedJson ['score']
    );
  }
}
```

æ•°æ®è§£æç±»åˆ›å»ºå¥½äº†ï¼Œå‰©ä¸‹çš„äº‹æƒ…å°±ç›¸å¯¹ç®€å•äº†ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠJSONæ–‡æœ¬é€šè¿‡JSON.decodeæ–¹æ³•è½¬æ¢æˆMapï¼Œç„¶åæŠŠå®ƒäº¤ç»™Studentçš„å·¥å‚ç±»fromJsonæ–¹æ³•ï¼Œå³å¯å®ŒæˆStudentå¯¹è±¡çš„è§£æï¼š

```
loadStudent() {
  //jsonStringä¸ºJSONæ–‡æœ¬
  final jsonResponse = json.decode(jsonString);
  Student student = Student.fromJson(jsonResponse);
  print(student.name);
}
```

åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒJSONæ–‡æœ¬æ‰€æœ‰çš„å±æ€§éƒ½æ˜¯åŸºæœ¬ç±»å‹ï¼Œå› æ­¤æˆ‘ä»¬ç›´æ¥ä»JSONå­—å…¸å–å‡ºç›¸åº”çš„å…ƒç´ ä¸ºå¯¹è±¡èµ‹å€¼å³å¯ã€‚è€Œå¦‚æœJSONä¸‹é¢è¿˜æœ‰åµŒå¥—å¯¹è±¡å±æ€§ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ä¸­ï¼ŒStudentè¿˜æœ‰ä¸€ä¸ªteacherçš„å±æ€§ï¼Œæˆ‘ä»¬åˆè¯¥å¦‚ä½•è§£æå‘¢ï¼Ÿ

```
String jsonString = '''
{
  "id":"123",
  "name":"å¼ ä¸‰",
  "score" : 95,
  "teacher": {
    "name": "æå››",
    "age" : 40
  }
}
''';
```

è¿™é‡Œï¼Œteacherä¸å†æ˜¯ä¸€ä¸ªåŸºæœ¬ç±»å‹ï¼Œè€Œæ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚é¢å¯¹è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦ä¸ºæ¯ä¸€ä¸ªéåŸºæœ¬ç±»å‹å±æ€§åˆ›å»ºä¸€ä¸ªè§£æç±»ã€‚ä¸Studentç±»ä¼¼ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦ä¸ºå®ƒçš„å±æ€§teacheråˆ›å»ºä¸€ä¸ªè§£æç±»Teacherï¼š

```
class Teacher {
  //Teacherçš„åå­—ä¸å¹´é¾„
  String name;
  int age;
  //æ„é€ æ–¹æ³•
  Teacher({this.name,this.age});
  //JSONè§£æå·¥å‚ç±»ï¼Œä½¿ç”¨å­—å…¸æ•°æ®ä¸ºå¯¹è±¡åˆå§‹åŒ–èµ‹å€¼
  factory Teacher.fromJson(Map<String, dynamic> parsedJson){
    return Teacher(
        name : parsedJson['name'],
        age : parsedJson ['age']
    );
  }
}
```

ç„¶åï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨Studentç±»ä¸­ï¼Œå¢åŠ teacherå±æ€§åŠå¯¹åº”çš„JSONæ˜ å°„è§„åˆ™å³å¯ï¼š

```
class Student{
  ...
  //å¢åŠ teacherå±æ€§
  Teacher teacher;
  //æ„é€ å‡½æ•°å¢åŠ teacher
  Student({
    ...
    this.teacher
  });
  factory Student.fromJson(Map<String, dynamic> parsedJson){
    return Student(
        ...
        //å¢åŠ æ˜ å°„è§„åˆ™
        teacher: Teacher.fromJson(parsedJson ['teacher'])
    );
  }
}
```

å®Œæˆäº†teacherå±æ€§çš„æ˜ å°„è§„åˆ™æ·»åŠ ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»§ç»­ä½¿ç”¨Studentæ¥è§£æä¸Šè¿°çš„JSONæ–‡æœ¬äº†ï¼š

```
final jsonResponse = json.decode(jsonString);//å°†å­—ç¬¦ä¸²è§£ç æˆMapå¯¹è±¡
Student student = Student.fromJson(jsonResponse);//æ‰‹åŠ¨è§£æ
print(student.teacher.name);
```

å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡è¿™ç§æ–¹æ³•ï¼Œæ— è®ºå¯¹è±¡æœ‰å¤šå¤æ‚çš„éåŸºæœ¬ç±»å‹å±æ€§ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥åˆ›å»ºå¯¹åº”çš„è§£æç±»è¿›è¡Œå¤„ç†ã€‚

ä¸è¿‡åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„JSONæ•°æ®è§£æè¿˜æ˜¯åœ¨ä¸»Isolateä¸­å®Œæˆã€‚å¦‚æœJSONçš„æ•°æ®æ ¼å¼æ¯”è¾ƒå¤æ‚ï¼Œæ•°æ®é‡åˆå¤§ï¼Œè¿™ç§è§£ææ–¹å¼å¯èƒ½ä¼šé€ æˆçŸ­æœŸUIæ— æ³•å“åº”ã€‚å¯¹äºè¿™ç±»CPUå¯†é›†å‹çš„æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æåˆ°çš„computeå‡½æ•°ï¼Œå°†è§£æå·¥ä½œæ”¾åˆ°æ–°çš„Isolateä¸­å®Œæˆï¼š

```
static Student parseStudent(String content) {
  final jsonResponse = json.decode(content);
  Student student = Student.fromJson(jsonResponse);
  return student;
}
doSth() {
 ...
 //ç”¨computeå‡½æ•°å°†jsonè§£ææ”¾åˆ°æ–°Isolate
 compute(parseStudent,jsonString).then((student)=>print(student.teacher.name));
}
```

é€šè¿‡computeçš„æ”¹é€ ï¼Œæˆ‘ä»¬å°±ä¸ç”¨æ‹…å¿ƒJSONè§£ææ—¶é—´è¿‡é•¿é˜»å¡UIå“åº”äº†ã€‚

## æ€»ç»“

å¥½äº†ï¼Œä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™é‡Œäº†ï¼Œæˆ‘ä»¬ç®€å•å›é¡¾ä¸€ä¸‹ä¸»è¦å†…å®¹ã€‚

é¦–å…ˆï¼Œæˆ‘å¸¦ä½ å­¦ä¹ äº†å®ç°Flutteråº”ç”¨ä¸æœåŠ¡ç«¯é€šä¿¡çš„ä¸‰ç§æ–¹å¼ï¼Œå³HttpClientã€httpä¸dioã€‚å…¶ä¸­dioæä¾›çš„åŠŸèƒ½æ›´ä¸ºå¼ºå¤§ï¼Œå¯ä»¥æ”¯æŒè¯·æ±‚æ‹¦æˆªã€æ–‡ä»¶ä¸Šä¼ ä¸‹è½½ã€è¯·æ±‚åˆå¹¶ç­‰é«˜çº§èƒ½åŠ›ã€‚å› æ­¤ï¼Œæˆ‘æ¨èä½ åœ¨å®é™…é¡¹ç›®ä¸­ä½¿ç”¨dioçš„æ–¹å¼ã€‚

ç„¶åï¼Œæˆ‘å’Œä½ åˆ†äº«äº†JSONè§£æçš„ç›¸å…³å†…å®¹ã€‚JSONè§£æåœ¨Flutterä¸­ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œä½†ç”±äºä¸æ”¯æŒåå°„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½æ‰‹åŠ¨è§£æï¼Œå³ï¼šå…ˆå°†JSONå­—ç¬¦ä¸²è½¬æ¢æˆMapï¼Œç„¶åå†æŠŠè¿™ä¸ªMapç»™åˆ°è‡ªå®šä¹‰ç±»ï¼Œè¿›è¡Œç›¸å…³å±æ€§çš„èµ‹å€¼ã€‚

å¦‚æœä½ æœ‰åŸç”ŸAndroidã€iOSå¼€å‘ç»éªŒçš„è¯ï¼Œå¯èƒ½ä¼šè§‰å¾—Flutteræä¾›çš„JSONæ‰‹åŠ¨è§£ææ–¹æ¡ˆå¹¶ä¸å¥½ç”¨ã€‚åœ¨Flutterä¸­ï¼Œæ²¡æœ‰åƒåŸç”Ÿå¼€å‘é‚£æ ·æä¾›äº†Gsonæˆ–Mantleç­‰åº“ï¼Œç”¨äºå°†JSONå­—ç¬¦ä¸²ç›´æ¥è½¬æ¢ä¸ºå¯¹åº”çš„å®ä½“ç±»ã€‚è€Œè¿™äº›èƒ½åŠ›æ— ä¸€ä¾‹å¤–éƒ½éœ€è¦ç”¨åˆ°è¿è¡Œæ—¶åå°„ï¼Œè¿™æ˜¯Flutterä»è®¾è®¡ä¹‹åˆå°±ä¸æ”¯æŒçš„ï¼Œç†ç”±å¦‚ä¸‹ï¼š

1. è¿è¡Œæ—¶åå°„ç ´åäº†ç±»çš„å°è£…æ€§å’Œå®‰å…¨æ€§ï¼Œä¼šå¸¦æ¥å®‰å…¨é£é™©ã€‚å°±åœ¨å‰æ®µæ—¶é—´ï¼ŒFastjsonæ¡†æ¶å°±çˆ†å‡ºäº†ä¸€ä¸ªå·¨å¤§çš„å®‰å…¨æ¼æ´ã€‚è¿™ä¸ªæ¼æ´ä½¿å¾—ç²¾å¿ƒæ„é€ çš„å­—ç¬¦ä¸²æ–‡æœ¬ï¼Œå¯ä»¥åœ¨ååºåˆ—åŒ–æ—¶è®©æœåŠ¡å™¨æ‰§è¡Œä»»æ„ä»£ç ï¼Œç›´æ¥å¯¼è‡´ä¸šåŠ¡æœºå™¨è¢«è¿œç¨‹æ§åˆ¶ã€å†…ç½‘æ¸—é€ã€çªƒå–æ•æ„Ÿä¿¡æ¯ç­‰æ“ä½œã€‚
2. è¿è¡Œæ—¶åå°„ä¼šå¢åŠ äºŒè¿›åˆ¶æ–‡ä»¶å¤§å°ã€‚å› ä¸ºæä¸æ¸…æ¥šå“ªäº›ä»£ç å¯èƒ½ä¼šåœ¨è¿è¡Œæ—¶ç”¨åˆ°ï¼Œå› æ­¤ä½¿ç”¨åå°„åï¼Œä¼šé»˜è®¤ä½¿ç”¨æ‰€æœ‰ä»£ç æ„å»ºåº”ç”¨ç¨‹åºï¼Œè¿™å°±å¯¼è‡´ç¼–è¯‘å™¨æ— æ³•ä¼˜åŒ–ç¼–è¯‘æœŸé—´æœªä½¿ç”¨çš„ä»£ç ï¼Œåº”ç”¨å®‰è£…åŒ…ä½“ç§¯æ— æ³•è¿›ä¸€æ­¥å‹ç¼©ï¼Œè¿™å¯¹äºè‡ªå¸¦Dartè™šæ‹Ÿæœºçš„Flutteråº”ç”¨ç¨‹åºæ˜¯éš¾ä»¥æ¥å—çš„ã€‚

åå°„ç»™å¼€å‘è€…ç¼–ç¨‹å¸¦æ¥äº†æ–¹ä¾¿ï¼Œä½†ä¹Ÿå¸¦æ¥äº†å¾ˆå¤šéš¾ä»¥è§£å†³çš„æ–°é—®é¢˜ï¼Œå› æ­¤Flutterå¹¶ä¸æ”¯æŒåå°„ã€‚è€Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯ï¼Œè€è€å®å®åœ°æ‰‹åŠ¨è§£æJSONå§ã€‚

æˆ‘æŠŠä»Šå¤©åˆ†äº«æ‰€æ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹æ‰“åŒ…åˆ°äº†[GitHub](https://github.com/cyndibaby905/24_network_demo)ä¸­ï¼Œä½ å¯ä»¥ä¸‹è½½ä¸‹æ¥ï¼Œåå¤è¿è¡Œå‡ æ¬¡ï¼ŒåŠ æ·±ç†è§£ä¸è®°å¿†ã€‚

## æ€è€ƒé¢˜

æœ€åï¼Œæˆ‘ç»™ä½ ç•™ä¸¤é“æ€è€ƒé¢˜å§ã€‚

1. è¯·ä½¿ç”¨dioå®ç°ä¸€ä¸ªè‡ªå®šä¹‰æ‹¦æˆªå™¨ï¼Œæ‹¦æˆªå™¨å†…æ£€æŸ¥headerä¸­çš„tokenï¼šå¦‚æœæ²¡æœ‰tokenï¼Œéœ€è¦æš‚åœæœ¬æ¬¡è¯·æ±‚ï¼ŒåŒæ—¶è®¿é—®"[http://xxxx.com/token](http://xxxx.com/token)"ï¼Œåœ¨è·å–æ–°tokenåç»§ç»­æœ¬æ¬¡è¯·æ±‚ã€‚
2. ä¸ºä»¥ä¸‹Student JSONå†™ç›¸åº”çš„è§£æç±»ï¼š

```
String jsonString = '''
  {
    "id":"123",
    "name":"å¼ ä¸‰",
    "score" : 95,
    "teachers": [
       {
         "name": "æå››",
         "age" : 40
       },
       {
         "name": "ç‹äº”",
         "age" : 45
       }
    ]
  }
  ''';
```

æ¬¢è¿ä½ åœ¨è¯„è®ºåŒºç»™æˆ‘ç•™è¨€åˆ†äº«ä½ çš„è§‚ç‚¹ï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ç­‰å¾…ä½ ï¼æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ15ï¼‰</strong></div><ul>
<li><span>å’Œå°èƒ–</span> ğŸ‘ï¼ˆ19ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>ç¬¬ä¸€ä¸ªé—®é¢˜è§£å†³æ–¹æ³•ï¼š
dio.interceptors.add(InterceptorsWrapper(
      onRequest: (Options options) async {
        if (options.headers[&#39;token&#39;] == null) {
          print(&quot;no tokenï¼Œrequest token firstly...&quot;);
          &#47;&#47;lock the dio.
          dio.lock();
          return new Dio().get(&quot;http:&#47;&#47;xxxx.com&#47;token&quot;).then((d) {
            options.headers[&quot;token&quot;] = d.data[&#39;token&#39;];
            print(&quot;request token succeed, value: &quot; + d.data[&#39;token&#39;]);
            print(
                &#39;continue to perform requestï¼špath:${options.path}ï¼ŒbaseURL:${options.path}&#39;);
            return options;
          }).whenComplete(() =&gt; dio.unlock()); &#47;&#47; unlock the dio
        }
        return options;
      }
  ));</p>2019-10-09</li><br/><li><span>æ±Ÿå®å½­äºæ™</span> ğŸ‘ï¼ˆ15ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>åˆ†äº«ä¸€ä¸ªjsonè½¬dartç±»çš„å·¥å…·ï¼Œç†è§£äº†åŸç†åï¼Œå®é™…é¡¹ç›®ä¸­å¯ä»¥çœä¸å°‘æ—¶é—´https:&#47;&#47;javiercbk.github.io&#47;json_to_dart&#47;</p>2019-09-11</li><br/><li><span>å’Œå°èƒ–</span> ğŸ‘ï¼ˆ6ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>ç¬¬äºŒé“é¢˜è§£å†³æ–¹æ³•ï¼š

class Student {
  String id;
  String name;
  int score;
  List&lt;Teacher&gt; teachers;

  Student({this.id, this.name, this.score, this.teachers});

  factory Student.fromJson(Map&lt;String, dynamic&gt; parsedJson) {
    return Student(
        id: parsedJson[&#39;id&#39;],
        name: parsedJson[&#39;name&#39;],
        score: parsedJson[&#39;score&#39;],
        teachers: getTeacher(parsedJson[&#39;teachers&#39;]));
  }

  static List&lt;Teacher&gt; getTeacher(dynamic list) {
    List&lt;Teacher&gt; teachers = new List();
    list.forEach((f) {
      teachers.add(Teacher.fromJson(f));
    });
    return teachers;
  }
}

class Teacher {
  String name;
  int age;

  Teacher({this.age, this.name});

  factory Teacher.fromJson(Map&lt;String, dynamic&gt; parsedJson) {
    return Teacher(name: parsedJson[&#39;name&#39;], age: parsedJson[&#39;age&#39;]);
  }
}</p>2019-10-09</li><br/><li><span>ç»™æˆ‘ç‚¹é˜³å…‰å°±ç¿çƒ‚</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>å¦‚ä½•è¿›è¡Œsocketé€šä¿¡</p>2019-08-22</li><br/><li><span>Geek_0793f1</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå°† JSON å­—ç¬¦ä¸²ä¼ é€’ç»™ JSON.decode æ–¹æ³•è§£ææˆä¸€ä¸ª Mapï¼Œç„¶åæŠŠè¿™ä¸ª Map ä¼ ç»™è‡ªå®šä¹‰çš„ç±»ï¼Œè¿›è¡Œç›¸å…³å±æ€§çš„èµ‹å€¼ã€‚

å‰ç«¯ä¸€èˆ¬æŠŠjsonå­—ç¬¦ä¸²è§£ææˆmapä¹‹åï¼Œå°±ç›´æ¥ç”¨è¿™ä¸ªmapè¿›è¡Œç›¸å…³çš„å±æ€§èµ‹å€¼äº†ï¼Œè€å¸ˆèƒ½è§£é‡Šä¸€ä¸‹ï¼Œä¼ ç»™è‡ªå®šä¹‰ç±»çš„åšæ³•çš„å¥½å¤„å—ï¼Ÿ</p>2019-09-02</li><br/><li><span>Geek_0d3a08</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>é‡å®šå‘ç›‘å¬æœ‰å—ï¼Ÿ</p>2019-08-29</li><br/><li><span>æ±Ÿåšå®</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆèƒ½ä¸èƒ½ä»‹ç»ä¸€ä¸‹ååºåˆ—åŒ–å·¥å…·ï¼Œæ¯”å¦‚json_serializableå’Œ built_valueï¼Œå»ºè®®ç”¨å“ªä¸€ä¸ªï¼Œå¦‚æœé‡åˆ°æ³›å‹ï¼Œè¯¥å¦‚ä½•å¤„ç†</p>2019-08-22</li><br/><li><span>Geek_4s70e3</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>json_model æ€ä¹ˆç”Ÿæˆçº¯æ•°ç»„çš„è§£æä»£ç ï¼Ÿ</p>2019-11-07</li><br/><li><span>å¤§ç¥åšå£«</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>æƒ³é—®ä¸‹ Flutter ä¸­ JSONP çš„è¯·æ±‚æ€ä¹ˆå¤„ç†</p>2019-09-21</li><br/><li><span>ç±³ç±³å‘€ğŸ‘§</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>import &#39;dart:convert&#39;;

import &#39;package:flutter&#47;material.dart&#39;;
import &#39;package:http&#47;http.dart&#39; as http;
[...]
  loadData() async {
    String dataURL = &quot;https:&#47;&#47;jsonplaceholder.typicode.com&#47;posts&quot;;
    http.Response response = await http.get(dataURL);
    setState(() {
      widgets = JSON.decode(response.body);
    });
  }
}

å®˜ç½‘Demoé‡Œé¢æ˜¯ç”¨çš„è¿™ä¸ªï¼Œè·ŸHttpClientæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿæˆ‘è¯¥ç”¨å“ªä¸ªï¼Ÿ</p>2019-09-10</li><br/><li><span>Geek_joestar</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>static List&lt;Teacher&gt; fromJsonList(List&lt;dynamic&gt; listJson){
    var list = List&lt;Teacher&gt;();
    for(Map&lt;String, dynamic&gt; parsedJson in listJson) {
      list.add(Teacher.fromJson(parsedJson));
    }
    return list;
  }</p>2019-09-08</li><br/><li><span>C</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>class Teacher {
  String name;
  int age;

  Teacher({this.name, this.age});

  factory Teacher.fromJson(Map&lt;String, dynamic&gt; parsedJson) {
    return Teacher(
      name: parsedJson[&#39;name&#39;],
      age: parsedJson[&#39;age&#39;],
    );
  }

  static List&lt;Teacher&gt; parseTeachers(List&lt;dynamic&gt; mapList) {
    List&lt;Teacher&gt; teachers = List&lt;Teacher&gt;();
    for(Map&lt;String, dynamic&gt; map in mapList) {
      teachers.add(Teacher.fromJson(map));
    }
    return teachers;
  }
}

class Student {
  String id;
  String name;
  int score;
  List&lt;Teacher&gt; teachers;

  Student({this.id, this.name, this.score, this.teachers});

  factory Student.fromJson(Map&lt;String, dynamic&gt; parsedJson) {
    return Student(
      id: parsedJson[&#39;id&#39;],
      name: parsedJson[&#39;name&#39;],
      score: parsedJson[&#39;score&#39;],
      teachers: Teacher.parseTeachers(parsedJson[&#39;teachers&#39;]),
    );
  }
}</p>2019-09-06</li><br/><li><span>å¤§å’Œ</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>dio.interceptors.add(InterceptorsWrapper(
        onRequest: (RequestOptions options) async {
          if (options.headers[&quot;token&quot;] == null) {
            try {
              var token = await new Dio().get(&quot;https:&#47;&#47;xxx.com&#47;token&quot;);
              options.headers[&quot;token&quot;] = token;
            }catch(e) {
              return dio.reject(&quot;Error: è¯·å…ˆç™»å½•...&quot;);
            }
          }
          return options;
        }
    ));</p>2019-09-04</li><br/><li><span>å®ç¼º</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è¯·é—®è€å¤§ï¼Œè¯¾åä½œä¸šçš„ç­”æ¡ˆå•¥æ—¶å€™ç»™å‚è€ƒä¸€ä¸‹</p>2019-09-03</li><br/><li><span>ç§‹</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ä½¿ç”¨Dioå‘é€postè¯·æ±‚ï¼Œdataæ•°æ®æ˜¯mapï¼Œä½†æ˜¯æœåŠ¡ç«¯æ¥æ”¶ä¸åˆ°ï¼Œè¯·é—®è€å¸ˆè¿™æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ</p>2019-09-02</li><br/>
</ul>