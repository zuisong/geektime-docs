ä½ å¥½ï¼Œæˆ‘æ˜¯é™ˆèˆªã€‚ä»Šå¤©ï¼Œæˆ‘æ¥å’Œä½ èŠèŠå¦‚ä½•åœ¨åŸç”Ÿåº”ç”¨ä¸­æ¥å…¥Flutterã€‚

åœ¨å‰é¢ä¸¤ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä¸ä½ åˆ†äº«äº†å¦‚ä½•åœ¨Dartå±‚å¼•å…¥Android/iOSå¹³å°ç‰¹å®šçš„èƒ½åŠ›ï¼Œæ¥æå‡Appçš„åŠŸèƒ½ä½“éªŒã€‚

ä½¿ç”¨Flutterä»å¤´å¼€å§‹å†™ä¸€ä¸ªAppï¼Œæ˜¯ä¸€ä»¶è½»æ¾æƒ¬æ„çš„äº‹æƒ…ã€‚ä½†ï¼Œå¯¹äºæˆç†Ÿäº§å“æ¥è¯´ï¼Œå®Œå…¨æ‘’å¼ƒåŸæœ‰Appçš„å†å²æ²‰æ·€ï¼Œè€Œå…¨é¢è½¬å‘Flutterå¹¶ä¸ç°å®ã€‚ç”¨Flutterå»ç»Ÿä¸€iOS/AndroidæŠ€æœ¯æ ˆï¼ŒæŠŠå®ƒä½œä¸ºå·²æœ‰åŸç”ŸAppçš„æ‰©å±•èƒ½åŠ›ï¼Œé€šè¿‡é€æ­¥è¯•éªŒæœ‰åºæ¨è¿›ä»è€Œæå‡ç»ˆç«¯å¼€å‘æ•ˆç‡ï¼Œå¯èƒ½æ‰æ˜¯ç°é˜¶æ®µFlutteræœ€å…·å¸å¼•åŠ›çš„åœ°æ–¹ã€‚

é‚£ä¹ˆï¼ŒFlutterå·¥ç¨‹ä¸åŸç”Ÿå·¥ç¨‹è¯¥å¦‚ä½•ç»„ç»‡ç®¡ç†ï¼Ÿä¸åŒå¹³å°çš„Flutterå·¥ç¨‹æ‰“åŒ…æ„å»ºäº§ç‰©è¯¥å¦‚ä½•æŠ½å–å°è£…ï¼Ÿå°è£…åçš„äº§ç‰©è¯¥å¦‚ä½•å¼•å…¥åŸç”Ÿå·¥ç¨‹ï¼ŸåŸç”Ÿå·¥ç¨‹åˆè¯¥å¦‚ä½•ä½¿ç”¨å°è£…åçš„Flutterèƒ½åŠ›ï¼Ÿ

è¿™äº›é—®é¢˜ä½¿å¾—åœ¨å·²æœ‰åŸç”ŸAppä¸­æ¥å…¥Flutterçœ‹ä¼¼å¹¶ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…ã€‚é‚£æ¥ä¸‹æ¥ï¼Œæˆ‘å°±å’Œä½ ä»‹ç»ä¸‹å¦‚ä½•åœ¨åŸç”ŸAppä¸­ä»¥æœ€è‡ªç„¶çš„æ–¹å¼æ¥å…¥Flutterã€‚

## å‡†å¤‡å·¥ä½œ

æ—¢ç„¶æ˜¯è¦åœ¨åŸç”Ÿåº”ç”¨ä¸­æ··ç¼–Flutterï¼Œç›¸ä¿¡ä½ ä¸€å®šå·²ç»å‡†å¤‡å¥½åŸç”Ÿåº”ç”¨å·¥ç¨‹æ¥å®æ–½ä»Šå¤©çš„æ”¹é€ äº†ã€‚å¦‚æœä½ è¿˜æ²¡æœ‰å‡†å¤‡å¥½ä¹Ÿæ²¡å…³ç³»ï¼Œæˆ‘ä¼šä»¥ä¸€ä¸ªæœ€å°åŒ–çš„ç¤ºä¾‹å’Œä½ æ¼”ç¤ºè¿™ä¸ªæ”¹é€ è¿‡ç¨‹ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬åˆ†åˆ«ç”¨Xcodeä¸Android Studioå¿«é€Ÿå»ºç«‹ä¸€ä¸ªåªæœ‰é¦–é¡µçš„åŸºæœ¬å·¥ç¨‹ï¼Œå·¥ç¨‹ååˆ†åˆ«ä¸ºiOSDemoä¸AndroidDemoã€‚

è¿™æ—¶ï¼ŒAndroidå·¥ç¨‹å°±å·²ç»å‡†å¤‡å¥½äº†ï¼›è€Œå¯¹äºiOSå·¥ç¨‹æ¥è¯´ï¼Œç”±äºåŸºæœ¬å·¥ç¨‹å¹¶ä¸æ”¯æŒä»¥ç»„ä»¶åŒ–çš„æ–¹å¼ç®¡ç†é¡¹ç›®ï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦å¤šåšä¸€æ­¥ï¼Œå°†å…¶æ”¹é€ æˆä½¿ç”¨CocoaPodsç®¡ç†çš„å·¥ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¦åœ¨iOSDemoæ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåªæœ‰åŸºæœ¬ä¿¡æ¯çš„Podfileæ–‡ä»¶ï¼š

```
use_frameworks!
platform :ios, '8.0'
target 'iOSDemo' do
#todo
end
```

ç„¶åï¼Œåœ¨å‘½ä»¤è¡Œè¾“å…¥pod installåï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªiOSDemo.xcworkspaceæ–‡ä»¶ï¼Œè¿™æ—¶æˆ‘ä»¬å°±å®Œæˆäº†iOSå·¥ç¨‹æ”¹é€ ã€‚

## Flutteræ··ç¼–æ–¹æ¡ˆä»‹ç»

å¦‚æœä½ æƒ³è¦åœ¨å·²æœ‰çš„åŸç”ŸAppé‡ŒåµŒå…¥ä¸€äº›Flutteré¡µé¢ï¼Œæœ‰ä¸¤ä¸ªåŠæ³•ï¼š

- å°†åŸç”Ÿå·¥ç¨‹ä½œä¸ºFlutterå·¥ç¨‹çš„å­å·¥ç¨‹ï¼Œç”±Flutterç»Ÿä¸€ç®¡ç†ã€‚è¿™ç§æ¨¡å¼ï¼Œå°±æ˜¯ç»Ÿä¸€ç®¡ç†æ¨¡å¼ã€‚
- å°†Flutterå·¥ç¨‹ä½œä¸ºåŸç”Ÿå·¥ç¨‹å…±ç”¨çš„å­æ¨¡å—ï¼Œç»´æŒåŸæœ‰çš„åŸç”Ÿå·¥ç¨‹ç®¡ç†æ–¹å¼ä¸å˜ã€‚è¿™ç§æ¨¡å¼ï¼Œå°±æ˜¯ä¸‰ç«¯åˆ†ç¦»æ¨¡å¼ã€‚

![](https://static001.geekbang.org/resource/image/43/e3/43959076df5aadeb751dff0d7b1134e3.png?wh=1304%2A326)

å›¾1 Flutteræ··ç¼–å·¥ç¨‹ç®¡ç†æ–¹å¼

ç”±äºFlutteræ—©æœŸæä¾›çš„æ··ç¼–æ–¹å¼èƒ½åŠ›åŠç›¸å…³èµ„æ–™æœ‰é™ï¼Œå›½å†…è¾ƒæ—©ä½¿ç”¨Flutteræ··åˆå¼€å‘çš„å›¢é˜Ÿå¤§å¤šä½¿ç”¨çš„æ˜¯ç»Ÿä¸€ç®¡ç†æ¨¡å¼ã€‚ä½†æ˜¯ï¼Œéšç€åŠŸèƒ½è¿­ä»£çš„æ·±å…¥ï¼Œè¿™ç§æ–¹æ¡ˆçš„å¼Šç«¯ä¹Ÿéšä¹‹æ˜¾éœ²ï¼Œä¸ä»…ä¸‰ç«¯ï¼ˆAndroidã€iOSã€Flutterï¼‰ä»£ç è€¦åˆä¸¥é‡ï¼Œç›¸å…³å·¥å…·é“¾è€—æ—¶ä¹Ÿéšä¹‹å¤§å¹…å¢é•¿ï¼Œå¯¼è‡´å¼€å‘æ•ˆç‡é™ä½ã€‚

æ‰€ä»¥ï¼Œåç»­ä½¿ç”¨Flutteræ··åˆå¼€å‘çš„å›¢é˜Ÿé™†ç»­æŒ‰ç…§ä¸‰ç«¯ä»£ç åˆ†ç¦»çš„æ¨¡å¼æ¥è¿›è¡Œä¾èµ–æ²»ç†ï¼Œå®ç°äº†Flutterå·¥ç¨‹çš„è½»é‡çº§æ¥å…¥ã€‚

é™¤äº†å¯ä»¥è½»é‡çº§æ¥å…¥ï¼Œä¸‰ç«¯ä»£ç åˆ†ç¦»æ¨¡å¼æŠŠFlutteræ¨¡å—ä½œä¸ºåŸç”Ÿå·¥ç¨‹çš„å­æ¨¡å—ï¼Œè¿˜å¯ä»¥å¿«é€Ÿå®ç°FlutteråŠŸèƒ½çš„â€œçƒ­æ’æ‹”â€ï¼Œé™ä½åŸç”Ÿå·¥ç¨‹çš„æ”¹é€ æˆæœ¬ã€‚è€ŒFlutterå·¥ç¨‹é€šè¿‡Android Studioè¿›è¡Œç®¡ç†ï¼Œæ— éœ€æ‰“å¼€åŸç”Ÿå·¥ç¨‹ï¼Œå¯ç›´æ¥è¿›è¡ŒDartä»£ç å’ŒåŸç”Ÿä»£ç çš„å¼€å‘è°ƒè¯•ã€‚

**ä¸‰ç«¯å·¥ç¨‹åˆ†ç¦»æ¨¡å¼çš„å…³é”®æ˜¯æŠ½ç¦»Flutterå·¥ç¨‹ï¼Œå°†ä¸åŒå¹³å°çš„æ„å»ºäº§ç‰©ä¾ç…§æ ‡å‡†ç»„ä»¶åŒ–çš„å½¢å¼è¿›è¡Œç®¡ç†**ï¼Œå³Androidä½¿ç”¨aarã€iOSä½¿ç”¨podã€‚æ¢å¥è¯è¯´ï¼Œæ¥ä¸‹æ¥ä»‹ç»çš„æ··ç¼–æ–¹æ¡ˆä¼šå°†Flutteræ¨¡å—æ‰“åŒ…æˆaarå’Œpodï¼Œè¿™æ ·åŸç”Ÿå·¥ç¨‹å°±å¯ä»¥åƒå¼•ç”¨å…¶ä»–ç¬¬ä¸‰æ–¹åŸç”Ÿç»„ä»¶åº“é‚£æ ·å¿«é€Ÿæ¥å…¥Flutteräº†ã€‚

å¬èµ·æ¥æ˜¯ä¸æ˜¯å¾ˆå…´å¥‹ï¼Ÿæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¼€å§‹æ­£å¼é‡‡ç”¨ä¸‰ç«¯åˆ†ç¦»æ¨¡å¼æ¥æ¥å…¥Flutteræ¨¡å—å§ã€‚

## é›†æˆFlutter

æˆ‘æ›¾åœ¨å‰é¢çš„æ–‡ç« ä¸­æåˆ°ï¼ŒFlutterçš„å·¥ç¨‹ç»“æ„æ¯”è¾ƒç‰¹æ®Šï¼ŒåŒ…æ‹¬Flutterå·¥ç¨‹å’ŒåŸç”Ÿå·¥ç¨‹çš„ç›®å½•ï¼ˆå³iOSå’ŒAndroidä¸¤ä¸ªç›®å½•ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒåŸç”Ÿå·¥ç¨‹å°±ä¼šä¾èµ–äºFlutterç›¸å…³çš„åº“å’Œèµ„æºï¼Œä»è€Œæ— æ³•è„±ç¦»çˆ¶ç›®å½•è¿›è¡Œç‹¬ç«‹æ„å»ºå’Œè¿è¡Œã€‚

åŸç”Ÿå·¥ç¨‹å¯¹Flutterçš„ä¾èµ–ä¸»è¦åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š

- Flutteråº“å’Œå¼•æ“ï¼Œä¹Ÿå°±æ˜¯Flutterçš„Frameworkåº“å’Œå¼•æ“åº“ï¼›
- Flutterå·¥ç¨‹ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è‡ªå·±å®ç°çš„Flutteræ¨¡å—åŠŸèƒ½ï¼Œä¸»è¦åŒ…æ‹¬Flutterå·¥ç¨‹libç›®å½•ä¸‹çš„Dartä»£ç å®ç°çš„è¿™éƒ¨åˆ†åŠŸèƒ½ã€‚

åœ¨å·²ç»æœ‰åŸç”Ÿå·¥ç¨‹çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦åœ¨åŒçº§ç›®å½•åˆ›å»ºFlutteræ¨¡å—ï¼Œæ„å»ºiOSå’ŒAndroidå„è‡ªçš„Flutterä¾èµ–åº“ã€‚è¿™ä¹Ÿå¾ˆå¥½å®ç°ï¼ŒFlutterå°±ä¸ºæˆ‘ä»¬æä¾›äº†è¿™æ ·çš„å‘½ä»¤ã€‚æˆ‘ä»¬åªéœ€è¦åœ¨åŸç”Ÿé¡¹ç›®çš„åŒçº§ç›®å½•ä¸‹ï¼Œæ‰§è¡ŒFlutterå‘½ä»¤åˆ›å»ºåä¸ºflutter\_libraryçš„æ¨¡å—å³å¯ï¼š

```
Flutter create -t module flutter_library
```

è¿™é‡Œçš„Flutteræ¨¡å—ï¼Œä¹Ÿæ˜¯Flutterå·¥ç¨‹ï¼Œæˆ‘ä»¬ç”¨Android Studioæ‰“å¼€å®ƒï¼Œå…¶ç›®å½•å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://static001.geekbang.org/resource/image/61/89/61d3530bcf7a23e1708c536b53ced789.png?wh=872%2A1268)

å›¾2 Flutteræ¨¡å—å·¥ç¨‹ç»“æ„

å¯ä»¥çœ‹åˆ°ï¼Œå’Œä¼ ç»Ÿçš„Flutterå·¥ç¨‹ç›¸æ¯”ï¼ŒFlutteræ¨¡å—å·¥ç¨‹ä¹Ÿæœ‰å†…åµŒçš„Androidå·¥ç¨‹ä¸iOSå·¥ç¨‹ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åƒæ™®é€šå·¥ç¨‹ä¸€æ ·ä½¿ç”¨Android Studioè¿›è¡Œå¼€å‘è°ƒè¯•ã€‚

ä»”ç»†æŸ¥çœ‹å¯ä»¥å‘ç°ï¼Œ**Flutteræ¨¡å—æœ‰ä¸€ä¸ªç»†å¾®çš„å˜åŒ–**ï¼šAndroidå·¥ç¨‹ä¸‹å¤šäº†ä¸€ä¸ªFlutterç›®å½•ï¼Œè¿™ä¸ªç›®å½•ä¸‹çš„build.gradleé…ç½®å°±æ˜¯æˆ‘ä»¬æ„å»ºaarçš„æ‰“åŒ…é…ç½®ã€‚è¿™å°±æ˜¯æ¨¡å—å·¥ç¨‹æ—¢èƒ½åƒFlutterä¼ ç»Ÿå·¥ç¨‹ä¸€æ ·ä½¿ç”¨Android Studioå¼€å‘è°ƒè¯•ï¼Œåˆèƒ½æ‰“åŒ…æ„å»ºaarä¸podçš„ç§˜å¯†ã€‚

å®é™…ä¸Šï¼ŒiOSå·¥ç¨‹çš„ç›®å½•ç»“æ„ä¹Ÿæœ‰ç»†å¾®å˜åŒ–ï¼Œä½†è¿™ä¸ªå·®å¼‚å¹¶ä¸å½±å“æ‰“åŒ…æ„å»ºï¼Œå› æ­¤æˆ‘å°±ä¸å†å±•å¼€äº†ã€‚

ç„¶åï¼Œæˆ‘ä»¬æ‰“å¼€main.dartæ–‡ä»¶ï¼Œå°†å…¶é€»è¾‘æ›´æ–°ä¸ºä»¥ä¸‹ä»£ç é€»è¾‘ï¼Œå³ä¸€ä¸ªå†™ç€â€œHello from Flutterâ€çš„å…¨å±çº¢è‰²çš„Flutter Widgetï¼š

```
import 'package:flutter/material.dart';
import 'dart:ui';

void main() => runApp(_widgetForRoute(window.defaultRouteName));//ç‹¬ç«‹è¿è¡Œä¼ å…¥é»˜è®¤è·¯ç”±

Widget _widgetForRoute(String route) {
  switch (route) {
    default:
      return MaterialApp(
        home: Scaffold(
          backgroundColor: const Color(0xFFD63031),//ARGBçº¢è‰²
          body: Center(
            child: Text(
              'Hello from Flutter', //æ˜¾ç¤ºçš„æ–‡å­—
              textDirection: TextDirection.ltr,
              style: TextStyle(
                fontSize: 20.0,
                color: Colors.blue,
              ),
            ),
          ),
        ),
      );
  }
}
```

æ³¨æ„ï¼šæˆ‘ä»¬åˆ›å»ºçš„Widgetå®é™…ä¸Šæ˜¯åŒ…åœ¨ä¸€ä¸ªswitch-caseè¯­å¥ä¸­çš„ã€‚è¿™æ˜¯å› ä¸ºå°è£…çš„Flutteræ¨¡å—ä¸€èˆ¬ä¼šæœ‰å¤šä¸ªé¡µé¢çº§Widgetï¼ŒåŸç”ŸAppä»£ç åˆ™ä¼šé€šè¿‡ä¼ å…¥è·¯ç”±æ ‡è¯†å­—ç¬¦ä¸²ï¼Œå‘Šè¯‰Flutterç©¶ç«Ÿåº”è¯¥è¿”å›ä½•ç§Widgetã€‚ä¸ºäº†ç®€åŒ–æ¡ˆä¾‹ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å¿½ç•¥æ ‡è¯†å­—ç¬¦ä¸²ï¼Œç»Ÿä¸€è¿”å›ä¸€ä¸ªMaterialAppã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦åšçš„äº‹æƒ…å°±æ˜¯æŠŠè¿™æ®µä»£ç ç¼–è¯‘æ‰“åŒ…ï¼Œæ„å»ºå‡ºå¯¹åº”çš„Androidå’ŒiOSä¾èµ–åº“ï¼Œå®ç°åŸç”Ÿå·¥ç¨‹çš„æ¥å…¥ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬é¦–å…ˆæ¥çœ‹çœ‹Androidå·¥ç¨‹å¦‚ä½•æ¥å…¥ã€‚

### Androidæ¨¡å—é›†æˆ

ä¹‹å‰æˆ‘ä»¬æåˆ°åŸç”Ÿå·¥ç¨‹å¯¹Flutterçš„ä¾èµ–ä¸»è¦åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå¯¹åº”åˆ°Androidå¹³å°ï¼Œè¿™ä¸¤éƒ¨åˆ†åˆ†åˆ«æ˜¯ï¼š

- Flutteråº“å’Œå¼•æ“ï¼Œä¹Ÿå°±æ˜¯icudtl.datã€libFlutter.soï¼Œè¿˜æœ‰ä¸€äº›classæ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶éƒ½å°è£…åœ¨Flutter.jarä¸­ã€‚
- Flutterå·¥ç¨‹äº§ç‰©ï¼Œä¸»è¦åŒ…æ‹¬åº”ç”¨ç¨‹åºæ•°æ®æ®µisolate\_snapshot\_dataã€åº”ç”¨ç¨‹åºæŒ‡ä»¤æ®µisolate\_snapshot\_instrã€è™šæ‹Ÿæœºæ•°æ®æ®µvm\_snapshot\_dataã€è™šæ‹ŸæœºæŒ‡ä»¤æ®µvm\_snapshot\_instrã€èµ„æºæ–‡ä»¶Flutter\_assetsã€‚

ææ¸…æ¥šFlutterå·¥ç¨‹çš„Androidç¼–è¯‘äº§ç‰©ä¹‹åï¼Œæˆ‘ä»¬å¯¹Androidçš„Flutterä¾èµ–æŠ½å–æ­¥éª¤å¦‚ä¸‹ï¼š

é¦–å…ˆåœ¨Flutter\_libraryçš„æ ¹ç›®å½•ä¸‹ï¼Œæ‰§è¡Œaaræ‰“åŒ…æ„å»ºå‘½ä»¤ï¼š

```
Flutter build apk --debug
```

è¿™æ¡å‘½ä»¤çš„ä½œç”¨æ˜¯ç¼–è¯‘å·¥ç¨‹äº§ç‰©ï¼Œå¹¶å°†Flutter.jarå’Œå·¥ç¨‹äº§ç‰©ç¼–è¯‘ç»“æœå°è£…æˆä¸€ä¸ªaarã€‚ä½ å¾ˆå¿«å°±ä¼šæƒ³åˆ°ï¼Œå¦‚æœæ˜¯æ„å»ºreleaseäº§ç‰©ï¼Œåªéœ€è¦æŠŠdebugæ¢æˆreleaseå°±å¯ä»¥äº†ã€‚

**å…¶æ¬¡**ï¼Œæ‰“åŒ…æ„å»ºçš„flutter-debug.aarä½äº.android/Flutter/build/outputs/aar/ç›®å½•ä¸‹ï¼Œæˆ‘ä»¬æŠŠå®ƒæ‹·è´åˆ°åŸç”ŸAndroidå·¥ç¨‹AndroidDemoçš„app/libsç›®å½•ä¸‹ï¼Œå¹¶åœ¨Appçš„æ‰“åŒ…é…ç½®build.gradleä¸­æ·»åŠ å¯¹å®ƒçš„ä¾èµ–:

```
...
repositories {
    flatDir {
        dirs 'libs'   // aarç›®å½•
    }
}
android {
    ...
    compileOptions {
        sourceCompatibility 1.8 //Java 1.8
        targetCompatibility 1.8 //Java 1.8
    }
    ...
}

dependencies {
    ...
    implementation(name: 'flutter-debug', ext: 'aar')//Flutteræ¨¡å—aar
    ...
}
```

Syncä¸€ä¸‹ï¼ŒFlutteræ¨¡å—å°±è¢«æ·»åŠ åˆ°äº†Androidé¡¹ç›®ä¸­ã€‚

å†æ¬¡ï¼Œæˆ‘ä»¬è¯•ç€æ”¹ä¸€ä¸‹MainActivity.javaçš„ä»£ç ï¼ŒæŠŠå®ƒçš„contentViewæ”¹æˆFlutterçš„widgetï¼š

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    View FlutterView = Flutter.createView(this, getLifecycle(), "defaultRoute"); //ä¼ å…¥è·¯ç”±æ ‡è¯†ç¬¦
    setContentView(FlutterView);//ç”¨FlutterViewæ›¿ä»£Activityçš„ContentView
}
```

æœ€åç‚¹å‡»è¿è¡Œï¼Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªå†™ç€â€œHello from Flutterâ€çš„å…¨å±çº¢è‰²çš„Flutter Widgetå°±å±•ç¤ºå‡ºæ¥äº†ã€‚è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº†Androidå·¥ç¨‹çš„æ¥å…¥ã€‚

![](https://static001.geekbang.org/resource/image/36/5b/3648bb9b0ec126fe07963d5e4cbede5b.png?wh=1440%2A2560)

å›¾3 Androidå·¥ç¨‹æ¥å…¥ç¤ºä¾‹

### iOSæ¨¡å—é›†æˆ

iOSå·¥ç¨‹æ¥å…¥çš„æƒ…å†µè¦ç¨å¾®å¤æ‚ä¸€äº›ã€‚åœ¨iOSå¹³å°ï¼ŒåŸç”Ÿå·¥ç¨‹å¯¹Flutterçš„ä¾èµ–åˆ†åˆ«æ˜¯ï¼š

- Flutteråº“å’Œå¼•æ“ï¼Œå³Flutter.frameworkï¼›
- Flutterå·¥ç¨‹çš„äº§ç‰©ï¼Œå³App.frameworkã€‚

iOSå¹³å°çš„Flutteræ¨¡å—æŠ½å–ï¼Œå®é™…ä¸Šå°±æ˜¯é€šè¿‡æ‰“åŒ…å‘½ä»¤ç”Ÿæˆè¿™ä¸¤ä¸ªäº§ç‰©ï¼Œå¹¶å°†å®ƒä»¬å°è£…æˆä¸€ä¸ªpodä¾›åŸç”Ÿå·¥ç¨‹å¼•ç”¨ã€‚

ç±»ä¼¼åœ°ï¼Œé¦–å…ˆæˆ‘ä»¬åœ¨Flutter\_libraryçš„æ ¹ç›®å½•ä¸‹ï¼Œæ‰§è¡ŒiOSæ‰“åŒ…æ„å»ºå‘½ä»¤ï¼š

```
Flutter build ios --debug
```

è¿™æ¡å‘½ä»¤çš„ä½œç”¨æ˜¯ç¼–è¯‘Flutterå·¥ç¨‹ç”Ÿæˆä¸¤ä¸ªäº§ç‰©ï¼šFlutter.frameworkå’ŒApp.frameworkã€‚åŒæ ·ï¼ŒæŠŠdebugæ¢æˆreleaseå°±å¯ä»¥æ„å»ºreleaseäº§ç‰©ï¼ˆå½“ç„¶ï¼Œä½ è¿˜éœ€è¦å¤„ç†ä¸€ä¸‹ç­¾åé—®é¢˜ï¼‰ã€‚

**å…¶æ¬¡**ï¼Œåœ¨iOSDemoçš„æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸ºFlutterEngineçš„ç›®å½•ï¼Œå¹¶æŠŠè¿™ä¸¤ä¸ªframeworkæ–‡ä»¶æ‹·è´è¿›å»ã€‚iOSçš„æ¨¡å—åŒ–äº§ç‰©å·¥ä½œè¦æ¯”Androidå¤šä¸€ä¸ªæ­¥éª¤ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦æŠŠè¿™ä¸¤ä¸ªäº§ç‰©æ‰‹åŠ¨å°è£…æˆpodã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºFlutterEngine.podspecï¼Œå³Flutteræ¨¡å—çš„ç»„ä»¶å®šä¹‰ï¼š

```
Pod::Spec.new do |s|
  s.name             = 'FlutterEngine'
  s.version          = '0.1.0'
  s.summary          = 'XXXXXXX'
  s.description      = <<-DESC
TODO: Add long description of the pod here.
                       DESC
  s.homepage         = 'https://github.com/xx/FlutterEngine'
  s.license          = { :type => 'MIT', :file => 'LICENSE' }
  s.author           = { 'chenhang' => 'hangisnice@gmail.com' }
  s.source       = { :git => "", :tag => "#{s.version}" }
  s.ios.deployment_target = '8.0'
  s.ios.vendored_frameworks = 'App.framework', 'Flutter.framework'
end
```

pod lib lintä¸€ä¸‹ï¼ŒFlutteræ¨¡å—ç»„ä»¶å°±å·²ç»åšå¥½äº†ã€‚è¶çƒ­æ‰“é“ï¼Œæˆ‘ä»¬å†ä¿®æ”¹Podfileæ–‡ä»¶æŠŠå®ƒé›†æˆåˆ°iOSDemoå·¥ç¨‹ä¸­ï¼š

```
...
target 'iOSDemo' do
    pod 'FlutterEngine', :path => './'
end
```

pod installä¸€ä¸‹ï¼ŒFlutteræ¨¡å—å°±é›†æˆè¿›iOSåŸç”Ÿå·¥ç¨‹ä¸­äº†ã€‚

å†æ¬¡ï¼Œæˆ‘ä»¬è¯•ç€ä¿®æ”¹ä¸€ä¸‹AppDelegate.mçš„ä»£ç ï¼ŒæŠŠwindowçš„rootViewControlleræ”¹æˆFlutterViewControllerï¼š

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions

{
    self.window = [[UIWindow alloc] initWithFrame:[UIScreen mainScreen].bounds];
    FlutterViewController *vc = [[FlutterViewController alloc]init];
    [vc setInitialRoute:@"defaultRoute"]; //è·¯ç”±æ ‡è¯†ç¬¦
    self.window.rootViewController = vc;
    [self.window makeKeyAndVisible];
    return YES;
}
```

æœ€åç‚¹å‡»è¿è¡Œï¼Œä¸€ä¸ªå†™ç€â€œHello from Flutterâ€çš„å…¨å±çº¢è‰²çš„Flutter Widgetä¹Ÿå±•ç¤ºå‡ºæ¥äº†ã€‚è‡³æ­¤ï¼ŒiOSå·¥ç¨‹çš„æ¥å…¥æˆ‘ä»¬ä¹Ÿé¡ºåˆ©æå®šäº†ã€‚

![](https://static001.geekbang.org/resource/image/a5/42/a511d31edbbbf2949763af49453ac642.png?wh=828%2A1792)

å›¾4 iOSå·¥ç¨‹æ¥å…¥ç¤ºä¾‹

## æ€»ç»“

é€šè¿‡åˆ†ç¦»Androidã€iOSå’ŒFlutterä¸‰ç«¯å·¥ç¨‹ï¼ŒæŠ½ç¦»Flutteråº“å’Œå¼•æ“åŠå·¥ç¨‹ä»£ç ä¸ºç»„ä»¶åº“ï¼Œä»¥Androidå’ŒiOSå¹³å°æœ€å¸¸è§çš„aarå’Œpodå½¢å¼æ¥å…¥åŸç”Ÿå·¥ç¨‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½æˆæœ¬åœ°æ¥å…¥Flutteræ¨¡å—ï¼Œæ„‰å¿«åœ°ä½¿ç”¨Flutteræ‰©å±•åŸç”ŸAppçš„è¾¹ç•Œäº†ã€‚

ä½†ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åšå¾—æ›´å¥½ã€‚

å¦‚æœæ¯æ¬¡é€šè¿‡æ„å»ºFlutteræ¨¡å—å·¥ç¨‹ï¼Œéƒ½æ˜¯æ‰‹åŠ¨æ¬è¿Flutterç¼–è¯‘äº§ç‰©ï¼Œé‚£å¾ˆå®¹æ˜“å°±ä¼šå› ä¸ºå·¥ç¨‹ç®¡ç†æ··ä¹±å¯¼è‡´Flutterç»„ä»¶åº“è¢«è¦†ç›–ï¼Œä»è€Œå¼•å‘éš¾ä»¥æ’æŸ¥çš„Bugã€‚è€Œè¦è§£å†³æ­¤ç±»é—®é¢˜çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥å¼•å…¥CIè‡ªåŠ¨æ„å»ºæ¡†æ¶ï¼ŒæŠŠFlutterç¼–è¯‘äº§ç‰©æ„å»ºè‡ªåŠ¨åŒ–ï¼ŒåŸç”Ÿå·¥ç¨‹é€šè¿‡æ¥å…¥ä¸åŒç‰ˆæœ¬çš„æ„å»ºäº§ç‰©ï¼Œå®ç°æ›´ä¼˜é›…çš„ä¸‰ç«¯åˆ†ç¦»æ¨¡å¼ã€‚

è€Œå…³äºè‡ªåŠ¨åŒ–æ„å»ºï¼Œæˆ‘ä¼šåœ¨åé¢çš„æ–‡ç« ä¸­å’Œä½ è¯¦ç»†ä»‹ç»ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç®€å•å›é¡¾ä¸€ä¸‹ä»Šå¤©çš„å†…å®¹ã€‚

åŸç”Ÿå·¥ç¨‹æ··ç¼–Flutterçš„æ–¹å¼æœ‰ä¸¤ç§ã€‚ä¸€ç§æ˜¯ï¼Œå°†Flutterå·¥ç¨‹å†…åµŒAndroidå’ŒiOSå·¥ç¨‹ï¼Œç”±Flutterç»Ÿä¸€ç®¡ç†çš„é›†ä¸­æ¨¡å¼ï¼›å¦ä¸€ç§æ˜¯ï¼Œå°†Flutterå·¥ç¨‹ä½œä¸ºåŸç”Ÿå·¥ç¨‹å…±ç”¨çš„å­æ¨¡å—ï¼Œç”±åŸç”Ÿå·¥ç¨‹å„è‡ªç®¡ç†çš„ä¸‰ç«¯å·¥ç¨‹åˆ†ç¦»æ¨¡å¼ã€‚ç›®å‰ï¼Œä¸šç•Œé‡‡ç”¨çš„åŸºæœ¬éƒ½æ˜¯ç¬¬äºŒç§æ–¹å¼ã€‚

è€Œå¯¹äºä¸‰ç«¯å·¥ç¨‹åˆ†ç¦»æ¨¡å¼æœ€ä¸»è¦çš„åˆ™æ˜¯æŠ½ç¦»Flutterå·¥ç¨‹ï¼Œå°†ä¸åŒå¹³å°çš„æ„å»ºäº§ç‰©ä¾ç…§æ ‡å‡†ç»„ä»¶åŒ–çš„å½¢å¼è¿›è¡Œç®¡ç†ï¼Œå³ï¼šé’ˆå¯¹Androidå¹³å°æ‰“åŒ…æ„å»ºç”Ÿæˆaarï¼Œé€šè¿‡build.gradleè¿›è¡Œä¾èµ–ç®¡ç†ï¼›é’ˆå¯¹iOSå¹³å°æ‰“åŒ…æ„å»ºç”Ÿæˆframeworkï¼Œå°†å…¶å°è£…æˆç‹¬ç«‹çš„podï¼Œå¹¶é€šè¿‡podfileè¿›è¡Œä¾èµ–ç®¡ç†ã€‚

æˆ‘æŠŠä»Šå¤©åˆ†äº«æ‰€æ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹æ‰“åŒ…åˆ°äº†GitHubï¼ˆ[flutter\_module\_page](https://github.com/cyndibaby905/28_module_page)ã€[iOS\_demo](https://github.com/cyndibaby905/28_iOSDemo)ã€[Android\_Demo](https://github.com/cyndibaby905/28_AndroidDemo)ï¼‰ä¸­ï¼Œä½ å¯ä»¥ä¸‹è½½ä¸‹æ¥ï¼Œåå¤è¿è¡Œå‡ æ¬¡ï¼ŒåŠ æ·±ç†è§£ä¸è®°å¿†ã€‚

## æ€è€ƒé¢˜

æœ€åï¼Œæˆ‘ç»™ä½ ä¸‹ç•™ä¸€ä¸ªæ€è€ƒé¢˜å§ã€‚

å¯¹äºæœ‰èµ„æºä¾èµ–çš„Flutteræ¨¡å—å·¥ç¨‹è€Œè¨€ï¼Œå…¶æ‰“åŒ…æ„å»ºçš„äº§ç‰©ï¼Œä»¥åŠæŠ½ç¦»Flutterç»„ä»¶åº“çš„è¿‡ç¨‹ä¼šæœ‰ä»€ä¹ˆä¸åŒå—ï¼Ÿ

æ¬¢è¿ä½ åœ¨è¯„è®ºåŒºç»™æˆ‘ç•™è¨€åˆ†äº«ä½ çš„è§‚ç‚¹ï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ç­‰å¾…ä½ ï¼æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ15ï¼‰</strong></div><ul>
<li><span>Geek_a9f943</span> ğŸ‘ï¼ˆ5ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>å¦‚æœåœ¨flutterä¸­æ·»åŠ äº†ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œæ‰“åŒ…æ—¶å°±ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥è¿™ç§æ–¹å¼æœ¬è´¨ä¸Šè¿˜æ˜¯ä¸é€‚ç”¨äºæ··åˆå¼€å‘ã€‚æœ€ç†æƒ³çš„çŠ¶æ€æ˜¯å°†flutterä½œä¸ºä¸€ä¸ªå•ç‹¬çš„é¡¹ç›®ï¼Œç„¶åæŠŠæœ€ç»ˆäº§ç‰©æä¾›ç»™androidï¼Œiosï¼Œè¿™æ ·åŸç”Ÿçš„å¼€å‘äººå‘˜ä¹Ÿä¸éœ€è¦å®‰è£…flutterè¿è¡Œç¯å¢ƒã€‚è¿™ä¸€èŠ‚å¯ä»¥å½“ä½œæ˜¯æ··åˆå¼€å‘çš„é¢„ä¹ ï¼Œå¸Œæœ›è€å¸ˆåç»­èƒ½æŠŠæ··åˆå¼€å‘è®²çš„æ›´å½»åº•ä¸€äº›ï¼Œæ¯•ç«Ÿè¿™æ‰æ˜¯flutterå­˜åœ¨çš„ä¸»è¦ç›®çš„</p>2019-09-16</li><br/><li><span>åƒã®æ˜Ÿ</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>è€å¸ˆï¼ŒæŒ‰ç…§æ‚¨çš„æ··ç¼–æ–¹æ³•ï¼Œå† flutter build apk --releaseï¼Œä¹‹åç”Ÿäº§çš„aar&#47;assets&#47;flutter_assets&#47;,é‡Œé¢ç¼ºå°‘isolate_snapshot_dataï¼Œisolate_snapshot_instrï¼Œvm_snapshot_dataï¼Œvm_snapshot_instrã€‚aaræ‹·è´åˆ°å…¬å¸nativeappè¿è¡Œåˆ°flutterå°±ä¼šæŠ¥é”™ï¼šAbort message: &#39;[FATAL:flutter&#47;shell&#47;common&#47;shell.cc(218)] Check failed: vm. Must be able to initialize the VM.ã€‚è¯·é—®æ˜¯ç¼ºå°‘ä»€ä¹ˆç¯èŠ‚
æˆ–è€…é…ç½®å—</p>2019-12-03</li><br/><li><span>é¢œä¸ºæ™¨</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>åŒ…ä½“ç§¯æœ€å°‘ä¼šå¢åŠ å¤šå°‘å‘¢ï¼Ÿ</p>2019-09-10</li><br/><li><span>è®¸ç«¥ç«¥</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>è€å¸ˆï¼Œä¸‰ç«¯åˆ†ç¦»çš„è¯ï¼Œæ˜¯è¦å»ºä¸‰ä¸ªgitä»“åº“å—ï¼Ÿè¿˜æ˜¯æœ‰ä»€ä¹ˆå…¶å®ƒçš„æ–¹å¼ç®¡ç†ï¼Ÿ</p>2019-08-31</li><br/><li><span>å¤§åœŸè±†</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼Œå‘ç°äº†ä¸€ç§ä¾èµ–æºç çš„æ–¹å¼ï¼Œä¸ç”¨æ‰“åŒ…aarå†å¼•ç”¨è¿™ä¹ˆéº»çƒ¦äº†ï¼Œéå¸¸é€‚åˆå°å›¢é˜Ÿå¼€å‘ã€‚https:&#47;&#47;github.com&#47;flutter&#47;flutter&#47;wiki&#47;Add-Flutter-to-existing-appsï¼Œå®˜æ–¹å‡ºçš„ä¾èµ–flutter moduleæºç çš„æ–¹å¼ï¼Œç›´æ¥runå°±å¯ä»¥çš„ï¼Œä»Šå¤©å®æµ‹äº†ä¸€ä¸‹ï¼Œæ²¡æœ‰é—®é¢˜</p>2019-10-21</li><br/><li><span>èœå¤´</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>flutter build ios --debug
æ‰“å‡ºæ¥çš„ Flutter.framework æ²¡æœ‰ Header æ–‡ä»¶å¤¹</p>2019-10-16</li><br/><li><span>çŸ®ä¸ªå­å…ˆç”ŸğŸ˜</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>å¯¹äºflutter moduleçš„æµ‹è¯•,å¯ä»¥æ‰‹åŠ¨æ·»åŠ å…¥å£,ä»¥IDEAä¸ºä¾‹,add configurations-&gt; + -&gt;flutter -&gt;
nameéšä¾¿å–ä¸ªæ ‡è¯†,Dart entrypointæŒ‡æ˜å…¥å£dartæ–‡ä»¶,æ¯”å¦‚main.dart,å…¶ä»–ä¸ç”¨ç®¡,è¿™æ ·å¯ä»¥è¾¹ç¼–å†™flutteræ—¶è¾¹çœ‹æ•ˆæœäº†</p>2019-09-04</li><br/><li><span>å•¥ç©æ„å„¿å•Š</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>è€å¸ˆ,ioså¯åŠ¨åç™½å±
Engine run configuration was invalid.
Could not launch engine with configuration.
æ˜¯æ‰“åŒ…ç¯èŠ‚å‡ºç°é—®é¢˜äº†å—</p>2019-12-06</li><br/><li><span>å…«é¢ç²ç‘</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼ŒiOS æ„å»ºæŠ¥è¿™ä¸ªé”™æ€ä¹ˆå¤„ç†å‘€
BUILD TARGET Runner OF PROJECT Runner WITH CONFIGURATION Debug ===
    Code Signing Error: No profiles for &#39;com.****.***&#39; were
    found:  Xcode couldn&#39;t find any iOS App Development provisioning profiles
    matching &#39;com.lvdingtao.blackHoleModule&#39;. Automatic signing is disabled and
    unable to generate a profile. To enable automatic signing, pass
    -allowProvisioningUpdates to xcodebuild.</p>2019-12-05</li><br/><li><span>17å²ç å†œæƒ³å½“æ¶æ„å¸ˆ</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ä¸ºä»€ä¹ˆä»å®‰å“åŸç”Ÿå·¥ç¨‹è¿›å…¥flutteré¡µé¢æ—¶å…ˆæ˜¯é»‘å±ä¸€ä¼šå„¿ï¼Œç„¶åæ‰å‡ºæ¥é¡µé¢ï¼Ÿ</p>2019-11-27</li><br/><li><span>è°­é¹</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>Flutter.frameworké‡Œé¢ æ²¡æœ‰headers æ–‡ä»¶å¤¹    cleanäº†å¥½å¤šé  </p>2019-11-21</li><br/><li><span>è°­é¹</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>Flutter build ios å æ²¡æœ‰å‘ç°app å’Œ flutter framework</p>2019-11-20</li><br/><li><span>è°­é¹</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>Flutter_library æ˜¯ä»€ä¹ˆç›®å½•</p>2019-11-20</li><br/><li><span>èœ¥èœ´1214</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼Œæˆ‘flutteré¡¹ç›®é€šè¿‡
Flutter build apk --debugæ‰“åŒ…åã€‚aaråªæœ‰9.7mã€‚æ·»åŠ åˆ°å®‰å“é¡¹ç›®åè¿è¡Œï¼Œä¼šæŠ¥é”™è¯¯: æ— æ³•è®¿é—®FlutterView
æ‰¾ä¸åˆ°io.flutter.view.FlutterViewçš„ç±»æ–‡ä»¶ã€‚</p>2019-11-18</li><br/><li><span>Geek_0ea3e4</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æˆ‘æ‰§è¡ŒFlutter create -t module flutter_library  ä¸ºä»€ä¹ˆæ²¡æœ‰ç”Ÿäº§é‚£ä¹ˆå¤šæ–‡ä»¶ï¼Ÿbogon:Documents liudongdong$ Flutter create -t module flutter_library
Creating project flutter_library...
  flutter_library&#47;test&#47;widget_test.dart (created)
  flutter_library&#47;flutter_library.iml (created)
  flutter_library&#47;.gitignore (created)
  flutter_library&#47;.metadata (created)
  flutter_library&#47;pubspec.yaml (created)
  flutter_library&#47;README.md (created)
  flutter_library&#47;lib&#47;main.dart (created)
  flutter_library&#47;flutter_library_android.iml (created)
  flutter_library&#47;.idea&#47;libraries&#47;Flutter_for_Android.xml (created)
  flutter_library&#47;.idea&#47;libraries&#47;Dart_SDK.xml (created)
  flutter_library&#47;.idea&#47;modules.xml (created)
  flutter_library&#47;.idea&#47;workspace.xml (created)
Running &quot;flutter pub get&quot; in flutter_library...                    14.5s</p>2019-11-06</li><br/>
</ul>