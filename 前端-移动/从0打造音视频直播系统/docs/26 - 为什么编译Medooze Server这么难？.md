åœ¨[ä¸Šä¸€ç¯‡æ–‡ç« ](https://time.geekbang.org/column/article/134284)ä¸­ï¼Œæˆ‘ä»¬å¯¹ Licodeã€Janusã€Mediasoupä»¥åŠMedooze å››ä¸ª WebRTC å¼€æºæµåª’ä½“æœåŠ¡å™¨çš„å®ç°è¿›è¡Œå¯¹æ¯”ï¼Œå¯¹äºæƒ³ç ”ç©¶éŸ³è§†é¢‘å¤šæ–¹ä¼šè®®ã€å½•åˆ¶å›æ”¾ã€ç›´æ’­ç­‰æµåª’ä½“æŠ€æœ¯çš„å¼€å‘äººå‘˜æ¥è¯´ï¼ŒMedooze æ˜¯å¾ˆå¥½çš„é€‰æ‹©ã€‚å› ä¸ºå®ƒæ”¯æŒæ‰€æœ‰è¿™äº›åŠŸèƒ½ï¼Œé€šè¿‡å®ƒçš„æºç åŠå…¶ Demo å°±å¯ä»¥å¯¹ Medooze è¿›è¡Œæ·±å…¥å­¦ä¹ äº†ã€‚

ä»æœ¬æ–‡å¼€å§‹ï¼Œåœ¨æ¥ä¸‹æ¥çš„å››ç¯‡æ–‡ç« æˆ‘ä¼šå‘ä½ è¯¦ç»†è®²è¿° Medooze çš„æ¶æ„ã€å®ç°ä»¥åŠåº”ç”¨ã€‚è€Œæœ¬æ–‡ä¸»è¦ä»‹ç»Medoozeæ˜¯å¦‚ä½•ç¼–è¯‘å’Œæ„å»ºçš„ã€‚

ä¹Ÿè®¸ä½ ä¼šè§‰å¾—Linuxä¸‹çš„ç¨‹åºç¼–è¯‘æœ‰ä»€ä¹ˆå¯è®²çš„å‘¢ï¼Œç›´æ¥åœ¨Linuxç³»ç»Ÿä¸‹æ‰§è¡Œä¸€ä¸‹ build å‘½ä»¤ä¸å°±è¡Œäº†ï¼Œè¿˜éœ€è¦ä¸“é—¨ç†è§£ç³»ç»Ÿçš„ç¼–è¯‘è¿‡ç¨‹å’Œæ„å»ºå·¥å…·çš„ä½¿ç”¨å—ï¼Ÿå®é™…ä¸Šï¼Œæ ¹æ®æˆ‘å¤šå¹´çš„å·¥ä½œç»éªŒæ¥çœ‹ï¼Œç†è§£é¡¹ç›®çš„ç¼–è¯‘è¿‡ç¨‹ã€ç†Ÿæ‚‰å„ç§æ„å»ºå·¥å…·çš„ä½¿ç”¨æ˜¯éå¸¸æœ‰å¿…è¦çš„ã€‚ä¸‹é¢æˆ‘å°±ä¸¾å‡ ä¸ªä¾‹å­ï¼Œé€šè¿‡è¿™å‡ ä¸ªä¾‹å­ï¼Œæˆ‘æƒ³ä½ å°±ä¼šå¯¹å®ƒä»¬æœ‰ä¸€ä¸ªæ·±åˆ»æ„Ÿæ‚Ÿäº†ã€‚

ç¬¬ä¸€ä¸ªä¾‹å­ï¼Œä¼´éšç€æŠ€æœ¯çš„é£é€Ÿå‘å±•ï¼Œæ„å»ºå·¥å…·ä¹Ÿæœ‰äº†å¾ˆå¤§çš„å˜åŒ–ï¼Œä»æœ€æ—©çš„æ‰‹åŠ¨ç¼–å†™ Makefileï¼Œé€æ¸è¿‡æ¸¡åˆ°ä½¿ç”¨ Autotoolsã€CMakeã€GYP ç­‰æ„å»ºå·¥å…·æ¥ç”Ÿæˆ Makefileï¼Œè¿™äº›æ„å»ºå·¥å…·å¯ä»¥å¤§å¤§æé«˜ä½ çš„å·¥ä½œæ•ˆç‡ã€‚æ¯”å¦‚ï¼Œé€šè¿‡Andorid Studio åˆ›å»ºJNIç¨‹åºæ—¶ï¼Œåœ¨ Android Studio åº•å±‚ä¼šä½¿ç”¨ CMake æ¥æ„å»ºé¡¹ç›®ï¼Œä½ ä¼šå‘ç°ä½¿ç”¨ CMake æ„å»º JNI éå¸¸æ–¹ä¾¿ã€‚ç„¶è€ŒåƒChromeæµè§ˆå™¨è¿™ç§å¤§å‹é¡¹ç›®ä¹Ÿç”¨ CMakeæ„å»ºå°±å¾ˆä¸åˆé€‚äº†ï¼Œå› ä¸ºChromeæµè§ˆå™¨çš„ä»£ç é‡å·¨å¤§ï¼Œä½¿ç”¨ CMake æ„å»ºå®ƒä¼šèŠ±è´¹ç‰¹åˆ«é•¿çš„æ—¶é—´ï¼ˆå¥½å‡ ä¸ªå°æ—¶ï¼‰ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ Chrome å›¢é˜Ÿè‡ªå·±å¼€å‘äº†ä¸€ä¸ªæ–°çš„æ„å»ºå·¥å…·ï¼Œå³GYPï¼Œæ¥æ„å»ºè¿™ç§å¤§å‹é¡¹ç›®ï¼Œä»è€Œå¤§å¤§æé«˜äº†æ„å»ºçš„æ•ˆç‡ã€‚ç”±æ­¤å¯è§ï¼Œä¸åŒçš„é¡¹ç›®ä½¿ç”¨ä¸åŒçš„æ„å»ºå·¥å…·å¯¹å¼€å‘æ•ˆç‡çš„æå‡æ˜¯å·¨å¤§çš„ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ20ï¼‰</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/10/12/ce/a8c8b5e8.jpg" width="30px"><span>Jason</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>å¾ˆèµï¼Œä¸ä½†èƒ½å­¦åˆ°è§†é¢‘çŸ¥è¯†ï¼Œè¿˜ç†Ÿæ‚‰äº†å¾ˆå¤šå·¥å…·</div>2019-09-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/8c/a5/e0d96e36.jpg" width="30px"><span>helloa</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>medoozeæ”¯æŒæ‰‹æœºå—ï¼Ÿ</div>2019-09-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/c5/24/dbc4d29d.jpg" width="30px"><span>é¢œå¹¿æ°</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ4ï¼‰<div>è€å¸ˆï¼Œæˆ‘ç”¨è¿™ä¸ªoptimizationsåˆ†æ”¯ä¹Ÿç¼–è¯‘å¤±è´¥ï¼Œèƒ½éº»çƒ¦å¸®æˆ‘çœ‹ä¸€ä¸‹å—ï¼Ÿ
root@iZwz9isydglfcdgnqd84a4Z:&#47;home&#47;media-server# make
mkdir -p &#47;home&#47;media-server&#47;build&#47;debug
mkdir -p &#47;home&#47;media-server&#47;build&#47;debug&#47;test
mkdir -p &#47;home&#47;media-server&#47;bin&#47;debug
[CXX] debug &#47;home&#47;media-server&#47;src&#47;mcu.cpp
In file included from &#47;home&#47;media-server&#47;include&#47;participant.h:14:0,
                 from &#47;home&#47;media-server&#47;include&#47;multiconf.h:9,
                 from &#47;home&#47;media-server&#47;include&#47;mcu.h:6,
                 from &#47;home&#47;media-server&#47;src&#47;mcu.cpp:5:
&#47;home&#47;media-server&#47;include&#47;rtpsession.h:10:10: fatal error: srtp2&#47;srtp.h: No such file or directory</div>2019-12-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg" width="30px"><span>piboye</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æ€ä¹ˆè¿™ä¹ˆå¤šäººå«æå·¥å•ŠğŸ˜‚</div>2020-12-31</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/da/c8/fc153ea2.jpg" width="30px"><span>ç«å“¥</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æå·¥ï¼Œä½ å¥½ï¼ŒMedoozeæ”¯æŒå¤šè·¯åˆæˆå—?</div>2020-01-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/de/8d/4c10ba83.jpg" width="30px"><span>ä¸€æ”¯ç®­ğŸ’¯Â¹â°Â²â´</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>Media-server-goè¿™ä¸ªé¡¹ç›®æœ‰ä»€ä¹ˆæ•™ç¨‹å—ï¼Ÿ</div>2019-10-29</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJLAxia7JictXmRQ02VwuibKOpib5bMcWbQHZeeQhsV17KeGh5u7ySyibgMVLwcoqCA3ZiayI3dLaVOjibRg/132" width="30px"><span>Geek_82d1fd</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆï¼Œmedoozeæœ‰æ²¡æœ‰ä»€ä¹ˆé›†æˆå¼€å‘å·¥å…·å¯ä»¥æ–­ç‚¹è°ƒè¯•</div>2021-05-21</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1e/0c/a2/14c30983.jpg" width="30px"><span>é˜¿è‰¯</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆå¥½ï¼Œæˆ‘éœ€è¦æµè§ˆå™¨ç«¯çš„WebRTCä¸å°ç¨‹åºç«¯è¿›è¡Œè§†é¢‘é€šè¯ï¼Œå°ç¨‹åºç«¯æ¨æ‹‰æµé‡‡ç”¨çš„æ˜¯rtmpåè®®(ä½¿ç”¨çš„æ˜¯node-media-server)ï¼Œè¯·é—®Medoozeèƒ½å¦æ»¡è¶³è¿™ä¸ªéœ€æ±‚ï¼Ÿ</div>2021-04-23</li><br/><li><img src="" width="30px"><span>å®‡å®™ä¹‹ç‹</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆè¿‘æœŸæœ‰è®¡åˆ’æ•´ç†ä¸€å¥—åœ¨CentOSä¸‹çš„Medoozeéƒ¨ç½²æ•™ç¨‹å—ï¼Ÿï¼Ÿ</div>2020-10-09</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/3giaicn2VaDJicDD7WnaT9mB5VbaF6J7aQszN4W9BVmSWmKoVFxTuN7iaDDgrKhlFp49k1iacvjMYSH3eejVbaH0Vhw/132" width="30px"><span>sam</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>åœ¨media-server-nodeç›®å½•ä¸‹æ‰§è¡Œnpm install medooze-media-server --save å‡ºç°è¿™ä¸ªé”™è¯¯

npm ERR! code ENOSELF
npm ERR! Refusing to install package with name &quot;medooze-media-server&quot; under a package
npm ERR! also called &quot;medooze-media-server&quot;. Did you name your project the same
npm ERR! as the dependency you&#39;re installing?
npm ERR! 
npm ERR! For more information, see:
npm ERR!     &lt;https:&#47;&#47;docs.npmjs.com&#47;cli&#47;install#limitations-of-npms-install-algorithm&gt;
</div>2020-07-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/b3/92/3fe36d79.jpg" width="30px"><span>å¹³è¡¡ä¹‹ç¾</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆå¯ä»¥ å¼„ä¸ª centos7 å®‰è£…çš„æ•™ç¨‹å—  æˆ‘ä»¬æœåŠ¡å™¨å…¨éƒ¨æ˜¯centos7çš„</div>2020-06-15</li><br/><li><img src="" width="30px"><span>Geek_8a57ad</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>medoozeæœ‰c++å®¢æˆ·ç«¯sdkå—?</div>2020-05-27</li><br/><li><img src="" width="30px"><span>taotao</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æå·¥ï¼Œä½ å¥½ licode mcu å…·ä½“æ€ä¹ˆé…ç½®äº†ï¼Œæˆ‘çœ‹æºç  æ²¡çœ‹åˆ°æ”¯æŒå¤šè·¯åˆæˆäº†</div>2020-03-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/da/c8/fc153ea2.jpg" width="30px"><span>ç«å“¥</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>æå·¥ï¼Œä½ å¥½ï¼Œå’¨è¯¢ä¸€ä¸‹ï¼Œæˆ‘ä»¬ç°åœ¨åªæ˜¯å°†ç‚¹å¯¹ç‚¹çš„ä¸¤äººéŸ³è§†é¢‘é€šè¯è¿‡ç¨‹åˆæˆå¹¶å½•åˆ¶ã€‚ä¹Ÿæ˜¯éœ€è¦Medoozeå•†ä¸šç‰ˆå—ï¼Ÿæœ‰æ²¡æœ‰å¼€æºçš„webrtcæµåª’ä½“æœåŠ¡æ¶æ„æ¨èä¸€ä¸‹ï¼Œæ”¯æŒéŸ³è§†é¢‘é€šè¯&#47;åˆæˆ&#47;å½•åˆ¶.æ„Ÿè°¢ï¼</div>2020-01-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/bb/ca/86d58e40.jpg" width="30px"><span>yang</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>å‘ƒï¼Œå‘å¤§äº†ï¼Œäº‘ä¸Šè£…çš„æ˜¯centos7,  å®˜æ–¹æ¨èç¼–è¯‘ç¯å¢ƒubuntu.ä¸€ä¸ªä¸€ä¸ªæºç ä¸‹æ¥ç¼–è¯‘å§ã€‚å“.....</div>2020-01-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/aa/57/1997dd93.jpg" width="30px"><span>æŠ¹æŸ“æµå¹´å¬é£</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>gyp WARN EACCES user &quot;root&quot; does not have permission to access the dev dir &quot;&#47;root&#47;.node-gyp&#47;10.14.1&quot;
gyp WARN EACCES attempting to reinstall using temporary dev dir &quot;&#47;node_modules&#47;medooze-media-server&#47;.node-gyp&quot;
gyp WARN install got an error, rolling back install
gyp WARN install got an error, rolling back install
gyp ERR! configure error 
gyp ERR! stack Error: EACCES: permission denied, mkdir &#39;&#47;node_modules&#47;medooze-media-server&#47;.node-gyp&#39;
gyp ERR! System Linux 3.10.0-693.2.2.el7.x86_64
gyp ERR! command &quot;&#47;usr&#47;local&#47;node&#47;bin&#47;node&quot; &quot;&#47;usr&#47;local&#47;node&#47;lib&#47;node_modules&#47;npm&#47;node_modules&#47;node-gyp&#47;bin&#47;node-gyp.js&quot; &quot;configure&quot;
gyp ERR! cwd &#47;node_modules&#47;medooze-media-server
gyp ERR! node -v v10.14.1
gyp ERR! node-gyp -v v3.8.0
gyp ERR! not ok 
npm WARN enoent ENOENT: no such file or directory, open &#39;&#47;package.json&#39;
npm WARN !invalid#1 No description
npm WARN !invalid#1 No repository field.
npm WARN !invalid#1 No README data
npm WARN !invalid#1 No license field.
npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@2.1.2 (node_modules&#47;fsevents):
npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@2.1.2: wanted {&quot;os&quot;:&quot;darwin&quot;,&quot;arch&quot;:&quot;any&quot;} (current: {&quot;os&quot;:&quot;linux&quot;,&quot;arch&quot;:&quot;x64&quot;})

npm ERR! code ELIFECYCLE
npm ERR! errno 1
npm ERR! medooze-media-server@0.81.1 install: `test -f build&#47;Release&#47;medooze-media-server.node || (node-gyp configure &amp;&amp; node-gyp rebuild --jobs=max)`
npm ERR! Exit status 1
npm ERR! 
npm ERR! Failed at the medooze-media-server@0.81.1 install script.
npm ERR! This is probably not a problem with npm. There is likely additional logging output above.

npm ERR! A complete log of this run can be found in:
npm ERR!     &#47;root&#47;.npm&#47;_logs&#47;2019-12-11T03_40_52_436Z-debug.log</div>2019-12-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/de/8d/4c10ba83.jpg" width="30px"><span>ä¸€æ”¯ç®­ğŸ’¯Â¹â°Â²â´</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>golang ç‰ˆæœ¬çš„ ç¼–è¯‘åæ‰§è¡ŒæŠ¥
# github.com&#47;notedit&#47;media-server-go&#47;wrapper
&#47;usr&#47;local&#47;lib&#47;libsrtp2.a(hmac_ossl.o)ï¼šåœ¨å‡½æ•°â€˜srtp_hmac_deallocâ€™ä¸­ï¼š
hmac_ossl.c:(.text+0xd9)ï¼šå¯¹â€˜HMAC_CTX_freeâ€™æœªå®šä¹‰çš„å¼•ç”¨
&#47;usr&#47;local&#47;lib&#47;libsrtp2.a(hmac_ossl.o)ï¼šåœ¨å‡½æ•°â€˜srtp_hmac_allocâ€™ä¸­ï¼š
hmac_ossl.c:(.text+0x223)ï¼šå¯¹â€˜HMAC_CTX_newâ€™æœªå®šä¹‰çš„å¼•ç”¨
collect2: error: ld returned 1 exit status</div>2019-10-29</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83er5tJHYf1ica9LdMM5Q9BCfwBL7dPibTPwicbHpuGbicAS3MquenIs7x3VNW5ZbuJhYZBwA84ianfedprA/132" width="30px"><span>Geek_bang</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ4ï¼‰<div>æ‰§è¡Œnpm install medooze-media-server --save æœ‰é‡åˆ°è¿™ä¸ªé—®é¢˜å˜›ï¼Ÿ
npm WARN optional Skipping failed optional dependency &#47;chokidar&#47;fsevents:
npm WARN notsup Not compatible with your operating system or architecture: fsevents@2.1.1
npm WARN enoent ENOENT: no such file or directory, open &#39;&#47;root&#47;workspace&#47;Medooze&#47;test&#47;package.json&#39;
npm WARN test No description
npm WARN test No repository field.
npm WARN test No README data
npm WARN test No license field.
npm ERR! Linux 4.15.0-20-generic
npm ERR! argv &quot;&#47;usr&#47;bin&#47;node&quot; &quot;&#47;usr&#47;bin&#47;npm&quot; &quot;install&quot; &quot;medooze-media-server&quot; &quot;--save&quot;
npm ERR! node v8.10.0
npm ERR! npm  v3.5.2
npm ERR! path &#47;root&#47;workspace&#47;Medooze&#47;test&#47;node_modules&#47;.staging&#47;@types&#47;prop-types-51921f0d
npm ERR! code ENOENT
npm ERR! errno -2
npm ERR! syscall rename

npm ERR! enoent ENOENT: no such file or directory, rename &#39;&#47;root&#47;workspace&#47;Medooze&#47;test&#47;node_modules&#47;.staging&#47;@types&#47;prop-types-51921f0d&#39; -&gt; &#39;&#47;root&#47;workspace&#47;Medooze&#47;test&#47;node_modules&#47;tap&#47;node_modules&#47;@types&#47;prop-types&#39;
npm ERR! enoent ENOENT: no such file or directory, rename &#39;&#47;root&#47;workspace&#47;Medooze&#47;test&#47;node_modules&#47;.staging&#47;@types&#47;prop-types-51921f0d&#39; -&gt; &#39;&#47;root&#47;workspace&#47;Medooze&#47;test&#47;node_modules&#47;tap&#47;node_modules&#47;@types&#47;prop-types&#39;
npm ERR! enoent This is most likely not a problem with npm itself
npm ERR! enoent and is related to npm not being able to find a file.
npm ERR! enoent

npm ERR! Please include the following file with any support request:
npm ERR!     &#47;root&#47;workspace&#47;Medooze&#47;test&#47;npm-debug.log</div>2019-10-24</li><br/><li><img src="" width="30px"><span>taotao</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>æå·¥ï¼Œä½ å¥½ è¯·é—®licodeæ€ä¹ˆé…ç½®mcuäº†  æˆ‘çœ‹äº†ä»£ç  æ²¡çœ‹åˆ°å®ƒæ”¯æŒå¤šè·¯åˆæˆäº†ï¼Ÿ</div>2020-03-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/da/c8/fc153ea2.jpg" width="30px"><span>ç«å“¥</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æå·¥ï¼Œå’¨è¯¢ä¸€ä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦ç‚¹å¯¹ç‚¹ä¸¤ä¸ªäººçš„éŸ³è§†é¢‘åˆæˆï¼Œç°åœ¨Medoozeå¼€æºç‰ˆçš„æ”¯æŒå—ï¼Ÿå¦‚æœä¸æ”¯æŒæœ‰æ²¡æœ‰æ¨èä¸€ä¸‹æ”¯æŒwebrtcå¹¶å½•éŸ³å½•åƒçš„æµåª’ä½“æœåŠ¡æ¡†æ¶ã€‚æ„Ÿè°¢ï¼</div>2020-01-15</li><br/>
</ul>