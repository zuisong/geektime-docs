ä½ å¥½ï¼Œæˆ‘æ˜¯æœ±æ¶›ã€‚

å‰é¢å‡ èŠ‚è¯¾ï¼Œæˆ‘ä»¬å­¦äº†ä¸å°‘Kotlinçš„è¯­æ³•ï¼Œä¹Ÿç®—æ˜¯å¯¹Kotlinæœ‰äº†ä¸€ä¸ªåŸºæœ¬è®¤è¯†ã€‚ä¸è¿‡ï¼Œå•çº¯åªè®¤è¯†Kotlinæ˜¯è¿œè¿œä¸å¤Ÿçš„ï¼Œæˆ‘ä»¬è¿˜è¦**ä¼šç”¨Kotlin**ã€‚å½“é‡åˆ°ä¸€ä¸ªå…·ä½“é—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾—èƒ½ç”¨Kotlinæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æ¢å¥è¯è¯´ï¼Œå°±æ˜¯è¦å®æˆ˜ã€‚åœ¨å®æˆ˜çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯¹Kotlinçš„ç†è§£ä¹Ÿä¼šè¿›ä¸€æ­¥åŠ æ·±ã€‚

é‚£ä¹ˆè¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°±æŠŠå‰é¢çš„çŸ¥è¯†ç‚¹ä¸²è”èµ·æ¥ï¼Œä¸€èµ·åšä¸€ä¸ªKotlinç‰ˆæœ¬çš„è®¡ç®—å™¨ã€‚ä¸ºäº†ä¾¿äºç†è§£ï¼Œæˆ‘ä¼šä»¥**å¾ªåºæ¸è¿›**çš„æ–¹å¼æ¥ç¼–å†™è¿™ä¸ªè®¡ç®—å™¨ç¨‹åºï¼Œç”±ç®€å•åˆ°å¤æ‚ã€‚ä½ åœ¨è¿™ä¸ªç”±æ˜“åˆ°éš¾çš„å®æ“è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥å®é™…ä½“ä¼šåˆ°Kotlinçš„ä»£ç å®ç°æ€è·¯ä»¥åŠç¼–ç æ–¹å¼çš„å˜åŒ–ï¼Œè¿›è€Œä¹Ÿå°±èƒ½æ›´å¥½åœ°æŒæ¡å’Œè¿ç”¨å‰é¢æ‰€å­¦çš„åŸºç¡€è¯­æ³•ï¼Œä»¥åŠä¸é¢å‘å¯¹è±¡ç›¸å…³çš„çŸ¥è¯†ç‚¹ã€‚

è¿™ä¸ªè®¡ç®—å™¨ç¨‹åºå¤§è‡´ä¼šåˆ†ä¸ºä¸‰ä¸ªç‰ˆæœ¬ï¼š

- è®¡ç®—å™¨1.0ï¼Œå®ç°ä¸¤ä¸ªæ•´æ•°çš„â€œåŠ å‡ä¹˜é™¤â€ï¼Œå¯¹è¾“å…¥æ•°æ®æœ‰ä¸¥æ ¼è¦æ±‚ã€‚
- è®¡ç®—å™¨2.0ï¼Œå¯¹è¾“å…¥æ•°æ®æ— ä¸¥æ ¼è¦æ±‚ï¼Œèå…¥é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ€æƒ³ã€‚
- è®¡ç®—å™¨3.0ï¼Œæ”¯æŒâ€œå¤§æ•°çš„åŠ æ³•â€ï¼Œå¢åŠ å•å…ƒæµ‹è¯•ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬å°±å¼€å§‹å®æˆ˜å§ã€‚

## åˆ›å»ºKotlinå·¥ç¨‹

å¦‚æœä½ ä¹‹å‰æ²¡æœ‰ä½¿ç”¨è¿‡IntelliJæˆ–Android Studioï¼Œä½ å¯èƒ½è¿˜ä¸çŸ¥é“æ€ä¹ˆåˆ›å»ºä¸€ä¸ªå·¥ç¨‹ã€‚åˆ«æ‹…å¿ƒï¼Œè¿™ä¸ªè¿‡ç¨‹å…¶å®å¾ˆç®€å•ï¼Œå®ƒåˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ã€‚

- ç¬¬ä¸€æ­¥ï¼šé€‰æ‹©èœå•â€œFile -&gt; New -&gt; Projectâ€ã€‚
- ç¬¬äºŒæ­¥ï¼šé€‰ä¸­èœå•å·¦è¾¹çš„â€œGradleâ€ï¼Œç„¶ååœ¨å³è¾¹å‹¾é€‰â€œJava å’Œ Kotlin/JVMâ€ï¼Œæœ€åç‚¹å‡»å³ä¸‹è§’çš„â€œNextâ€ã€‚
- ç¬¬ä¸‰æ­¥ï¼šç»™å·¥ç¨‹å–ä¸€ä¸ªä½ å–œæ¬¢çš„åå­—ï¼Œæˆ‘ä»¬è¿™é‡Œå°±ç”¨Calculatorã€‚GroupIdè¿™ä¸ªåœ°æ–¹ä¸€èˆ¬ä½¿ç”¨å€’è¿‡æ¥çš„åŸŸåï¼Œè¿™é‡Œæ ¹æ®ä½ çš„å®é™…æƒ…å†µå¡«å†™å³å¯ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒIDEä¼šè‡ªåŠ¨å¸®ä½ è®¾ç½®æˆâ€œorg.exampleâ€ï¼Œæ‰€ä»¥ä½ ä¸å»æ”¹åŠ¨å®ƒä¹Ÿæ²¡é—®é¢˜ã€‚æœ€åï¼Œæˆ‘ä»¬ç‚¹å‡»Finishï¼Œå·¥ç¨‹å°±åˆ›å»ºæˆåŠŸäº†ï¼
- ç¬¬å››æ­¥ï¼šç­‰å¾…å·¥ç¨‹é…ç½®å®Œæˆã€‚**å¦‚æœä½ æ˜¯ç¬¬ä¸€æ¬¡åˆ›å»ºKotlinå·¥ç¨‹ï¼Œç‚¹å‡»Finishä»¥åï¼Œä½ å¯èƒ½éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼ŒIDEéœ€è¦ä¸‹è½½Gradleï¼Œç„¶åç”¨Gradleä¸‹è½½å·¥ç¨‹æ‰€éœ€çš„ä¾èµ–ã€‚**å½“ä½ åœ¨IDEå½“ä¸­èƒ½çœ‹åˆ°è¿™æ ·çš„å·¥ç¨‹ç»“æ„æ—¶ï¼Œè¿™ä¸ªå·¥ç¨‹å°±ç®—é…ç½®å®Œæˆäº†ã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/89/9f/89cyycca9830e62538528df5e62fbc9f.gif?wh=1000x750)

## å¯¼å…¥åˆå§‹åŒ–å·¥ç¨‹

å…¶å®ï¼Œä½ åªéœ€è¦çŸ¥é“å¦‚ä½•åˆ›å»ºä¸€ä¸ªKotlinå·¥ç¨‹å°±è¡Œäº†ï¼Œä¹Ÿæ²¡å¿…è¦çœŸçš„è·Ÿç€æˆ‘ä¸€æ­¥æ­¥æ“ä½œã€‚è¯¾ç¨‹é…å¥—çš„æºä»£ç å·²ç»åœ¨[GitHub](https://github.com/chaxiu/Calculator.git)å¼€æºï¼Œä½ å¯ä»¥å°†å…¶ä¸‹è½½ä¸‹æ¥å¹¶åˆ‡æ¢åˆ°startåˆ†æ”¯ï¼Œè¿™æ ·å°±å¯ä»¥è·Ÿç€è¯¾ç¨‹ä¸€æ­¥æ­¥å®ç°è®¡ç®—å™¨çš„ä¸‰ä¸ªç‰ˆæœ¬äº†ã€‚

**å…·ä½“åšæ³•æ˜¯è¿™æ ·çš„ï¼š**æ‰“å¼€IntelliJï¼Œç‚¹å‡»â€œGet from VCSâ€æŒ‰é’®ï¼Œæ¥ç€åœ¨å¼¹å‡ºçš„çª—å£ä¸­ï¼Œå¡«å…¥æˆ‘ä»¬çš„GitHub URLâ€œ[https://github.com/chaxiu/Calculator.git](https://github.com/chaxiu/Calculator.git)â€ï¼Œç„¶åç‚¹å‡»å³ä¸‹è§’çš„CloneæŒ‰é’®å³å¯ã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/47/03/477cd386aa83dddb7e2ab659b433f503.gif?wh=1000x750)

ç­‰ä»£ç ä¸‹è½½å®Œæˆä»¥åï¼ŒIDEä¼šé—®ä½ æ˜¯å¦è¦æ‰“å¼€æ­¤å·¥ç¨‹ï¼Œæˆ‘ä»¬é€‰æ‹©æ‰“å¼€ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬çš„è®¡ç®—å™¨å·¥ç¨‹å°±ç®—å¯¼å…¥è¿›æ¥äº†ã€‚

æœ€åï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°†å·¥ç¨‹æ”¹ä¸ºåˆå§‹åŒ–çŠ¶æ€ï¼Œå€ŸåŠ©Gitæˆ‘ä»¬å¯ä»¥éå¸¸æ–¹ä¾¿åœ°å®ç°ï¼š

- åœ¨IntelliJçš„å³ä¸‹è§’ï¼Œæ‰¾åˆ°mainæŒ‰é’®å¹¶ä¸”ç‚¹å‡»ï¼›
- åœ¨å¼¹å‡ºçš„èœå•ä¸­ï¼Œç‚¹å‡»startåˆ†æ”¯ï¼›
- æœ€åï¼Œç‚¹å‡»Checkoutï¼Œä»£è¡¨å°†å½“å‰ä»£ç åˆ‡æ¢åˆ°åˆå§‹çŠ¶æ€ã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/73/a7/730f5377ef2ee6e9d8dbe9179eb849a7.png?wh=581x379)

è¿™æ ·ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†æ•´ä¸ªå·¥ç¨‹çš„åˆå§‹åŒ–é…ç½®äº†ã€‚ä¸ºäº†æµ‹è¯•æˆ‘ä»¬çš„å¼€å‘ç¯å¢ƒæ˜¯å¦å·²ç»é…ç½®å¥½ï¼Œæˆ‘ä»¬å¯ä»¥æ‰“å¼€å·¥ç¨‹é‡Œçš„HelloWorldæ–‡ä»¶ï¼Œè¿è¡Œä¸€ä¸‹ï¼Œçœ‹çœ‹ç¨‹åºæ˜¯å¦æ­£å¸¸æ‰§è¡Œã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/db/1f/db316ef784abb04cd3fc87fcd9b0a31f.gif?wh=976x544)

å¦‚æœä½ ä¹Ÿèƒ½åœ¨å·¥ç¨‹å½“ä¸­çœ‹è§æ§åˆ¶å°è¾“å‡ºâ€œHello world.â€ï¼Œè¯´æ˜ä½ çš„å¼€å‘ç¯å¢ƒå·²ç»å®Œå…¨æ²¡é—®é¢˜äº†ã€‚æ¥ä¸‹æ¥ï¼Œå°±è®©æˆ‘ä»¬ä¸€èµ·ç”¨Kotlinå®Œæˆè®¡ç®—å™¨çš„1.0ç‰ˆæœ¬å§ï¼

## è®¡ç®—å™¨1.0

ç¬¬ä¸€ä¸ªç‰ˆæœ¬çš„è®¡ç®—å™¨ï¼Œå®ƒçš„åŠŸèƒ½éå¸¸ç®€å•ï¼Œä½ å¯ä»¥çœ‹çœ‹ä¸‹é¢çš„åŠ¨å›¾æ¼”ç¤ºã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/dd/10/dd01d14119706f7eeef220576dda5510.gif?wh=596x359)

æˆ‘ä»¬å¤§è‡´åˆ—ä¸¾ä¸€ä¸‹è¿™ä¸ªè®¡ç®—å™¨çš„åŠŸèƒ½éœ€æ±‚ï¼š

- äº¤äº’å¼ç•Œé¢ï¼Œè¾“å…¥ç®—å¼ï¼ŒæŒ‰ä¸‹å›è½¦ï¼Œç¨‹åºå°±ä¼šå¸®æˆ‘ä»¬è®¡ç®—å‡ºç»“æœï¼›
- æ•°å­—ä¸å­—ç¬¦ä¹‹é—´è¦æ±‚æœ‰ç©ºæ ¼ï¼Œâ€œ1 + 1â€æ˜¯å¯ä»¥çš„ï¼Œâ€œ1+1â€åˆ™ä¸è¡Œï¼›
- è¾“å…¥exitï¼ŒæŒ‰ä¸‹å›è½¦ï¼Œç¨‹åºå°±ä¼šé€€å‡ºï¼›
- æ”¯æŒâ€œåŠ å‡ä¹˜é™¤â€ï¼Œå››ç§è¿ç®—ï¼Œä»…æ”¯æŒä¸¤ä¸ªæ•°çš„è¿ç®—ã€‚

ææ¸…æ¥šåŠŸèƒ½éœ€æ±‚ä»¥åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å†™ä»£ç äº†ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªKotlinæºä»£ç æ–‡ä»¶ï¼šåœ¨Kotlinæ–‡ä»¶å¤¹ä¸‹ï¼Œç‚¹å‡»å³é”®ï¼Œé€‰æ‹©â€œNew -&gt; Kotlin Class/Fileâ€ï¼Œç„¶åå¡«å†™æ–‡ä»¶åå­—å³å¯ï¼Œè¿™é‡Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸ºCalculatorçš„Kotlinæ–‡ä»¶ã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/32/19/32be58b2b1ee01ccb888yy862546d019.png?wh=815x225)

ç”±äºæˆ‘ä»¬çš„ç¨‹åºè¦å’Œå‘½ä»¤è¿›è¡Œäº¤äº’ï¼Œæ ¹æ®ä¸åŒçš„å‘½ä»¤æ¥åšå‡ºä¸åŒçš„è¡Œä¸ºï¼Œå› æ­¤ï¼Œæˆ‘ä»¬çš„ç¨‹åºéœ€è¦æœ‰ä¸€ä¸ª **whileå¾ªç¯**çš„é€»è¾‘ï¼Œåœ¨å¾ªç¯å½“ä¸­ï¼Œè¿˜è¦è¯»å–å‘½ä»¤è¡Œçš„è¾“å…¥ï¼Œç„¶åæ ¹æ®è¾“å…¥çš„ç»“æœæ¥åˆ¤æ–­æ‰§è¡Œé€»è¾‘ã€‚æˆ‘ä»¬å¯ä»¥å°†æ•´ä¸ªç¨‹åºåˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š

- åˆå§‹åŒ–ï¼Œæ‰“å°æç¤ºä¿¡æ¯ï¼›
- ç¬¬ä¸€æ­¥ï¼Œè¯»å–è¾“å…¥å‘½ä»¤ï¼›
- ç¬¬äºŒæ­¥ï¼Œåˆ¤æ–­å‘½ä»¤æ˜¯ä¸æ˜¯exitï¼Œå¦‚æœç”¨æˆ·è¾“å…¥çš„æ˜¯â€œexitâ€åˆ™ç›´æ¥é€€å‡ºç¨‹åºï¼›
- ç¬¬ä¸‰æ­¥ï¼Œè§£æç®—å¼ï¼Œåˆ†è§£å‡ºâ€œæ•°å­—â€ä¸â€œæ“ä½œç¬¦â€ï¼šâ€œ1â€â€œ+â€â€œ2â€ï¼›
- ç¬¬å››æ­¥ï¼Œæ ¹æ®æ“ä½œç¬¦ç±»å‹ï¼Œç®—å‡ºç»“æœï¼š3ï¼›
- ç¬¬äº”æ­¥ï¼Œè¾“å‡ºç»“æœï¼š1 + 2 = 3ï¼›
- ç¬¬å…­æ­¥ï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªwhileå¾ªç¯ã€‚

```plain
fun main() {
    while(true) {
        // åˆå§‹åŒ–ï¼Œæ‰“å°æç¤ºä¿¡æ¯
        println("è¯·è¾“å…¥æ ‡å‡†çš„ç®—å¼ï¼Œå¹¶ä¸”æŒ‰å›è½¦; \n" +
                "æ¯”å¦‚ï¼š1 + 1ï¼Œæ³¨æ„ç¬¦åˆä¸æ•°å­—ä¹‹é—´è¦æœ‰ç©ºæ ¼ã€‚\n" +
                "è¾“å…¥exitï¼Œé€€å‡ºç¨‹åºã€‚")

        // ç¬¬ä¸€æ­¥ï¼Œè¯»å–è¾“å…¥å‘½ä»¤ï¼›
        var input = readLine()
        if (input == null) continue
        // ç¬¬äºŒæ­¥ï¼Œåˆ¤æ–­å‘½ä»¤æ˜¯ä¸æ˜¯exitï¼Œå¦‚æœæ˜¯åˆ™ç›´æ¥é€€å‡ºç¨‹åºï¼›
        if (input == "exit") exitProcess(0)

        // ç¬¬ä¸‰æ­¥ï¼Œè§£æç®—å¼ï¼Œåˆ†è§£å‡ºâ€œæ•°å­—â€ä¸â€œæ“ä½œç¬¦â€ï¼šâ€œ1â€â€œ+â€â€œ2â€ï¼›
        var inputList = input.split(" ")
        // ç¬¬å››æ­¥ï¼Œæ ¹æ®æ“ä½œç¬¦ç±»å‹ï¼Œç®—å‡ºç»“æœï¼š3ï¼›
        var result = calculate(inputList)

        // ç¬¬äº”æ­¥ï¼Œè¾“å‡ºç»“æœï¼š1 + 2 = 3ï¼›
        if (result == null) {
            println("è¾“å…¥æ ¼å¼ä¸å¯¹")
            continue
        } else {
            println("$input = $result")
        }

        // ç¬¬å…­æ­¥ï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªwhileå¾ªç¯ã€‚
    }
}

// å…·ä½“è®¡ç®—é€»è¾‘
private fun calculate(inputList: List<String>): Int? {
    if (inputList.size != 3) return null

    // ç¬¬ä¸ƒæ­¥ï¼Œå–å‡ºæ•°å­—å’Œæ“ä½œç¬¦
    var left = inputList.get(0).toInt()
    var operation = inputList.get(1)
    var right = inputList.get(2).toInt()

    // ç¬¬å…«æ­¥ï¼Œæ ¹æ®æ“ä½œç¬¦çš„ç±»å‹ï¼Œæ‰§è¡Œè®¡ç®—
    when(operation) {
        "+" -> return left + right
        "-" -> return left - right
        "*" -> return left * right
        "/" -> return left / right
        else -> return null
    }
}
```

ä¸Šé¢çš„ä»£ç éå¸¸ç®€å•ç›´ç™½ï¼Œå³ä½¿ä½ æ²¡æœ‰ä»»ä½•ç¼–ç¨‹ç»éªŒï¼Œåº”è¯¥ä¹Ÿèƒ½å¤Ÿç†è§£ã€‚å®ƒä¹Ÿéå¸¸ç¬¦åˆäººçš„ç¼–ç¨‹ç›´è§‰ã€‚

ä¸è¿‡ï¼Œç«™åœ¨Kotlinçš„è§’åº¦ä¸Šçœ‹ï¼Œä»¥ä¸Šçš„ä»£ç å…¶å®æ˜¯æœ‰ä¸å°‘é—®é¢˜çš„ï¼Œè®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå›¾æ¥å¯¹æ¯”ç€çœ‹ï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/84/03/84cac3866e2b1e14fd3ae6dc68074a03.png?wh=1240x1016)

- ç®­å¤´â‘ ï¼Œè¡¨ç¤ºç¨‹åºä¸­çš„â€œæç¤ºä¿¡æ¯â€åº”è¯¥ä½¿ç”¨Kotlinçš„â€œä¸‰å¼•å·â€çš„åŸå§‹å­—ç¬¦ä¸²ï¼Œè¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥çœå»ç¹ççš„â€œ\\nå’Œ+â€ï¼Œå¹¶ä¸”æ‰€è§å³æ‰€å¾—ï¼›
- ç®­å¤´â‘¡ï¼Œè¡¨ç¤ºè¯»å–è¾“å…¥å‘½ä»¤åï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨Elvisè¡¨è¾¾å¼ï¼Œä¸¤è¡Œä»£ç å°±ä¼šå˜æˆä¸€è¡Œï¼›
- ç®­å¤´â‘¢ï¼Œè¡¨ç¤ºç¨‹åºä¸­æ‰€æœ‰çš„varéƒ½åº”è¯¥æ”¹ä¸ºvalï¼Œæˆ‘åœ¨[ç¬¬1è®²](https://time.geekbang.org/column/article/472154)ä¸­è¯´è¿‡ï¼Œåœ¨Kotlinå½“ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥ä¼˜å…ˆä½¿ç”¨valï¼Œå°½é‡é¿å…ä½¿ç”¨å¯å˜çš„å˜é‡ã€‚
- ç®­å¤´â‘£ï¼Œè¡¨ç¤ºinputList.get(i)å¯ä»¥æ”¹ä¸ºinputList\[i]ï¼Œè¿™æ˜¯å› ä¸ºKotlinç»Ÿä¸€äº†æ•°ç»„å’Œé›†åˆçš„å…ƒç´ è®¿é—®æ“ä½œï¼Œæˆ‘ä»¬å†ä¹Ÿä¸ç”¨æ‹…å¿ƒå¼„æ··äº†ã€‚
- ç®­å¤´â‘¤ï¼Œè¡¨ç¤ºäº†ä¸¤ç‚¹ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥å°†returnæ”¾åˆ°whenè¡¨è¾¾å¼çš„å‰é¢ï¼Œè¿™æ ·å°±çœå¾—æˆ‘ä»¬æ¯ä¸ªåˆ†æ”¯éƒ½å†™ä¸€éreturnã€‚å¦å¤–ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨whenè¡¨è¾¾å¼çš„æ—¶å€™ï¼Œåº”è¯¥å°½é‡ç»“åˆâ€œæšä¸¾â€æˆ–è€…â€œå¯†å°ç±»â€æ¥ä½¿ç”¨ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºâ€œåŠ å‡ä¹˜é™¤â€å››ä¸ªæ“ä½œç¬¦åˆ›å»ºä¸€ä¸ªæšä¸¾ç±»ã€‚è¿™æ ·ï¼Œwhenè¡¨è¾¾å¼çš„åˆ†æ”¯ä¼šè‡ªåŠ¨åˆ¤å®šå®Œå¤‡ï¼Œè€Œä¸éœ€è¦elseåˆ†æ”¯äº†ã€‚

é‚£ä¹ˆç»è¿‡è°ƒæ•´ï¼Œæœ€ç»ˆçš„æºä»£ç åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š

```
val help = """
--------------------------------------
ä½¿ç”¨è¯´æ˜ï¼š
1. è¾“å…¥ 1 + 1ï¼ŒæŒ‰å›è½¦ï¼Œå³å¯ä½¿ç”¨è®¡ç®—å™¨ï¼›
2. æ³¨æ„ï¼šæ•°å­—ä¸ç¬¦å·ä¹‹é—´è¦æœ‰ç©ºæ ¼ï¼›
3. æƒ³è¦é€€å‡ºç¨‹åºï¼Œè¯·è¾“å…¥ï¼šexit
--------------------------------------""".trimIndent()

fun main() {
    while (true) {
        println(help)

        val input = readLine() ?: continue
        if (input == "exit") exitProcess(0)

        val inputList = input.split(" ")
        val result = calculate(inputList)

        if (result == null) {
            println("è¾“å…¥æ ¼å¼ä¸å¯¹")
            continue
        } else {
            println("$input = $result")
        }
    }
}

private fun calculate(inputList: List<String>): Int? {
    if (inputList.size != 3) return null

    val left = inputList[0].toInt()
    //                           â‘ 
    //                           â†“
    val operation = Operation.valueOf(inputList[1])
    val right = inputList[2].toInt()

    return when (operation) {
        Operation.ADD -> left + right
        Operation.MINUS -> left - right
        Operation.MULTI -> left * right
        Operation.DIVI -> left / right
    }
}

enum class Operation(val value: String) {
    ADD("+"),
    MINUS("-"),
    MULTI("*"),
    DIVI("/")
}
```

å¥½ï¼Œæˆ‘ä»¬çš„è®¡ç®—å™¨1.0ç‰ˆæœ¬ï¼Œåˆ°è¿™é‡Œå°±ç®—æ˜¯å®Œæˆäº†ã€‚

å¦‚æœä½ è·Ÿéšç€æˆ‘ï¼Œä¸€èµ·æ¥å®ç°äº†è¿™ä¸ªç®€å•çš„è®¡ç®—å™¨ï¼Œé‚£ä¹ˆä½ åœ¨è¿™ä¸ªå®æ“è¿‡ç¨‹ä¸­å°±å¯ä»¥ä½“ä¼šåˆ°ï¼ŒKotlinç¼–ç¨‹ä¸ä¼ ç»Ÿçš„Java/Cä¹‹é—´ç¡®å®æ˜¯å­˜åœ¨ç€ä¸€å®šçš„å·®åˆ«çš„ã€‚

**æƒ³è¦å­¦ä¼šKotlinè¯­æ³•å…¶å®ä¸éš¾ï¼Œä½†è¦å†™å‡ºä¼˜é›…çš„Kotlinä»£ç ï¼Œå´ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…ã€‚**æˆ‘ä»¬å”¯ä¸€èƒ½åšçš„ï¼Œå°±æ˜¯å¤šå†™Kotlinä»£ç ï¼ŒåŒæ—¶å¤šçœ‹ä¼˜ç§€çš„Kotlinä»£ç ï¼Œä»¥åŠå¤šæ€è€ƒæ”¹è¿›è‡ªå·±å·²æœ‰çš„ä»£ç ã€‚

ä¸è¿‡ï¼Œä»£ç ä¸­æ³¨é‡Šâ‘ å¤„å…¶å®è¿˜æœ‰ä¸€äº›é—®é¢˜ï¼Œæ¥ç€è®©æˆ‘ä»¬è¿›å…¥ç¬¬äºŒä¸ªç‰ˆæœ¬çš„å¼€å‘å§ï¼

## è®¡ç®—å™¨2.0

åœ¨2.0ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬ä¼šåˆ†æˆä¸¤ä¸ªé˜¶æ®µï¼š

- ç¬¬ä¸€ä¸ªé˜¶æ®µï¼Œ**èå…¥é¢å‘å¯¹è±¡çš„æ€æƒ³**ã€‚1.0ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬åªå†™äº†ä¸¤ä¸ªå‡½æ•°ï¼Œä¸€ä¸ªæ˜¯main()å‡½æ•°ï¼Œå¦ä¸€ä¸ªæ˜¯calculate()å‡½æ•°ã€‚è™½ç„¶è¿™æ ·çš„è®¾è®¡éå¸¸ç›´è§‚ä¸”ä¾¿äºç†è§£ï¼Œä½†å´ä¸å¤ªç¬¦åˆæˆ‘ä»¬å·¥ç¨‹ç•Œçš„æ€ç»´ä¹ æƒ¯ã€‚æˆ‘ä»¬åº”è¯¥å°†ç¨‹åºå°è£…åˆ°ä¸€ä¸ªç±»å½“ä¸­ï¼Œå¹¶ä¸”å°½é‡è®©æ¯ä¸ªå‡½æ•°çš„åŠŸèƒ½åˆ’åˆ†æ¸…æ¥šï¼Œä¿æŒæ¯ä¸ªå‡½æ•°å°½é‡ç®€å•ã€‚
- ç¬¬äºŒä¸ªé˜¶æ®µï¼Œ**å…¼å®¹è¾“å…¥æ ¼å¼**ã€‚1.0ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬å¯¹è¾“å…¥æœ‰ä¸¥æ ¼çš„è¦æ±‚ï¼Œæ•°å­—å’Œç¬¦å·ä¹‹é—´å¿…é¡»æœ‰ç©ºæ ¼ï¼Œå¦åˆ™æˆ‘ä»¬çš„ç®—å¼è§£æä¼šå‡ºé”™ã€‚åœ¨2.0ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬å°è¯•å…¼å®¹ä¸åŒçš„è¾“å…¥æ ¼å¼ï¼Œä¸ç®¡æ•°å­—å’Œç¬¦å·ä¹‹é—´æœ‰æ²¡æœ‰ç©ºæ ¼ï¼Œæˆ‘ä»¬éƒ½è¦èƒ½æˆåŠŸæ‰§è¡Œã€‚

è®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥ï¼Œé¦–å…ˆæ˜¯èå…¥é¢å‘å¯¹è±¡çš„æ€æƒ³ã€‚

### ç¬¬ä¸€é˜¶æ®µï¼šèå…¥é¢å‘å¯¹è±¡æ€æƒ³

å…·ä½“åšæ³•å…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬å¯ä»¥å°†å‰é¢å®šä¹‰çš„ä¸¤ä¸ªå‡½æ•°æ”¶æ‹¢åˆ°ä¸€ä¸ªç±»å½“ä¸­å»ï¼Œæ¯”å¦‚â€œCalculatorV2â€ï¼š

```plain
class CalculatorV2 {
    fun start() {}
    fun calculate(input: String): Int? {}
}
```

å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿™ä¸ªCalculatorV2ç±»å½“ä¸­æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œ**start()** ç”¨äºå¯åŠ¨æˆ‘ä»¬çš„è®¡ç®—å™¨ç¨‹åºï¼Œç›‘å¬æ§åˆ¶å°çš„æ–‡æœ¬è¾“å…¥ï¼›**calculate(input)** ç”¨äºæ¥æ”¶è¾“å…¥æ–‡æœ¬ï¼Œè®¡ç®—å‡ºç®—å¼çš„ç»“æœï¼Œç„¶åè¿”å›ä¸€ä¸ªå¯ä¸ºç©ºçš„æ•´å‹ï¼Œå½“è¾“å…¥ä¸åˆæ³•çš„æ—¶å€™ä¼šè¿”å›nullã€‚

è¿™æ ·ï¼Œæˆ‘ä»¬çš„è®¡ç®—å™¨ä½œä¸ºä¸€ä¸ªæ•´ä½“å·²ç»æ˜¯ä¸€ä¸ªå¯¹è±¡äº†ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°åœ¨main()å‡½æ•°å½“ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œå¹¶ä¸”è°ƒç”¨å®ƒçš„start()å‡½æ•°ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬çš„è®¡ç®—å™¨ä¹Ÿå°±å¯ä»¥å……åˆ†å‘æŒ¥å‡ºé¢å‘å¯¹è±¡çš„ä¼˜åŠ¿ã€‚

```plain
fun main() {
    val calculator = CalculatorV2()
    calculator.start()
}
```

é™¤äº†è®¡ç®—å™¨æœ¬èº«éœ€è¦é¢å‘å¯¹è±¡ï¼Œæˆ‘ä»¬çš„è¾“å…¥è¡¨è¾¾å¼ä¹Ÿå¯ä»¥æŠ½è±¡å‡ºä¸€ä¸ªå…·ä½“æ¨¡å‹å‡ºæ¥ã€‚

æˆ‘ä»¬çŸ¥é“ï¼Œä¸€ä¸ªç®—å¼åˆ†ä¸ºå·¦è¾¹çš„æ•°å­—ã€æ“ä½œç¬¦å’Œå³è¾¹çš„æ•°å­—ã€‚å› æ­¤æˆ‘ä»¬è¿˜å¯ä»¥å®šä¹‰ä¸€ä¸ªç±»ï¼Œæ¥ä»£è¡¨ç®—å¼è¡¨è¾¾å¼ã€‚

```plain
data class Expression(
    val left: String,
    val operator: Operation,
    val right: String
)
```

æ¯”å¦‚ï¼Œæˆ‘ä»¬æƒ³è¦è¡¨è¾¾â€œ1 + 2â€è¿™ä¸ªå¼å­çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨è¿™æ ·ä¸€ä¸ªç»“æ„æ¥è¡¨ç¤ºï¼š

```plain
Expression("1", Operation.ADD, "2")
```

é‚£ä¹ˆï¼Œåœ¨å®Œæˆäº†é¢å‘å¯¹è±¡çš„æ¨¡å‹åŒ–ä»¥åï¼Œæˆ‘ä»¬è¿˜éœ€è¦è¿›ä¸€æ­¥æ‹†åˆ†å‡½æ•°çš„èŒè´£ä¸é¢—ç²’åº¦ã€‚å…¶ä¸­ï¼Œstart()æ–¹æ³•ï¼Œä¸»è¦ç”¨äºæ§åˆ¶ç¨‹åºçš„æµç¨‹ã€è¾“å…¥ä¸è¾“å‡ºï¼š

```plain
fun start() {
    while (true) {
        println(HELP)
        val input = readLine() ?: continue
        val result = calculate(input)
        if (result == null) {
            println("è¾“å…¥æ ¼å¼ä¸å¯¹")
            continue
        } else {
            println("$input = $result")
        }
    }
}
```

è€Œcalculate()æ–¹æ³•ï¼Œåˆ™éœ€è¦è¿›ä¸€æ­¥åœ°æ‹†åˆ†ï¼š

```plain
fun calculate(input: String): String? {
    if (shouldExit(input)) exitProcess(0)
    val exp = parseExpression(input) ?: return null
    val left = exp.left
    val operator = exp.operator
    val right = exp.right
    return when (operator) {
        Operation.ADD -> addString(left, right)
        Operation.MINUS -> minusString(left, right)
        Operation.MULTI -> multiString(left, right)
        Operation.DIVI -> diviString(left, right)
    }
}

fun addString(left: String, right: String): String {
    val result = left.toInt() + right.toInt()
    return result.toString()
}
fun minusString(left: String, right: String): String {
    val result = left.toInt() - right.toInt()
    return result.toString()
}
fun multiString(left: String, right: String): String {
    val result = left.toInt() * right.toInt()
    return result.toString()
}
fun diviString(left: String, right: String): String {
    val result = left.toInt() / right.toInt()
    return result.toString()
}

fun shouldExit(input: String): Boolean {
    return input == EXIT
}

fun parseExpression(input: String): Expression? {
    // å¾…å®Œæˆ
}

fun parseOperator(input: String): Operation? {
    // å¾…å®Œæˆ
}
```

é€šè¿‡ä»¥ä¸Šä»£ç å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æ‹†åˆ†calculate()æ–¹æ³•ä¸»è¦åšäº†ä¸‰ä»¶äº‹ï¼š

- ç¬¬ä¸€ï¼Œ**å°†â€œæ˜¯å¦é€€å‡ºâ€çš„é€»è¾‘å°è£…åˆ°äº†shouldExit()æ–¹æ³•å½“ä¸­**ï¼Œå¦‚æœå°†æ¥è¿™éƒ¨åˆ†é€»è¾‘å˜å¾—æ›´å¤æ‚ï¼Œæˆ‘ä»¬åªæ”¹åŠ¨è¿™ä¸€ä¸ªæ–¹æ³•å³å¯ã€‚
- ç¬¬äºŒï¼Œ**å°†ç®—å¼çš„è§£æï¼Œå°è£…åˆ°äº†parseExpression()æ–¹æ³•å½“ä¸­**ï¼Œè€Œè§£æç®—å¼çš„æ—¶å€™ä¹Ÿéœ€è¦è§£ææ“ä½œç¬¦ï¼Œè¿™æ—¶å€™æˆ‘ä»¬ä¹Ÿéœ€è¦parseOperator()ã€‚
- ç¬¬ä¸‰ï¼Œ**å°†å…·ä½“çš„è®¡ç®—é€»è¾‘äº¤ç»™äº†å¯¹åº”çš„æ–¹æ³•**ã€‚è¿™ä¹ˆåšçš„åŸå› ï¼Œæ˜¯å¯ä»¥è®©æˆ‘ä»¬çš„ç¨‹åºå˜å¾—æ›´åŠ çµæ´»ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬åœ¨ä¸‹ä¸ªç‰ˆæœ¬å½“ä¸­ä¼šæ›´æ”¹â€œåŠ æ³•â€çš„è®¡ç®—é€»è¾‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åªéœ€è¦æ”¹åŠ¨è¿™ä¸€ä¸ªæ–¹æ³•å°±è¡Œäº†ã€‚

åŒæ—¶ï¼Œä»¥ä¸Šæ‰€æœ‰ç‹¬ç«‹æŠ½å‡ºæ¥çš„æ–¹æ³•ï¼Œå®ƒä»¬ä¹Ÿéƒ½å°†å˜å¾—**å¯æµ‹è¯•**ï¼Œè¿™æœ‰åˆ©äºæå‡ç¨‹åºçš„ç¨³å®šæ€§ã€‚

åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å¯¹è®¡ç®—å™¨2.0çš„ç¬¬ä¸€é˜¶æ®µæ”¹é€ å°±å·®ä¸å¤šå®Œæˆäº†ï¼Œæˆ‘ä»¬èå…¥äº†é¢å‘å¯¹è±¡çš„æ€æƒ³ï¼Œä¹Ÿå¯¹calculate()æ–¹æ³•è¿›è¡Œäº†æ›´ç»†é¢—ç²’åº¦çš„æ‹†åˆ†ã€‚ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯å…¼å®¹ç®—å¼çš„æ ¼å¼ï¼Œè®©å®ƒèƒ½å¤Ÿè§£ææ²¡æœ‰ç©ºæ ¼çš„ç®—å¼ã€‚

### ç¬¬äºŒé˜¶æ®µï¼šå…¼å®¹è¾“å…¥æ ¼å¼

ç°åœ¨ï¼Œå‡è®¾æˆ‘ä»¬çš„è¾“å…¥æ˜¯â€œ1+2â€ï¼Œæ•°å­—ä¸å­—ç¬¦ä¹‹é—´æ²¡æœ‰ç©ºæ ¼ã€‚é‚£åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±æ— æ³•ä½¿ç”¨ç©ºæ ¼ä½œä¸ºåˆ†éš”ç¬¦äº†ã€‚æ‰€ä»¥è¦æ¢ä¸€ç§æ–¹å¼ï¼Œæƒ³åŠæ³•ä»ç®—å¼å½“ä¸­ï¼Œè§£æå‡ºæ“ä½œç¬¦â€œåŠ å‡ä¹˜é™¤â€ä¸­çš„ä¸€ç§ï¼Œç„¶åå†ç”¨æ“ä½œç¬¦ä½œä¸ºæˆ‘ä»¬çš„åˆ†éš”ç¬¦å»æ‰¾å‡ºæ•°å­—ã€‚

å…¶å®ï¼Œå› ä¸ºæ“ä½œç¬¦åªæœ‰è¿™å››ç§æƒ…å†µï¼Œæ‰€ä»¥æˆ‘ä»¬å¾ˆå®¹æ˜“å°±èƒ½æƒ³åˆ°ä¸€ç§æ–¹æ¡ˆï¼Œä¸€ä¸ªä¸ªå»å°è¯•ï¼š

```plain
fun parseOperator(input: String): Operation? {
    return when {
        input.contains(Operation.ADD.value) -> Operation.ADD
        input.contains(Operation.MINUS.value) -> Operation.MINUS
        input.contains(Operation.MULTI.value) -> Operation.MULTI
        input.contains(Operation.DIVI.value) -> Operation.DIVI
        else -> null
    }
}
```

è™½ç„¶ï¼Œè¿™æ®µä»£ç è¿è¡Œèµ·æ¥æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œé€»è¾‘ä¹Ÿéå¸¸å¾—æ¸…æ™°ï¼Œä½†å®ƒçœ‹èµ·æ¥å¾ˆä¸‘é™‹ã€‚è€Œä¸”å®ƒè¿˜æœ‰ä¸€ä¸ªåå¤„ï¼šéšç€æšä¸¾ç±»å‹çš„å¢å¤šï¼Œæˆ‘ä»¬çš„é€»è¾‘åˆ†æ”¯ä¹Ÿä¼šå¢å¤šï¼Œæ‰‹åŠ¨æ·»åŠ èµ·æ¥ä¹Ÿç‰¹åˆ«éº»çƒ¦ã€‚

å› æ­¤è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å°±åº”è¯¥å……åˆ†å€ŸåŠ© **Kotlinæšä¸¾**çš„ä¼˜åŠ¿ï¼Œé€šè¿‡éå†çš„æ–¹å¼æ¥åšï¼š

```plain
fun parseOperator(input: String): Operation? {
    Operation.values().forEach {
        if (input.contains(it.value)) {
            return it
        }
    }
    return null
}
```

å¯ä»¥çœ‹åˆ°ï¼Œä¼˜åŒ–åçš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¸å†éœ€è¦æ‰‹åŠ¨åœ°å»å†™whençš„é€»è¾‘åˆ†æ”¯ï¼Œä¹Ÿä¸å¿…è‡ªå·±å»æšä¸¾Operationçš„æ¯ä¸€ç§æƒ…å†µï¼Œå°±è¿ä»£ç é‡ä¹Ÿé™ä½äº†å¾ˆå¤šï¼Œå³ä½¿å°†æ¥æšä¸¾ç§ç±»å¢åŠ äº†ï¼Œæˆ‘ä»¬ä¹Ÿä¸å¿…ä¿®æ”¹è¿™éƒ¨åˆ†ä»£ç äº†ã€‚

éœ€è¦æ³¨æ„ï¼Œä»¥ä¸Šçš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ç”¨åˆ°äº†é›†åˆéå†çš„è¯­æ³•â€œforEachâ€ï¼Œä½ å¯ä»¥å°†å®ƒæƒ³è±¡æˆå¼ºåŒ–ç‰ˆçš„forå¾ªç¯ï¼Œå®ƒå…·ä½“çš„ç”¨æ³•æˆ‘ä¼šåœ¨åé¢â€œKotliné›†åˆâ€é‚£ä¸€èŠ‚ä¸­è®²è§£ã€‚

ç°åœ¨ï¼Œå¯¹äºä¸€ä¸ªç®—å¼â€œ1+2â€ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥æˆåŠŸè§£æå‡ºæ“ä½œç¬¦â€œ+â€äº†ï¼Œæ¥ä¸‹æ¥è¦åšçš„ï¼Œå°±æ˜¯é€šè¿‡â€œ+â€æ¥åˆ†å‰²å­—ç¬¦ä¸²ï¼Œå°†å·¦å³ä¸¤ä¸ªæ•°å­—å–å‡ºæ¥â€œ1â€â€œ2â€ã€‚è¿™ä¸ªé€»è¾‘å°±å¾ˆç®€å•äº†ï¼š

```plain
fun parseExpression(input: String): Expression? {
    // è§£ææ“ä½œç¬¦
    val operation = parseOperator(input) ?: return null
    // ç”¨æ“ä½œç¬¦åˆ†å‰²ç®—å¼ï¼Œæ‹¿åˆ°æ•°å­—
    val list = input.split(operation.value)
    if (list.size != 2) return null

    return Expression(
        // ç®—å¼å·¦è¾¹
        left = list[0].trim(),
        operator = operation,
        // ç®—å¼å³è¾¹
        right = list[1].trim()
    )
}
```

ä»¥ä¸Šä»£ç å¤§è‡´åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼Œæˆ‘ä»¬ä»¥â€œ1+2â€ä¸ºä¾‹ï¼š

- ç¬¬ä¸€ä¸ªæ­¥éª¤ï¼Œè°ƒç”¨parseOperator()æ–¹æ³•è§£ææ“ä½œç¬¦â€œ+â€ï¼›
- ç¬¬äºŒä¸ªæ­¥éª¤ï¼Œæ ¹æ®æ“ä½œç¬¦åˆ†å‰²ç®—å¼çš„æ•°å­—ï¼Œåˆ†å‰²ä¹‹åå¾—åˆ°çš„ä¼šæ˜¯â€œ1â€â€œ2â€ç»„æˆçš„åˆ—è¡¨ï¼›
- ç¬¬ä¸‰ä¸ªæ­¥éª¤ï¼Œå°†æ“ä½œç¬¦ã€æ•°å­—ç»„åˆæˆExpressionå¯¹è±¡ã€‚

è¿™é‡Œæœ‰ä¸€ä¸ªç»†èŠ‚éœ€è¦æ³¨æ„ï¼Œæˆ‘ä»¬å…¼å®¹çš„è¾“å…¥å…¶å®æœ‰ä¸¤ç§æƒ…å†µï¼Œç¬¬ä¸€ç§æ˜¯**ä¸åŒ…å«ç©ºæ ¼**â€œ1+2â€ï¼Œé‚£ä¹ˆæˆ‘ä»¬è§£æå‡ºæ¥çš„æ•°å­—ä¼šæ˜¯â€œ1â€â€œ2â€ï¼Œè¿™ç§æƒ…å†µä¸‹ä¸ä¼šæœ‰é—®é¢˜ï¼›ä½†è¿˜æœ‰ç¬¬äºŒç§æƒ…å†µ**åŒ…å«ç©ºæ ¼**ï¼Œå¯¹äºåŸæœ¬æ­£ç¡®çš„æ ¼å¼ï¼Œæˆ‘ä»¬æ›´åº”è¯¥æ”¯æŒï¼Œæ¯”å¦‚â€œ1 + 2â€ï¼Œè¢«åˆ†éš”ä¹‹åçš„ç»“æœä¼šæ˜¯â€œ1 â€â€œ2â€ï¼Œè¿™ä¸¤ä¸ªæ•°å­—å½“ä¸­æ˜¯åŒ…å«ç©ºæ ¼ç¬¦çš„ã€‚

æ‰€ä»¥ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†`list[0].trim()`ï¼Œè¿™é‡Œçš„`trim()`æ–¹æ³•å°±æ˜¯ç”¨äºå»æ‰å¤šä½™ç©ºæ ¼çš„ã€‚

è®©æˆ‘ä»¬å®é™…è¿è¡Œä¸€ä¸‹çœ‹çœ‹æ•ˆæœï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/ce/b2/ce2c6debc469a274d7d0a6fd488978b2.gif?wh=852x452)

è‡³æ­¤ï¼Œæˆ‘ä»¬çš„è®¡ç®—å™¨2.0ç‰ˆæœ¬å°±å®Œæˆäº†ã€‚åœ¨2.0ç‰ˆæœ¬çš„å®æ“è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å…¶å®æ˜¯åœ¨åŸæœ‰çš„åŸºç¡€ä¸Šï¼Œèå…¥äº†é¢å‘å¯¹è±¡çš„æ€æƒ³ï¼Œå°†è®¡ç®—å™¨åŠŸèƒ½æ”¶æ‹¢åˆ°äº†ä¸€ä¸ªç±»å½“ä¸­ï¼ŒåŒæ—¶ä¹Ÿå¯¹è®¡ç®—å™¨å†…éƒ¨çš„æ–¹æ³•è¿›è¡Œäº†ç»†é¢—ç²’åº¦çš„æ‹†åˆ†ã€‚

åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸‰ä¸ªç±»ï¼šâ€œCalculatorâ€ç±»ï¼Œä»£è¡¨æ•´ä¸ªè®¡ç®—å™¨ï¼›â€œOperationâ€æšä¸¾ç±»ï¼Œä»£è¡¨åŠ å‡ä¹˜é™¤å››ç§è¿ç®—æ“ä½œç¬¦ï¼›â€œExpressionâ€æ•°æ®ç±»ï¼Œä»£è¡¨æˆ‘ä»¬ç®—å¼å½“ä¸­çš„æ•°å­—å’Œæ“ä½œç¬¦ã€‚ä¹‹åï¼Œæˆ‘ä»¬åˆå¯¹è®¡ç®—å™¨çš„æ ¸å¿ƒåŠŸèƒ½è¿›è¡Œäº†æ›´ç»†é¢—ç²’åº¦çš„æ‹†åˆ†ï¼Œæé«˜äº†ç¨‹åºçš„çµæ´»æ€§ï¼Œä¸ºæˆ‘ä»¬çš„åŠŸèƒ½æ‰©å±•æ‰“ä¸‹äº†åŸºç¡€ã€‚

å¥½äº†ï¼Œç°åœ¨è®©æˆ‘ä»¬è¿›å…¥3.0ç‰ˆæœ¬çš„å¼€å‘å§ã€‚

## è®¡ç®—å™¨3.0

é’ˆå¯¹3.0è¿™ä¸ªç‰ˆæœ¬ï¼Œæˆ‘ä»¬ä¹Ÿåˆ†ä¸ºäº†ä¸¤ä¸ªé˜¶æ®µï¼š

- ç¬¬ä¸€é˜¶æ®µï¼Œ**å¢åŠ å•å…ƒæµ‹è¯•**ã€‚å•å…ƒæµ‹è¯•æ˜¯è½¯ä»¶å·¥ç¨‹å½“ä¸­çš„ä¸€ä¸ªæ¦‚å¿µï¼Œå®ƒæŒ‡çš„æ˜¯å¯¹è½¯ä»¶å½“ä¸­çš„æœ€å°å¯æ‰§è¡Œå•å…ƒè¿›è¡Œæµ‹è¯•ï¼Œä»¥æé«˜è½¯ä»¶çš„ç¨³å®šæ€§ã€‚åœ¨Javaå½“ä¸­ï¼Œæœ€å°å•å…ƒä¸€èˆ¬ä¼šè®¤ä¸ºæ˜¯ç±»ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šä»¥ç±»ä¸ºå•å…ƒï¼Œå¯¹ç±»å½“ä¸­çš„æ–¹æ³•è¿›è¡Œä¸€ä¸€æµ‹è¯•ã€‚
- ç¬¬äºŒé˜¶æ®µï¼Œ**æ”¯æŒå¤§æ•°çš„åŠ æ³•**ã€‚æˆ‘ä»¬çŸ¥é“Javaã€Kotlinå½“ä¸­çš„æ•´å‹éƒ½æ˜¯æœ‰èŒƒå›´é™åˆ¶çš„ï¼Œå¦‚æœæˆ‘ä»¬è¾“å…¥ä¸¤ä¸ªç‰¹åˆ«å¤§çš„æ•°å­—è¿›è¡Œè®¡ç®—ï¼Œé‚£ä¹ˆç¨‹åºæ˜¯æ— æ³•æ­£å¸¸å·¥ä½œçš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ç‰¹åˆ«å¤§çš„æ•°è¿›è¡Œå…¼å®¹ã€‚

ä¸‹é¢ï¼Œæˆ‘ä»¬å…ˆæ¥æå®šå•å…ƒæµ‹è¯•ã€‚

### ç¬¬ä¸€é˜¶æ®µï¼šå•å…ƒæµ‹è¯•

åœ¨Kotlinå½“ä¸­ï¼Œå¦‚æœè¦ä½¿ç”¨å•å…ƒæµ‹è¯•ï¼Œæˆ‘ä»¬éœ€è¦åœ¨gradleæ–‡ä»¶å½“ä¸­ï¼Œæ·»åŠ Kotlinå®˜æ–¹æä¾›çš„ä¾èµ–ï¼š

```plain
testImplementation 'org.jetbrains.kotlin:kotlin-test'
```

è¿™æ ·ï¼Œæˆ‘ä»¬çš„å·¥ç¨‹å°±æ‹¥æœ‰å•å…ƒæµ‹è¯•çš„èƒ½åŠ›äº†ã€‚å•å…ƒæµ‹è¯•çš„ä»£ç ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šæ”¾åœ¨å·¥ç¨‹çš„testç›®å½•ä¸‹ï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/c3/1f/c305f53c828d94e671f7e89267c2111f.png?wh=395x629)

æˆ‘ä»¬å¯ä»¥ä»è¿™ä¸ªå›¾ä¸­çœ‹å‡ºå¾ˆå¤šä¿¡æ¯ï¼š

- ç¬¬ä¸€ï¼Œtestç›®å½•ã€mainç›®å½•ï¼Œå®ƒä»¬æ˜¯å¹³çº§çš„ç›®å½•ï¼Œå†…éƒ¨æ‹¥æœ‰ç€ç›¸åŒçš„ç»“æ„ã€‚mainç›®å½•ä¸‹æ”¾çš„æ˜¯åŠŸèƒ½ä»£ç ï¼Œtestç›®å½•ä¸‹æ”¾çš„åˆ™æ˜¯æµ‹è¯•ä»£ç ã€‚
- ç¬¬äºŒï¼Œç”±äºæˆ‘ä»¬è¦å¼€å‘3.0ç‰ˆæœ¬ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨mainç›®å½•ä¸‹åˆ›å»ºäº†CalculatorV3è¿™ä¸ªç±»ï¼›å¦å¤–ï¼Œç”±äºæˆ‘ä»¬éœ€è¦åœ¨3.0ç‰ˆæœ¬åŠ å…¥å•å…ƒæµ‹è¯•ï¼Œæ‰€ä»¥å¯¹åº”çš„ï¼Œæˆ‘ä»¬åœ¨testç›®å½•ä¸‹ç›¸åŒçš„åœ°æ–¹ï¼Œåˆ›å»ºäº†TestCalculatorV3ã€‚è¿™ä¸¤ä¸ªç±»çš„å…³ç³»æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼ŒCalculatorV3æ˜¯ä¸ºäº†å®ç°3.0ç‰ˆæœ¬çš„åŠŸèƒ½ï¼ŒTestCalculatorV3æ˜¯ä¸ºäº†æµ‹è¯•3.0ç‰ˆæœ¬çš„åŠŸèƒ½ï¼Œç¡®ä¿åŠŸèƒ½æ­£å¸¸ã€‚

ä¸è¿‡è¿™é‡Œä½ è¦**æ³¨æ„**ï¼Œè™½ç„¶æˆ‘ä»¬åˆ›å»ºäº†CalculatorV3è¿™ä¸ªç±»ï¼Œä½†å…¶å®å®ƒé‡Œé¢çš„ä»£ç è¿˜æ˜¯ç”¨çš„CalculatorV2çš„ä»£ç ã€‚3.0ç‰ˆæœ¬çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬æ”¾åˆ°ç¬¬äºŒé˜¶æ®µæ‰ä¼šå»å®ç°ã€‚

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬æ¥ç¼–å†™æµ‹è¯•ä»£ç ï¼š

```plain
class TestCalculatorV3 {
    @Test
    fun testCalculate() {
        val calculator = CalculatorV3()

        val res1 = calculator.calculate("1+2")
        assertEquals("3", res1)
    }
}
```

é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæ–¹æ³•testCalculate()ï¼Œå¹¶ä¸”ä½¿ç”¨äº†ä¸€ä¸ªæ³¨è§£@Testæ¥ä¿®é¥°å®ƒã€‚å› ä¸ºè¿™æ ·åšä»¥åï¼ŒIntelliJå°±ä¼šçŸ¥é“ï¼šå“¦ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨æ¥åšæµ‹è¯•çš„æ–¹æ³•ã€‚

æ¥ç€ï¼Œæˆ‘ä»¬åœ¨testCalculate()å½“ä¸­åˆ›å»ºäº†ä¸€ä¸ªCalculatorV3çš„å¯¹è±¡ï¼Œç„¶åè°ƒç”¨äº†å®ƒçš„calculate()æ–¹æ³•ï¼Œä¼ å…¥äº†â€œ1+2â€ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœç¨‹åºæ­£å¸¸å·¥ä½œçš„è¯ï¼Œè¿”å›çš„ç»“æœåº”è¯¥æ˜¯â€œ3â€ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ç´§æ¥ç€å°±æ‰§è¡Œäº†ä¸€ä¸ª**æ–­è¨€**â€œassertEquals(â€œ3â€, res1)â€ï¼Œå®ƒçš„æ„æ€æ˜¯â€œres1ä¸€å®šç­‰äº3â€ã€‚å¦‚æœres1=3ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„å•å…ƒæµ‹è¯•å°±ä¼šæˆåŠŸï¼Œå¦åˆ™å°±ä¼šå¤±è´¥ã€‚

æˆ‘ä»¬å¯ä»¥çœ‹çœ‹å•å…ƒæµ‹è¯•è¿è¡ŒæˆåŠŸçš„æ•ˆæœï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/b1/b1/b1c48ab4dd9c900bc3ee2e020da187b1.gif?wh=1348x960)

å¦‚æœè¿™æ—¶å€™ï¼Œæˆ‘ä»¬å°†â€œ1+2â€æ”¹æˆå¤§æ•°çš„åŠ æ³•ï¼Œæ¯”å¦‚â€œ2333333333333332+1â€ï¼Œå¹¶ä¸”å°†æ–­è¨€ä¹Ÿä¿®æ”¹ä¸€ä¸‹ï¼š

```plain
val res1 = calculator.calculate("2333333333333332+1")
assertEquals("2333333333333333", res1)
```

é‚£ä¹ˆï¼Œä½ è§‰å¾—å•å…ƒæµ‹è¯•çš„ç»“æœä¼šæ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿ

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/b9/bc/b968fc9666cefc95545cd022e7a523bc.gif?wh=1348x960)

å•å…ƒæµ‹è¯•å¤±è´¥äº†ï¼

å…·ä½“åŸå› ç›¸ä¿¡ä½ ä¸€å®šä¹Ÿèƒ½çŒœåˆ°ï¼Œå› ä¸ºâ€œ2333333333333332â€è¿™ä¸ªæ•°å®åœ¨å¤ªå¤§äº†ï¼Œå·²ç»è¿œè¿œè¶…å‡ºäº†Intç±»å‹çš„èŒƒå›´ï¼Œå¦‚æœä¸åšç‰¹æ®Šå¤„ç†çš„è¯ï¼Œæˆ‘ä»¬çš„ç¨‹åºæ˜¯æ— æ³•æ­£å¸¸è¿è¡Œçš„ã€‚è€Œè¿™æ­£å¥½å°±æ˜¯æˆ‘ä»¬ä¸‹ä¸€ä¸ªé˜¶æ®µè¦åšçš„äº‹æƒ…ï¼šæ”¯æŒå¤§æ•°çš„åŠ æ³•ã€‚ä¸è®ºå¤šå¤§çš„ä¸¤ä¸ªæ•°å­—ç›¸åŠ ï¼Œæˆ‘ä»¬éƒ½è¦ç®—å‡ºæ­£ç¡®çš„ç»“æœã€‚

è¿™ä¸ªå•å…ƒæµ‹è¯•çš„ä»£ç æˆ‘ä»¬å…ˆç•™ç€ï¼Œç­‰æˆ‘ä»¬å®ç°â€œå¤§æ•°çš„åŠ æ³•â€åï¼Œæˆ‘ä»¬å†é‡æ–°è¿è¡Œä¸€éï¼Œè¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å€Ÿæ­¤éªŒè¯ä»£ç æ˜¯å¦æ­£ç¡®ã€‚

### ç¬¬äºŒé˜¶æ®µï¼šå¤§æ•°åŠ æ³•

å¤§æ•°çš„åŠ æ³•ï¼Œå…¶å®æ˜¯æˆ‘ä»¬ç¨‹åºå‘˜é¢è¯•å½“ä¸­çš„ä¸€é“é«˜é¢‘é¢˜ã€‚å®ƒçš„è§£é¢˜æ€è·¯ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯é€šè¿‡æ¨¡æ‹Ÿæˆ‘ä»¬**æ‰‹å†™åŠ æ³•ç«–å¼**çš„æ–¹æ³•ï¼Œä»ä¸ªä½ã€åä½ã€ç™¾ä½ã€åƒä½ï¼Œä¸€ç›´ç´¯åŠ ï¼Œè¶…è¿‡10çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦è¿›ä½ã€‚

æˆ‘ä»¬ä»¥â€œ135+99â€ä¸ºä¾‹ï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/f7/83/f777d39dd91641f5fb0b58a43e9bfc83.gif?wh=405x434)

ä»ä¸Šé¢çš„æ‰‹å†™åŠ æ³•ç«–å¼çš„è¿‡ç¨‹æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªè®¡ç®—å…¶å®å°±æ˜¯åˆ†äº†ä¸‰ä¸ªæ­¥éª¤åœ¨è¿›è¡Œï¼Œåˆ†åˆ«æ˜¯ä¸ªä½ã€åä½ã€ç™¾ä½ï¼š

- ä¸ªä½è®¡ç®—ï¼Œâ€œ5+9=14â€ï¼Œå‡ºç°è¿›ä½ï¼Œè¿™æ—¶å€™æˆ‘ä»¬ç”¨carryæ¥å­˜å‚¨è¿›ä½ï¼šcarry=1ï¼Œä¸ªä½ç»“æœä¸º4ï¼›
- åä½è®¡ç®—ï¼Œåä½ç›¸åŠ â€œ3+9=12â€ï¼Œç”±äºä¹‹å‰æœ‰è¿‡è¿›ä½ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯â€œ3+9+1=13â€ï¼Œåä½ç»“æœä¸º3ï¼›
- ç™¾ä½è®¡ç®—ï¼Œç”±äº99ä¸å­˜åœ¨ç™¾ä½ï¼Œæˆ‘ä»¬è‡ªåŠ¨è¡¥é›¶ï¼Œæ‰€ä»¥å°±åº”è¯¥æ˜¯â€œ1+0+1=2â€ï¼Œç™¾ä½ç»“æœä¸º2ã€‚

æœ€ç»ˆï¼Œæˆ‘ä»¬å°†æ¯ä¸€ä½çš„ç»“æœæ‹¼æ¥èµ·æ¥ï¼Œå°±å¾—åˆ°äº†æœ€ç»ˆçš„ç»“æœã€‚æœ‰äº†è¿™æ ·çš„æ€è·¯åï¼Œæˆ‘ä»¬çš„ä»£ç å°±å¾ˆå®¹æ˜“å®ç°äº†ã€‚

```plain
fun addString(leftNum: String, rightNum: String): String {
    // â‘ 
    val result = StringBuilder()
    // â‘¡
    var leftIndex = leftNum.length - 1
    var rightIndex = rightNum.length - 1
    // â‘¢
    var carry = 0

    // â‘£
    while (leftIndex >= 0 || rightIndex >= 0) {
        // â‘¤
        val leftVal = if (leftIndex >= 0) leftNum.get(leftIndex).digitToInt() else 0
        val rightVal = if (rightIndex >= 0) rightNum.get(rightIndex).digitToInt() else 0
        val sum = leftVal + rightVal + carry
        // â‘¥
        carry = sum / 10
        result.append(sum % 10)
        leftIndex--
        rightIndex--
    }
    // â‘¦
    if (carry != 0) {
        result.append(carry)
    }

    // â‘§
    return result.reverse().toString()
}
```

ä¸Šé¢çš„ä»£ç ä¸€å…±æœ‰8å¤„æ³¨é‡Šï¼Œä»£è¡¨äº†æ•´ä½“çš„ç¨‹åºæµç¨‹ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥åˆ†æï¼š

- æ³¨é‡Šâ‘ ï¼Œæˆ‘ä»¬**åˆ›å»ºäº†ä¸€ä¸ªStringBuilderå¯¹è±¡ï¼Œ**ç”¨äºå­˜å‚¨æœ€ç»ˆç»“æœï¼Œç”±äºæˆ‘ä»¬çš„ç»“æœæ˜¯ä¸€ä½ä½è®¡ç®—å‡ºæ¥çš„ï¼Œæ‰€ä»¥æ¯ä¸€ä½ç»“æœéƒ½æ˜¯æ…¢æ…¢æ‹¼æ¥ä¸Šå»çš„ï¼Œåœ¨è¿™é‡Œï¼Œä¸ºäº†æé«˜ç¨‹åºçš„æ€§èƒ½ï¼Œæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨StringBuilderã€‚
- æ³¨é‡Šâ‘¡ï¼Œæˆ‘ä»¬**å®šä¹‰äº†ä¸¤ä¸ªå¯å˜çš„å˜é‡index**ï¼Œå®ƒä»¬åˆ†åˆ«æŒ‡å‘äº†ä¸¤ä¸ªæ•°å­—çš„ä¸ªä½ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬çš„è®¡ç®—æ˜¯ä»ä¸ªä½å¼€å§‹çš„ã€‚
- æ³¨é‡Šâ‘¢ï¼Œ**carry**ï¼Œæˆ‘ä»¬ç”¨å®ƒæ¥å­˜å‚¨æ¯ä¸€ä½è®¡ç®—ç»“æœçš„è¿›ä½ã€‚
- æ³¨é‡Šâ‘£ï¼Œè¿™ä¸ª **whileå¾ªç¯**å½“ä¸­ï¼Œæˆ‘ä»¬ä¼šè®©ä¸¤ä¸ªindexä»ä½ä½ä¸€ç›´åˆ°é«˜ä½ï¼Œç›´åˆ°éå†å®Œå®ƒä»¬æ‰€æœ‰çš„æ•°å­—ä½ã€‚
- æ³¨é‡Šâ‘¤ï¼Œè¿™é‡Œçš„é€»è¾‘æ˜¯**å–æ¯ä¸€ä½ä¸Šçš„æ•°å­—**ï¼Œå…¶ä¸­æœ‰ä¸ªç»†èŠ‚å°±æ˜¯è¡¥é›¶æ“ä½œï¼Œæ¯”å¦‚å½“ç¨‹åºè¿è¡Œåˆ°ç™¾ä½çš„æ—¶å€™ï¼Œ99æ²¡æœ‰ç™¾ä½ï¼Œè¿™æ—¶å€™rightVal = 0ã€‚
- æ³¨é‡Šâ‘¥ï¼Œå½“æˆ‘ä»¬çš„ç¨‹åºè®¡ç®—å‡ºç»“æœåï¼Œæˆ‘ä»¬è¦**åˆ†åˆ«ç®—å‡ºcarryï¼Œä»¥åŠå½“å‰ä½çš„ç»“æœ**ã€‚è¿™æ—¶å€™æˆ‘ä»¬åˆ†åˆ«ä½¿ç”¨â€œé™¤æ³•â€è®¡ç®—carryï¼Œä½¿ç”¨â€œå–ä½™â€æ“ä½œè®¡ç®—å½“å‰ä½çš„ç»“æœã€‚
- æ³¨é‡Šâ‘¦ï¼Œè¿™é‡Œæ˜¯**ä¸ºäº†å…¼å®¹ä¸€ä¸ªç‰¹æ®Šçš„åœºæ™¯**ï¼Œåœ¨â€œ99+1â€çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„whileå¾ªç¯æœ€å¤šåªä¼šéå†åˆ°åä½ï¼Œå¦‚æœä¸åšç‰¹æ®Šå¤„ç†çš„è¯ï¼Œç»“æœå°†å˜æˆâ€œ99+1=00â€ã€‚è¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œæ‰€ä»¥ï¼Œä¸ºäº†å…¼å®¹è¿™ç§ç‰¹æ®Šæƒ…å†µï¼Œæˆ‘ä»¬**åœ¨whileå¾ªç¯ç»“æŸåå¢åŠ äº†ä¸€ä¸ªåˆ¤æ–­**ï¼Œå¦‚æœcarry=1ï¼Œé‚£å°±è¯´æ˜åœ¨æœ€å¤§çš„é‚£ä¸€ä½æ•°è®¡ç®—å®Œä»¥åï¼Œä»ç„¶æœ‰è¿›ä½ï¼Œæˆ‘ä»¬è¦æ‰‹åŠ¨æ·»åŠ ã€‚
- æ³¨é‡Šâ‘§ï¼Œå¯¹äºä¸€ä¸ªç®—å¼â€œ135+99â€ï¼Œæˆ‘ä»¬çš„resultæ‹¼æ¥å…¶å®æ˜¯å€’å™çš„â€œ432â€ï¼Œè¿™æ—¶å€™æˆ‘ä»¬éœ€è¦**å°†å…¶ç¿»è½¬**ä¸€ä¸‹ï¼Œæ‰èƒ½å¾—åˆ°æ­£ç¡®çš„ç»“æœâ€œ135+99=234â€ã€‚

åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬çš„å¤§æ•°åŠ æ³•åŠŸèƒ½ï¼Œå°±ç®—å®ç°äº†ã€‚è®©æˆ‘ä»¬å›è¿‡å¤´ï¼Œå†å»è¿è¡Œä¸€æ¬¡å•å…ƒæµ‹è¯•ï¼Œæ¥éªŒè¯ä¸‹æˆ‘ä»¬çš„ä»£ç æ˜¯å¦æ­£ç¡®ï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/4d/eb/4dd2dyyf2b31cd5379a7134b0f6822eb.gif?wh=1348x960)

æœç„¶ï¼Œåœ¨æˆ‘ä»¬å…¼å®¹äº†â€œå¤§æ•°åŠ æ³•â€ä»¥åï¼Œå•å…ƒæµ‹è¯•å°±å¯ä»¥æˆåŠŸé€šè¿‡äº†ã€‚è‡³æ­¤ï¼Œæˆ‘ä»¬çš„è®¡ç®—å™¨3.0ç‰ˆæœ¬å°±ç®—æ˜¯å®Œæˆäº†ã€‚

åœ¨è¿™ä¸ªç‰ˆæœ¬çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆæˆ‘ä»¬å¼•å…¥äº†å•å…ƒæµ‹è¯•ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥æµ‹è¯•ä»£ç é€»è¾‘æ˜¯å¦æ­£ç¡®ï¼Œå¹¶å¯ä»¥è¾…åŠ©æˆ‘ä»¬æ’æŸ¥é—®é¢˜ã€‚æ¥ç€ï¼Œæˆ‘ä»¬å†™äº†ä¸€ä¸ªâ€œ2333333333333332+1â€çš„æµ‹è¯•ç”¨ä¾‹ï¼Œå¹¶ä¸”å¤±è´¥äº†ï¼Œä¸è¿‡åœ¨å®Œæˆå¤§æ•°åŠ æ³•çš„åŠŸèƒ½åï¼Œè¿™ä¸ªæµ‹è¯•ä¹Ÿæœ€ç»ˆé€šè¿‡äº†ã€‚

è¿™é‡Œæˆ‘éœ€è¦ç‰¹æ®Šè¯´æ˜çš„æ˜¯ï¼Œä¸ºäº†ä¸åç¦»æœ¬æ¬¡å®æˆ˜è¯¾çš„ç›®çš„ï¼Œæˆ‘ä»¬çš„å•å…ƒæµ‹è¯•åªå†™äº†ä¸¤ä¸ªï¼Œä½†åœ¨å®é™…çš„å¼€å‘å·¥ä½œå½“ä¸­ï¼Œå•å…ƒæµ‹è¯•æ˜¯éœ€è¦å°½é‡è¦†ç›–æ‰€æœ‰æƒ…å†µçš„ã€‚æ¢å¥è¯è¯´ï¼Œä»…ä»…åªæ˜¯æµ‹è¯•â€œ1+2â€â€œ2333333333333332+1â€è¿™ä¸¤ç§æƒ…å†µï¼Œæ˜¯æ— æ³•ä¿è¯æˆ‘ä»¬çš„è®¡ç®—å™¨é€»è¾‘æ­£ç¡®çš„ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸ªåº”ç”¨äºå•†ä¸šçš„è®¡ç®—å™¨ï¼Œå®ƒçš„å•å…ƒæµ‹è¯•ç”¨ä¾‹æ•°é‡ä¼šè¾¾åˆ°å‡ ç™¾ä¸Šåƒä¸ªã€‚

## å°ç»“

åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±é€šè¿‡å®Œæˆä¸‰ä¸ªä¸åŒç‰ˆæœ¬çš„å››åˆ™è¿ç®—è®¡ç®—å™¨ï¼Œä¸€èµ·æ¢³ç†äº†å‰é¢è¯¾ç¨‹ä¸­ï¼Œå­¦ä¹ çš„é‚£äº›é‡è¦çš„Kotlinçš„çŸ¥è¯†ç‚¹ï¼Œæ¯”å¦‚ä¸å¯å˜çš„å˜é‡valã€whenè¡¨è¾¾å¼ã€æ•°æ®ç±»ã€æšä¸¾ç±»ï¼Œç­‰ç­‰ã€‚å¹¶ä¸”ä¹Ÿåœ¨å®æ“è¿‡ç¨‹ä¸­ï¼Œä¸€èµ·æ€è€ƒäº†ä»£ç å®ç°æ—¶å¯èƒ½ä¼šå‡ºç°çš„é—®é¢˜ã€‚

ä½ ä¹Ÿå¯ä»¥åœ¨åŠ¨æ‰‹æ“ä½œçš„è¿‡ç¨‹ä¸­ï¼Œå…·ä½“æ„Ÿå—ä¸‹è·ŸJavaä»£ç çš„ä¸åŒï¼ŒåŒæ—¶ä¹Ÿçœ‹çœ‹è‡ªå·±çš„æ€è·¯ä¸è¯¾ç¨‹çš„æ€è·¯æœ‰ä»€ä¹ˆä¸åŒï¼Œè¯¾ç¨‹å½“ä¸­çš„ä»£ç è¿˜æœ‰å“ªäº›å¯ä»¥æ”¹è¿›çš„åœ°æ–¹ã€‚

æœ€åæˆ‘æƒ³è®©ä½ æ³¨æ„çš„æ˜¯ï¼Œåœ¨3.0ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬å¼•å…¥äº†**å•å…ƒæµ‹è¯•åŠŸèƒ½**ã€‚å®é™…ä¸Šï¼Œå•å…ƒæµ‹è¯•çš„ä½œç”¨ï¼Œä¸ä»…ä»…å¯ä»¥éªŒè¯æ–°å¼€å‘çš„åŠŸèƒ½ï¼ŒåŒæ—¶å®ƒè¿˜å¯ä»¥ç”¨äºä¿è¯æ—§çš„åŠŸèƒ½ä¸å—å½±å“ã€‚åœ¨å®é™…å¼€å‘å·¥ä½œä¸­ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å› ä¸ºå¯¹åŠŸèƒ½Açš„æ”¹åŠ¨ï¼Œå¯¼è‡´åŠŸèƒ½Bå‡ºé—®é¢˜ã€‚ç„¶åå¾€å¾€ç”±äºæ—¶é—´é™åˆ¶ï¼Œæµ‹è¯•äººå‘˜åªæµ‹è¯•äº†åŠŸèƒ½Aï¼Œå¿½ç•¥äº†åŠŸèƒ½Bï¼Œæœ€ç»ˆå¯¼è‡´çº¿ä¸Šæ•…éšœå¸¦æ¥ç»æµæŸå¤±ã€‚

è€Œå€ŸåŠ©å•å…ƒæµ‹è¯•ï¼Œåœ¨æ¯ä¸€æ¬¡çš„å¼€å‘å·¥ä½œå®Œæˆä»¥åï¼Œæˆ‘ä»¬å°±ç»Ÿä¸€è·‘ä¸€éæ‰€æœ‰çš„å•å…ƒæµ‹è¯•ï¼Œåªè¦å•å…ƒæµ‹è¯•é€šè¿‡äº†ï¼Œæˆ‘ä»¬å°±èƒ½ä¿è¯ï¼Œæ–°çš„åŠŸèƒ½æ²¡é—®é¢˜ï¼Œè€Œæ—§çš„åŠŸèƒ½ä¹Ÿæ²¡é—®é¢˜ã€‚

## åŠ¨æ‰‹å®æ“

åœ¨3.0ç‰ˆæœ¬çš„å¼€å‘å½“ä¸­ï¼Œæˆ‘ä»¬ä»…ä»…åªå®ç°äº†â€œå¤§æ•°çš„åŠ æ³•â€ï¼Œå…¶ä½™çš„â€œå¤§æ•°çš„å‡æ³•â€â€œå¤§æ•°çš„ä¹˜æ³•â€â€œå¤§æ•°çš„é™¤æ³•â€éƒ½æ²¡æœ‰å®ç°ã€‚è¯·ä½ æŒ‘å…¶ä¸­ä¸€ä¸ªåŠŸèƒ½ï¼Œå°è¯•è‡ªå·±å®ç°ï¼Œå‚è€ƒç­”æ¡ˆæˆ‘ä¼šåœ¨ä¹‹åæ”¾å‡ºæ¥ã€‚

æ¬¢è¿ä½ åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„å®ç°æ€è·¯ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ15ï¼‰</strong></div><ul>
<li><span>qinsi</span> ğŸ‘ï¼ˆ32ï¼‰ ğŸ’¬ï¼ˆ5ï¼‰<p>val left = exp.left
val operator = exp.operator
val right = exp.right

æ˜¯ä¸æ˜¯å¯ä»¥å†™æˆ

val (left, operator, right) = exp</p>2022-01-04</li><br/><li><span>ç‹ç‰æœ‹</span> ğŸ‘ï¼ˆ6ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼Œ135+99çš„åŠ æ³•ç«–å¼åŠ¨ç”»å›¾æ˜¯ç”¨ä»€ä¹ˆåšçš„ï¼Ÿ</p>2022-01-04</li><br/><li><span>Geek_Adr</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>V3å®æˆ˜ åŠ  ç®—æ³• ï¼æé«˜è¯­è¨€çš„æ‰‹æ„Ÿï¼Ÿ
åå­¦ç”Ÿå·æ‡’ string.toBigInteger()
</p>2022-02-04</li><br/><li><span>JokerFake</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æ‰€ä»¥æšä¸¾é‚£åªèƒ½ä¼ ADD ä¸èƒ½ä¼ + è¿™ä¸ªbugæ˜¯æ•…æ„å°±ç»™æˆ‘ä»¬è‡ªå·±æ”¹çš„ï¼Ÿ</p>2022-01-06</li><br/><li><span>è‹ç‹</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>private fun minusString(left: String, right: String): String {
        val result = StringBuilder()

        &#47;&#47;åˆ¤æ–­æ˜¯å¦ç»“æœä½è´Ÿæ•°
        val isMinus = (left.length &lt; right.length || left.length == right.length &amp;&amp; left[0] &lt; right[0])

        var leftIndex = left.length - 1
        var rightIndex = right.length - 1
        var _left = left
        var _right = right
        if (isMinus) {
            _left = right
            _right = left
            leftIndex = _left.length - 1
            rightIndex = _right.length - 1
        }

        var carry = 0
        while (leftIndex &gt;= 0 || rightIndex &gt;= 0) {
            val leftVal = if (leftIndex &gt;= 0) _left[leftIndex].digitToInt() else 0
            val rightVal = if (rightIndex &gt;= 0) _right[rightIndex].digitToInt() else 0
            var sum: Int
            if (leftVal - rightVal &lt; 0) {
                sum = leftVal - rightVal + 10 + carry
                carry = -1
            } else {
                sum = leftVal - rightVal + carry
                carry = 0
            }
            result.append(sum)
            leftIndex--
            rightIndex--

        }

        if (isMinus) {
            result.append(&quot;-&quot;)
        }

        return result.reverse().toString()
    }


 @Test
    fun testCalculateMinus1() {
        val calculatorV = CalculatorV3()

        val result = calculatorV.calculate(&quot;90-1&quot;)
        assertEquals(&quot;89&quot;, result)
    }

    @Test
    fun testCalculateMinus2() {
        val calculatorV = CalculatorV3()

        val result = calculatorV.calculate(&quot;1-9&quot;)
        assertEquals(&quot;-8&quot;, result)
    }

    @Test
    fun testCalculateMinus3() {
        val calculatorV = CalculatorV3()

        val result = calculatorV.calculate(&quot;233333333333333333333-1&quot;)
        assertEquals(&quot;233333333333333333332&quot;, result)
    }</p>2022-01-30</li><br/><li><span>JL</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æ‚¨å¥½ï¼Œæƒ³é—®ä¸€ä¸ªå…³äºå•å…ƒæµ‹è¯•çš„é—®é¢˜ï¼š
æˆ‘åœ¨å·¥ä½œä¸­assertEquals å’Œ assertThat().equals() ä¸¤ç§éƒ½é‡åˆ°è¿‡ ä½†æ˜¯æœ‰äººè¯´ ç¬¬äºŒç§æ›´å¥½ä¸€ç‚¹ã€‚ æƒ³å¬å¬æ‚¨çš„æ„è§å’Œå»ºè®®ã€‚

ä¹‹å‰ç½‘ä¸Šæœäº†ä¸€ä¸‹ ä¹Ÿæ²¡æœ‰çœ‹åˆ°è¿‡è¯´å“ªä¸ªå¥½å“ªä¸ªå</p>2022-01-05</li><br/><li><span>droidYu</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>è€å¸ˆï¼ŒV1ç‰ˆæœ¬çš„ä»£ç è¾“å…¥ 3 + 4 ä¼šæŠ¥é”™ï¼šNo enum constant Operation.+ï¼›éœ€è¦è¾“å…¥3 ADD 4æ‰èƒ½æ­£å¸¸è¿è¡Œï¼Œæ˜¯æ‚¨æ ‡çš„â‘ å¤„çš„ä»£ç çš„é—®é¢˜Operation.valueOf()æ–¹æ³•æŠ›é”™ï¼Œä¸ºä»€ä¹ˆè¦æ•…æ„å†™é”™ï¼Œæ˜¯æœ‰ä»€ä¹ˆè®¾è®¡è¦è®²è§£å—ï¼Ÿ</p>2022-03-20</li><br/><li><span>çˆ±å­¦ä¹ çš„å°ç¾Š</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>private fun minus(left: String, right: String): String {

        var maxNumber = String()
        var mainNumber = String()
        var resultMean = String()
        val data = left.length - right.length
        if (data &gt; 0){
            maxNumber = left
            mainNumber = right
            resultMean = &quot;&quot;
        }else if (data &lt; 0){
            maxNumber = right
            mainNumber = left
            resultMean = &quot;-&quot;
        }else{
            var position = 0
            while (left.get(position).digitToInt() == right.get(position).digitToInt()){
                position++
            }
            if (left.get(position).digitToInt() - right.get(position).digitToInt() &gt; 0){
                maxNumber = left
                mainNumber = right
                resultMean = &quot;&quot;
            }else{
                maxNumber = right
                mainNumber = left
                resultMean = &quot;-&quot;
            }
        }
        val result = StringBuilder()
        var maxIndex = maxNumber.length - 1
        var mainIndex = mainNumber.length - 1
        var carry = 0
        while (maxIndex &gt;= 0 || mainIndex &gt;= 0) {
            var leftVal = if (maxIndex &gt;= 0) maxNumber.get(maxIndex).digitToInt() else 0
            var rightVal = if (mainIndex &gt;= 0) mainNumber.get(mainIndex).digitToInt() else 0
            leftVal -= carry
            while (leftVal + carry * 10 &lt; rightVal) {
                carry++
            }
            val sum = leftVal + carry * 10 - rightVal
            if (sum in 1..9) {
                result.append(sum)
            }
            maxIndex--
            mainIndex--
        }
        return result.append(resultMean).reverse().toString()
    }
å¤§ä½¬è¿™æ ·å†™å¯å—</p>2022-02-23</li><br/><li><span>æ•…äº‹ä¸é…’</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>å¤§æ•°åŠ å’Œä¹˜

fun minusString(left:String,right:String):String{
    val result = StringBuilder()
    var _left = left
    var _right = right
    var borrowNum = 0 &#47;&#47;æ˜¯å¦å‘å‰å€Ÿä½
    var leftIndex = left.length -1
    var rightIndex = right.length - 1


    &#47;&#47;åˆ¤æ–­æ˜¯å¦æ˜¯å°-å¤§
    val isRightBig = left.length&lt;right.length || left.length == right.length &amp;&amp; left[0] &lt; right[0]
    if (isRightBig){
         _left = right
         _right = left
        leftIndex = _left.length - 1
        rightIndex = _right.length - 1
    }


    while(leftIndex &gt;=0 || rightIndex &gt;= 0){
        val leftVal = if (leftIndex &gt;= 0) _left.get(leftIndex).digitToInt() else 0
        val rightVal = if (rightIndex &gt;= 0) _right.get(rightIndex).digitToInt() else 0

        val digitResult = leftVal - rightVal - borrow</p>2022-02-14</li><br/><li><span>å‰‘æ¥</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è®²ä¸€ä¸ªä¸æ˜¯å¾ˆå…³é”®çš„ä¸œè¥¿ï¼Œé€šè¿‡ä½ è¿™ä¸ªæ–¹å¼æ‹‰å–ä»£ç åï¼Œä¸€èˆ¬åˆšä¸‹æ¥æœ¬åœ°æ˜¯æ²¡æœ‰startåˆ†æ”¯çš„ï¼Œéœ€è¦é€šè¿‡origin&#47;startè¿™ä¸ªè¿œç¨‹åˆ†æ”¯å»checkoutã€‚</p>2022-01-24</li><br/><li><span>æµ…è‰²çš„é£</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p> fun minusString(leftNum: String, rightNum: String): String {
        val result = StringBuilder()
        var leftIndex = leftNum.length - 1
        var rightIndex = rightNum.length - 1

        var borrow = 0

        while(leftIndex &gt;= 0 || rightIndex &gt;= 0){
            var leftVal = if(leftIndex &gt;= 0 ) leftNum.get(leftIndex).digitToInt() else 0
            val rightVal = if(rightIndex &gt;= 0 ) rightNum.get(rightIndex).digitToInt() else 0

            leftVal -= borrow;

            if(leftVal &gt;= rightVal ) borrow = 0 else borrow = 1

            val minu = borrow*10 + leftVal - rightVal

            result.append(minu)

            leftIndex--
            rightIndex--
        }

        if (result.get(result.lastIndex).digitToInt() == 0) {
            result.deleteAt(result.lastIndex)
        }
        return result.reverse().toString()
    }</p>2022-01-17</li><br/><li><span>éƒ‘å³°</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>  private fun addString(left: String, right: String) = left.toBigDecimal().add(right.toBigDecimal()).toString()
  private fun minusString(left: String, right: String) = left.toBigDecimal().subtract(right.toBigDecimal()).toString()
  private fun multiString(left: String, right: String) = left.toBigDecimal().multiply(right.toBigDecimal()).toString()
  private fun divString(left: String, right: String) = left.toBigDecimal().divideToIntegralValue(right.toBigDecimal()).toString()
</p>2022-01-16</li><br/><li><span>çˆ±å­¦ä¹ çš„å°ç¾Š</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>å¤§ä½¬ä»¥åå‡ºä¹¦çš„è¯  å¯ä»¥é€æˆ‘ä¸€æœ¬å—</p>2022-01-11</li><br/><li><span>Marten</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<p>å¤§æ•°çš„å‡æ³•
fun minusString(left: String, right: String): String {
        val result = StringBuilder()
        var leftIndex = left.length - 1
        var rightIndex = right.length - 1

        var carry = 0

        while (leftIndex &gt;= 0 || rightIndex &gt;= 0) {
            var leftVal = if (leftIndex &gt;= 0) left.get(leftIndex).digitToInt() else 0
            var rightVal = if (rightIndex &gt;= 0) right.get(rightIndex).digitToInt() else 0
            leftVal -= carry
            while (leftVal + carry * 10 &lt; rightVal) {
                carry++
            }
            val sum = leftVal + carry * 10 - rightVal
            if (sum &lt;10) {
                result.append(sum)
            }
            leftIndex--
            rightIndex--

        }

        return result.reverse().toString().toInt().toString()
    }</p>2022-01-05</li><br/><li><span>Marten</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p> fun minusString(left: String, right: String): String {
        val result = StringBuilder()
        var leftIndex = left.length - 1
        var rightIndex = right.length - 1

        var carry = 0

        while (leftIndex &gt;= 0 || rightIndex &gt;= 0) {
            var leftVal = if (leftIndex &gt;= 0) left.get(leftIndex).digitToInt() else 0
            var rightVal = if (rightIndex &gt;= 0) right.get(rightIndex).digitToInt() else 0
            leftVal -= carry
            if (leftVal &lt; rightVal) {
                carry = 1
            }
            val sum = leftVal + carry * 10 - rightVal

            result.append(sum)
            leftIndex--
            rightIndex--

        }
        return result.reverse().toString()
    }</p>2022-01-05</li><br/>
</ul>