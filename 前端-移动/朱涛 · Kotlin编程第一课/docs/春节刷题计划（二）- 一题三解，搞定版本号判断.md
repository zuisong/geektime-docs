ä½ å¥½ï¼Œæˆ‘æ˜¯æœ±æ¶›ã€‚ä»Šå¤©æ˜¯é™¤å¤•å¤œï¼Œå…ˆç¥ä½ è™å¹´æ˜¥èŠ‚å¿«ä¹ï¼

åœ¨ä¸ŠèŠ‚åˆ·é¢˜è¯¾ä¸­ï¼Œæˆ‘ç»™ä½ ç•™äº†ä¸€ä¸ªä½œä¸šï¼Œé‚£å°±æ˜¯ï¼šç”¨Kotlinæ¥å®Œæˆ [LeetCodeçš„165å·é¢˜ã€Šç‰ˆæœ¬å·åˆ¤æ–­ã€‹](https://leetcode-cn.com/problems/compare-version-numbers/)ã€‚é‚£ä¹ˆä»Šå¤©è¿™èŠ‚è¯¾ï¼Œæˆ‘å°±æ¥è®²è®²æˆ‘çš„è§£é¢˜æ€è·¯ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥ä¸€äº›å¯å‘ã€‚

è¿™é“é¢˜ç›®å…¶å®è·Ÿæˆ‘ä»¬å¹³æ—¶çš„å·¥ä½œæ¯æ¯ç›¸å…³ã€‚ç»™ä½ ä¸¤ä¸ªå­—ç¬¦ä¸²ä»£è¡¨çš„ç‰ˆæœ¬å·ï¼Œéœ€è¦ä½ åˆ¤æ–­å“ªä¸ªç‰ˆæœ¬å·æ˜¯æ–°çš„ï¼Œå“ªä¸ªç‰ˆæœ¬å·æ˜¯æ—§çš„ã€‚æ¯”å¦‚ï¼Œ2.0ä¸1.0å¯¹æ¯”çš„è¯ï¼Œ2.0è‚¯å®šæ˜¯æ–°ç‰ˆæœ¬ï¼Œ1.0è‚¯å®šæ˜¯æ—§ç‰ˆæœ¬ã€‚å¯¹å§ï¼Ÿ

ä¸è¿‡ï¼Œè¿™é‡Œé¢è¿˜æœ‰ä¸€äº›é—®é¢˜éœ€è¦ç•™æ„ï¼Œè¿™äº›éƒ½æ˜¯æˆ‘ä»¬åœ¨æ­£å¼å†™ä»£ç ä¹‹å‰è¦å¼„æ¸…æ¥šçš„ã€‚

- é¦–å…ˆï¼Œç‰ˆæœ¬å·æ˜¯å¯èƒ½ä»¥0å¼€å¤´çš„ã€‚æ¯”å¦‚0.1ã€1.01ï¼Œè¿™äº›éƒ½æ˜¯åˆç†çš„ç‰ˆæœ¬å·ã€‚
- å¦å¤–ï¼Œå¦‚æœæ˜¯ä»¥0å¼€å¤´çš„è¯ï¼Œ1ä¸ª0å’Œå¤šä¸ª0ï¼Œå®ƒä»¬æ˜¯ç­‰ä»·çš„ï¼Œæ¯”å¦‚1.01ã€1.001ã€1.00001ä¹‹é—´å°±æ˜¯ç­‰ä»·çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™å‡ ä¸ªç‰ˆæœ¬å·å…¶å®æ˜¯ç›¸ç­‰çš„ã€‚
- è¿˜æœ‰ï¼Œ1.0ã€1.0.0ã€1.0.0.0å®ƒä»¬ä¹‹é—´ä¹Ÿæ˜¯ç­‰ä»·çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™å‡ ä¸ªç‰ˆæœ¬å·ä¹Ÿæ˜¯ç›¸ç­‰çš„ã€‚

## æ€è·¯ä¸€

å¥½äº†ï¼Œç†è§£äº†é¢˜æ„ä»¥åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å†™ä»£ç äº†ï¼ŒLeetCodeä¸Šé¢ç»™äº†æˆ‘ä»¬ä¸€ä¸ªå¾…å®ç°çš„æ–¹æ³•ï¼Œå¤§è‡´å¦‚ä¸‹ï¼š

```plain
fun compareVersion(version1: String, version2: String): Int {
    // å¾…å®Œå–„
}
```

åˆ†æå®Œé¢˜ç›®ä»¥åï¼Œä¹Ÿè®¸ä½ å·²ç»å‘ç°äº†ï¼Œè¿™é“é¢˜ç›®å…¶å®å¹¶ä¸éœ€è¦ä»€ä¹ˆç‰¹æ®Šçš„æ•°æ®ç»“æ„å’Œç®—æ³•åŸºç¡€ï¼Œè¿™æ˜¯ä¸€é“å•çº¯çš„â€œæ¨¡æ‹Ÿé¢˜â€ã€‚æˆ‘ä»¬è„‘å­é‡Œæ˜¯å¦‚ä½•å¯¹æ¯”ä¸¤ä¸ªç‰ˆæœ¬å·çš„ï¼Œæˆ‘ä»¬çš„ä»£ç å°±å¯ä»¥æ€ä¹ˆå†™ã€‚  
ä¸‹é¢æˆ‘åšäº†ä¸€ä¸ªåŠ¨å›¾ï¼Œå±•ç¤ºäº†ç‰ˆæœ¬å·å¯¹æ¯”çš„æ•´ä½“æµç¨‹ã€‚

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/25/ab/25a423b14908721aef1dd36082d345ab.gif?wh=1080x608)

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªå¯¹æ¯”çš„æµç¨‹ï¼Œå¤§è‡´å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ã€‚

- ç¬¬ä¸€æ­¥ï¼Œå°†ç‰ˆæœ¬å·çš„å­—ç¬¦ä¸²ç”¨â€œç‚¹å·â€è¿›è¡Œåˆ†å‰²ï¼Œå¾—åˆ°ä¸¤ä¸ªå­—ç¬¦ä¸²çš„åˆ—è¡¨ã€‚
- ç¬¬äºŒæ­¥ï¼ŒåŒæ—¶éå†è¿™ä¸¤ä¸ªåˆ—è¡¨ï¼Œå°†åˆ—è¡¨ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ è½¬æ¢æˆæ•´æ•°ï¼Œæ¯”å¦‚ï¼Œå½“éå†åˆ°ç¬¬äºŒä½çš„æ—¶å€™ï¼Œ5ã€05è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œéƒ½ä¼šè½¬æ¢æˆæ•°å­—5ã€‚è¿™é‡Œ**æœ‰ä¸ªç»†èŠ‚**ï¼Œé‚£å°±æ˜¯å½“ç‰ˆæœ¬å·çš„é•¿åº¦ä¸ä¸€æ ·çš„æ—¶å€™ï¼Œæ¯”å¦‚ï¼Œéå†åˆ°7.05.002.2çš„æœ€åä¸€ä½æ—¶ï¼Œ7.5.2å…¶å®å·²ç»è¶Šç•Œäº†ï¼Œè¿™æ—¶å€™æˆ‘ä»¬éœ€è¦è¿›è¡Œè¡¥é›¶ï¼Œç„¶åå†è½¬æ¢æˆæ•°å­—ã€‚
- ç¬¬ä¸‰æ­¥ï¼Œæ ¹æ®è½¬æ¢åçš„æ•°å­—è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœä¸¤è€…ç›¸ç­‰çš„è¯ï¼Œæˆ‘ä»¬å°±ç»§ç»­éå†ä¸‹ä¸€ä½ã€‚å¦‚æœä¸ç›¸ç­‰çš„è¯ï¼Œæˆ‘ä»¬å°±èƒ½ç›´æ¥è¿”å›å¯¹æ¯”çš„ç»“æœäº†ã€‚
- ç¬¬å››æ­¥ï¼Œå¦‚æœä¸¤ä¸ªç‰ˆæœ¬å·éƒ½éå†åˆ°äº†æœ«å°¾ï¼Œä»ç„¶æ²¡æœ‰å¯¹æ¯”å‡ºå¤§å°çš„å·®å¼‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è®¤ä¸ºè¿™ä¸¤ä¸ªç‰ˆæœ¬å·ç›¸ç­‰ï¼Œè¿”å›0å³å¯ã€‚

æ‰€ä»¥ï¼ŒæŒ‰ç…§ä¸Šé¢çš„æ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠcompareVersion()è¿™ä¸ªå‡½æ•°åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š

```plain
fun compareVersion(version1: String, version2: String): Int {
    // â‘  ä½¿ç”¨â€œ.â€ï¼Œåˆ†å‰² version1 å’Œ version2ï¼Œå¾—åˆ°list1ã€list2
    // â‘¡ åŒæ—¶éå†list1ã€list2ï¼Œå–å‡ºçš„å…ƒç´ v1ã€v2ï¼Œå¹¶å°†å…¶è½¬æ¢æˆæ•´æ•°ï¼Œè¿™é‡Œæ³¨æ„è¡¥é›¶æ“ä½œ
    // â‘¢ å¯¹æ¯”v1ã€v2çš„å¤§å°ï¼Œå¦‚æœå®ƒä»¬ä¸¤è€…ä¸ä¸€æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»ˆæ­¢æµç¨‹ï¼Œç›´æ¥è¿”å›ç»“æœã€‚
    // â‘£ å½“éå†å®Œlist1ã€list2åä»ç„¶æ²¡æœ‰åˆ¤æ–­å‡ºå¤§å°è¯ï¼Œè¯´æ˜ä¸¤ä¸ªç‰ˆæœ¬å·å…¶å®æ˜¯ç›¸ç­‰çš„ï¼Œè¿™æ—¶å€™åº”è¯¥è¿”å›0
}
```

é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œå…¶å®å°±å¾ˆç®€å•äº†ã€‚æˆ‘ä»¬åªéœ€è¦å°†æ³¨é‡Šé‡Œé¢çš„è‡ªç„¶è¯­è¨€ï¼Œç”¨ä»£ç å†™å‡ºæ¥å°±è¡Œäº†ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š

```plain
fun compareVersion(version1: String, version2: String): Int {
    // â‘  åˆ†å‰²
    val list1 = version1.split(".")
    val list2 = version2.split(".")

    var i = 0
    while (i < list1.size || i < list2.size) {
        // â‘¡ éå†å…ƒç´ 
        val v1 = list1.getOrNull(i)?.toInt()?:0
        val v2 = list2.getOrNull(i)?.toInt()?:0

        // â‘¢ å¯¹æ¯”
        if (v1 != v2) {
            return v1.compareTo(v2)
        }
        i++
    }

    // â‘£ ç›¸ç­‰
    return 0
}
```

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæœ‰ä¸¤ä¸ªåœ°æ–¹éœ€è¦æ ¼å¤–æ³¨æ„ã€‚

**ä¸€ä¸ªæ˜¯whileå¾ªç¯çš„æ¡ä»¶**ã€‚ç”±äºlist1ã€list2çš„é•¿åº¦å¯èƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬çš„å¾ªç¯æ¡ä»¶æ˜¯ï¼šlist1ã€list2å½“ä¸­åªè¦æœ‰ä¸€ä¸ªæ²¡æœ‰éå†å®Œçš„è¯ï¼Œæˆ‘ä»¬å°±è¦ç»§ç»­éå†ã€‚

è¿˜æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Œ**getOrNull(i)ï¼Œè¿™æ˜¯Kotlinç‹¬æœ‰çš„åº“å‡½æ•°**ã€‚ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬ä¸å¿…æ‹…å¿ƒè¶Šç•Œé—®é¢˜ï¼Œå½“indexè¶Šç•Œä»¥åï¼Œè¿™ä¸ªæ–¹æ³•ä¼šè¿”å›nullï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬æŠŠå®ƒè·Ÿ [Elvisè¡¨è¾¾å¼](https://time.geekbang.org/column/article/472154)ç»“åˆèµ·æ¥ï¼Œå°±å®ç°äº†è‡ªåŠ¨è¡¥é›¶æ“ä½œã€‚è¿™ä¹Ÿä½“ç°å‡ºäº†Kotlinè¡¨è¾¾å¼è¯­æ³•çš„ä¼˜åŠ¿ã€‚

å¥½ï¼Œåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±ç”¨ç¬¬ä¸€ç§æ€è·¯å®ç°äº†ç‰ˆæœ¬å·å¯¹æ¯”çš„ç®—æ³•ã€‚ä¸‹é¢æˆ‘ä»¬å†æ¥çœ‹çœ‹ç¬¬äºŒç§æ€è·¯ã€‚

## æ€è·¯äºŒ

å‰é¢çš„æ€è·¯ï¼Œæˆ‘ä»¬æ˜¯ä½¿ç”¨çš„Kotlinçš„åº“å‡½æ•°split()è¿›è¡Œåˆ†å‰²ï¼Œç„¶åå¯¹åˆ—è¡¨è¿›è¡Œéå†æ¥åˆ¤æ–­çš„ç‰ˆæœ¬å·ã€‚å…¶å®ï¼Œè¿™ç§æ€è·¯è¿˜å¯ä»¥**è¿›ä¸€æ­¥ä¼˜åŒ–**ï¼Œé‚£å°±æ˜¯æˆ‘ä»¬è‡ªå·±éå†å­—ç¬¦ä¸²ï¼Œæ¥æ¨¡æ‹Ÿsplitçš„è¿‡ç¨‹ï¼Œç„¶ååœ¨éå†è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é¡ºä¾¿å°±æŠŠæ¯”å¯¹çš„å·¥ä½œä¸€èµ·åšå®Œäº†ã€‚

æ€è·¯äºŒçš„æ•´ä½“è¿‡ç¨‹æ¯”è¾ƒç»•ï¼Œæˆ‘åŒæ ·æ˜¯åˆ¶ä½œäº†ä¸€ä¸ªåŠ¨å›¾æ¥æè¿°è¿™ä¸ªç®—æ³•çš„æ•´ä½“æµç¨‹ï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/dd/67/dd6a09c1428892c7dc5a52623842d067.gif?wh=1080x608)

ä»¥ä¸Šçš„æ•´ä½“ç®—æ³•è¿‡ç¨‹ï¼Œæ˜¯å…¸å‹çš„â€œ**åŒæŒ‡é’ˆ**â€æ€æƒ³ã€‚è¿ç”¨è¿™æ ·çš„æ€æƒ³ï¼Œæˆ‘ä»¬å¤§è‡´å¯ä»¥å†™å‡ºä¸‹é¢è¿™æ ·çš„ä»£ç ï¼š

```plain
fun compareVersion(version1: String, version2: String): Int {
    val length1 = version1.length
    val length2 = version2.length

    // â‘ 
    var i = 0
    var j = 0
    // â‘¡
    while (i < length1 || j < length2) {
        // â‘¢
        var x = 0
        while (i < length1 && version1[i] != '.') {
            x = x * 10 + version1[i].toInt() - '0'.toInt()
            i++
        }
        i++

        // â‘£
        var y = 0
        while (j < length2 && version2[j] != '.') {
            y = y * 10 + version2[j].toInt() - '0'.toInt()
            j++
        }
        j++

        // â‘¤
        if (x != y) {
            return x.compareTo(y)
        }
    }
    // â‘¥
    return 0
}
```

è¿™æ®µä»£ç ä¸€å…±æœ‰6ä¸ªæ³¨é‡Šï¼Œæˆ‘ä»¬æ¥ä¸€ä¸ªä¸ªè§£é‡Šã€‚

- æ³¨é‡Šâ‘ ï¼Œä»£è¡¨çš„å°±æ˜¯æˆ‘ä»¬éå†ä¸¤ä¸ªç‰ˆæœ¬å·çš„indexï¼ŒåŒæŒ‡é’ˆï¼ŒæŒ‡çš„å°±æ˜¯å®ƒä»¬ä¸¤ä¸ªã€‚
- æ³¨é‡Šâ‘¡ï¼Œæœ€å¤–å±‚çš„whileå¾ªç¯ï¼Œå…¶å®å°±æ˜¯ä¸ºäº†ç¡®ä¿åŒæŒ‡é’ˆå¯ä»¥éå†åˆ°ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ«å°¾ã€‚ä½ æ³¨æ„ä¸‹è¿™é‡Œçš„å¾ªç¯æ¡ä»¶ï¼Œåªè¦version1ã€version2å½“ä¸­æœ‰ä¸€ä¸ªæ²¡åˆ°æœ«å°¾ï¼Œå°±ä¼šç»§ç»­éå†ã€‚
- æ³¨é‡Šâ‘¢ï¼Œè¿™é‡Œå°±æ˜¯åœ¨éå†version1ï¼Œä¸€ç›´åˆ°å­—ç¬¦ä¸²æœ«å°¾ï¼Œæˆ–è€…é‡åˆ°â€œç‚¹å·â€ã€‚åœ¨åŒä¸€ä¸ªå¾ªç¯å½“ä¸­ï¼Œæˆ‘ä»¬ä¼šå¯¹xçš„å€¼è¿›è¡Œç´¯åŠ ï¼Œè¿™ä¸ªåšæ³•å…¶å®å°±æ˜¯æŠŠå­—ç¬¦ä¸²çš„æ•°å­—è½¬æ¢æˆåè¿›åˆ¶çš„æ•°å­—ã€‚
- æ³¨é‡Šâ‘£ï¼Œè¿™é‡Œå’Œæ³¨é‡Šâ‘¢çš„é€»è¾‘ä¸€æ ·ï¼Œåªæ˜¯éå†çš„å¯¹è±¡æ˜¯version2ã€‚
- æ³¨é‡Šâ‘¤ï¼Œè¿™é‡Œä¼šå¯¹ç´¯åŠ å‡ºæ¥çš„xã€yè¿›è¡Œå¯¹æ¯”ï¼Œä¸ç›¸åŒçš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿”å›ç»“æœäº†ã€‚
- æ³¨é‡Šâ‘¥ï¼Œå¦‚æœéå†åˆ°æœ«å°¾è¿˜æ²¡æœ‰ç»“æœï¼Œè¿™å°±è¯´æ˜version1ã€version2ç›¸ç­‰ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬å°±å·²ç»ç”¨Kotlinå†™å‡ºäº†ä¸¤ä¸ªé¢˜è§£ï¼Œä½¿ç”¨çš„æ€è·¯éƒ½æ˜¯å‘½ä»¤å¼çš„ç¼–ç¨‹æ–¹å¼ã€‚ä¹Ÿè®¸ä½ ä¼šå¥½å¥‡ï¼Œ**è¿™ä¸ªé—®é¢˜èƒ½ç”¨å‡½æ•°å¼çš„æ€è·¯æ¥å®ç°å—ï¼Ÿ**

ç­”æ¡ˆå½“ç„¶æ˜¯å¯ä»¥çš„ï¼

## æ€è·¯ä¸‰

æˆ‘ä»¬åœ¨å‰é¢å°±æåˆ°è¿‡ï¼ŒKotlinæ˜¯æ”¯æŒå¤šèŒƒå¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®å®é™…åœºæ™¯æ¥çµæ´»é€‰æ‹©ç¼–ç¨‹èŒƒå¼ã€‚é‚£ä¹ˆåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥å€Ÿé‰´ä¸€ä¸‹å‰é¢ç¬¬ä¸€ç§è§£æ³•çš„æ€è·¯ã€‚

å…¶å®ï¼Œæƒ³è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åªè¦èƒ½æŠŠversion1ã€version2è½¬æ¢æˆä¸¤ä¸ªæ•´æ•°çš„åˆ—è¡¨ï¼Œå°±å¯ä»¥å¾ˆå¥½åœ°è¿›è¡Œå¯¹æ¯”äº†ã€‚æˆ‘åˆ¶ä½œäº†ä¸€ä¸ªåŠ¨å›¾ï¼Œæ–¹ä¾¿ä½ ç†è§£ï¼š

![å›¾ç‰‡](https://static001.geekbang.org/resource/image/ee/32/eea4765d618437d7145ae77c8e404a32.gif?wh=1080x608)

æ ¹æ®è¿™ä¸ªæµç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥å¤§è‡´å†™å‡ºä¸‹é¢è¿™æ ·çš„ä»£ç ï¼š

```plain
fun compareVersion(version1: String, version2: String): Int =
    version1.split(".")
        .zipLongest(version2.split("."), "0") // â‘ 
        .onEach { // â‘¡
            with(it) {
                if (first != second) {
                    return first.compareTo(second)
                }
            }
        }.run { return 0 }
```

è¿™æ®µä»£ç çœ‹èµ·æ¥å¾ˆç®€æ´ï¼Œæ ¸å¿ƒçš„é€»è¾‘åœ¨ä¸¤ä¸ªæ–¹æ³•å½“ä¸­ï¼Œæˆ‘åˆ†åˆ«ç”¨æ³¨é‡Šæ ‡æ³¨äº†ã€‚

- æ³¨é‡Šâ‘ ï¼ŒzipLongest()è¿™ä¸ªæ–¹æ³•ï¼Œå®ƒçš„ä½œç”¨æ˜¯å°†version1ã€version2å¯¹åº”çš„åˆ—è¡¨åˆå¹¶åˆ°ä¸€èµ·ï¼Œå®ƒè¿”å›å€¼çš„ç±»å‹æ˜¯List&lt;Pair&lt;Int, Int&gt;&gt;ã€‚
- æ³¨é‡Šâ‘¡ï¼ŒonEach()ï¼Œå…¶å®å®ƒæ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯éå†Listå½“ä¸­çš„æ¯ä¸€ä¸ªPairï¼Œå°†å…¶ä¸­çš„æ•´å‹ç‰ˆæœ¬å·æ‹¿å‡ºæ¥å¯¹æ¯”ï¼Œå¦‚æœä¸ä¸€æ ·ï¼Œå°±å¯ä»¥ç›´æ¥è¿”å›ç»“æœã€‚

ç°åœ¨ï¼Œä½ å¯èƒ½ä¼šæ„Ÿæ…¨ï¼Œè¿™ä»£ç çœ‹èµ·æ¥çœŸé¦™å•Šï¼è¿™ä¸ªå˜›â€¦â€¦åˆ«é«˜å…´å¾—å¤ªæ—©ã€‚è™½ç„¶Kotlinæ”¯æŒåŸºç¡€çš„zipè¯­æ³•ï¼Œä½†å®ƒç›®å‰è¿˜ä¸æ”¯æŒzipLongest()è¿™ä¹ˆé«˜çº§çš„æ“ä½œç¬¦ã€‚

é‚£ä¹ˆè¿™è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬åªèƒ½è‡ªå·±æ¥å®ç°zipLongest()äº†ï¼ä¸ºäº†è®©å‰é¢çš„ä»£ç é€šè¿‡ç¼–è¯‘ï¼Œæˆ‘ä»¬å¿…é¡»è¦è‡ªå·±åŠ¨æ‰‹å®ç°ä¸‹é¢ä¸‰ä¸ªæ‰©å±•å‡½æ•°ã€‚

```plain
private fun Iterable<String>.zipLongest(
    other: Iterable<String>,
    default: String
): List<Pair<Int, Int>> {
    val first = iterator()
    val second = other.iterator()
    val list = ArrayList<Pair<Int, Int>>(minOf(collectionSizeOrDefault(10), other.collectionSizeOrDefault(10)))
    while (first.hasNext() || second.hasNext()) {
        val v1 = (first.nextOrNull() ?: default).toInt()
        val v2 = (second.nextOrNull() ?: default).toInt()
        list.add(Pair(v1, v2))
    }
    return list
}

private fun <T> Iterable<T>.collectionSizeOrDefault(default: Int): Int =
        if (this is Collection<*>) this.size else default

private fun <T> Iterator<T>.nextOrNull(): T? = if (hasNext()) next() else null

// Pair æ˜¯Kotlinæ ‡å‡†åº“æä¾›çš„ä¸€ä¸ªæ•°æ®ç±»
// ä¸“é—¨ç”¨äºå­˜å‚¨ä¸¤ä¸ªæˆå‘˜çš„æ•°æ®
// æäº¤ä»£ç çš„æ—¶å€™ï¼ŒPairä¸éœ€è¦æ‹·è´è¿›å»
public data class Pair<out A, out B>(
    public val first: A,
    public val second: B
) : Serializable {
    public override fun toString(): String = "($first, $second)"
}
```

è¿™ä¸‰ä¸ªæ‰©å±•å‡½æ•°å®ç°èµ·æ¥è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼ŒzipLongest()å…¶å®å°±æ˜¯åˆå¹¶äº†ä¸¤ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ï¼Œç„¶åå°†å®ƒä»¬æŒ‰ç…§indexåˆå¹¶æˆPairï¼Œå¦å¤–é‚£ä¸¤ä¸ªæ‰©å±•å‡½æ•°éƒ½åªæ˜¯èµ·äº†è¾…åŠ©ä½œç”¨ã€‚

è¿™æ ·ï¼Œæˆ‘ä»¬æŠŠå‰é¢çš„ä»£ç ä¸€èµ·ç²˜è´´åˆ°LeetCodeå½“ä¸­ï¼Œå…¶å®ä»£ç æ˜¯å¯ä»¥é€šè¿‡çš„ã€‚ä¸è¿‡å‘¢ï¼Œæˆ‘ä»¬çš„ä»£ç å½“ä¸­å…¶å®è¿˜æœ‰ä¸€ä¸ª**æ¯”è¾ƒæ·±çš„åµŒå¥—**ï¼Œçœ‹èµ·æ¥ä¸æ˜¯å¾ˆé¡ºçœ¼ï¼š

```plain
fun compareVersion(version1: String, version2: String): Int =
    version1.split(".")
        .zipLongest(version2.split("."), "0")
        .onEach {
            // è¿™é‡Œçš„åµŒå¥—æ¯”è¾ƒæ·±
            with(it) {
                if (first != second) {
                    return first.compareTo(second)
                }
            }
        }.run { return 0 }
```

ä½ å¯ä»¥æ³¨æ„åˆ°ï¼Œåœ¨onEachå½“ä¸­ï¼Œæœ‰ä¸€ä¸ªä»£ç å—ï¼Œå®ƒæœ‰ä¸¤å±‚åµŒå¥—ï¼Œè¿™çœ‹èµ·æ¥æœ‰ç‚¹ä¸‘é™‹ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬èƒ½ä¸èƒ½å¯¹å®ƒè¿›ä¸€æ­¥ä¼˜åŒ–å‘¢ï¼Ÿ

å½“ç„¶æ˜¯å¯ä»¥çš„ã€‚

è¿™é‡Œï¼Œæˆ‘ä»¬åªéœ€è¦æƒ³åŠæ³•è®©onEachå½“ä¸­çš„Lambdaï¼Œå˜æˆ[å¸¦æ¥æ”¶è€…çš„å‡½æ•°ç±»å‹](https://time.geekbang.org/column/article/476637)å³å¯ã€‚å…·ä½“åšæ³•å°±æ˜¯ï¼Œæˆ‘ä»¬è‡ªå·±å®ç°ä¸€ä¸ªæ–°çš„onEachWithReceiver()çš„é«˜é˜¶å‡½æ•°ã€‚

```plain
//                                                        æ³¨æ„è¿™é‡Œ
//                                                           â†“
inline fun <T, C : Iterable<T>> C.onEachWithReceiver(action: T.() -> Unit): C {
    return apply { for (element in this) action(element) }
}

//                                                   æ³¨æ„è¿™é‡Œ
// Kotlinåº“å‡½æ•°å½“ä¸­çš„onEach                                â†“
public inline fun <T, C : Iterable<T>> C.onEach(action: (T) -> Unit): C {
    return apply { for (element in this) action(element) }
}
```

ä¸Šé¢çš„ä»£ç å±•ç¤ºäº†onEach()å’ŒonEachWithReceiver()ä¹‹é—´çš„å·®åˆ«ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå®ƒä»¬ä¸¤ä¸ªçš„å‡½æ•°ä½“å…¶å®æ²¡æœ‰ä»»ä½•å˜åŒ–ï¼ŒåŒºåˆ«åªæ˜¯actionçš„å‡½æ•°ç±»å‹è€Œå·²ã€‚

æ‰€ä»¥åœ¨è¿™é‡Œï¼Œå€ŸåŠ©onEachWithReceiver()ï¼Œå°±å¯ä»¥è¿›ä¸€æ­¥ç®€åŒ–æˆ‘ä»¬çš„ä»£ç ï¼š

```plain
fun compareVersion(version1: String, version2: String): Int =
    version1.split(".")
        .zipLongest(version2.split("."), "0")
        .onEachWithReceiver {
            // å‡å°‘äº†ä¸€å±‚åµŒå¥—
            if (first != second) {
                return first.compareTo(second)
            }
        }.run { return 0 }
```

åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬æŠŠonEach()æ”¹æˆäº†onEachWithReceiver()ï¼Œå› ä¸ºå®ƒé‡Œé¢çš„Lambdaæ˜¯å¸¦æœ‰æ¥æ”¶è€…ï¼ŒåŸæœ¬çš„Pairå¯¹è±¡å˜æˆäº†thiså¯¹è±¡ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ä½¿ç”¨firstã€secondæ¥è®¿é—®Pairå½“ä¸­çš„æˆå‘˜äº†ã€‚

ç°åœ¨ï¼Œå°±è®©æˆ‘ä»¬æ¥çœ‹çœ‹æ•´ä½“çš„ä»£ç å§ï¼š

```plain
fun compareVersion(version1: String, version2: String): Int =
    version1.split(".")
        .zipLongest(version2.split("."), "0")
        .onEachWithReceiver {
            if (first != second) {
                return first.compareTo(second)
            }
        }.run { return 0 }

private inline fun <T, C : Iterable<T>> C.onEachWithReceiver(action: T.() -> Unit): C {
    return apply { for (element in this) action(element) }
}

private fun <T> Iterable<T>.collectionSizeOrDefault(default: Int): Int =
    if (this is Collection<*>) this.size else default

private fun <T> Iterator<T>.nextOrNull(): T? = if (hasNext()) next() else null

private fun Iterable<String>.zipLongest(
    other: Iterable<String>,
    default: String
): List<Pair<Int, Int>> {
    val first = iterator()
    val second = other.iterator()
    val list = ArrayList<Pair<Int, Int>>(minOf(collectionSizeOrDefault(10), other.collectionSizeOrDefault(10)))
    while (first.hasNext() || second.hasNext()) {
        val v1 = (first.nextOrNull() ?: default).toInt()
        val v2 = (second.nextOrNull() ?: default).toInt()
        list.add(Pair(v1, v2))
    }
    return list
}
```

å¥½äº†ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸‰ç§æ€è·¯ã€‚çœ‹å®Œè¿™ä¸‰ç§æ€è·¯ä»¥åï¼Œä½ ä¼šæ›´å€¾å‘äºå“ªç§æ€è·¯å‘¢ï¼Ÿ

## å°ç»“

è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸‰ç§æ€è·¯ï¼Œå®ç°äº†[LeetCodeçš„165å·é¢˜ã€Šç‰ˆæœ¬å·åˆ¤æ–­ã€‹](https://leetcode-cn.com/problems/compare-version-numbers/)ã€‚å…¶ä¸­ï¼Œå‰ä¸¤ç§æ€è·¯ï¼Œæ˜¯å‘½ä»¤å¼çš„ç¼–ç¨‹æ–¹å¼ï¼Œç¬¬ä¸‰ç§æ˜¯åå‡½æ•°å¼çš„æ–¹å¼ã€‚åœ¨æˆ‘çœ‹æ¥å‘¢ï¼Œè¿™ä¸‰ç§æ–¹å¼å„æœ‰ä¼˜åŠ£ã€‚

- æ€è·¯ä¸€ï¼Œä»£ç é€»è¾‘æ¯”è¾ƒæ¸…æ™°ï¼Œä»£ç é‡å°ï¼Œæ—¶é—´å¤æ‚åº¦ã€ç©ºé—´å¤æ‚åº¦è¾ƒå·®ã€‚
- æ€è·¯äºŒï¼Œä»£ç é€»è¾‘æ¯”è¾ƒå¤æ‚ï¼Œä»£ç é‡ç¨å¤§ï¼Œæ—¶é—´å¤æ‚åº¦ã€ç©ºé—´å¤æ‚åº¦éå¸¸å¥½ã€‚
- æ€è·¯ä¸‰ï¼Œä»£ç ä¸»é€»è¾‘éå¸¸æ¸…æ™°ï¼Œä»£ç é‡å¤§ï¼Œæ—¶é—´å¤æ‚åº¦ã€ç©ºé—´å¤æ‚åº¦è¾ƒå·®ã€‚

ç¬¬ä¸‰ä¸ªæ€è·¯å…¶å®è¿˜æœ‰ä¸€ä¸ªé¢å¤–çš„ä¼˜åŠ¿ï¼Œé‚£å°±æ˜¯ï¼Œæˆ‘ä»¬è‡ªå·±å®ç°çš„æ‰©å±•å‡½æ•°ï¼Œå¯ä»¥ç”¨äºä»¥åè§£å†³å…¶ä»–é—®é¢˜ã€‚è¿™å°±ç›¸å½“äºæ²‰æ·€å‡ºäº†æœ‰ç”¨çš„å·¥å…·ã€‚

## å°ä½œä¸š

å¥½ï¼Œæœ€åï¼Œæˆ‘è¿˜æ˜¯ç»™ä½ ç•™ä¸€ä¸ªå°ä½œä¸šï¼Œè¯·ä½ ç”¨Kotlinæ¥å®Œæˆ[LeetCodeçš„640å·é¢˜ã€Šæ±‚è§£æ–¹ç¨‹ã€‹](https://leetcode-cn.com/problems/solve-the-equation/)ã€‚è¿™é“é¢˜ç›®æˆ‘åŒæ ·ä¼šåœ¨ä¸‹èŠ‚è¯¾ç»™å‡ºç­”æ¡ˆè§£æã€‚

æ¬¢è¿ç»§ç»­ç»™æˆ‘ç•™è¨€ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ8ï¼‰</strong></div><ul>
<li><span>qinsi</span> ğŸ‘ï¼ˆ6ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æ–¹æ³•ä¸‰æœ‰ç‚¹ä¸€è¨€éš¾å°½å§...

å°è¯•å†™ä¸€ä¸ªpythonçš„ç‰ˆæœ¬ï¼š

```python
class Solution:
    def compareVersion(self, ver1: str, ver2: str) -&gt; int:
        to_nums = lambda ver: map(int, ver.split(&#39;.&#39;))
        zipped = zip_longest(*map(to_nums, [ver1, ver2]), fillvalue=0)
        cmp = lambda a, b: (a &gt; b) - (a &lt; b) 
        return next((i for i in starmap(cmp, zipped) if i != 0), 0)
        # return next(filter(lambda x: x != 0, starmap(cmp, zipped)), 0)
```

æ–‡ä¸­çš„zipLongestå®ç°æ¥å—Iterable&lt;String&gt;ï¼Œè¿”å›List&lt;Pair&lt;Int, Int&gt;&gt;ã€‚è¿™æ„å‘³ï¼š

1. è¾“å…¥æ˜¯Iterableï¼Œè¾“å‡ºæˆäº†Listã€‚è¿™æ ·å°±ä¸é€‚ç”¨äºè¾“å…¥é•¿åº¦æ— é™çš„æƒ…å†µï¼Œæˆ–æ˜¯å¯ä»¥æƒ°æ€§æ±‚å€¼çš„æƒ…å†µã€‚åœ¨æœ¬é¢˜ä¸­ï¼Œå› ä¸ºåªè¦é‡åˆ°ç¬¬ä¸€ä¸ªä¸ç›¸åŒçš„å­ç‰ˆæœ¬å·å°±å¯ä»¥è¿”å›ï¼Œæ‰€ä»¥å¯ä»¥ä¸ç”¨ç”Ÿæˆå®Œæ•´çš„Listï¼Œæ­£å¥½æ˜¯å¯ä»¥åˆ©ç”¨æƒ°æ€§æ±‚å€¼çš„æƒ…å†µï¼›

2. è¾“å…¥Iterableçš„åŸºç±»å‹æ˜¯Stringï¼Œè¾“å‡ºPairçš„åŸºç±»å‹æ˜¯Intï¼Œè¿™å°±æŠŠç±»å‹è½¬æ¢å†™æ­»åœ¨äº†å®ç°é‡Œï¼Œè®©å®ç°å¤±å»äº†é€šç”¨æ€§ï¼Œå³ä¾¿æ²‰æ·€å‡ºæ¥å¯èƒ½ç”¨é€”ä¹Ÿæœ‰é™å§ï¼›

3. æ–‡ä¸­çš„å®ç°åªæ”¯æŒä¸€ä¸ªIterableä¸å¦ä¸€ä¸ªIterableè¿›è¡Œzipï¼Œè€Œpythonçš„å®ç°æ”¯æŒä»»æ„å¤šä¸ªã€‚

è¿™é‡Œä¸æ˜¯è¦æŠ¬æ ï¼Œåªæ˜¯æƒ³è¯´å„ç§è¯­è¨€çš„ä¸åŒç‰¹æ€§ä¼šå½¢æˆä¸åŒçš„æƒ¯ç”¨æ³•ï¼Œå¼ºè¡Œä½¿ç”¨å¦ä¸€ç§è¯­è¨€çš„æƒ¯ç”¨æ³•å¯èƒ½ä¼šæ˜¾å¾—ä¸ä¼¦ä¸ç±»ã€‚å¦‚æœ‰å†’çŠ¯è¿˜è¯·è§è°…ã€‚</p>2022-01-31</li><br/><li><span>æ¢ä¸­å</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>è¿™æ ·å†™ä¹Ÿç®—æ¯”è¾ƒç®€æ´æŠŠï¼š
 val list1 = version1.split(&quot;.&quot;)
        val list2 = version2.split(&quot;.&quot;)
        val result = list1.zip(list2) { v1, v2 -&gt; Pair(v1.toInt(), v2.toInt()) }
            .onEach {
                if (it.first != it.second) {
                   return it.first.compareTo(it.second)
                }
            }.run { return  list1.size - list2.size }</p>2022-03-19</li><br/><li><span>ç™½ä¹¾æ¶›</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>å·¥ä½œä¸­è°æ•¢ç”¨æ–¹æ³•ä¸‰ï¼Œæˆ‘ä¿å‡†è®©ä»–é»˜å†™åéï¼</p>2022-03-02</li><br/><li><span>ç™½ä¹¾æ¶›</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è§£æ³•äºŒç¨åŠ å°è£…äº†ä¸€ä¸‹

fun compareVersion(version1: String, version2: String): Int {
    val v1 = Version(0, 0, version1)
    val v2 = Version(0, 0, version2)

    while (v1.index &lt; version1.length || v2.index &lt; version2.length) {
        v1.dealVersion()
        v2.dealVersion()
        if (v1.subValue != v2.subValue) {
            return v1.subValue.compareTo(v2.subValue)
        }
    }
    return 0
}

data class Version(var index: Int, var subValue: Int, var text: String) {
    fun dealVersion(): Version {
        subValue = 0
        while (index &lt; text.length &amp;&amp; text[index] != &#39;.&#39;) {
            subValue = subValue * 10 + text[index].toInt() - &#39;0&#39;.toInt()
            index++
        }
        index++
        return this
    }
}</p>2022-03-02</li><br/><li><span>Geek_Adr</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>class Solution {
    &#47;&#47; ax+b
    &#47;&#47; symbol å’Œ tmp éƒ½æ˜¯å¤„ç†è¡¨è¾¾å¼ä¸´æ—¶å˜é‡
    data class Expr(var a: Int, var b: Int, var symbol: Int, var tmp: String)

    fun solveEquation(equation: String): String {
        return equation
            .split(&quot;=&quot;)&#47;&#47; 1ã€åˆ†æˆå‰åä¸¤ä¸ªéƒ¨åˆ†
            .map {&#47;&#47; 2ã€å¤„ç†è¡¨è¾¾å¼ä¸º ax+b
                &quot;$it+&quot;&#47;&#47;éªšæ“ä½œåŠ &quot;+&quot;ï¼šé˜²æ­¢è¡¨è¾¾å¼æœ€åä¸€ç‚¹ä¸¢å¤±å¤„ç†
                    .fold(Expr(0, 0, 1, &quot;&quot;)) { acc, c -&gt;
                        when (c) {
                            &#39;+&#39;, &#39;-&#39; -&gt; {
                                if (acc.tmp.contains(&quot;x&quot;)) {
                                    acc.a += acc.symbol * acc.tmp.replace(&quot;x&quot;, &quot;&quot;).ifBlank { &quot;1&quot; }.toInt()
                                } else {
                                    acc.b += acc.symbol * acc.tmp.ifBlank { &quot;0&quot; }.toInt()
                                }
                                acc.symbol = if (c == &#39;+&#39;) 1 else -1
                                acc.tmp = &quot;&quot;
                            }
                            else -&gt; {
                                acc.tmp += c
                            }
                        }
                        acc
                    }

            }.reduce { acc, expr -&gt; &#47;&#47; 3ã€å‰æ®µ å‡ åæ®µ
                acc.a -= expr.a
                acc.b -= expr.b
                acc
            }.run {
                when {
                    a == 0 &amp;&amp; b != 0 -&gt; &quot;No solution&quot;
                    a == 0 -&gt; &quot;Infinite solutions&quot;
                    else -&gt; &quot;x=${-1 * b &#47; a}&quot;

                }
            }
    }
}
</p>2022-02-19</li><br/><li><span>è‹¹æœæ˜¯æˆ‘å’¬çš„</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>class Solution {
    fun solveEquation(equation: String): String {
        val eq = equation.replace(&quot;-&quot;, &quot;+-&quot;).split(&quot;=&quot;)
        val (lx, ln) = parse(eq[0])
        val (rx, rn) = parse(eq[1])
        val x = lx - rx
        val n = rn - ln
        return if (x == 0 &amp;&amp; n != 0) {
            &quot;No solution&quot;
        } else if (x == 0 &amp;&amp; n == 0) {
            &quot;Infinite solutions&quot;
        } else {
            &quot;x=${ n &#47; x }&quot;
        }
    }

    fun parse(eq: String): Pair&lt;Int, Int&gt; {
        val exp = eq.split(&quot;+&quot;)
        var (x, n) = 0 to 0
        exp.filter { !it.contains(&quot;x&quot;) &amp;&amp; it != &quot;&quot; }
            .forEach { n += it.toInt() }
        exp.filter { it.contains(&quot;x&quot;) }
            .forEach {
                x += if (it.length == 1 || it.length == 2 &amp;&amp; it[0] == &#39;-&#39;) it.replace(&quot;x&quot;, &quot;1&quot;).toInt()
                else it.replace(&quot;x&quot;, &quot;&quot;).toInt()
            }
        return x to n
    }
}</p>2022-02-17</li><br/><li><span>éƒ‘å³°</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>```Kotlin

fun solveEquation(equation: String): String {
  val (left, right) = equation.split(&quot;=&quot;).take(2)
  val (lx, ln) = parse(left)
  val (rx, rn) = parse(right)
  if (lx == rx) return if (ln == rn) &quot;Infinite solutions&quot; else &quot;No solution&quot;
  if ((rn - ln) % (lx - rx) != 0) return &quot;No solution&quot;
  return &quot;x=&quot; + (rn - ln) &#47; (lx - rx)
}

@OptIn(ExperimentalStdlibApi::class)
fun parse(exp: String): Pair&lt;Int, Int&gt; {
  &#47;&#47; Split operands and operators
  val operands = exp.split(&quot;[+-]&quot;.toRegex())
  val operators = buildList&lt;Int&gt; {
    add(1) &#47;&#47; Add leading + to align with operands
    addAll(exp.filter { it == &#39;+&#39; || it == &#39;-&#39; }.map { if (it == &#39;+&#39;) 1 else -1 })
  }

  var (x, n) = 0 to 0

  &#47;&#47; Calculate x and n
  for (i in operands.indices) {
    if (operands[i].isEmpty()) continue
    if (operands[i].last() == &#39;x&#39;) {
      x += operators[i] * (operands[i].dropLast(1).toIntOrNull() ?: 1)
    } else {
      n += operators[i] * operands[i].toInt()
    }
  }

  return x to n
}

```</p>2022-02-01</li><br/><li><span>PP</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<p>fun solveEquation(equation: String) {
        var sumX = 0
        var numEq = 0
        equation.replace(&quot;-&quot;, &quot;+-&quot;).split(&#39;=&#39;).forEachIndexed { index, s -&gt;
            s.split(&#39;+&#39;).forEach {
                if (it.contains(&#39;x&#39;)) {
                    val count = if (it == &quot;x&quot;) 1 else it.removeSuffix(&quot;x&quot;).toInt()
                    sumX += if (index == 0) count else -count
                } else {
                    numEq += if (index == 0) -it.toInt() else it.toInt()
                }
            }
        }
        println(when {
            sumX == 0 -&gt; &quot;Infinite solutions&quot;
            numEq.mod(sumX) == 0 -&gt; &quot;x = ${numEq.div(sumX)}&quot;
            else -&gt; &quot;no solution&quot;
        })
    }</p>2023-07-27</li><br/>
</ul>