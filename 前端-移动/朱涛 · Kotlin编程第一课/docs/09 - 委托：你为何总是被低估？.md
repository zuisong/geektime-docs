ä½ å¥½ï¼Œæˆ‘æ˜¯æœ±æ¶›ã€‚ä»Šå¤©æˆ‘ä»¬æ¥å­¦ä¹ Kotlinçš„å§”æ‰˜ç‰¹æ€§ã€‚

Kotlinçš„å§”æ‰˜ä¸»è¦æœ‰ä¸¤ä¸ªåº”ç”¨åœºæ™¯ï¼Œä¸€ä¸ªæ˜¯å§”æ‰˜ç±»ï¼Œå¦ä¸€ä¸ªæ˜¯å§”æ‰˜å±æ€§ã€‚å¯¹æ¯”ç¬¬6è®²æˆ‘ä»¬å­¦è¿‡çš„[æ‰©å±•](https://time.geekbang.org/column/article/475684)æ¥çœ‹çš„è¯ï¼ŒKotlinå§”æ‰˜è¿™ä¸ªç‰¹æ€§å°±æ²¡æœ‰é‚£ä¹ˆâ€œç¥å¥‡â€äº†ã€‚

å› ä¸ºæ‰©å±•å¯ä»¥ä»ç±»çš„å¤–éƒ¨ï¼Œä¸ºä¸€ä¸ªç±»â€œæ·»åŠ â€æˆå‘˜æ–¹æ³•å’Œå±æ€§ï¼Œå› æ­¤Kotlinæ‰©å±•çš„åº”ç”¨åœºæ™¯ä¹Ÿååˆ†æ˜ç¡®ï¼Œè€ŒKotlinå§”æ‰˜çš„åº”ç”¨åœºæ™¯å°±æ²¡é‚£ä¹ˆæ¸…æ™°äº†ã€‚è¿™ä¹Ÿæ˜¯å¾ˆå¤šäººä¼šâ€œé‡è§†æ‰©å±•â€ï¼Œè€Œâ€œè½»è§†å§”æ‰˜â€çš„åŸå› ã€‚

ç„¶è€Œï¼Œæˆ‘è¦å‘Šè¯‰ä½ çš„æ˜¯ï¼Œ**Kotlinâ€œå§”æ‰˜â€çš„é‡è¦æ€§ä¸€ç‚¹ä¹Ÿä¸æ¯”â€œæ‰©å±•â€ä½**ã€‚Kotlinå§”æ‰˜åœ¨è½¯ä»¶æ¶æ„ä¸­å¯ä»¥å‘æŒ¥å·¨å¤§çš„ä½œç”¨ï¼Œåœ¨æŒæ¡äº†Kotlinå§”æ‰˜ç‰¹æ€§åï¼Œä½ ä¸ä»…å¯ä»¥æ”¹å–„åº”ç”¨çš„æ¶æ„ï¼Œè¿˜å¯ä»¥å¤§å¤§æå‡å¼€å‘æ•ˆç‡ã€‚

å¦å¤–ï¼Œå¦‚æœä½ æ˜¯Androidå·¥ç¨‹å¸ˆï¼Œä½ ä¼šå‘ç°Jetpack Composeå½“ä¸­å¤§é‡ä½¿ç”¨äº†Kotlinå§”æ‰˜ç‰¹æ€§ã€‚å¯ä»¥è¯´ï¼Œå¦‚æœä½ ä¸ç†è§£å§”æ‰˜ï¼Œä½ å°±æ— æ³•çœŸæ­£ç†è§£Jetpack Composeã€‚

çœ‹åˆ°è¿™é‡Œï¼Œæƒ³å¿…ä½ ä¹Ÿå·²ç»çŸ¥é“Kotlinå§”æ‰˜çš„é‡è¦æ€§äº†ï¼Œæ¥ä¸‹æ¥å°±æ¥å¼€å¯æˆ‘ä»¬çš„å­¦ä¹ ä¹‹æ—…å§ï¼

## å§”æ‰˜ç±»

æˆ‘ä»¬å…ˆä»å§”æ‰˜ç±»å¼€å§‹ï¼Œå®ƒçš„ä½¿ç”¨åœºæ™¯éå¸¸ç®€å•æ˜“æ‡‚ï¼šå®ƒå¸¸å¸¸ç”¨äºå®ç°ç±»çš„â€œå§”æ‰˜æ¨¡å¼â€ã€‚æˆ‘ä»¬æ¥çœ‹ä¸ªç®€å•ä¾‹å­ï¼š

```plain
interface DB {
    fun save()
}

class SqlDB() : DB {
    override fun save() { println("save to sql") }
}

class GreenDaoDB() : DB {
    override fun save() { println("save to GreenDao") }
}
//               å‚æ•°  é€šè¿‡ by å°†æ¥å£å®ç°å§”æ‰˜ç»™ db 
//                â†“            â†“
class UniversalDB(db: DB) : DB by db

fun main() {
    UniversalDB(SqlDB()).save()
    UniversalDB(GreenDaoDB()).save()
}

/*
è¾“å‡ºï¼š
save to sql
save to GreenDao
*/
```
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ21ï¼‰</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/0f/c6/78/9b1e4b15.jpg" width="30px"><span>ZircoN</span> ğŸ‘ï¼ˆ7ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>SPè¯»å†™çš„å§”æ‰˜å°è£…ï¼Œç»å¸¸ç”¨</div>2022-01-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/ef/7e/231c9fa2.jpg" width="30px"><span>æ–‡èŒ‚æƒ</span> ğŸ‘ï¼ˆ7ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ç»™æ²¡çœ‹æ‡‚è‡ªå®šä¹‰å§”æ‰˜çš„åŒå­¦åšç‚¹ç¬”è®°ï¼š
kotlin.properties.PropertyDelegateProvider æ¥å£ï¼šå¯ä»¥ç”¨äºå±æ€§å§”æ‰˜çš„åŸºæœ¬æ¥å£ï¼Œä½†å¼€å‘è€…å¯ä»¥ç›´æ¥ override fun è€Œä¸å£°æ˜å®ç°ã€‚ 
åœ¨è¿™é‡Œ SmartDelegator æ˜¯ç›´æ¥å®ç°äº†provideDelegate æ–¹æ³•ï¼Œï¼ˆéšå¼å®ç°äº†è¿™ä¸ªæ¥å£ï¼‰ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥å¯¹ Owner æä¾›å§”æ‰˜çš„å®ç°ã€‚</div>2022-01-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2b/ee/f4/27a5080a.jpg" width="30px"><span>7Promise</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>Kotlin å§”æ‰˜çš„ä½¿ç”¨åœºæ™¯ï¼šåˆ—è¡¨æ§ä»¶çš„é€‚é…å™¨å¯¹è±¡å¯ä»¥é€šè¿‡æ‡’åŠ è½½ï¼ˆby lazyï¼‰è·å¾—ã€‚å¯ä»¥å¾…æ•°æ®è·å–æˆåŠŸæ—¶æ‰ä½¿ç”¨è¯¥é€‚é…å™¨å¯¹è±¡ï¼Œä»è€Œé¿å…ä¸éœ€è¦çš„æ—¶å€™åˆ›å»ºè¯¥å¯¹è±¡ã€‚</div>2022-01-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/59/66/e2839938.jpg" width="30px"><span>æ¨æµ©</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>javaå¾ˆå®¹æ˜“å°±ä¸Šæ‰‹ï¼ŒåŸºæœ¬è¯­æ³•å¾ˆå°‘ã€‚
æ„Ÿè§‰kotlinï¼ŒæŠŠå¾ˆå¤šçš„è®¾è®¡æ¨¡å¼éƒ½å˜æˆäº†è¯­æ³•ï¼Œå¾ˆå¼ºå¤§ï¼ŒåŒæ—¶ä¹Ÿå¾ˆæ·±å¥¥ã€‚
</div>2022-01-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2c/06/e5/51ef9735.jpg" width="30px"><span>A Lonely Cat</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>åªè¦ä½ æš´éœ²äº†é›†åˆçš„å®ä¾‹ç»™å¤–éƒ¨ï¼Œå¤–éƒ¨å°±å¯ä»¥éšæ„ä¿®æ”¹é›†åˆçš„å€¼ã€‚

å®ç°äº† List æ¥å£çš„é›†åˆç±»å¦‚æœæ²¡æœ‰å®ç°æŸäº›æ–¹æ³•ï¼Œå¤–éƒ¨è°ƒç”¨æ—¶å°±ä¼šæŠ›å‡º UnsupportedOperationException è¿™ä¸ªå¼‚å¸¸ï¼ŒArrays.ArrayList è¿™ä¸ªå†…éƒ¨ç±»å°±æ²¡æœ‰å®ç° List æ¥å£çš„æŸäº›æ–¹æ³•ï¼Œæ‰€ä»¥å¤–éƒ¨åœ¨è°ƒç”¨è¿™äº›æ–¹æ³•æ—¶å°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œä¹Ÿå°±æ— æ³•éšæ„ä¿®æ”¹é›†åˆçš„å€¼äº†ã€‚</div>2022-01-21</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/71/c1/cbc55e06.jpg" width="30px"><span>ç™½ä¹¾æ¶›</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è®¾è®¡çš„å¤ªå¤æ‚äº†ï¼Œè¿™ä¹ˆå¤æ‚çš„è¯­æ³•è‚¯å®šåŠé€€äº†å¥½å¤šäºº</div>2022-01-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/c2/cb/65e37991.jpg" width="30px"><span>å°‹é“</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>@NotNull
   public final String getName() {
      Map var1 = this.name$delegate;
      KProperty var3 = $$delegatedProperties[0];
      boolean var4 = false;
      return (String)MapsKt.getOrImplicitDefaultNullable(var1, var3.getName());
   }
æ‚¨å¥½ï¼Œæˆ‘å°è¯•å°† kotlin ç¼–è¯‘åçš„ class åç¼–è¯‘ä¸º java æ–‡ä»¶æ¥å­¦ä¹  by map å§”æ‰˜çš„åŸç†ï¼Œä½†æ˜¯ MapsKt.getOrImplicitDefaultNullable è¿™ä¸ªæ–¹æ³•æˆ‘ä¸ºä½•æ‰¾ä¸åˆ°ï¼ŸMapsKt ç±»å¯ä»¥åœ¨ Kotlin çš„å¼€æºåº“å†…æ‰¾åˆ°ï¼Œè¯¥æ–¹æ³•å®ç°å´æ²¡æœ‰ï¼Œæœ›å¸®å¿™è§£ç­”ï¼Œè°¢è°¢</div>2022-04-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2b/f2/c7/c5855ff3.jpg" width="30px"><span>l-zesong</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>ç°åœ¨æ‰‹æœºå†…å­˜è¿™ä¹ˆå¤§ï¼Œby lazyæœ‰å¿…è¦å—ï¼Ÿ</div>2022-01-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/d5/8f/d0874a01.jpg" width="30px"><span>æ›¾å¸…</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>å§”æ‰˜ï¼Œæˆ–è€…è¯´ä»£ç†ï¼Œå¼€å‘ä¸­æ¯”è¾ƒå¸¸è§çš„è¿˜æœ‰ mock æ•°æ®ï¼Œä¸»ç•Œé¢ç‰ˆæœ¬çš„è¿­ä»£ï¼Œå¼€æºæ¡†æ¶çš„åŠŸèƒ½åŒ…è£¹ã€‚æ„Ÿè§‰è¿™äº›æ¦‚å¿µè¿˜æ˜¯ä¸€æ ·ï¼Œåªæ˜¯ Kotlin è®©è¿™äº›ä¸œè¥¿å†™èµ·æ¥æ›´åŠ ç®€å•ï¼Œæˆ–è€…æ›´åŠ æ–¹ä¾¿ã€‚</div>2022-01-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/47/b0/8c301d00.jpg" width="30px"><span>H.ZWei</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>var total: Int by ::count
æŠ¥é”™ï¼šType KMutableProperty0 has no method getValue&#47;setValue and thus it cannot serve as a delegate
kotlinæ˜¯1.6ç‰ˆæœ¬ï¼ŒIDEæ˜¯intelliJ 2021.3ç‰ˆæœ¬çš„</div>2022-03-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/40/2b/fcf4c7a8.jpg" width="30px"><span>Universe</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>&quot;æ¡ˆä¾‹ 1ï¼šå±æ€§å¯è§æ€§å°è£…&quot; ä¾‹å­å¾ˆå¥½ï¼Œå¾ˆæœ‰ç”¨</div>2022-02-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/71/c1/cbc55e06.jpg" width="30px"><span>ç™½ä¹¾æ¶›</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>var total: Int by ::count

ä¸ºå•¥æˆ‘è¿™é‡ŒæŠ¥é”™å‘¢ï¼Œæç¤ºï¼šType KMutableProperty0 has no method getValue&#47;setValue and thus it cannot serve as a delegate</div>2022-02-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/19/1f/644ae553.jpg" width="30px"><span>é‡è§à¸ˆà¸¸à¹Šà¸š</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ViewModelLazyæ˜¯å•¥ ä¼¼ä¹å°‘äº†ä¸€æ®µä¸œè¥¿ï¼Ÿ</div>2022-01-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/23/7d/01/3577c256.jpg" width="30px"><span>#æœåŠ›ä¹˜#</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>var count:Int =0
var total:Int by ::count

è¿™ä¸ªåœ¨kotlin1.4æ‰å¯ä»¥å—ï¼Ÿ1.3ä¼šæŠ¥é”™ï¼Œæ€ä¹ˆåœ¨1.3å®ç°å‘¢ï¼Ÿ</div>2022-01-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/c6/f0/e5aec198.jpg" width="30px"><span>echoliulin</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>public fun interface ReadOnlyProperty {}
è¿™ä¸ªå†™æ³•æ²¡å¤ªæ‡‚</div>2022-08-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/7b/f7/21fb7574.jpg" width="30px"><span>æœ±åˆš</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>val data: List by ::_data å†™æˆ val data: List = _data  ä¸æ˜¯æ›´ç®€å•å—ï¼Ÿ </div>2024-08-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/36/61/54/31a8d7e6.jpg" width="30px"><span>anmi</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªæ–°çš„å˜é‡ totalï¼Œç„¶åå°†å…¶å§”æ‰˜ç»™ countã€‚
è¿™ä¸ªè¯´åäº†ã€‚ä»å®˜æ–¹æ–‡æ¡£æ¥çœ‹ï¼Œåº”è¯¥æ˜¯å°†æ—§çš„å€¼å§”æ‰˜ç»™æ–°çš„å€¼ã€‚å°½ç®¡æœ€ç»ˆæ•ˆæœä¼¼ä¹çœ‹èµ·æ¥æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯åŒºåˆ«è¿˜æ˜¯æœ‰çš„ã€‚</div>2023-11-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/4a/10/365ea684.jpg" width="30px"><span>èªæ˜çš„å‚»å­©å­</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>kotlinçš„ç¡®ä¼šç”¨çš„å¾ˆå¥½ç”¨ï¼Œå­¦èµ·æ¥æ˜¯çœŸçš„åƒåŠ›åˆè´¹åŠ²å„¿</div>2023-06-15</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/33dVHfOPRwHGLtbsxS6GP3cjlB27QSlTQ9twmNMSx8dFTjnoOOtJY3Pq1INF3peB38k6XgB4uRjvBGvkxduRuw/132" width="30px"><span>é»‘çŸ®äºº</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>&#47;&#47;æ§ä»¶å¯è§æ€§å§”æ‰˜
fun View.isVisible(keepBounds: Boolean): ReadWriteProperty&lt;Any, Boolean&gt; =
        object : ReadWriteProperty&lt;Any, Boolean&gt; {
            override fun getValue(
                thisRef: Any,
                property: KProperty&lt;*&gt;
            ): Boolean = visibility == View.VISIBLE

            override fun setValue(
                thisRef: Any,
                property: KProperty&lt;*&gt;,
                value: Boolean
            ) {
                visibility = when {
                    value -&gt; View.VISIBLE
                    keepBounds -&gt; View.INVISIBLE
                    else -&gt; View.GONE
                }
            }
        }</div>2022-10-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/23/b7/0e/f7b48767.jpg" width="30px"><span>é’Ÿæ„</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>operator fun TextView.provideDelegate(value: Any?, property: KProperty&lt;*&gt;) {
    object : ReadWriteProperty&lt;Any?, String?&gt; {
        var text: String? = null

        override fun getValue(thisRef: Any?, property: KProperty&lt;*&gt;): String? = text
        override fun setValue(thisRef: Any?, property: KProperty&lt;*&gt;, value: String?) {
            text = value
        }
}

class MainActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)
        
        var textView : TextView = findViewById&lt;TextView&gt;(R.id.tv)

        &#47;&#47; â‘ 
        var message: String? by textView &#47;&#47; æŠ¥é”™ï¼šType &#39;Unit&#39; has no method &#39;getValue(Nothing?, KProperty&lt;*&gt;)&#39; and thus it cannot serve as a delegate</div>2022-08-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/f9/c5/95b97dfa.jpg" width="30px"><span>éƒ‘å³°</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>late init for Primitive type 

var name: String by notNull()</div>2022-07-26</li><br/>
</ul>