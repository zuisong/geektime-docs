ä½ å¥½ï¼Œæˆ‘æ˜¯å‘¨çˆ±æ°‘ã€‚

ä¸Šä¸€è®²ï¼Œæˆ‘ä»¬è¯´åˆ°å¦‚ä½•å°†å¤æ‚çš„ç±»å‹è½¬æ¢ç¼©å‡åˆ°ä¸¤æ¡ç®€å•çš„è§„åˆ™ï¼Œä»¥åŠä¸¤ç§ä¸»è¦ç±»å‹ã€‚è¿™ä¸¤æ¡ç®€å•è§„åˆ™æ˜¯ï¼š

1. ä»å€¼xåˆ°å¼•ç”¨ï¼šè°ƒç”¨Object(x)å‡½æ•°ã€‚
2. ä»å¼•ç”¨xåˆ°å€¼ï¼šè°ƒç”¨x.valueOf()æ–¹æ³•ï¼›æˆ–ï¼Œè°ƒç”¨å››ç§å€¼ç±»å‹çš„åŒ…è£…ç±»å‡½æ•°ï¼Œä¾‹å¦‚Number(x)ï¼Œæˆ–è€…String(x)ç­‰ç­‰ã€‚

ä¸¤ç§ä¸»è¦ç±»å‹åˆ™æ˜¯**å­—ç¬¦ä¸²**å’Œ**æ•°å­—å€¼**ã€‚

å½“ç±»å‹è½¬æ¢ç³»ç»Ÿè¢«ç¼©å‡æˆè¿™æ ·ä¹‹åï¼Œæœ‰äº›é—®é¢˜å°±å˜å¾—å¥½è§£é‡Šäº†ï¼Œä½†ä¹Ÿç¡®å®æœ‰äº›é—®é¢˜å˜å¾—æ›´åŠ éš¾è§£ã€‚ä¾‹å¦‚@graybernhardt åœ¨è®²æ¼”ä¸­æå‡ºçš„çµé­‚å‘é—®ï¼Œå°±æ˜¯ï¼š

- å¦‚æœå°†æ•°ç»„è·Ÿå¯¹è±¡ç›¸åŠ ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

å¦‚æœä½ å¿˜äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸€èµ·æ¥å›é¡¾ä¸€ä¸‹è¿™å››ä¸ªç›´å‡»ä½ çµé­‚æ·±å¤„çš„ç¤ºä¾‹ï¼Œç®€å•åœ°è¯´ï¼Œè¿™äº›ç¤ºä¾‹å°±æ˜¯â€œæ•°ç»„ä¸å¯¹è±¡â€ç›¸åŠ çš„å››ç§æƒ…å†µï¼Œç»“æœéƒ½å®Œå…¨ä¸åŒã€‚

```
> [] + {}
'[object Object]'

> {} + []
0

> {} + {}
NaN

> [] + []
''
```

è€Œè¿™ä¸ªé—®é¢˜ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸¤è®²çš„æ ‡é¢˜ä¸­â€œa + bâ€è¿™ä¸ªè¡¨è¾¾å¼çš„ç”±æ¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚ä½•å‡†ç¡®åœ°è§£é‡Šâ€œä¸¤ä¸ªæ“ä½œæ•°ç›¸åŠ â€ï¼Œä¸å¦‚ä½•å…¨é¢ç†è§£JavaScriptçš„ç±»å‹ç³»ç»Ÿçš„è½¬æ¢è§„åˆ™ï¼Œå…³ç³»åŒªæµ…ï¼

## é›†ä¸­ç²¾åŠ›åŠå¤§äº‹

ä¸€èˆ¬æ¥è¯´ï¼Œè¿ç®—ç¬¦å¾ˆå®¹æ˜“çŸ¥é“æ“ä½œæ•°çš„ç±»å‹ï¼Œä¾‹å¦‚â€œa - bâ€ä¸­çš„å‡å·ï¼Œæˆ‘ä»¬ä¸€çœ‹å°±çŸ¥é“æ„å›¾ï¼Œæ˜¯ä¸¤ä¸ªæ•°å€¼æ±‚å·®ï¼Œæ‰€ä»¥aå’Œbéƒ½åº”è¯¥æ˜¯æ•°å€¼ï¼›åˆä¾‹å¦‚â€œobj.xâ€ä¸­çš„ç‚¹å·ï¼Œæˆ‘ä»¬ä¸€çœ‹ä¹ŸçŸ¥é“ï¼Œæ˜¯å–**å¯¹è±¡obj**çš„å±æ€§å**å­—ç¬¦ä¸²x**ã€‚

å½“éœ€è¦å¼•æ“â€œæ¨æ–­ç›®çš„â€æ—¶ï¼ŒJavaScriptè®¾å®šæ¨æ–­ç»“æœå¿…ç„¶æ˜¯ä¸‰ç§åŸºç¡€å€¼ï¼ˆbooleanã€numberå’Œstringï¼‰ã€‚ç”±äºå…¶ä¸­çš„booleanæ˜¯é€šè¿‡æŸ¥è¡¨æ¥è¿›è¡Œçš„ï¼Œæ‰€ä»¥å°±åªå‰©ä¸‹äº†numberå’Œstringç±»å‹éœ€è¦â€œè‡ªåŠ¨åœ°ã€éšå¼åœ°è½¬æ¢â€ã€‚

ä½†æ˜¯åœ¨JavaScriptä¸­ï¼Œâ€œåŠ å·ï¼ˆ+ï¼‰â€æ˜¯ä¸€ä¸ªéå¸¸ç‰¹åˆ«çš„è¿ç®—ç¬¦ã€‚åƒä¸Šé¢é‚£æ ·ç®€å•çš„åˆ¤æ–­ï¼Œåœ¨åŠ å·ï¼ˆ+ï¼‰ä¸Šé¢å°±ä¸è¡Œï¼Œå› ä¸ºå®ƒåœ¨JavaScriptä¸­æ—¢å¯èƒ½æ˜¯å­—ç¬¦ä¸²è¿ç»“ï¼Œä¹Ÿå¯èƒ½æ˜¯æ•°å€¼æ±‚å’Œã€‚å¦å¤–è¿˜æœ‰ä¸€ä¸ªä¸æ­¤ç›¸å…³çš„æƒ…å†µï¼Œå°±æ˜¯`object[x]`ä¸­çš„`x`ï¼Œå…¶å®ä¹Ÿå¾ˆéš¾æ˜ç¡®åœ°è¯´å®ƒæ˜¯å­—ç¬¦ä¸²è¿˜æ˜¯æ•°å€¼ã€‚å› ä¸ºè®¡ç®—å±æ€§ï¼ˆcomputed propertyï¼‰çš„åå­—å¹¶ä¸èƒ½ç¡®å®šæ˜¯å­—ç¬¦ä¸²è¿˜æ˜¯æ•°å€¼ï¼›å°¤å…¶æ˜¯ç°åœ¨ï¼Œå®ƒè¿˜å¯èƒ½æ˜¯ç¬¦å·ç±»å‹ï¼ˆsymbolï¼‰ã€‚

> NOTEï¼šåœ¨è®¨è®ºè®¡ç®—å±æ€§åï¼ˆcomputed property nameï¼‰æ—¶ï¼ŒJavaScriptå°†å®ƒä½œä¸ºé¢„æœŸä¸ºå­—ç¬¦ä¸²çš„ä¸€ä¸ªå€¼æ¥å¤„ç†ï¼Œå³`r = ToPrimitive(x, String)`ã€‚ä½†æ˜¯è¿™ä¸ªè½¬æ¢çš„ç»“æœä»ç„¶å¯èƒ½æ˜¯5ç§å€¼ç±»å‹ä¹‹ä¸€ï¼Œå› æ­¤åœ¨å¾—åˆ°æœ€ç»ˆå±æ€§åçš„æ—¶å€™ï¼ŒJavaScriptè¿˜ä¼šå†è°ƒç”¨ä¸€æ¬¡`ToString(r)`ã€‚

ç”±äºâ€œåŠ å·ï¼ˆ+ï¼‰â€ä¸èƒ½é€šè¿‡ä»£ç å­—é¢æ¥åˆ¤æ–­æ„å›¾ï¼Œå› æ­¤åªèƒ½åœ¨è¿ç®—è¿‡ç¨‹ä¸­å®æ—¶åœ°æ£€æŸ¥æ“ä½œæ•°çš„ç±»å‹ã€‚å¹¶ä¸”ï¼Œè¿™äº›ç±»å‹æ£€æŸ¥éƒ½å¿…é¡»æ˜¯åŸºäºâ€œåŠ å·ï¼ˆ+ï¼‰è¿ç®—å¿…ç„¶æ“ä½œä¸¤ä¸ªå€¼æ•°æ®â€è¿™ä¸ªå‡è®¾æ¥è¿›è¡Œã€‚äºæ˜¯ï¼ŒJavaScriptä¼šå…ˆè°ƒç”¨`ToPrimitive()`å†…éƒ¨æ“ä½œæ¥åˆ†åˆ«å¾—åˆ°â€œaå’Œbä¸¤ä¸ªæ“ä½œæ•°â€å¯èƒ½çš„åŸå§‹å€¼ç±»å‹ã€‚

æ‰€ä»¥ï¼Œé—®é¢˜å°±åˆå›åˆ°äº†åœ¨ä¸Šé¢è®²çš„`Value vs. Primitive values`è¿™ä¸ªä¸œè¥¿ä¸Šé¢ã€‚å¯¹è±¡åˆ°åº•ä¼šè½¬æ¢æˆä»€ä¹ˆï¼Ÿè¿™ä¸ªè½¬æ¢è¿‡ç¨‹æ˜¯å¦‚ä½•å†³å®šçš„å‘¢ï¼Ÿ

è¿™ä¸ªè¿‡ç¨‹åŒ…æ‹¬å¦‚ä¸‹çš„å››ä¸ªæ­¥éª¤ã€‚

### æ­¥éª¤ä¸€

é¦–å…ˆï¼ŒJavaScriptçº¦å®šï¼šå¦‚æœ`x`åŸæœ¬å°±æ˜¯åŸå§‹å€¼ï¼Œé‚£ä¹ˆ`ToPrimitive(x)`è¿™ä¸ªæ“ä½œç›´æ¥å°±è¿”å›`x`æœ¬èº«ã€‚è¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œå› ä¸ºå®ƒä¸éœ€è¦è½¬æ¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ˆå¦‚ä¸‹ä»£ç æ˜¯ä¸èƒ½ç›´æ¥æ‰§è¡Œçš„ï¼‰ï¼š

```
# 1. å¦‚æœxæ˜¯éå¯¹è±¡ï¼Œåˆ™è¿”å›x
> _ToPrimitive(5)
5
```

### æ­¥éª¤äºŒ

æ¥ä¸‹æ¥çš„çº¦å®šæ˜¯ï¼šå¦‚æœ`x`æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¸”å®ƒæœ‰å¯¹åº”çš„äº”ç§`PrimitiveValue`å†…éƒ¨æ§½ä¹‹ä¸€ï¼Œé‚£ä¹ˆå°±ç›´æ¥è¿”å›è¿™ä¸ªå†…éƒ¨æ§½ä¸­çš„åŸå§‹å€¼ã€‚ç”±äºè¿™äº›å¯¹è±¡çš„`valueOf()`å°±å¯ä»¥è¾¾æˆè¿™ä¸ªç›®çš„ï¼Œå› æ­¤è¿™ç§æƒ…å†µä¸‹ä¹Ÿå°±æ˜¯ç›´æ¥è°ƒç”¨è¯¥æ–¹æ³•ï¼ˆæ­¥éª¤ä¸‰ï¼‰ã€‚ç›¸å½“äºå¦‚ä¸‹ä»£ç ï¼š

```
# 2. å¦‚æœxæ˜¯å¯¹è±¡ï¼Œåˆ™å°è¯•å¾—åˆ°ç”±x.valueOf()è¿”å›çš„åŸå§‹å€¼
> Object(5).valueOf()
5
```

ä½†æ˜¯åœ¨å¤„ç†è¿™ä¸ªçº¦å®šçš„æ—¶å€™ï¼ŒJavaScriptæœ‰ä¸€é¡¹ç‰¹åˆ«çš„è®¾å®šï¼Œå°±æ˜¯å¯¹â€œå¼•æ“æ¨æ–­ç›®çš„â€è¿™ä¸€è¡Œä¸ºåšä¸€ä¸ªé¢„è®¾ã€‚å¦‚æœæŸä¸ªè¿ç®—æ²¡æœ‰é¢„è®¾ç›®çš„ï¼Œè€ŒJavaScriptä¹Ÿä¸èƒ½æ¨æ–­ç›®çš„ï¼Œé‚£ä¹ˆJavaScriptå°±ä¼šå¼ºåˆ¶å°†è¿™ä¸ªé¢„è®¾ä¸ºâ€œnumberâ€ï¼Œå¹¶è¿›å…¥â€œä¼ ç»Ÿçš„â€ç±»å‹è½¬æ¢é€»è¾‘ï¼ˆæ­¥éª¤å››ï¼‰ã€‚

æ‰€ä»¥ï¼Œç®€å•åœ°è¯´ï¼ˆ**è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç»“è®º**ï¼‰ï¼š

å¦‚æœä¸€ä¸ªè¿ç®—æ— æ³•ç¡®å®šç±»å‹ï¼Œé‚£ä¹ˆåœ¨ç±»å‹è½¬æ¢å‰ï¼Œå®ƒçš„è¿ç®—æ•°å°†è¢«é¢„è®¾ä¸ºnumberã€‚

> NOTE1ï¼šé¢„è®¾ç±»å‹åœ¨ECMAScriptç§°ä¸ºPreferredTypeï¼Œå®ƒå¯ä»¥ä¸ºundefinedæˆ–"default"ã€‚ä½†æ˜¯â€œdefaultâ€å€¼æ˜¯â€œä¼ ç»Ÿçš„â€ç±»å‹è½¬æ¢é€»è¾‘æ‰€ä¸èƒ½å¤„ç†çš„ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼ŒJavaScriptä¼šå…ˆå°†å®ƒé‡ç½®ä¸ºâ€œnumberâ€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä¼ ç»Ÿçš„è½¬æ¢æ¨¡å¼ä¸­ï¼Œâ€œnumberâ€æ˜¯ä¼˜å…ˆçš„ã€‚  
> NOTE2ï¼šäº‹å®ä¸Šï¼Œåªæœ‰å¯¹è±¡çš„ç¬¦å·å±æ€§Symbol.toPrimitiveæ‰€è®¾ç½®çš„å‡½æ•°æ‰ä¼šè¢«è¦æ±‚å¤„ç†â€œdefaultâ€è¿™ä¸ªé¢„è®¾ã€‚è¿™ä¹Ÿæ˜¯åœ¨Proxy/Reflectä¸­å¹¶æ²¡æœ‰ä¸ç±»å‹è½¬æ¢ç›¸å…³çš„é™·é˜±æˆ–æ–¹æ³•çš„åŸå› ã€‚

äºæ˜¯ï¼Œè¿™é‡Œä¼šå‘ç”Ÿä¸¤ç§æƒ…å†µï¼Œä¹Ÿå°±æ˜¯æ¥ä¸‹æ¥çš„æ­¥éª¤ä¸‰å’Œæ­¥éª¤å››ã€‚

### æ­¥éª¤ä¸‰ï¼šä½œä¸ºåŸå§‹å€¼å¤„ç†

å¦‚æœæ˜¯ä¸Šè¿°çš„äº”ç§åŒ…è£…ç±»çš„å¯¹è±¡å®ä¾‹ï¼ˆå®ƒä»¬æœ‰äº”ç§`PrimitiveValue`å†…éƒ¨æ§½ä¹‹ä¸€ï¼‰ï¼Œé‚£ä¹ˆå®ƒä»¬çš„`valueOf()`æ–¹æ³•æ€»æ˜¯ä¼šå¿½ç•¥æ‰â€œnumberâ€è¿™æ ·çš„é¢„è®¾ï¼Œå¹¶è¿”å›å®ƒä»¬å†…éƒ¨ç¡®å®šï¼ˆå³å†…éƒ¨æ§½ä¸­æ‰€ä¿ç•™çš„ï¼‰çš„åŸå§‹å€¼ã€‚

æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬ä¸ºç¬¦å·åˆ›å»ºä¸€ä¸ªå®ƒçš„åŒ…è£…ç±»å¯¹è±¡å®ä¾‹ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹è§£å‡ºå®ƒçš„å€¼ã€‚ä¾‹å¦‚ï¼š

```
> x = Symbol()

> obj = Object(x)

> obj.valueOf() === x
true
```

æ­£æ˜¯å› ä¸ºå¯¹è±¡ï¼ˆå¦‚æœå®ƒæ˜¯åŸå§‹å€¼çš„åŒ…è£…ç±»ï¼‰ä¸­çš„åŸå§‹å€¼æ€»æ˜¯è¢«è§£å‡ºæ¥ï¼Œæ‰€ä»¥ï¼Œä½ è¦å°†æ•°å­—å€¼`5`è½¬æ¢æˆä¸¤ä¸ªå¯¹è±¡ç±»å‹ï¼Œå¹¶ä¸”å†å°†è¿™ä¸¤ä¸ªå¯¹è±¡ç›¸åŠ ï¼Œé‚£ä¹ˆå…¶ç»“æœä¹Ÿä¼šæ˜¯æ•°å€¼10ã€‚

```
> Object(5) + Object(5)
10
```

è¿™ä¸ªä»£ç çœ‹èµ·æ¥æ˜¯ä¸¤ä¸ªå¯¹è±¡â€œç›¸åŠ â€ï¼Œä½†æ˜¯å´ç­‰æ•ˆäºå®ƒä»¬çš„åŸå§‹å€¼ç›´æ¥ç›¸åŠ ã€‚

ä½†æ˜¯å¦‚æœè€ƒè™‘â€œå¯¹è±¡å±æ€§å­˜å–â€è¿™æ ·çš„ä¾‹å­æƒ…å†µå°±å‘ç”Ÿäº†å˜åŒ–ï¼Œç”±äºâ€œå¯¹è±¡å±æ€§å­˜å–â€æ˜¯ä¸€ä¸ªâ€œæœ‰é¢„æœŸâ€çš„è¿ç®—â€”â€”å®ƒçš„é¢„æœŸæ˜¯â€œå­—ç¬¦ä¸²â€ï¼Œå› æ­¤ä¼šæœ‰ç¬¬äºŒç§æƒ…å†µâ€”â€”æ­¥éª¤å››ã€‚

### æ­¥éª¤å››ï¼šè¿›å…¥â€œä¼ ç»Ÿçš„ç±»å‹è½¬æ¢é€»è¾‘â€

è¿™éœ€è¦åˆ©ç”¨åˆ°å¯¹è±¡çš„`valueOf()`å’Œ`toString()`æ–¹æ³•ï¼šå½“é¢„æœŸæ˜¯â€œnumberâ€æ—¶ï¼Œ`valueOf()`æ–¹æ³•ä¼˜å…ˆè°ƒç”¨ï¼›å¦åˆ™å°±ä»¥`toString()`ä¸ºä¼˜å…ˆã€‚å¹¶ä¸”ï¼Œé‡è¦çš„æ˜¯ï¼Œä¸Šé¢çš„é¢„æœŸåªå†³å®šäº†ä¸Šè¿°çš„ä¼˜å…ˆçº§ï¼Œè€Œå½“è°ƒç”¨ä¼˜å…ˆæ–¹æ³•ä»ç„¶å¾—ä¸åˆ°éå¯¹è±¡å€¼æ—¶ï¼Œè¿˜ä¼šé¡ºåºè°ƒç”¨å¦ä¸€æ–¹æ³•ã€‚

è¿™å¸¦æ¥äº†ä¸€ä¸ªç»“æœï¼Œå³ï¼šå¦‚æœç”¨æˆ·ä»£ç è¯•å›¾å¾—åˆ°â€œnumberâ€ç±»å‹ï¼Œä½†`x.valueOf()`è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆå°±è¿˜ä¼šè°ƒç”¨`x.toString()`ï¼Œå¹¶æœ€ç»ˆå¾—åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚

åˆ°è¿™é‡Œï¼Œå°±å¯ä»¥è§£é‡Šå‰é¢å››ç§å¯¹è±¡ä¸æ•°ç»„ç›¸åŠ æ‰€å¸¦æ¥çš„ç‰¹æ®Šæ•ˆæœäº†ã€‚

## è§£é¢˜1ï¼šä»å¯¹è±¡åˆ°åŸå§‹å€¼

åœ¨`a + b`çš„è¡¨è¾¾å¼ä¸­ï¼Œ`a`å’Œ`b`æ˜¯å¯¹è±¡ç±»å‹æ—¶ï¼Œç”±äºâ€œåŠ å·ï¼ˆ+ï¼‰â€è¿ç®—ç¬¦å¹¶ä¸èƒ½åˆ¤åˆ«ä¸¤ä¸ªæ“ä½œæ•°çš„é¢„æœŸç±»å‹ï¼Œå› æ­¤å®ƒä»¬è¢«â€œä¼˜å…ˆåœ°â€å‡è®¾ä¸ºæ•°å­—å€¼ï¼ˆnumberï¼‰è¿›è¡Œç±»å‹è½¬æ¢ã€‚è¿™æ ·ä¸€æ¥ï¼Œæ— è®ºæ˜¯å¯¹è±¡ï¼Œè¿˜æ˜¯æ•°ç»„ï¼Œå®ƒä»¬çš„.valueOf()æ–¹æ³•è°ƒç”¨çš„ç»“æœéƒ½å°†å¾—åˆ°å®ƒä»¬æœ¬èº«ã€‚å¦‚æœç”¨typeof()çœ‹ä¸€ä¸‹ï¼Œç»“æœè¿˜ä»ç„¶æ˜¯`object`ç±»å‹ã€‚æ¥ä¸‹æ¥ï¼Œç”±äºè¿™ä¸ªè°ƒç”¨.valueOf()æ–¹æ³•çš„ç»“æœä¸æ˜¯å€¼ç±»å‹ï¼Œæ‰€ä»¥å°±ä¼šå†å°è¯•ä¸€ä¸‹è°ƒç”¨.toString()è¿™ä¸ªæ–¹æ³•ã€‚

```
# åœ¨é¢„æœŸæ˜¯'number'æ—¶ï¼Œå…ˆè°ƒç”¨`valueOf()`æ–¹æ³•ï¼Œä½†å¾—åˆ°çš„ç»“æœä»ç„¶æ˜¯å¯¹è±¡ç±»å‹ï¼›
> [typeof ([].valueOf()), typeof ({}.valueOf())]
[ 'object', 'object' ]

# ç”±äºä¸Šè¿°çš„ç»“æœæ˜¯å¯¹è±¡ç±»å‹ï¼ˆè€Œéå€¼ï¼‰ï¼Œäºæ˜¯å†å°è¯•`toString()`æ–¹æ³•æ¥å¾—åˆ°å­—ç¬¦ä¸²
> [[].toString(), {}.toString()]
[ ''ï¼Œ '[object Object]' ]
```

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°±ä¼šçœ‹åˆ°æœ‰ä¸€ç‚¹ç‚¹å·®å¼‚äº†ã€‚ç©ºæ•°ç»„è½¬æ¢å‡ºæ¥ï¼Œæ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œè€Œå¯¹è±¡çš„è½¬æ¢æˆå­—ç¬¦ä¸²æ—¶æ˜¯â€™\[object Object]â€™ã€‚

æ‰€ä»¥æ¥ä¸‹æ¥çš„å››ç§è¿ç®—å˜æˆäº†ä¸‹é¢è¿™ä¸ªæ ·å­ï¼Œå®ƒä»¬å…¶å®æ˜¯å¯¹å­—ç¬¦ä¸²ç›¸åŠ ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²è¿æ¥çš„ç»“æœã€‚

```
# [] + {}
> '' + '[object Object]'
'[object Object]'

# {} + []
> ???
0

# {} + {}
> ???
NaN

# [] + []
> '' + ''
''
```

å¥½çš„ï¼Œä½ åº”è¯¥å·²ç»æ³¨æ„åˆ°äº†ï¼Œåœ¨ç¬¬äºŒå’Œç¬¬ä¸‰ç§è½¬æ¢çš„æ—¶å€™æˆ‘æ‰“äº†ä¸‰ä¸ªé—®å·â€œ???â€ã€‚å› ä¸ºå¦‚æœæŒ‰ç…§ä¸Šé¢çš„è½¬æ¢è¿‡ç¨‹ï¼Œå®ƒä»¬æ— éæ˜¯å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œä½†ç»“æœå®ƒä»¬å´æ˜¯ä¸¤ä¸ªæ•°å­—å€¼ï¼Œåˆ†åˆ«æ˜¯0ï¼Œè¿˜æœ‰NaNã€‚

æ€ä¹ˆä¼šè¿™æ ·ï¼Ÿï¼ï¼

## è§£é¢˜2ï¼šâ€œåŠ å·ï¼ˆ+ï¼‰â€è¿ç®—çš„æˆåˆ†å¾ˆå¤š

ç°åœ¨çœ‹çœ‹è¿™ä¸¤ä¸ªè¡¨è¾¾å¼ã€‚

```
{} + []
{} + {}
```

ä½ æœ‰æ²¡æœ‰ä¸€ç‚¹ç†Ÿæ‚‰æ„Ÿï¼Ÿå—¯ï¼Œå¾ˆä¸å¹¸ï¼Œå®ƒä»¬çš„å·¦ä¾§æ˜¯ä¸€å¯¹å¤§æ‹¬å·ï¼Œè€Œå½“å®ƒä»¬ä½œä¸ºè¯­å¥æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼šè¢«ä¼˜å…ˆè§£ææˆâ€”â€”å—è¯­å¥ï¼å¹¶ä¸”å¤§æ‹¬å·ä½œä¸ºç»“å°¾çš„æ—¶å€™ï¼Œæ˜¯å¯ä»¥çœç•¥æ‰è¯­å¥ç»“æŸç¬¦â€œåˆ†å·ï¼ˆ;ï¼‰â€çš„ã€‚

æ‰€ä»¥ï¼Œä½ ç¢°åˆ°äº†JavaScriptè¯­è¨€è®¾è®¡å†å²ä¸­æœ€å¤§çš„ä¸€å—é“æ¿ï¼å°±æ˜¯æ‰€è°“â€œè‡ªåŠ¨åˆ†å·æ’å…¥ï¼ˆASIï¼‰â€ã€‚è¿™ä¸ªä¸œè¥¿çš„ç»†èŠ‚æˆ‘è¿™é‡Œå°±ä¸è®²äº†ï¼Œä½†å®ƒçš„ç»“æœæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸Šé¢çš„ä»£ç å˜æˆä¸‹é¢è¿™ä¸ªæ ·å­ï¼š

- `{}; +[]`
- `{}; +{}`

å®åœ¨æ˜¯ä¸å¹¸å•Šï¼è¿™æ ·çš„ä»£ç ä»ç„¶æ˜¯å¯ä»¥é€šè¿‡è¯­æ³•è§£æï¼Œå¹¶ä¸”ä»ç„¶æ˜¯å¯ä»¥è¿›è¡Œè¡¨è¾¾å¼è®¡ç®—æ±‚å€¼çš„ï¼

äºæ˜¯åç»­çš„ç»“è®ºå°±æ¯”è¾ƒæ˜¾è€Œæ˜“è§äº†ã€‚

ç”±äºâ€œ+â€å·åŒæ—¶ä¹Ÿæ˜¯â€œæ­£å€¼è¿ç®—ç¬¦â€ï¼Œå¹¶ä¸”å®ƒå¾ˆæ˜æ˜¾å¯ä»¥å‡†ç¡®åœ°é¢„æœŸåç»­æ“ä½œæ•°æ˜¯ä¸€ä¸ªæ•°å€¼ï¼Œæ‰€ä»¥å®ƒå¹¶ä¸éœ€è¦è°ƒç”¨`ToPrimitive()`å†…éƒ¨æ“ä½œæ¥å¾—åˆ°åŸå§‹å€¼ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨â€œToNumber(x)â€æ¥å°è¯•å°†`x`è½¬æ¢ä¸ºæ•°å­—å€¼ã€‚è€Œä¸Šé¢ä¹Ÿè®²åˆ°ï¼Œâ€œå°†å¯¹è±¡è½¬æ¢ä¸ºæ•°å­—å€¼ï¼Œç­‰æ•ˆäºä½¿ç”¨å®ƒçš„åŒ…è£…ç±»æ¥è½¬æ¢ï¼Œä¹Ÿå°±æ˜¯Number(x)â€ã€‚æ‰€ä»¥ï¼Œä¸Šè¿°ä¸¤ç§è¿ç®—çš„ç»“æœå°±å˜æˆäº†ä¸‹é¢çš„æ ·å­ï¼š

```
# +[] å°†ç­‰ä¹‰äº
> + Number([])
0

# +{} å°†ç­‰ä¹‰äº
> + Number({})
NaN
```

## è§£é¢˜3ï¼šé¢„æœŸ vs. éé¢„æœŸ

ä½†æ˜¯ä½ å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼šå½“ä½¿ç”¨â€œâ€¦ + {}â€æ—¶ï¼Œ`ToPrimitive()`è½¬æ¢å‡ºæ¥çš„ï¼Œæ˜¯å­—ç¬¦ä¸²â€œ\[object Object]â€ï¼›è€Œåœ¨ä½¿ç”¨â€œ+ {}â€æ—¶ï¼Œ`ToNumber(x)`è½¬æ¢å‡ºæ¥çš„å´æ˜¯å€¼NaNã€‚æ‰€ä»¥ï¼Œåœ¨ä¸åŒçš„é¢„æœŸä¸‹é¢ï¼Œâ€œå¯¹è±¡-&gt;å€¼â€è½¬æ¢çš„ç»“æœå´å¹¶ä¸ç›¸åŒã€‚

è¿™ä¹‹é—´æœ‰ä»€ä¹ˆè§„å¾‹å—ï¼Ÿ

æˆ‘ä»¬å¾—å…ˆç†è§£å“ªäº›æƒ…å†µä¸‹ï¼ŒJavaScriptæ˜¯ä¸èƒ½ç¡®å®šç”¨æˆ·ä»£ç çš„é¢„æœŸçš„ã€‚æ€»ç»“èµ·æ¥ï¼Œè¿™å…¶å®å¾ˆæœ‰é™ï¼ŒåŒ…æ‹¬ï¼š

1. â€œåŠ å·ï¼ˆ+ï¼‰â€è¿ç®—ä¸­ï¼Œä¸èƒ½ç¡®å®šå·¦ã€å³æ“ä½œæ•°çš„ç±»å‹ï¼›
2. â€œç­‰å€¼ï¼ˆ==ï¼‰â€è¿ç®—ä¸­ï¼Œä¸èƒ½ç¡®å®šå·¦ã€å³æ“ä½œæ•°çš„ç±»å‹ï¼›ï¼ˆJavaScriptè®¤ä¸ºï¼Œå¦‚æœå·¦ã€å³æ“ä½œæ•°ä¹‹ä¸€ä¸ºstringã€numberã€bigintå’Œsymbolå››ç§åŸºç¡€ç±»å‹ä¹‹ä¸€ï¼Œè€Œå¦ä¸€ä¸ªæ“ä½œæ•°æ˜¯å¯¹è±¡ç±»å‹(x)ï¼Œé‚£ä¹ˆå°±éœ€è¦å°†å¯¹è±¡ç±»å‹â€œè½¬æ¢æˆåŸºç¡€ç±»å‹ï¼ˆToPrimitive(x)ï¼‰â€æ¥è¿›è¡Œæ¯”è¾ƒã€‚æ“ä½œæ•°å°†å°½é‡è½¬æ¢ä¸ºæ•°å­—æ¥è¿›è¡Œæ¯”è¾ƒï¼Œå³æœ€ç»ˆç»“æœå°†ç­‰æ•ˆäºï¼šNumber(x) == Number(y)ã€‚ï¼‰
3. â€œnew Date(x)â€ä¸­ï¼Œå¦‚æœxæ˜¯ä¸€ä¸ªéDate()å®ä¾‹çš„å¯¹è±¡ï¼Œé‚£ä¹ˆå°†å°è¯•æŠŠxè½¬æ¢ä¸ºåŸºç¡€ç±»å‹x1ï¼›å¦‚æœx1æ˜¯å­—ç¬¦ä¸²ï¼Œå°è¯•ä»å­—ç¬¦ä¸²ä¸­parserå‡ºæ—¥æœŸå€¼ï¼›å¦åˆ™å°è¯•x2 = Number(x1)ï¼Œå¦‚æœèƒ½å¾—åˆ°æœ‰æ•ˆçš„æ•°å­—å€¼ï¼Œåˆ™ç”¨x2æ¥åˆ›å»ºæ—¥æœŸå¯¹è±¡ã€‚
4. åŒæ ·æ˜¯åœ¨Date()çš„å¤„ç†ä¸­ï¼Œï¼ˆç›¸å¯¹äºç¼ºçœæ—¶ä¼˜å…ˆnumberç±»å‹æ¥è¯´ï¼Œï¼‰JavaScriptå†…éƒ¨è°ƒæ•´äº†Dateåœ¨è½¬æ¢ä¸ºå€¼ç±»å‹æ—¶çš„é¢„æœŸã€‚ä¸€ä¸ªDateç±»å‹çš„å¯¹è±¡(x)è½¬æ¢ä¸ºå€¼æ—¶ï¼Œå°†ä¼˜å…ˆå°†å®ƒè§†ä¸ºå­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯å…ˆè°ƒç”¨x.toString()ï¼Œä¹‹åå†è°ƒç”¨x.valueOf()ã€‚

å…¶ä»–æƒ…å†µä¸‹ï¼ŒJavaScriptä¸ä¼šä¸ºç”¨æˆ·ä»£ç è°ƒæ•´æˆ–å‡è®¾é¢„æœŸå€¼ã€‚è¿™ä¹Ÿå°±æ˜¯è¯´ï¼ŒæŒ‰ç…§ECMAScriptå†…éƒ¨çš„é€»è¾‘ä¸å¤„ç†è¿‡ç¨‹ï¼Œå…¶ä»–çš„è¿ç®—ï¼ˆè¿ç®—ç¬¦æˆ–å…¶ä»–å†…ç½®æ“ä½œï¼‰å¯¹äºâ€œå¯¹è±¡xâ€ï¼Œéƒ½æ˜¯æœ‰ç›®æ ‡ç±»å‹æ˜ç¡®çš„ã€æµç¨‹ç¡®å®šçš„æ–¹æ³•æ¥è½¬æ¢ä¸ºâ€œï¼ˆå€¼ç±»å‹çš„ï¼‰å€¼â€çš„ã€‚

## å…¶ä»–

### æ˜¾å¼çš„ vs. éšå¼çš„è½¬æ¢

å¾ˆå¤§ç¨‹åº¦ä¸Šæ¥è¯´ï¼Œæ˜¾å¼çš„è½¬æ¢å…¶å®åªå†³å®šäº†â€œè½¬æ¢çš„é¢„æœŸâ€ï¼Œè€Œå®ƒå†…éƒ¨çš„è½¬æ¢è¿‡ç¨‹ï¼Œä»ç„¶æ˜¯éœ€è¦â€œéšå¼è½¬æ¢è¿‡ç¨‹â€æ¥å‚ä¸çš„ã€‚ä¾‹å¦‚ï¼Œä½ è°ƒç”¨Number()å‡½æ•°æ¥è½¬æ¢å¯¹è±¡`x`ï¼š

```
> x = new Object
> Number(x)
NaN
```

å¯¹äºè¿™æ ·çš„ä¸€ä¸ªæ˜¾å¼è½¬æ¢ï¼ŒNumber()åªå†³å®šå®ƒé¢„æœŸçš„ç›®æ ‡æ˜¯â€™numberâ€™ç±»å‹ï¼Œå¹¶æœ€ç»ˆå°†è°ƒç”¨`ToPrimitive(x, 'Number')`æ¥å¾—åˆ°ç»“æœã€‚ç„¶è€Œï¼Œä¸€å¦‚ä¹‹å‰æ‰€è¯´çš„ï¼ŒToPrimitive()ä¼šæ¥å—ä»»ä½•ä¸€ä¸ªâ€œåŸå§‹å€¼â€ä½œä¸ºç»“æœ`x1`è¿”å›ï¼ˆå¹¶ä¸”è¦ç•™æ„çš„æ˜¯ï¼Œåœ¨è¿™é‡Œnullå€¼ä¹Ÿæ˜¯åŸå§‹å€¼ï¼‰ï¼Œå› æ­¤å®ƒå¹¶ä¸ä¿è¯ç»“æœç¬¦åˆé¢„æœŸ`'number'`ã€‚

æ‰€ä»¥ï¼Œæœ€ç»ˆNumber()è¿˜ä¼šå†è°ƒç”¨ä¸€æ¬¡è½¬æ¢è¿‡ç¨‹ï¼Œå°è¯•å°†`x1`è½¬æ¢ä¸ºæ•°å­—ã€‚

### å­—ç¬¦ä¸²åœ¨â€œ+â€å·ä¸­çš„ä¼˜å…ˆæƒ

å¦ä¸€æ–¹é¢ï¼Œåœ¨â€œ+â€å·è¿ç®—ä¸­ï¼Œç”±äºå¯èƒ½çš„è¿ç®—åŒ…æ‹¬æ•°æ®å’Œå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æŒ‰ç…§éšå¼è½¬æ¢è§„åˆ™ï¼Œåœ¨ä¸ç¡®å®šçš„æƒ…å†µä¸‹ï¼Œä¼˜å…ˆå°†è¿ç®—æ•°ä½œä¸ºæ•°å­—å¤„ç†ã€‚é‚£ä¹ˆå°±æ˜¯é»˜è®¤â€œ+â€å·æ˜¯åšæ±‚å’Œè¿ç®—çš„ã€‚

ä½†æ˜¯ï¼Œåœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œç»“æœå¾€å¾€ä¼šæ˜¯å­—ç¬¦ä¸²å€¼ã€‚

è¿™æ˜¯å› ä¸ºå­—ç¬¦ä¸²åœ¨â€œ+â€å·è¿ç®—ä¸­è¿˜æœ‰å¦ä¸€å±‚é¢çš„ä¼˜å…ˆçº§ï¼Œè¿™æ˜¯ç”±â€œ+â€å·è¿ç®—ç¬¦è‡ªå·²å†³å®šçš„ï¼Œå› è€Œå¹¶ä¸æ˜¯ç±»å‹è½¬æ¢ä¸­çš„æ™®éè§„åˆ™ã€‚

â€œ+â€å·è¿ç®—ç¬¦çº¦å®šï¼Œå¯¹äºå®ƒçš„ä¸¤ä¸ªæ“ä½œæ•°ï¼Œåœ¨é€šè¿‡`ToPrimitive()`å¾—åˆ°ä¸¤ä¸ªç›¸åº”çš„åŸå§‹å€¼ä¹‹åï¼ŒäºŒè€…ä¹‹ä»»ä¸€æ˜¯å­—ç¬¦ä¸²çš„è¯ï¼Œå°±ä¼˜å…ˆè¿›è¡Œå­—ç¬¦ä¸²è¿æ¥æ“ä½œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ç§æƒ…å†µä¸‹å¦ä¸€ä¸ªæ“ä½œæ•°ä¼šå‘ç”Ÿä¸€æ¬¡â€œå€¼-&gt;å€¼â€çš„è½¬æ¢ï¼Œå¹¶æœ€ç»ˆè¿æ¥ä¸¤ä¸ªå­—ç¬¦ä¸²ä»¥ä½œä¸ºç»“æœè¿”å›ã€‚

é‚£ä¹ˆï¼Œæˆ‘ä»¬æ€ä¹ˆç†è§£è¿™ä¸ªè¡Œä¸ºå‘¢ï¼Ÿæ¯”å¦‚è¯´ï¼Œå¦‚æœå¯¹è±¡xè½¬æ¢æˆæ•°å­—å’Œå­—ç¬¦ä¸²çš„æ•ˆæœå¦‚ä¸‹ï¼š

```
x = {
  valueOf() { console.log('Call valueOf'); return Symbol() },
  toString() { console.log('Call toString'); return 'abc' }
}
```

æˆ‘å£°æ˜äº†ä¸€ä¸ªå¯¹è±¡xï¼Œå®ƒå¸¦æœ‰ä¸¤ä¸ªå®šåˆ¶çš„toString()å’ŒvalueOf()æ–¹æ³•ï¼Œç”¨æ¥è§‚å¯Ÿç±»å‹è½¬æ¢çš„è¿‡ç¨‹ï¼›å¹¶ä¸”ï¼Œå…¶ä¸­valueOf()ä¼šè¿”å›ä¸€ä¸ªsymbolç¬¦å·ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæ˜¯â€œå€¼ç±»å‹â€ï¼Œä½†æ—¢ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œä¹Ÿä¸æ˜¯æ•°å­—å€¼ã€‚

æ¥ä¸‹æ¥æˆ‘ä»¬å°è¯•ç”¨å®ƒè·Ÿä¸€ä¸ªä»»æ„å€¼åšâ€œ+â€å·è¿ç®—ï¼Œä¾‹å¦‚ï¼š

```
# ä¾‹1ï¼šä¸éå­—ç¬¦ä¸²åšâ€œ+â€è¿ç®—æ—¶
> true + x
Call valueOf
TypeError: Cannot convert a Symbol value to a number
```

â€œ+â€å·è¿ç®—åœ¨å¤„ç†è¿™ç§æƒ…å†µï¼ˆç”¨å¯¹è±¡ä¸éå­—ç¬¦ä¸²å€¼åšåŠ å·è¿ç®—ï¼‰æ—¶ï¼Œä¼šå…ˆè°ƒç”¨`x`çš„valueOf()æ–¹æ³•ï¼Œç„¶åç”±äºâ€œ+â€å·çš„ä¸¤ä¸ªæ“ä½œæ•°éƒ½ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å°†å†æ¬¡å°è¯•å°†å®ƒä»¬è½¬æ¢æˆæ•°å­—å¹¶æ±‚å’Œã€‚åˆä¾‹å¦‚ï¼š

```
# ä¾‹2ï¼šä¸å­—ç¬¦ä¸²åšâ€œ+â€è¿ç®—æ—¶
> 'OK, ' + x
Call valueOf
TypeError: Cannot convert a Symbol value to a string
```

è¿™ç§æƒ…å†µä¸‹ï¼Œç”±äºå­˜åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²æ“ä½œæ•°ï¼Œå› æ­¤â€œå­—ç¬¦ä¸²è¿æ¥â€è¿ç®—è¢«ä¼˜å…ˆï¼Œäºæ˜¯ä¼šå°è¯•å°†`x`è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚

ç„¶è€Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šè¿°ä¸¤ä¸ªæ“ä½œä¸­éƒ½å¹¶æ²¡æœ‰è°ƒç”¨x.toString()ï¼Œè€Œâ€œéƒ½ä»…ä»…æ˜¯â€åœ¨ToPrimitive()å†…éƒ¨æ“ä½œä¸­è°ƒç”¨äº†x.valueOf()ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ£€æµ‹æ“ä½œæ•°çš„å€¼ç±»å‹â€œæ˜¯å¦æ˜¯å­—ç¬¦ä¸²â€ä¹‹åï¼Œå†æ¬¡è¿›è¡Œçš„â€œå€¼-&gt;å€¼â€çš„è½¬æ¢æ“ä½œæ˜¯åŸºäºToPrimitive()çš„ç»“æœï¼Œè€ŒéåŸå¯¹è±¡`x`çš„ã€‚

è¿™ä¹Ÿæ˜¯ä¹‹å‰åœ¨â€œè§£é¢˜3â€ä¸­ç‰¹åˆ«è®²è¿°Date()å¯¹è±¡è¿™ä¸€ç‰¹ä¾‹çš„åŸå› ã€‚å› ä¸ºDate()åœ¨â€œè°ƒç”¨ToPrimitive()â€è¿™ä¸ªé˜¶æ®µçš„å¤„ç†é¡ºåºæ˜¯åçš„ï¼Œæ‰€ä»¥å®ƒä¼šå…ˆè°ƒç”¨x.toStringï¼Œä»è€Œäº§ç”Ÿä¸ä¸€æ ·çš„æ•ˆæœã€‚ä¾‹å¦‚ï¼š

```
// åˆ›å»ºMyDateç±»ï¼Œè¦†ç›–valueOf()å’ŒtoString()æ–¹æ³•
class MyDate extends Date {
  valueOf() { console.log('Call valueOf'); return Symbol() }
  toString() { console.log('Call toString'); return 'abc' }
}
```

æµ‹è¯•å¦‚ä¸‹ï¼š

```
# ç¤ºä¾‹
> x = new MyDate;

# ä¸éå­—ç¬¦ä¸²åšâ€œ+â€è¿ç®—æ—¶
> true + x
Call toString
trueabc

# ä¸éå­—ç¬¦ä¸²åšâ€œ+â€è¿ç®—æ—¶
> 'OK, ' + x
Call toString
OK, abc
```

é‚£ä¹ˆå¯¹äºDate()è¿™ä¸ªç±»æ¥è¯´ï¼Œè¿™åˆæ˜¯å¦‚ä½•åšåˆ°çš„å‘¢ï¼Ÿ

### Symbol.toPrimitiveçš„å¤„ç†

ç®€å•åœ°è¯´ï¼ŒDateç±»é‡å†™äº†åŸå‹å¯¹è±¡Date.prototypeä¸Šçš„ç¬¦å·å±æ€§`Symbol.toPrimitive`ã€‚ä»»ä½•æƒ…å†µä¸‹ï¼Œå¦‚æœç”¨æˆ·ä»£ç é‡å†™äº†å¯¹è±¡çš„`Symbol.toPrimitive`ç¬¦å·å±æ€§ï¼Œé‚£ä¹ˆ`ToPrimitive()`è¿™ä¸ªè½¬æ¢è¿‡ç¨‹å°±å°†ç”±ç”¨æˆ·ä»£ç è´Ÿè´£ï¼Œè€ŒåŸæœ‰çš„é¡ºåºä¸è§„åˆ™å°±å¤±æ•ˆäº†ã€‚

æˆ‘ä»¬çŸ¥é“ï¼Œç”±äºè°ƒç”¨`ToPrimitive(hint)`æ—¶çš„å…¥å£å‚æ•°hintå¯èƒ½ä¸º`default/string/number`è¿™ä¸‰ç§å€¼ä¹‹ä¸€ï¼Œè€Œå®ƒè¦æ±‚è¿”å›çš„åªæ˜¯â€œå€¼ç±»å‹â€ç»“æœï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç»“æœå¯ä»¥æ˜¯æ‰€æœ‰5ç§å€¼ç±»å‹ä¹‹ä»»ä¸€ã€‚å› æ­¤ï¼Œç”¨æˆ·ä»£ç å¯¹`ToPrimitive(hint)`çš„é‡å†™å¯ä»¥â€œå‚è€ƒâ€è¿™ä¸ªhintå€¼ï¼Œä¹Ÿå¯ä»¥æ— è§†ä¹‹ï¼Œä¹Ÿå¯ä»¥åœ¨è®¸å¯èŒƒå›´å†…è¿”å›ä»»ä½•ä¸€ç§å€¼ã€‚

ç®€å•åœ°è¯´ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªè¶…å¼ºç‰ˆçš„`valueOf()`ã€‚

äº‹å®ä¸Šï¼Œä¸€æ—¦ç”¨æˆ·ä»£ç å£°æ˜äº†ç¬¦å·å±æ€§`Symbol.toPrimitive`ï¼Œé‚£ä¹ˆvalueOf()å°±å¤±æ•ˆäº†ï¼ŒECMAScripté‡‡ç”¨è¿™ä¸ªæ–¹å¼â€œä¸€ä¸¾â€æ‘§æ¯äº†åŸæœ‰çš„éšå¼è½¬æ¢çš„å…¨éƒ¨é€»è¾‘ã€‚è¿™æ ·ä¸€æ¥ï¼ŒåŒ…æ‹¬é¢„æœŸçš„é¡ºåºä¸é‡ç½®ï¼Œä»¥åŠtoStringå’ŒvalueOfè°ƒç”¨ç­‰ç­‰éƒ½â€œä¸å¤å­˜ç„‰â€ã€‚

ä¸€åˆ‡é‡å½’äºé›¶ï¼šå®šåˆ¶`Symbol.toPrimitive`ï¼Œè¿”å›`å€¼ç±»å‹`ï¼›å¦åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚

> NOTEï¼šDate()ç±»ä¸­ä»ç„¶æ˜¯ä¼šè°ƒç”¨toStringæˆ–valueOfçš„ï¼Œè¿™æ˜¯å› ä¸ºåœ¨å®ƒçš„`Symbol.toPrimitive`å®ç°ä¸­ä»…æ˜¯è°ƒæ•´äº†ä¸¤ä¸ªæ–¹æ³•çš„è°ƒç”¨é¡ºåºï¼Œè€Œä¹‹åä»ç„¶æ˜¯è°ƒç”¨åŸå§‹çš„ã€å†…ç½®çš„`ToPrimitive()`æ–¹æ³•çš„ã€‚å¯¹äºç”¨æˆ·ä»£ç æ¥è¯´ï¼Œå¯ä»¥è‡ªè¡Œå†³å®šè¯¥ç¬¦å·å±æ€§ï¼ˆæ–¹æ³•ï¼‰çš„è°ƒç”¨ç»“æœï¼Œæ— éœ€ä¾èµ–`ToPrimitive()`æ–¹æ³•ã€‚

## ç»“è¯­ä¸æ€è€ƒ

ä»Šå¤©æˆ‘ä»¬æ›´æ·±å…¥åœ°è®²è¿°äº†ç±»å‹è½¬æ¢çš„è¯¸å¤šç»†èŠ‚ï¼Œé™¤äº†è¿™ä¸€è®²çš„ç®€å•é¢˜è§£ä¹‹å¤–ï¼Œå¯¹äºâ€œ+â€å·è¿ç®—ä¹Ÿåšäº†ä¸€äº›è¡¥å……ã€‚

æ€»åœ°æ¥è®²ï¼Œæˆ‘ä»¬æ˜¯åœ¨è®¨è®ºJavaScriptè¯­è¨€æ‰€è°“â€œåŠ¨æ€ç±»å‹â€çš„éƒ¨åˆ†ï¼Œä½†æ˜¯åŠ¨æ€ç±»å‹å¹¶ä¸ä»…é™äºæ­¤ã€‚ä¹Ÿå°±æ˜¯è¯´JavaScriptä¸­å¹¶ä¸ä»…ä»…æ˜¯â€œç±»å‹è½¬æ¢â€è¡¨ç°å‡ºæ¥åŠ¨æ€ç±»å‹çš„ç‰¹æ€§ã€‚ä¾‹å¦‚ä¸€ä¸ªæ›´ç®€å•çš„é—®é¢˜ï¼š

â€œx === xâ€åœ¨å“ªäº›æƒ…å†µä¸‹ä¸ä¸ºtrueï¼Ÿ

è¿™åŸæœ¬æ˜¯è¿™ä¸¤è®²çš„å¦ä¸€ä¸ªå¤‡é€‰çš„æ ‡é¢˜ï¼Œå®ƒä¹Ÿæ˜¯è®¨è®ºåŠ¨æ€ç±»å‹é—®é¢˜çš„ã€‚åªä¸è¿‡è¿™ä¸ªé—®é¢˜æ‰€æ¶‰åŠçš„èŒƒå›´å¤ªçª„ï¼Œå¹¶ä¸é€‚åˆå±•å¼€åˆ°è¿™ä¸¤è®²æ‰€æ¶µç›–çš„å†…å®¹ï¼Œå› æ­¤è¢«å¼ƒç”¨äº†ã€‚è¿™é‡ŒæŠŠå®ƒä½œä¸ºä¸€ä¸ªå°å°çš„æ€è€ƒé¢˜ç•™ç»™ä½ ï¼Œä½ å¯ä»¥è¯•ç€æ‰¾æ‰¾ç­”æ¡ˆã€‚

> NOTE1ï¼šæˆ‘å¯ä»¥å‘Šè¯‰ä½ ç­”æ¡ˆä¸åªä¸€ä¸ªï¼Œä¾‹å¦‚â€œxæ˜¯NaNâ€ã€‚^^.  
> NOTE2ï¼šâ€œxæ˜¯NaNâ€è¿™æ ·çš„ç­”æ¡ˆä¸åŠ¨æ€ç±»å‹æˆ–åŠ¨æ€è¯­è¨€è¿™ä¸ªä½“ç³»æ²¡ä»€ä¹ˆå…³ç³»ï¼Œæ‰€ä»¥å®ƒä¸æ˜¯æˆ‘åœ¨è¿™é‡Œæƒ³ä¸ä½ è®¨è®ºçš„ä¸»è¦è¯é¢˜ã€‚

æ¬¢è¿ä½ åœ¨è¿›è¡Œæ·±å…¥æ€è€ƒåï¼Œä¸å…¶ä»–åŒå­¦åˆ†äº«è‡ªå·±çš„æƒ³æ³•ï¼Œä¹Ÿè®©æˆ‘æœ‰æœºä¼šèƒ½å¬å¬ä½ çš„æ”¶è·ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ15ï¼‰</strong></div><ul>
<li><span>weineel</span> ğŸ‘ï¼ˆ11ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>å¼ºè¡Œæ‰¾åˆ°ä¸€ç§æ–¹æ³•, ä½†å’Œæœ¬èŠ‚æ‰€è®²æ²¡å•¥å…³ç³»ï¼š

Object.defineProperty(global, &#39;x&#39;, {
    get: function() {
        return Math.random();
    }
})

x === x &#47;&#47; false</p>2019-12-27</li><br/><li><span>é™ˆå¼º</span> ğŸ‘ï¼ˆ9ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è¿™é‡Œæ˜¯ä¸€ä¸ªæ‹“å±•é˜…è¯»ï¼šhttps:&#47;&#47;2ality.com&#47;2012&#47;01&#47;object-plus-object.html

ä¸ºä»€ä¹ˆ{} + {} åœ¨æµè§ˆå™¨ä¸­æ‰“å°çš„æ˜¯ &quot;[object Object][object Object]&quot;
å› ä¸ºâ€œthe Node.js REPL parses its input differently from either Firefox or Chrome (which even uses the same V8 JavaScript engine as Node.js). The following input is parsed as expressions and the results are less surprising:â€
å®é™…ä¸Šchromeè‡ªå·±åŠ äº†console.log()ï¼Œç›¸å½“äº({} + {})ï¼Œfirefoxçš„æ§åˆ¶å°ä¼šè¾“å‡ºNaNã€‚
&#47;&#47; test in chrome
{} + {} &#47;&#47; &quot;[object Object][object Object]&quot;
{} + {} === &quot;[object Object][object Object]&quot; &#47;&#47; false
({} + {}) === &quot;[object Object][object Object]&quot; &#47;&#47; true</p>2020-04-08</li><br/><li><span>Geek_185c7d</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<p>è¯·é—®è€å¸ˆï¼Œä¸ºä»€ä¹ˆ{} + {} åœ¨æµè§ˆå™¨ä¸­æ‰“å°çš„æ˜¯ &quot;[object Object][object Object]&quot;</p>2020-01-19</li><br/><li><span>æ™“å°ä¸œ</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>éš¾é“æ˜¯è¿™ä¸ªå—ï¼Œ å¦‚æœä½œä¸ºæ ‡è¯†ç¬¦var  x ç¡®å®æ²¡æƒ³å‡ºã€‚
&gt;&gt; Symbol() === Symbol() &#47;&#47; false</p>2019-12-28</li><br/><li><span>æ¸…æ³¢</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆæ‚¨å¥½ï¼Œæˆ‘åœ¨æµè§ˆå™¨æ§åˆ¶å°ï¼Œnodeç¯å¢ƒæ§åˆ¶å°æˆ–è€…ä»£ç ä¸­ï¼š{} + {}çš„æ‰§è¡Œç»“æœéƒ½æ˜¯&quot;[object Object][object Object]&quot;ï¼Œä½†æ˜¯æ•™ç¨‹ä¸­çš„ç»“æœæ˜¯NaNï¼Œæ˜¯ä¸æ˜¯è¿˜æœ‰å…¶ä»–ç†è§£æ–¹å¼ï¼Ÿ</p>2022-01-07</li><br/><li><span>undefined</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>&gt; node -v
v12.20.1

&gt; node -p &#39;{} + {}&#39;
NaN

&gt; node -p &#39;({} + {})&#39;
[object Object][object Object]

&gt; node -p &quot;eval(&#39;{} + {}&#39;)&quot;
NaN

&gt; node -p &quot;eval(&#39;({} + {})&#39;)&quot;
[object Object][object Object]
</p>2021-04-30</li><br/><li><span>wheatup</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>å’Œsprintyçš„æ–¹æ³•ç±»ä¼¼ï¼Œåªä¸è¿‡é¿å…äº†æ±¡æŸ“å…¨å±€ä½œç”¨åŸŸï¼š

with ({ get x() { return Symbol() } }) {
	console.log(x === x);  &#47;&#47; false
}
è¿™ä¸ªèƒ½æˆåŠŸçš„åŸå› æ˜¯è¿™é‡Œçš„ x å…¶å®æ˜¯æœ‰ [withObj].x å–å€¼çš„ä¸€ä¸ªæ“ä½œï¼Œç„¶ååˆ©ç”¨getterè¿”å›ä¸åŒçš„å€¼é€ æˆçš„ã€‚

---

çœŸè¦è¯´åˆ©ç”¨æœ¬èŠ‚è¯¾å­¦åˆ°çš„å†…å®¹çš„è¯ï¼Œå¯ä»¥æŠŠé¢˜ç›®çš„ x === x æ¢æˆ x &gt;= xï¼Œå•çº¯çš„x === xæ˜¯ä¸ä¼šè§¦å‘éšå¼ç±»å‹è½¬æ¢çš„ï¼Œè€Œjsåœ¨æ¯”è¾ƒå¤§å°æ—¶ä¸€å®šä¼šå°†å¯¹è±¡è½¬æ¢æˆæ•°å€¼å†è¿›è¡Œæ¯”è¾ƒï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¼šè°ƒç”¨[Symbol.toPrimitive]ï¼Œè¿™æ—¶å€™å°±å¯ä»¥é‡å†™è¿™ä¸ªæ–¹æ³•åšäº›æ‰‹è„šï¼š

let x = {
	[Symbol.toPrimitive]() {
		return Math.random();
	}
};

console.log(x &gt;= x); &#47;&#47; trueå’Œfalseéƒ½æœ‰å¯èƒ½</p>2020-06-10</li><br/><li><span>æ²¹èœ</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼ŒNumber([]) == Number([]) æ˜¯trueï¼Œä½†[] == [] æ˜¯falseï¼ŒåŠ¨æ€ç±»å‹è½¬æ¢å¦‚ä½•è§£é‡Šè¿™ä¸ªæ¡ˆä¾‹å‘¢ï¼Ÿ
------------
var x = [];
x === x &#47;&#47; true;
x === [] &#47;&#47; false;
[] === x &#47;&#47; false;
[] === [] &#47;&#47;false;</p>2020-11-19</li><br/><li><span>HoSalt</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ã€ŒDate() ç±»ä¸­ä»ç„¶æ˜¯ä¼šè°ƒç”¨ toString æˆ– valueOf çš„ï¼Œè¿™æ˜¯å› ä¸ºåœ¨å®ƒçš„Symbol.toPrimitiveå®ç°ä¸­ä»…æ˜¯è°ƒæ•´äº†ä¸¤ä¸ªæ–¹æ³•çš„è°ƒç”¨é¡ºåºï¼Œè€Œä¹‹åä»ç„¶æ˜¯è°ƒç”¨åŸå§‹çš„ã€å†…ç½®çš„ToPrimitive()æ–¹æ³•çš„ã€
è°ƒæ•´é¡ºåºæ˜¯å€¼hintå€¼ä¸ºdefaultçš„æƒ…å†µä¸‹ï¼Ÿ</p>2020-05-25</li><br/><li><span>K4SHIFZ</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>è‡ªåŠ¨åˆ†å·æ’å…¥å¹¶ä¸ä¼šå°†{}+{} å˜æˆ{};+{} å§ï¼Ÿå› ä¸ºæ²¡æœ‰è¡Œç»“æŸç¬¦ã€‚</p>2020-03-28</li><br/><li><span>æ™“å°ä¸œ</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆæˆ‘æµ‹å¾ˆå¤šä»£ç å¾—å‡ºä¸€ä¸ªæ€»ç»“ï¼š
å‚ä¸ + æˆ– - è¿ç®— + - åªè®¤é‚£äº”ç§å€¼ç±»å‹æ•°æ®ï¼Œ
ä»åŒ…è£…å¯¹è±¡å®ä¾‹ï¼ˆStringï¼Œ Numberï¼Œ Boolean, Symbolï¼‰ï¼Œå’Œæ•°ç»„Object å¯¹è±¡è°ƒç”¨valueOfå¯ä»¥çœ‹å‡º
åªè¦valueOf è¿”å›äº”ç§å€¼ç±»å‹æ•°æ®ï¼Œ å°±ä¸ä¼štoString()æ–¹æ³•ï¼Œ åä¹‹å¦‚æœè¿˜æ˜¯å¯¹è±¡ç±»å‹ï¼Œå³ä½¿æ˜¯åŒ…è£…å¯¹è±¡å®ä¾‹ï¼Œè¿˜æ˜¯ä¼šè°ƒç”¨toStringæ–¹æ³•
æ€»ç»“æ˜¯ï¼š åœ¨toPrimitiveï¼ˆï¼‰ä¸­è¦è·å–äº”ç§å€¼ç±»å‹æ•°æ®åŒ…æ‹¬undefined å’Œ nullï¼Œ å¤§éƒ¨åˆ†æƒ…å†µä¸‹å¼•æ“éƒ½æ˜¯æŒ‰æ•°æ®å€¼ç±»å‹è¿›è¡Œé¢„æµ‹ï¼š å¦‚ä¸‹ï¼š
{}; + []
String(1) + [];
1 - [];
éƒ½æ˜¯valueOf -&gt; toString è¿‡ç¨‹

æœ€ç»ˆåœ¨toPrimitivie() ä¸­ æ ¹æ® + æˆ–è€… - ä»¥åŠè¿ç®—ç¬¦ä¸¤ä¾§å€¼ç±»å‹ è°ƒç”¨ç›¸åº”String æˆ–è€…Number è¿›è¡Œè½¬æ¢ æ±‚å€¼
æ‰€ä»¥æœ€ç»ˆçš„ç»“æœåªæœ‰ä¸‰ç§ å­—ç¬¦ä¸²ã€æ•°å€¼ã€å’Œ NaN

ç›´æ¥toStringå°±æ˜¯åœ¨æ¨¡æ¿å­—ç¬¦ä¸²ä¸­(ç›®å‰å‘ç°è¿™ä¸€ç§é™¤äº†Date)
`${x}`

æµ‹è¯•ä»£ç å¦‚ä¸‹ 
ä»£ç é“¾æ¥ https:&#47;&#47;repl.it&#47;@XiaoDHuang&#47;MadEuphoricTabs

let valueOf = Array.prototype.valueOf
let toString = Array.prototype.toString;

Array.prototype.valueOf = function() {
    console.log(this.flag + &quot; valueOf&quot;)
    return valueOf.call(this);
}

Array.prototype.toString = function() {
    console.log(this.flag + &#39; toString&#39;);
    return toString.call(this);
}

var x = [];

x.flag = &#39;{}; + []&#39;;
{}; + x;

x.flag = &#39;String(1) + []&#39;;
console.log(1 + x);

x.flag = &#39;1 - []&#39;;
console.log(1 - x);

x.flag = &#39;`${x}`&#39;
console.log(`${x}`);</p>2019-12-27</li><br/><li><span>Astrogladiator-åŸƒè’‚çº³åº¦æ–¯</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>https:&#47;&#47;developer.mozilla.org&#47;en-US&#47;docs&#47;Web&#47;JavaScript&#47;Equality_comparisons_and_sameness

çœ‹äº†ä¸‹mdnï¼Œè¿˜çœŸæ˜¯åªæœ‰NaNè¿™ä¹ˆä¸€ç§æƒ…å†µã€‚

If Type(x) is different from Type(y), return false.
If Type(x) is Number or BigInt, then
Return ! Type(x)::equal(x, y).
Return ! SameValueNonNumeric(x, y).

Assert: Type(x) is not Number or BigInt.
Assert: Type(x) is the same as Type(y).
If Type(x) is Undefined, return true.
If Type(x) is Null, return true.
If Type(x) is String, then
If x and y are exactly the same sequence of code units (same length and same code units at corresponding indices), return true; otherwise, return false.
If Type(x) is Boolean, then
If x and y are both true or both false, return true; otherwise, return false.
If Type(x) is Symbol, then
If x and y are both the same Symbol value, return true; otherwise, return false.
If x and y are the same Object value, return true. Otherwise, return false.

æŒ‰ç…§https:&#47;&#47;tc39.es&#47;ecma262&#47;#sec-samevaluenonnumericçš„è¯´æ˜æµ‹è¯•äº†ä¸‹ä¹Ÿæ²¡æœ‰æ‰¾åˆ°å…¶ä»–çš„å¯èƒ½

å¥½å¥‡è¿™ä¸ªç­”æ¡ˆæ˜¯ä»€ä¹ˆ
</p>2019-12-27</li><br/><li><span>æ™“å°ä¸œ</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆè¿™ä¸ªâ€œå…¶ä¸­çš„ boolean æ˜¯é€šè¿‡æŸ¥è¡¨æ¥è¿›è¡Œçš„â€œ  è¿™ä¸ªæŸ¥è¡¨è¯¥å¦‚ä½•ç†è§£ï¼Ÿï¼Ÿï¼Ÿ</p>2019-12-27</li><br/><li><span>æ½‡æ½‡é›¨æ­‡</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ7ï¼‰<p>æƒ³ä¸å‡ºå•¦â€¦â€¦NaNä¸æ˜¯å”¯ä¸€çš„å—</p>2019-12-27</li><br/><li><span>westfall</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<p>å…³äº chrome æ§åˆ¶å° {} + {} æ‰“å°å‡º &quot;[object Object][object Object]&quot;ï¼Œæ‰¾åˆ°ä¸€ä¸ªè§£é‡Šï¼Œchrome ä¼šå°†æ‰€æœ‰å·² &#39;{&#39; å¼€å¤´ï¼Œå·² &#39;}&#39; ç»“å°¾çš„è¾“å…¥å¼ºè¡Œç”¨ () åŒ…èµ·æ¥ï¼Œå› æ­¤è¾“å…¥ {} å¾—åˆ°çš„æ˜¯ä¸€ä¸ªå¯¹è±¡å­—é¢é‡çš„æ±‚å€¼ ({})ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªè¯­å¥å—ï¼ŒåŒæ · {} + {} å¾—åˆ°çš„æ˜¯ ({} + {})ã€‚æºç åœ¨æ­¤ï¼šhttps:&#47;&#47;chromium.googlesource.com&#47;chromium&#47;src.git&#47;+&#47;4fd348fdb9c0b3842829acdfb2b82c86dacd8e0a%5E!&#47;#F2</p>2021-02-08</li><br/>
</ul>