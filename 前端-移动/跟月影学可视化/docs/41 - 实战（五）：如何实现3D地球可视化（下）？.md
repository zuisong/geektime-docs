ä½ å¥½ï¼Œæˆ‘æ˜¯æœˆå½±ã€‚

ä¸ŠèŠ‚è¯¾ï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªæœ‰ç€æ˜Ÿç©ºèƒŒæ™¯çš„3Dåœ°çƒæ•ˆæœã€‚ä½†è¿™ä¸ªæ•ˆæœè¿˜æ¯”è¾ƒç®€å•ï¼Œåœ¨æŸäº›å¯è§†åŒ–å¤§å±é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä¸ä»…è¦å‘ˆç°è§†è§‰æ•ˆæœï¼Œè¿˜è¦å…è®¸ç”¨æˆ·ä¸å¯è§†åŒ–å¤§å±ä¸­å‘ˆç°çš„å†…å®¹è¿›è¡Œäº¤äº’ã€‚æ‰€ä»¥è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬ä¼šå…ˆç»™è¿™ä¸ª3Dåœ°çƒæ·»åŠ å„ç§äº¤äº’ç»†èŠ‚ï¼Œæ¯”å¦‚è®©åœ°çƒä¸Šçš„å›½å®¶éšç€æˆ‘ä»¬é¼ æ ‡çš„ç§»åŠ¨è€Œé«˜äº®ï¼Œæ¥ç€ï¼Œæˆ‘ä»¬å†åœ¨åœ°çƒä¸Šæ”¾ç½®å„ç§è®°å·ï¼Œæ¯”å¦‚å…‰æŸ±ã€åœ°æ ‡ç­‰ç­‰ã€‚

## å¦‚ä½•é€‰ä¸­åœ°çƒä¸Šçš„åœ°ç†ä½ç½®ï¼Ÿ

æˆ‘ä»¬å…ˆæ¥è§£å†³ä¸ŠèŠ‚è¯¾ç•™ä¸‹çš„ä¸€ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬åœ¨ç»˜åˆ¶3Dåœ°çƒçš„æ—¶å€™ï¼Œè¦å¤§è´¹å‘¨ç« åœ°ä½¿ç”¨topoJSONæ•°æ®ï¼Œè€Œä¸æ˜¯ç›´æ¥ç”¨ä¸€ä¸ªç°æˆçš„ç­‰è§’æ–¹ä½æŠ•å½±çš„ä¸–ç•Œåœ°å›¾å›¾ç‰‡ä½œä¸ºçƒä½“çš„çº¹ç†ã€‚è¿™æ˜¯å› ä¸ºï¼Œæˆ‘ä»¬æƒ³è®©åœ°çƒèƒ½å¤Ÿå’Œæˆ‘ä»¬çš„é¼ æ ‡è¿›è¡Œäº¤äº’ï¼Œæ¯”å¦‚å½“ç‚¹å‡»åˆ°åœ°å›¾ä¸Šçš„ä¸­å›½åŒºåŸŸçš„æ—¶å€™ï¼Œæˆ‘ä»¬æƒ³è®©ä¸­å›½æ˜¾ç¤ºé«˜äº®ï¼Œè¿™æ˜¯çº¹ç†å›¾ç‰‡æ— æ³•å®ç°çš„ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥çœ‹çœ‹æ€ä¹ˆå®ç°è¿™æ ·äº¤äº’çš„æ•ˆæœã€‚

### å®ç°åæ ‡è½¬æ¢

å®ç°äº¤äº’æ•ˆæœçš„éš¾ç‚¹åœ¨äºåæ ‡è½¬æ¢ã€‚å› ä¸ºé¼ æ ‡æŒ‡å‘åœ°çƒä¸Šçš„æŸä¸ªåŒºåŸŸçš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šè¿‡SpriteJSæ‹¿åˆ°çš„æ˜¯å½“å‰é¼ æ ‡åœ¨ç‚¹å‡»çš„åœ°çƒåŒºåŸŸçš„ä¸€ä¸ªä¸‰ç»´åæ ‡ï¼Œè€Œè¿™ä¸ªåæ ‡æ˜¯ä¸èƒ½ç›´æ¥åˆ¤æ–­ç‚¹ä¸­çš„åŒºåŸŸå±äºå“ªä¸ªå›½å®¶çš„ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒè½¬æ¢æˆäºŒç»´çš„åœ°å›¾ç»çº¬åº¦åæ ‡ï¼Œæ‰èƒ½é€šè¿‡åœ°å›¾æ•°æ®æ¥è·å–åˆ°å½“å‰ç»çº¬åº¦ä¸‹çš„å›½å®¶æˆ–åœ°åŒºä¿¡æ¯ã€‚

é‚£å¦‚ä½•å®ç°è¿™ä¸ªåæ ‡è½¬æ¢å‘¢ï¼Ÿé¦–å…ˆï¼Œæˆ‘ä»¬çš„é¼ æ ‡åœ¨åœ°çƒä¸Šç§»åŠ¨çš„æ—¶å€™ï¼Œé€šè¿‡SpriteJSï¼Œæˆ‘ä»¬æ‹¿åˆ°ä¸‰ç»´çš„çƒé¢åæ ‡ï¼Œä»£ç å¦‚ä¸‹ï¼š

```
layer.setRaycast();


globe.addEventListener('mousemove', (e) => {
  console.log(e.hit.localPoint);
});
...
skyBox.attributes.raycast = 'none';

```

ä¸Šé¢çš„ä»£ç ä¸­æœ‰ä¸€ä¸ªå°ç»†èŠ‚ï¼Œæˆ‘ä»¬å°†å¤©ç©ºåŒ…å›´ç›’çš„raycastè®¾ç½®æˆäº†noneã€‚ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšå‘¢ï¼Ÿå› ä¸ºåœ°çƒåŒ…å›´åœ¨å¤©ç©ºç›’å­å†…ï¼Œè¿™æ ·è®¾ç½®ä¹‹åï¼Œé¼ æ ‡å°±èƒ½ç©¿é€å¤©ç©ºåŒ…å›´ç›’åˆ°è¾¾åœ°çƒï¼Œå¦‚æœä¸è¿™ä¹ˆåšï¼Œå¤©ç©ºç›’å­å°±ä¼šé®æŒ¡ä½é¼ æ ‡äº‹ä»¶ï¼Œåœ°çƒä¹Ÿå°±æ•è·ä¸åˆ°äº‹ä»¶äº†ã€‚è¿™æ ·ä¸€æ¥ï¼Œå½“é¼ æ ‡ç§»åŠ¨åˆ°åœ°çƒä¸Šæ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ç›¸åº”çš„ä¸‰ç»´åæ ‡ä¿¡æ¯äº†ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦å°†ä¸‰ç»´åæ ‡ä¿¡æ¯è½¬æ¢ä¸ºç»çº¬åº¦ä¿¡æ¯ï¼Œé‚£ç¬¬ä¸€æ­¥å°±æ˜¯å°†ä¸‰ç»´åæ ‡è½¬æ¢ä¸ºäºŒç»´å¹³é¢åæ ‡ã€‚

```
/**
 * å°†çƒé¢åæ ‡è½¬æ¢ä¸ºå¹³é¢åœ°å›¾åæ ‡
 * @param {*} x
 * @param {*} y
 * @param {*} z
 * @param {*} radius
 */
function unproject(x, y, z, radius = 1) {
  const pLength = Math.PI * 2;
  const tLength = Math.PI;
  const v = Math.acos(y / radius) / tLength; // const y = radius * Math.cos(v * tLength);
  let u = Math.atan2(-z, x) + Math.PI; // z / x = -1 * Math.tan(u * pLength);
  u /= pLength;
  return [u * mapScale * mapWidth, v * mapScale * mapHeight];
}
```

è¿™ä¸ªçƒé¢å’Œå¹³é¢åæ ‡è½¬æ¢ï¼Œå®é™…ä¸Šå°±æ˜¯å°†ç©ºé—´åæ ‡ç³»ä»çƒåæ ‡ç³»è½¬æ¢ä¸ºå¹³é¢ç›´æ¥åæ ‡ç³»ã€‚å…·ä½“çš„è½¬æ¢æ–¹æ³•æ˜¯ï¼Œæˆ‘ä»¬å…ˆå°†çƒåæ ‡ç³»è½¬ä¸ºåœ†æŸ±åæ ‡ç³»ï¼Œå†å°†åœ†æŸ±åæ ‡ç³»è½¬ä¸ºå¹³é¢ç›´è§’åæ ‡ç³»ã€‚å…·ä½“çš„å…¬å¼æ¨å¯¼è¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œæˆ‘ä»¬æ²¡å¿…è¦æ·±å…¥ç†è§£ï¼Œä½ åªè¦ä¼šç”¨æˆ‘ç»™å‡ºçš„unprojectå‡½æ•°å°±å¯ä»¥äº†ã€‚å¦‚æœä½ å¯¹æ¨å¯¼åŸç†æœ‰å…´è¶£å¯ä»¥å›é¡¾[ç¬¬15è¯¾](https://time.geekbang.org/column/article/266346)ï¼Œè‡ªå·±æ¥æ¨å¯¼ä¸€ä¸‹ï¼Œæˆ–è€…é˜…è¯»[è¿™ç¯‡æ–‡ç« ](https://zhuanlan.zhihu.com/p/34485962)ã€‚

æ‹¿åˆ°äº†äºŒç»´å¹³é¢ç›´è§’åæ ‡ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨ç­‰è§’æ–¹ä½æŠ•å½±å‡½æ•°çš„åå‡½æ•°å°†è¿™ä¸ªå¹³é¢ç›´è§’åæ ‡è½¬æ¢ä¸ºç»çº¬åº¦ï¼Œä»£ç å¦‚ä¸‹ï¼š

```
function positionToLatlng(x, y, z, radius = 1) {
  const [u, v] = unproject(x, y, z, radius);
  return projection.invert([u, v]);
}
```

æ¥ç€ï¼Œæˆ‘ä»¬å®ç°ä¸€ä¸ªé€šè¿‡ç»çº¬åº¦æ‹¿åˆ°å›½å®¶ä¿¡æ¯çš„å‡½æ•°ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ç›´æ¥é€šè¿‡d3.geoContainsæ–¹æ³•ï¼Œä»countriesæ•°æ®ä¸­æ‹¿åˆ°å¯¹åº”çš„å›½å®¶ä¿¡æ¯ã€‚

```
function getCountryInfo(latitude, longitude, countries) {
  if(!countries) return {index: -1};
  let idx = -1;
  countries.features.some((d, i) => {
    const ret = d3.geoContains(d, [longitude, latitude]);
    if(ret) idx = i;
    return ret;
  });
  const info = idx >= 0 ? {...countries.features[idx]} : {};
  info.index = idx;
  return info;
}
```

è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬åªè¦ä¿®æ”¹mousemoveæ–¹æ³•ï¼Œå°±å¯ä»¥çŸ¥é“æˆ‘ä»¬çš„é¼ æ ‡ç§»åŠ¨åœ¨å“ªä¸ªå›½å®¶ä¹‹ä¸Šäº†ã€‚

```
globe.addEventListener('mousemove', (e) => {
  const [lng, lat] = positionToLatlng(...e.hit.localPoint);
  const country = getCountryInfo(lat, lng, countries);
  if(country.properties) {
    console.log(country.properties.name);
  }
});
```

### é«˜äº®å›½å®¶åœ°åŒºçš„æ–¹æ³•

ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°ä¸€ä¸ªæ–¹æ³•æ¥é«˜äº®é¼ æ ‡ç§»åŠ¨åˆ°çš„å›½å®¶æˆ–åœ°åŒºäº†ã€‚è¦é«˜äº®å¯¹åº”çš„å›½å®¶æˆ–åœ°åŒºï¼Œå…¶å®å¤„ç†èµ·æ¥å¹¶ä¸å¤æ‚ã€‚æˆ‘ä»¬å…ˆæŠŠåŸå§‹çš„éé«˜äº®çš„å›¾ç‰‡å¦å­˜ä¸€ä»½ï¼Œç„¶åæ ¹æ®é€‰ä¸­å›½å®¶çš„indexä¿¡æ¯ï¼Œä»contriesåŸå§‹æ•°æ®ä¸­å–å‡ºå¯¹åº”çš„é‚£ä¸ªå›½å®¶ï¼Œç”¨ä¸åŒçš„å¡«å……è‰²fillStyleå†ç»˜åˆ¶ä¸€æ¬¡ï¼Œæœ€åæ›´æ–°textureå’Œlayerï¼Œå°±å¯ä»¥å°†é«˜äº®åŒºåŸŸç»˜åˆ¶å‡ºæ¥äº†ã€‚ä»£ç å¦‚ä¸‹ï¼š

```
function highlightMap(texture, info, countries) {
  if(texture.index === info.index) return;
  const canvas = texture.image;
  if(!canvas) return;


  const idx = info.index;
  const highlightMapContxt = canvas.getContext('2d');


  if(!imgCache) {
    imgCache = new OffscreenCanvas(canvas.width, canvas.height);
    imgCache.getContext('2d').drawImage(canvas, 0, 0);
  }
  highlightMapContxt.clearRect(0, 0, mapScale * mapWidth, mapScale * mapHeight);
  highlightMapContxt.drawImage(imgCache, 0, 0);


  if(idx > 0) {
    const path = d3.geoPath(projection).context(highlightMapContxt);
    highlightMapContxt.save();
    highlightMapContxt.fillStyle = '#fff';
    highlightMapContxt.beginPath();
    path({type: 'FeatureCollection', features: countries.features.slice(idx, idx + 1)});
    highlightMapContxt.fill();
    highlightMapContxt.restore();
  }
  texture.index = idx;
  texture.needsUpdate = true;
  layer.forceUpdate();
```

ä»”ç»†çœ‹ä¸Šé¢çš„ä»£ç ä½ ä¼šå‘ç°ï¼Œè¿™é‡Œæˆ‘ä»¬å®é™…ä¸Šåšäº†ä¸¤ç‚¹ä¼˜åŒ–ï¼Œä¸€æ˜¯æˆ‘ä»¬åœ¨textureå¯¹è±¡ä¸Šè®°å½•äº†ä¸Šä¸€æ¬¡é€‰ä¸­åŒºåŸŸçš„indexã€‚å¦‚æœç§»åŠ¨é¼ æ ‡æ—¶ï¼Œindexæ²¡å‘ç”Ÿå˜åŒ–ï¼Œè¯´æ˜é¼ æ ‡ä»ç„¶åœ¨å½“å‰é«˜äº®çš„å›½å®¶å†…ï¼Œæ²¡æœ‰å¿…è¦é‡ç»˜ã€‚äºŒæ˜¯æˆ‘ä»¬ä¿å­˜äº†åŸå§‹éé«˜äº®å›¾ç‰‡ã€‚ä¹‹æ‰€ä»¥è¿™æ ·åšï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬åªè¦å°†ä¿å­˜çš„éé«˜äº®å›¾ç‰‡é€šè¿‡drawImageä¸€æ¬¡ç»˜åˆ¶ï¼Œç„¶åå†ç»˜åˆ¶é«˜äº®åŒºåŸŸï¼Œå°±å¯ä»¥å®Œæˆåœ°å›¾é«˜äº®æ•ˆæœï¼Œè€Œä¸éœ€è¦æ¯æ¬¡éƒ½é‡æ–°ç”¨Pathæ¥ç»˜åˆ¶æ•´ä¸ªåœ°å›¾äº†ï¼Œå› è€Œå¤§å¤§å‡å°‘äº†Canvas2Dç»˜å›¾æŒ‡ä»¤çš„æ•°é‡ï¼Œæ˜¾è‘—æå‡äº†æ€§èƒ½ã€‚

å®ç°äº†è¿™ä¸ªå‡½æ•°ä¹‹åï¼Œæˆ‘ä»¬æ”¹å†™mousemoveäº‹ä»¶å¤„ç†å‡½æ•°ï¼Œå°±èƒ½å°†è¿™ä¸ªäº¤äº’æ•ˆæœå®Œæ•´åœ°æ˜¾ç¤ºå‡ºæ¥äº†ã€‚å…·ä½“çš„ä»£ç å’Œæ•ˆæœå›¾å¦‚ä¸‹ï¼š

```
globe.addEventListener('mousemove', (e) => {
  const [lng, lat] = positionToLatlng(...e.hit.localPoint);
  const country = getCountryInfo(lat, lng, countries);
  highlightMap(texture, country, countries);
});

```

![](https://static001.geekbang.org/resource/image/14/e8/14ea287ce617789ce37cd2e3d40ee4e8.gif?wh=604%2A584)

## å¦‚ä½•åœ¨åœ°çƒä¸Šæ”¾ç½®æ ‡è®°ï¼Ÿ

é€šè¿‡é€‰ä¸­å¯¹åº”çš„å›½å®¶ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°é¼ æ ‡çš„ç§»åŠ¨çš„é«˜äº®äº¤äº’æ•ˆæœã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥å®ç°å¦ä¸€ä¸ªäº¤äº’æ•ˆæœï¼Œåœ¨åœ°çƒçš„æŒ‡å®šç»çº¬åº¦å¤„æ”¾ç½®ä¸€äº›æ ‡è®°ã€‚

### å¦‚ä½•è®¡ç®—å‡ ä½•ä½“æ‘†æ”¾ä½ç½®ï¼Ÿ

æ—¢ç„¶è¦æŠŠç‰©ä½“æ”¾ç½®åœ¨åœ°çƒæŒ‡å®šçš„ç»çº¬åæ ‡å¤„ï¼Œé‚£æˆ‘ä»¬æ¥ä¸‹æ¥çš„æ“ä½œä¾ç„¶ç¦»ä¸å¼€åæ ‡è½¬æ¢ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬çŸ¥é“å‡ ä½•ä½“é€šå¸¸é»˜è®¤æ˜¯ä»¥ä¸­å¿ƒç‚¹ä¸ºï¼ˆ0,0ï¼‰ç‚¹ï¼Œä½†æˆ‘ä»¬æ”¾ç½®çš„æ—¶å€™ï¼Œå´éœ€è¦å°†ç‰©ä½“çš„åº•éƒ¨æ”¾ç½®åœ¨çƒé¢ä¸Šï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹çƒé¢åæ ‡ä½ç½®è¿›è¡Œä¸€ä¸ªåæ ‡å˜æ¢ã€‚

![](https://static001.geekbang.org/resource/image/82/06/82406267ec504e29b8d975789a4f8a06.jpg?wh=1298%2A1032)

å› æ­¤ï¼Œæˆ‘ä»¬åœ¨å®ç°æ”¾ç½®å‡½æ•°çš„æ—¶å€™ï¼Œä¼šé€šè¿‡ latlngToPosition å…ˆå°†ç»çº¬åº¦è½¬æˆçƒé¢åæ ‡posï¼Œå†å»¶å±•åˆ°ç‰©ä½“é«˜åº¦çš„ä¸€åŠï¼Œå› ä¸ºçƒå¿ƒçš„åæ ‡æ˜¯0,0ï¼Œæ‰€ä»¥posä½ç½®å°±æ˜¯å¯¹åº”çš„ä¸‰ç»´å‘é‡ï¼Œæˆ‘ä»¬ä½¿ç”¨scaleå°±å¯ä»¥ç›´æ¥å°†å®ƒç§»åŠ¨åˆ°æˆ‘ä»¬è¦çš„é«˜åº¦äº†ã€‚

```
function setGlobeTarget(globe, target, {latitude, longitude, transpose = false, ...attrs}) {
  const radius = globe.attributes.radius;
  if(transpose) target.transpose();
  if(latitude != null && longitude != null) {
    const scale = target.attributes.scaleY * (attrs.scale || 1.0);
    const height = target.attributes.height;
    const pos = latlngToPosition(latitude, longitude, radius);
    // è¦å°†åº•éƒ¨æ”¾ç½®åœ¨åœ°é¢ä¸Š
    pos.scale(height * 0.5 * scale / radius + 1);
    attrs.pos = pos;
  }
  target.attr(attrs);
  const sp = new Vec3().copy(attrs.pos).scale(2);
  target.lookAt(sp);
  globe.append(target);
}
```

è¿™é‡Œçš„ latlngToPosition æ˜¯å‰é¢ positionToLatlng çš„åå‘æ“ä½œï¼Œä¹Ÿå°±æ˜¯å…ˆç”¨ projection å‡½æ•°å°†ç»çº¬åº¦æ˜ å°„ä¸ºåœ°å›¾ä¸Šçš„ç›´è§’åæ ‡ï¼Œç„¶åç”¨ç›´è§’åæ ‡è½¬çƒé¢åæ ‡çš„å…¬å¼ï¼Œå°†å®ƒè½¬ä¸ºçƒé¢åæ ‡ã€‚å…·ä½“çš„å®ç°ä»£ç å¦‚ä¸‹ï¼š

```
/**
 * å°†ç»çº¬åº¦è½¬æ¢ä¸ºçƒé¢åæ ‡
 * @param {*} latitude
 * @param {*} longitude
 * @param {*} radius
 */
function latlngToPosition(latitude, longitude, radius = 1) {
  const [u, v] = projection([longitude, latitude]);
  return project(u, v, radius);
}


/**
 * å°†å¹³é¢åœ°å›¾åæ ‡è½¬æ¢ä¸ºçƒé¢åæ ‡
 * @param {*} u
 * @param {*} v
 * @param {*} radius
 */
function project(u, v, radius = 1) {
  u /= mapScale * mapWidth;
  v /= mapScale * mapHeight;
  const pLength = Math.PI * 2;
  const tLength = Math.PI;
  const x = -radius * Math.cos(u * pLength) * Math.sin(v * tLength);
  const y = radius * Math.cos(v * tLength);
  const z = radius * Math.sin(u * pLength) * Math.sin(v * tLength);
  return new Vec3(x, y, z);
}

```

æœ‰äº†è¿™ä¸ªä½ç½®ä¹‹åï¼Œæˆ‘ä»¬å°†ç‰©ä½“æ”¾ä¸Šå»ï¼Œå¹¶ä¸”è®©ç‰©ä½“æœå‘çƒé¢çš„æ³•çº¿æ–¹å‘ã€‚è¿™ä¸€æ­¥æˆ‘ä»¬å¯ä»¥ç”¨lookAtå‡½æ•°æ¥å®ç°ã€‚ä¸è¿‡ï¼ŒlookAtå‡½æ•°æ˜¯è®©ç‰©ä½“çš„zè½´æœå‘å‘é‡æ–¹å‘ï¼Œè€Œæˆ‘ä»¬ç»˜åˆ¶çš„ä¸€äº›å‡ ä½•ä½“ï¼Œæ¯”å¦‚åœ†æŸ±ä½“ï¼Œå…¶å®æ˜¯è¦è®©yè½´æœå‘å‘é‡æ–¹å‘ï¼Œæ‰€ä»¥è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å‡ ä½•ä½“çš„é¡¶ç‚¹åšä¸€ä¸ªè½¬ç½®æ“ä½œï¼Œä¹Ÿå°±æ˜¯å°†å®ƒçš„é¡¶ç‚¹å‘é‡çš„xã€yã€zçš„å€¼è½®æ¢ä¸€ä¸‹ï¼Œè®©x = yã€y = zã€ z = xã€‚è¿™ä¹ˆåšä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨åœ°çƒè¡¨é¢æ‘†æ”¾å‡ ä½•ä½“äº†ã€‚

### æ‘†æ”¾å…‰æŸ±

æˆ‘ä»¬å…ˆåœ¨åœ°çƒçš„æŒ‡å®šä½ç½®ä¸Šæ”¾ç½®ä¸€äº›å…‰æŸ±ï¼Œå…‰æŸ±é€šå¸¸å¯ä»¥ç”¨æ¥æ ‡è®°å½“å‰ä½ç½®æ˜¯ä¸€ä¸ªé‡è¦çš„åœ°ç‚¹ã€‚å…‰æŸ±æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://static001.geekbang.org/resource/image/2d/67/2d02f5fd187b659b47a299baa4fe9e67.gif?wh=604%2A584)

è¿™ä¸ªæ•ˆæœæ€ä¹ˆå®ç°å‘¢ï¼Ÿå› ä¸ºå…‰æŸ±æœ¬èº«æ˜¯åœ†æŸ±ä½“ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨Cylindarå¯¹è±¡æ¥ç»˜åˆ¶ã€‚è€Œå…‰æŸ±çš„å…‰çº¿è¿˜ä¼šéšç€é«˜åº¦è¡°å‡ï¼Œå¯¹åº”çš„Shaderä»£ç å¦‚ä¸‹ï¼š

```
    const beamVertx = `
      precision highp float;
      precision highp int;


      attribute vec3 position;
      attribute vec3 normal;
      attribute vec4 color;


      uniform mat4 modelViewMatrix;
      uniform mat4 projectionMatrix;
      uniform mat3 normalMatrix;


      varying vec3 vNormal;
      varying vec4 vColor;


      uniform vec4 ambientColor; // ç¯å¢ƒå…‰
      uniform float uHeight;


      void main() {
        vNormal = normalize(normalMatrix * normal);
        vec3 ambient = ambientColor.rgb * color.rgb;// è®¡ç®—ç¯å¢ƒå…‰åå°„é¢œè‰²
        float height = 0.5 - position.z / uHeight;
        vColor = vec4(ambient + 0.3 * sin(height), color.a * height);
        vec3 P = position;
        P.xy *= 2.0 - pow(height, 3.0);
        gl_Position = projectionMatrix * modelViewMatrix * vec4(P, 1.0);
      }
      `;




    const beamFrag = `
      precision highp float;
      precision highp int;


      varying vec3 vNormal;
      varying vec4 vColor;


      void main() {
        gl_FragColor = vColor;
      

```

å®ç°Shaderçš„ä»£ç å¹¶ä¸å¤æ‚ï¼Œåœ¨é¡¶ç‚¹ç€è‰²å™¨é‡Œï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®é«˜åº¦å‡å°‘é¢œè‰²çš„ä¸é€æ˜åº¦ã€‚å¦å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ ¹æ®é«˜åº¦å¯¹xyä¹Ÿå°±æ˜¯åœ†æŸ±çš„æˆªé¢åšä¸€ä¸ªæ‰©å±•ï¼š P.xy \*= 2.0 - pow(height, 3.0)ï¼Œè¿™æ ·å°±èƒ½äº§ç”Ÿä¸€ç§å…‰çº¿å‘æ•£ï¼ˆé¡¶éƒ¨æ¯”åº•éƒ¨ç•¥å¤§ï¼‰çš„æ•ˆæœäº†ã€‚

äºæ˜¯ï¼Œå¯¹åº”çš„addBeamå‡½æ•°å®ç°å¦‚ä¸‹æ‰€ç¤ºã€‚å®ƒå°±æ˜¯æ ¹æ®å‚æ•°åˆ›å»ºå¯¹åº”çš„åœ†æŸ±ä½“å¯¹è±¡ï¼Œå¹¶æŠŠå®ƒä»¬æ·»åŠ åˆ°åœ°çƒå¯¹åº”çš„ç»çº¬åº¦ä½ç½®ä¸Šã€‚

```
function addBeam(globe, {
  latitude,
  longitude,
  width = 1.0,
  height = 25.0,
  color = 'rgba(245,250,113, 0.5)',
  raycast = 'none',
  segments = 60} = {}) {
  const layer = globe.layer;
  const radius = globe.attributes.radius;
  if(layer) {
    const r = width / 2;
    const scale = radius * 0.015;
    const program = layer.createProgram({
      transparent: true,
      vertex: beamVertx,
      fragment: beamFrag,
      uniforms: {
        uHeight: {value: height},
      },
    });
    const beam = new Cylinder(program, {
      radiusTop: r,
      radiusBottom: r,
      radialSegments: segments,
      height,
      colors: color,
    });
    setGlobeTarget(globe, beam, {transpose: true, latitude, longitude, scale, raycast});
    return beam;
  }
}
```

### æ‘†æ”¾åœ°æ ‡

é™¤äº†æ‘†æ”¾å…‰æŸ±ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ‘†æ”¾åœ°æ ‡ã€‚åœ°æ ‡é€šå¸¸è¡¨ç¤ºå½“å‰ä½ç½®äº§ç”Ÿäº†ä¸€ä¸ªé‡å¤§äº‹ä»¶ã€‚åœ°æ ‡å®ç°èµ·æ¥ä¼šæ¯”å…‰æŸ±æ›´å¤æ‚ä¸€äº›ï¼Œå®ƒç”±ä¸€ä¸ªå®šä½ç‚¹ï¼ˆSpotï¼‰å’Œä¸€ä¸ªåŠ¨æ€çš„æ ‡è®°ï¼ˆMarkerï¼‰å…±åŒç»„æˆã€‚æ‘†æ”¾äº†åœ°æ ‡çš„åœ°å›¾æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://static001.geekbang.org/resource/image/bc/4f/bc82d420e44aed51be20a16f63c9434f.gif?wh=604%2A584)

æƒ³è¦å®ç°å®ƒï¼Œç¬¬ä¸€æ­¥æˆ‘ä»¬è¿˜æ˜¯è¦å®ç°å¯¹åº”çš„Shaderã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬è¿™æ¬¡éœ€è¦å®ç°ä¸¤ç»„Shaderã€‚é¦–å…ˆæ˜¯spotçš„é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡å…ƒç€è‰²å™¨ï¼Œå®ç°èµ·æ¥ä¹Ÿéå¸¸ç®€å•ã€‚åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­ï¼Œæˆ‘ä»¬æ ¹æ®uWidthæ‰©å±•xã€yåæ ‡ï¼Œæ ¹æ®é¡¶ç‚¹ç»˜åˆ¶å‡ºä¸€ä¸ªç‰¹å®šå¤§å°çš„å¹³é¢å›¾å½¢ã€‚åœ¨ç‰‡å…ƒç€è‰²å™¨ä¸­ï¼Œæˆ‘ä»¬è®©å›¾å½¢çš„ä¸­å¿ƒç¨äº®ä¸€äº›ï¼Œè®©è¾¹ç¼˜äº®åº¦éšç€è·ç¦»è¡°å‡ï¼Œè¿™ä¹ˆåšæ˜¯ä¸ºäº†å¢å¼ºè§†è§‰æ•ˆæœã€‚ä¸è¿‡ï¼Œç”±äºåˆ†è¾¨ç‡çš„åŸå› ï¼Œå…·ä½“çš„æ•ˆæœåœ¨æˆªå›¾ä¸­å¯èƒ½ä½“ç°ä¸å‡ºæ¥ï¼Œä½ å¯ä»¥è¿è¡Œç¤ºä¾‹ä»£ç æŠŠåœ°çƒå±€éƒ¨æ”¾å¤§ï¼Œæ¥å®é™…è§‚å¯Ÿå’Œä½“ä¼šä¸€ä¸‹ã€‚

```
const spotVertex = `
  precision highp float;
  precision highp int;


  attribute vec4 position;


  uniform mat4 modelViewMatrix;
  uniform mat4 projectionMatrix;
  uniform mat3 normalMatrix;


  uniform float uWidth;
  uniform float uSpeed;
  uniform float uHeight;


  varying vec2 st;


  void main() {
    float s = 0.0 + (0.2 * uWidth * position.w);
    vec3 P = vec3(s * position.xy, 0.0);
    st = P.xy;
    gl_Position = projectionMatrix * modelViewMatrix * vec4(P, 1.0);
  }
`;




const spotFragment = `
  precision highp float;
  precision highp int;


  uniform vec2 uResolution;
  uniform vec3 uColor;
  uniform float uWidth;


  varying vec2 st;


  void main() {
    float d = distance(st, vec2(0));
    gl_FragColor.rgb = uColor + 1.5 * (0.2 * uWidth - 2.0 * d);
    gl_FragColor.a = 1.
```

æ¥ç€ï¼Œæˆ‘ä»¬å®ç°markerçš„é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡å…ƒç€è‰²å™¨ï¼Œå®ƒä»¬ç¨å¾®å¤æ‚ä¸€äº›ã€‚

```
const markerVertex = `
  precision highp float;
  precision highp int;


  attribute vec4 position;


  uniform mat4 modelViewMatrix;
  uniform mat4 projectionMatrix;
  uniform mat3 normalMatrix;


  uniform float uTime;
  uniform float uWidth;
  uniform float uSpeed;
  uniform float uHeight;


  varying float time;


  void main() {
    time = mod(uTime, 1.5 / uSpeed) * uSpeed + position.z - 1.0;
    float d = clamp(0.0, uWidth * mix(1.0, 0.5, min(1.0, uHeight)), time);
    float s = d + (0.1 * position.w);
    vec3 P = vec3(s * position.xy, uHeight * time);
    gl_Position = projectionMatrix * modelViewMatrix * vec4(P, 1.0);
  }
`;


const markerFragment = `
  precision highp float;
  precision highp int;


  uniform vec2 uResolution;
  uniform vec3 uColor;


  varying float time;


  void main() {
    float t = clamp(0.0, 1.0, time);
    gl_FragColor.rgb = uColor;
    gl_FragColor.a = 1.0 - t
```

åœ¨é¡¶ç‚¹ç€è‰²å™¨é‡Œï¼Œæˆ‘ä»¬æ ¹æ®æ—¶é—´å‚æ•°uTimeæ¥è°ƒæ•´ç‰©ä½“å®šç‚¹çš„é«˜åº¦ã€‚è¿™æ ·ï¼Œå½“æˆ‘ä»¬è®¾ç½®uHeightå‚æ•°æ—¶ï¼Œmarkerå°±èƒ½å‘ˆç°å‡ºç«‹ä½“çš„æ•ˆæœã€‚

æœ‰äº†è¿™ä¸¤ç»„ç€è‰²å™¨ä¹‹åï¼Œæˆ‘ä»¬å†å®ç°ä¸¤ä¸ªå‡½æ•°ï¼Œç”¨æ¥åˆ†åˆ«ç”Ÿæˆspotå’Œmarkerçš„é¡¶ç‚¹ï¼Œå‡½æ•°ä»£ç å¦‚ä¸‹ï¼š

```
function makeSpotVerts(radis = 1.0, n_segments) {
  const vertex = [];
  for(let i = 0; i <= n_segments; i++) {
    const theta = Math.PI * 2 * i / n_segments;
    const x = radis * Math.cos(theta);
    const y = radis * Math.sin(theta);
    vertex.push(x, y, 1, 0, x, y, 1, 1.0);
  }
  return {
    position: {data: vertex, size: 4},
  };
}


function makeMarkerVerts(radis = 1.0, n_segments) {
  const vertex = [];
  for(let i = 0; i <= n_segments; i++) {
    const theta = Math.PI * 2 * i / n_segments;
    const x = radis * Math.cos(theta);
    const y = radis * Math.sin(theta);
    vertex.push(x, y, 1, 0, x, y, 1, 1.0);
  }
  const copied = [...vertex];
  vertex.push(...copied.map((v, i) => {
    return i % 4 === 2 ? 0.33 : v;
  }));
  vertex.push(...copied.map((v, i) => {
    return i % 4 === 2 ? 0.67 : v;
  }));
  return {
    position: {data: vertex, size: 4},
  };
}
```

è¿™ä¸¤ä¸ªå‡½æ•°éƒ½æ˜¯ç”¨ç”Ÿæˆæ­£å¤šè¾¹å½¢é¡¶ç‚¹çš„ç®—æ³•æ¥ç”Ÿæˆå¯¹åº”çš„é¡¶ç‚¹ï¼Œå®ƒä»¬çš„åŒºåˆ«æ˜¯ï¼Œspotåªç”Ÿæˆä¸€ç»„é¡¶ç‚¹ï¼Œå› ä¸ºæ˜¯å¹³é¢å›¾å½¢ï¼Œæ‰€ä»¥zåæ ‡ä¸º0ï¼Œè€Œmarkeråˆ™ç”Ÿæˆä¸‰ç»„ä¸åŒé«˜åº¦çš„é¡¶ç‚¹ç»„æˆç«‹ä½“çš„å½¢çŠ¶ã€‚

æ¥ç€ï¼Œæˆ‘ä»¬å†å®ç°ä¸€ä¸ªåˆå§‹åŒ–å‡½æ•°ï¼Œç”¨æ¥ç”Ÿæˆspotå’Œmarkerå¯¹åº”çš„WebGLProgramï¼Œå‡½æ•°ä»£ç å¦‚ä¸‹ï¼š

```
function initMarker(layer, globe, {width, height, speed, color, segments}) {
  const markerProgram = layer.createProgram({
    transparent: true,
    vertex: markerVertex,
    fragment: markerFragment,
    uniforms: {
      uTime: {value: 0},
      uColor: {value: new Color(color).slice(0, 3)},
      uWidth: {value: width},
      uSpeed: {value: speed},
      uHeight: {value: height},
    },
  });


  const markerGeometry = new Geometry(layer.gl, makeMarkerVerts(globe.attributes.radius, segments));


  const spotProgram = layer.createProgram({
    transparent: true,
    vertex: spotVertex,
    fragment: spotFragment,
    uniforms: {
      uTime: {value: 0},
      uColor: {value: new Color(color).slice(0, 3)},
      uWidth: {value: width},
      uSpeed: {value: speed},
      uHeight: {value: height},
    },
  });


  const spotGeometry = new Geometry(layer.gl, makeSpotVerts(globe.attributes.radius, segments));


  return {
    program: markerProgram,
    geometry: markerGeometry,
    spotGeometry,
    spotProgram,
    mode: 'TRIANGLE_STRIP',
  }

```

æœ€åï¼Œæˆ‘ä»¬å®ç°addMarkeræ–¹æ³•ï¼Œå°†åœ°æ ‡æ·»åŠ åˆ°åœ°çƒä¸Šã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å®ç°äº†ç»˜åˆ¶åœ°æ ‡çš„åŠŸèƒ½ã€‚

```
function addMarker(globe, {
  latitude,
  longitude,
  width = 1.0,
  height = 0.0,
  speed = 1.0,
  color = 'rgb(245,250,113)',
  segments = 60,
  lifeTime = Infinity} = {}) {
  const layer = globe.layer;
  const radius = globe.attributes.radius;


  if(layer) {
    let mode = 'TRIANGLES';
    const ret = initMarker(layer, globe, {width, height, speed, color, segments});
    const markerProgram = ret.program;
    const markerGeometry = ret.geometry;
    const spotProgram = ret.spotProgram;
    const spotGeometry = ret.spotGeometry;
    mode = ret.mode;


    if(markerProgram) {
      const pos = latlngToPosition(latitude, longitude, radius);
      const marker = new Mesh3d(markerProgram, {model: markerGeometry, mode});
      const spot = new Mesh3d(spotProgram, {model: spotGeometry, mode});
      setGlobeTarget(globe, marker, {pos, scale: 0.05, raycast: 'none'});
      setGlobeTarget(globe, spot, {pos, scale: 0.05, raycast: 'none'});
      layer.bindTime(marker.program);


      if(Number.isFinite(lifeTime)) {
        setTimeout(() => {
          layer.unbindTime(marker.program);
          marker.dispose();
          spot.dispose();
          marker.program.remove();
          spot.program.remove();
        }, lifeTime);
      }
      return {marker, spot};
    }
  }
```

## è¦ç‚¹æ€»ç»“

ä»Šå¤©ï¼Œæˆ‘ä»¬åœ¨ä¸ŠèŠ‚è¯¾çš„åŸºç¡€ä¸Šå­¦ä¹ äº†ä¸åœ°çƒäº¤äº’ï¼Œä»¥åŠåœ¨åœ°çƒä¸Šæ”¾ç½®æ ‡è®°çš„æ–¹æ³•ã€‚

ä¸åœ°çƒäº¤äº’çš„å®ç°è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“ä¸ºå››æ­¥ï¼šé¦–å…ˆæˆ‘ä»¬é€šè¿‡å°†ä¸‰ç»´çƒé¢åæ ‡è½¬æ¢ä¸ºç»çº¬åº¦åæ ‡ï¼Œå†é€šè¿‡topoJSONçš„APIè·å–å½“å‰é€‰ä¸­çš„å›½å®¶æˆ–åœ°åŒºä¿¡æ¯ï¼Œç„¶ååœ¨ç¦»å±Canvasä¸Šå°†å½“å‰é€‰ä¸­çš„å›½å®¶æˆ–åœ°åŒºé«˜äº®æ˜¾ç¤ºï¼Œæœ€åæ›´æ–°çº¹ç†å’Œé‡ç»˜layerã€‚è¿™æ ·ï¼Œé«˜äº®æ˜¾ç¤ºçš„å›½å®¶æˆ–åœ°åŒºå°±å‡ºç°åœ¨3Dåœ°çƒä¸Šäº†ã€‚

è€Œè¦åœ¨åœ°çƒä¸Šæ”¾ç½®æ ‡è®°ï¼Œæˆ‘ä»¬å…ˆè¦è®¡ç®—å‡ ä½•ä½“æ‘†æ”¾ä½ç½®ï¼Œç„¶åå®ç°æ ‡è®°å¯¹åº”çš„shaderï¼Œåˆ›å»ºWebGLProgramï¼Œæœ€åå°†æ ‡è®°æ·»åŠ åˆ°åœ°çƒè¡¨é¢å¯¹åº”ç»çº¬åº¦æ¢ç®—çš„çƒé¢åæ ‡ä½ç½®å¤„ï¼Œç”¨lookAtè®©å®ƒæœå‘æ³•çº¿æ–¹å‘å°±å¯ä»¥äº†ã€‚

åˆ°è¿™é‡Œï¼Œåœ°çƒ3Då¯è§†åŒ–çš„æ ¸å¿ƒåŠŸèƒ½æˆ‘ä»¬å°±å…¨éƒ¨å®ç°äº†ã€‚å®é™…ä¸Šï¼Œé™¤äº†è¿™äº›åŠŸèƒ½ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ·»åŠ ä¸€äº›æ›´åŠ å¤æ‚çš„æ ‡è®°ï¼Œæ¯”å¦‚ä¸¤ä¸ªç‚¹ä¹‹é—´è¿çº¿ä»¥åŠåŠ¨æ€çš„é£çº¿ã€‚è¿™äº›åŠŸèƒ½å®ç°çš„åŸºæœ¬åŸç†å…¶å®å’Œæ”¾ç½®æ ‡è®°æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥åªè¦ä½ æŒæ¡äº†æˆ‘ä»¬ä»Šå¤©è®²çš„æ€è·¯ï¼Œå°±èƒ½æ¯”è¾ƒè½»æ¾åœ°è§£å†³è¿™äº›éœ€æ±‚äº†ã€‚

## å°è¯•ç‰›åˆ€

å®é™…ä¸Šï¼Œåœ°çƒä¸Šä¸ä»…å¯ä»¥æ”¾ç½®æ™®é€šçš„å•ç‚¹æ ‡è®°ï¼Œè¿˜å¯ä»¥ç”¨æ›²çº¿å°†ä¸¤ä¸ªåœ°ç†ç‚¹è¿æ¥èµ·æ¥ã€‚å…·ä½“çš„æ–¹æ³•æ˜¯åœ¨ä¸¤ä¸ªç‚¹ä¹‹é—´è®¡ç®—å¼§çº¿æˆ–è´å¡å°”æ›²çº¿ï¼Œç„¶åå°†è¿™äº›è¿çº¿ç”Ÿæˆå¹¶ç»˜åˆ¶å‡ºæ¥ã€‚åœ¨SpriteJSçš„3Dæ‰©å±•ä¸­æœ‰ä¸€ä¸ªPath3då¯¹è±¡ï¼Œå®ƒå¯ä»¥ç»˜åˆ¶ç©ºé—´ä¸­çš„ä¸‰ç»´æ›²çº¿ã€‚ä½ èƒ½è¯•ç€å®ç°ä¸¤ç‚¹ä¹‹é—´çš„è¿çº¿å—ï¼Ÿå¦‚æœå¾ˆè½»æ¾å°±èƒ½å®ç°ï¼Œä½ è¿˜å¯ä»¥è¯•ç€æ·»åŠ åŠ¨ç”»ï¼Œå®ç°ä¸¤ç‚¹ä¹‹é—´çš„é£çº¿åŠ¨ç”»æ•ˆæœã€‚ï¼ˆæç¤ºï¼šä½ å¯ä»¥é€šè¿‡å®˜æ–¹æ–‡æ¡£æ¥å­¦ä¹ Path3dçš„ç”¨æ³•ï¼Œå®ç°ä¸¤ç‚¹ä¹‹é—´çš„è¿çº¿ã€‚åœ¨å®ç°é£çº¿åŠ¨ç”»æ•ˆæœçš„æ—¶å€™ï¼Œä½ å¯ä»¥å‚ç…§GitHubä»“åº“é‡Œçš„ä»£ç æ¥è¿›è¡Œå­¦ä¹ ï¼Œæ¥ç†è§£æˆ‘æ˜¯æ€ä¹ˆåšçš„ï¼‰

æ¬¢è¿æŠŠä½ å®ç°çš„æ•ˆæœåˆ†äº«åˆ°ç•™è¨€åŒºï¼Œæˆ‘ä»¬ä¸€èµ·äº¤æµã€‚ä¹Ÿæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾è½¬å‘å‡ºå»ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ï¼

* * *

## æºç 

ç¤ºä¾‹ä»£ç è¯¦è§[GitHubä»“åº“](https://github.com/akira-cn/graphics/tree/master/vis-geo-earth)

## æ¨èé˜…è¯»

[çƒåæ ‡ä¸ç›´è§’åæ ‡çš„è½¬æ¢](https://zhuanlan.zhihu.com/p/34485962)
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ5ï¼‰</strong></div><ul>
<li><span>Geek_e15910</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>vertex.push(x, y, 1, 0, x, y, 1, 1.0);
  æœˆå½±å¤§å¤§ï¼Œè¿™ä¸ªç”Ÿæˆmarkerçš„æ–¹æ³•ä¸­ï¼Œä¸ºä»€ä¹ˆè¦æ·»åŠ ä¸¤æ¬¡x,y,1,0å‘¢ï¼Ÿ</p>2020-12-03</li><br/><li><span>èŒèŒçš„ç¨‹åºåª›</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>æˆ‘ç”¨ä»£ç ä¸­ä¾‹å­ï¼Œä½†æ˜¯æŠ¥é”™  æ²¡æœ‰createGlobeè¿™ä¸ªå¯¹è±¡ï¼Œè¿™æ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿ</p>2021-03-10</li><br/><li><span>å†°ç³–çˆ±ç™½å¼€æ°´</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<p>çŸ¥é“äº†ï¼Œé€šè¿‡å°„çº¿
</p>2023-02-21</li><br/><li><span>å†°ç³–çˆ±ç™½å¼€æ°´</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<p>é¼ æ ‡ä¸åœ°çƒäº¤äº’æ—¶ï¼Œé¼ æ ‡ç‚¹å‡»æ—¶ï¼Œæ˜¯æ€æ ·è·å–çš„çƒé¢åæ ‡ï¼Ÿï¼Ÿ</p>2023-02-21</li><br/><li><span>Geek_0e4bce</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<p>è€å¸ˆï¼Œä»£ç æ²¡æœ‰åŠæ³•æ­£å¸¸è¿è¡Œï¼Œvid-geo-earthä¸­çš„ä¾‹å­é™¤äº†b_globe.htmlå¯ä»¥æ­£å¸¸è¿è¡Œå¤–ï¼Œå…¶ä»–éƒ½æŠ¥é”™</p>2022-04-28</li><br/>
</ul>