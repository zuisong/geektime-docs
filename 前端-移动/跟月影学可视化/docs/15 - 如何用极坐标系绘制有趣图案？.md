ä½ å¥½ï¼Œæˆ‘æ˜¯æœˆå½±ã€‚

åœ¨å‰é¢çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸€ç›´æ˜¯ä½¿ç”¨ç›´è§’åæ ‡ç³»æ¥ç»˜å›¾çš„ã€‚ä½†åœ¨å›¾å½¢å­¦ä¸­ï¼Œé™¤äº†ç›´è§’åæ ‡ç³»ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ç§æ¯”è¾ƒå¸¸ç”¨çš„åæ ‡ç³»å°±æ˜¯æåæ ‡ç³»ã€‚

[![](https://static001.geekbang.org/resource/image/b6/31/b62312e2af6385ffcdb1d3dab4fdd731.jpeg?wh=1920%2A1080 "æåæ ‡ç¤ºæ„å›¾")](http://zh.wikipedia.org)

ä½ å¯¹æåæ ‡ç³»åº”è¯¥ä¹Ÿä¸é™Œç”Ÿï¼Œå®ƒæ˜¯ä¸€ä¸ªäºŒç»´åæ ‡ç³»ã€‚ä¸äºŒç»´ç›´è§’åæ ‡ç³»ä½¿ç”¨xã€yåˆ†é‡è¡¨ç¤ºåæ ‡ä¸åŒï¼Œæåæ ‡ç³»ä½¿ç”¨ç›¸å¯¹æç‚¹çš„è·ç¦»ï¼Œä»¥åŠä¸xè½´æ­£å‘çš„å¤¹è§’æ¥è¡¨ç¤ºç‚¹çš„åæ ‡ï¼Œå¦‚ï¼ˆ3ï¼Œ60Â°ï¼‰ã€‚

åœ¨å›¾å½¢å­¦ä¸­ï¼Œæåæ ‡çš„åº”ç”¨æ¯”è¾ƒå¹¿æ³›ï¼Œå®ƒä¸ä»…å¯ä»¥ç®€åŒ–ä¸€äº›æ›²çº¿æ–¹ç¨‹ï¼Œç”šè‡³æœ‰äº›æ›²çº¿åªèƒ½ç”¨æåæ ‡æ¥è¡¨ç¤ºã€‚ä¸è¿‡ï¼Œè™½ç„¶ç”¨æåæ ‡å¯ä»¥ç®€åŒ–è®¸å¤šæ›²çº¿æ–¹ç¨‹ï¼Œä½†æœ€ç»ˆæ¸²æŸ“çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜æ˜¯éœ€è¦è½¬æ¢æˆå›¾å½¢ç³»ç»Ÿé»˜è®¤æ”¯æŒçš„ç›´è§’åæ ‡æ‰å¯ä»¥è¿›è¡Œç»˜åˆ¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±å¿…é¡»è¦çŸ¥é“ç›´è§’åæ ‡å’Œæåæ ‡æ˜¯æ€ä¹ˆç›¸äº’è½¬æ¢çš„ã€‚ä¸¤ä¸ªåæ ‡ç³»å…·ä½“è½¬æ¢æ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸¤ä¸ªç®€å•çš„å‡½æ•°ï¼ŒtoPolarå’ŒfromPolaræ¥å®ç°ï¼Œå‡½æ•°ä»£ç å¦‚ä¸‹ï¼š

```
// ç›´è§’åæ ‡å½±å°„ä¸ºæåæ ‡
function toPolar(x, y) {
  const r = Math.hypot(x, y);
  const Î¸= Math.atan2(y, x);
  return [r, Î¸];
}

// æåæ ‡æ˜ å°„ä¸ºç›´è§’åæ ‡
function fromPolar(r, Î¸) {
  const x = r * cos(Î¸);
  const y = r * sin(Î¸);
  return [x, y];
}

```

é‚£ä»Šå¤©ï¼Œæˆ‘ä»¬å°±é€šè¿‡å‚æ•°æ–¹ç¨‹ç»“åˆæåæ ‡ï¼Œæ¥ç»˜åˆ¶ä¸€äº›ä¸å¤ªå¥½ç”¨ç›´è§’åæ ‡ç³»ç»˜åˆ¶çš„æ›²çº¿ï¼Œè®©ä½ è®¤è¯†æåæ ‡çš„ä¼˜ç‚¹ï¼Œä»è€Œå¸®åŠ©ä½ æŒæ¡æåæ ‡çš„ç”¨æ³•ã€‚

## å¦‚ä½•ç”¨æåæ ‡æ–¹ç¨‹ç»˜åˆ¶æ›²çº¿

åœ¨[ç¬¬6èŠ‚è¯¾](https://time.geekbang.org/column/article/256827)ä¸­ï¼Œä¸ºäº†æ›´æ–¹ä¾¿åœ°ç»˜åˆ¶æ›²çº¿ï¼Œæˆ‘ä»¬ç”¨parametric.jså‡½æ•°å®ç°äº†ä¸€ä¸ªå‚æ•°æ–¹ç¨‹çš„ç»˜å›¾æ¨¡å—ï¼Œå®ƒéå¸¸æ–¹ä¾¿ã€‚æ‰€ä»¥åœ¨ä½¿ç”¨æåæ ‡æ–¹ç¨‹ç»˜åˆ¶æ›²çº¿çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿè¦ç”¨åˆ°parametric.jså‡½æ•°ã€‚ä¸è¿‡ï¼Œåœ¨ä½¿ç”¨ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜è¦å¯¹å®ƒè¿›è¡Œæ‰©å±•ï¼Œè®©å®ƒæ”¯æŒåæ ‡æ˜ å°„ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥å†™å‡ºå¯¹åº”çš„åæ ‡æ˜ å°„å‡½æ•°ï¼Œä»è€Œå°†æåæ ‡æ˜ å°„ä¸ºç»˜å›¾éœ€è¦çš„ç›´è§’åæ ‡äº†ã€‚

å…·ä½“çš„æ“ä½œå°±æ˜¯ï¼Œç»™parametricå¢åŠ ä¸€ä¸ªå‚æ•°**rFunc**ã€‚rFuncæ˜¯ä¸€ä¸ªåæ ‡æ˜ å°„å‡½æ•°ï¼Œé€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥å°†ä»»æ„åæ ‡æ˜ å°„ä¸ºç›´è§’åæ ‡ï¼Œä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹ï¼š

```
export function parametric(sFunc, tFunc, rFunc) {
  return function (start, end, seg = 100, ...args) {
    const points = [];
    for(let i = 0; i <= seg; i++) {
      const p = i / seg;
      const t = start * (1 - p) + end * p;
      const x = sFunc(t, ...args);
      const y = tFunc(t, ...args);
      if(rFunc) {
        points.push(rFunc(x, y));
      } else {
        points.push([x, y]);
      }
    }
    return {
      draw: draw.bind(null, points),
      points,
    };
  };
}
```

çœ‹åˆ°è¿™é‡Œï¼Œä½ å¯èƒ½æƒ³é—®ï¼Œç›´è§’åæ ‡å’Œæåæ ‡è½¬æ¢çš„å‡½æ•°ï¼Œæˆ‘ä»¬åœ¨ä¸€å¼€å§‹ä¸æ˜¯å·²ç»è®²è¿‡äº†å—ï¼Ÿä¸ºä»€ä¹ˆè¿™é‡Œåˆè¦æ‹“å±•ä¸€ä¸ªrFuncå‚æ•°å‘¢ï¼Ÿå…¶å®å•Šï¼Œå¼€å¤´æˆ‘ç»™å‡ºçš„å‡½æ•°è™½ç„¶è¶³å¤Ÿç®€å•ï¼Œä½†ä¸å¤Ÿçµæ´»ï¼Œä¹Ÿä¸ä¾¿äºæ‰©å±•ã€‚è€Œå…ˆä½¿ç”¨rFuncæ¥æŠ½è±¡åæ ‡æ˜ å°„ï¼Œå†æŠŠå…¶ä»–å‡½æ•°ä½œä¸ºrFuncå‚æ•°ä¼ ç»™parametricï¼Œæ˜¯ä¸€ç§æ›´é€šç”¨çš„åæ ‡æ˜ å°„æ–¹æ³•ï¼Œå®ƒå±äºå‡½æ•°å¼ç¼–ç¨‹æ€æƒ³ã€‚

è¯´åˆ°è¿™ï¼Œæˆ‘å†å¤šè¯´å‡ å¥ã€‚è™½ç„¶å‡½æ•°å¼è®¾è®¡æ€æƒ³ä¸æ˜¯æˆ‘ä»¬è¿™ä¸ªè¯¾ç¨‹çš„æ ¸å¿ƒï¼Œä½†å®ƒå¯¹æ¡†æ¶å’Œåº“çš„è®¾è®¡å¾ˆé‡è¦ï¼Œæ‰€ä»¥ï¼Œæˆ‘è®²å®ƒä¹Ÿæ˜¯å¸Œæœ›ä½ èƒ½é€šè¿‡è¿™ä¸ªä¾‹å­ï¼Œå°½å¯èƒ½åœ°ç†è§£ä»£ç ä¸­çš„ç²¾é«“ï¼Œå­¦ä¼šä½¿ç”¨æœ€ä½³çš„è®¾è®¡æ–¹æ³•å’Œæ€è·¯å»è§£å†³é—®é¢˜ï¼Œè·å¾—æ›´å¤šé¢å¤–çš„æ”¶è·ï¼Œè€Œä¸åªæ˜¯å»ç†è§£çœ¼å‰çš„åŸºæœ¬æ¦‚å¿µã€‚

é‚£æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç”¨æåæ ‡å‚æ•°æ–¹ç¨‹ç”»ä¸€ä¸ªåŠå¾„ä¸º200çš„åŠåœ†ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠfromPolarä½œä¸ºrFuncå‚æ•°ä¼ ç»™parametricï¼Œå°±å¯ä»¥ä½¿ç”¨æåæ ‡çš„å‚æ•°æ–¹ç¨‹æ¥ç»˜åˆ¶å›¾å½¢äº†ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚

```
const fromPolar = (r, Î¸) => {
  return [r * Math.cos(Î¸), r * Math.sin(Î¸)];
};

const arc = parametric(
  t => 200,
  t => t,
  fromPolar,
);

arc(0, Math.PI).draw(ctx);

```

æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ·»åŠ å…¶ä»–çš„æåæ ‡å‚æ•°æ–¹ç¨‹æ¥ç»˜åˆ¶æ›´å¤šæ›²çº¿ï¼Œæ¯”å¦‚ç«ç‘°çº¿ã€å¿ƒå½¢çº¿æˆ–è€…åŒçº½çº¿ã€‚å› ä¸ºè¿™äº›æ“ä½œéƒ½æ¯”è¾ƒç®€å•ï¼Œæˆ‘å°±ç›´æ¥åœ¨ä¸‹é¢ç»™å‡ºä»£ç äº†ã€‚

```
const rose = parametric(
  (t, a, k) => a * Math.cos(k * t),
  t => t,
  fromPolar,
);

rose(0, Math.PI, 100, 200, 5).draw(ctx, {strokeStyle: 'blue'});

const heart = parametric(
  (t, a) => a - a * Math.sin(t),
  t => t,
  fromPolar,
);

heart(0, 2 * Math.PI, 100, 100).draw(ctx, {strokeStyle: 'red'});

const foliumRight = parametric(
  (t, a) => Math.sqrt(2 * a ** 2 * Math.cos(2 * t)),
  t => t,
  fromPolar,
);

const foliumLeft = parametric(
  (t, a) => -Math.sqrt(2 * a ** 2 * Math.cos(2 * t)),
  t => t,
  fromPolar,
);

foliumRight(-Math.PI / 4, Math.PI / 4, 100, 100).draw(ctx, {strokeStyle: 'green'});
foliumLeft(-Math.PI / 4, Math.PI / 4, 100, 100).draw(ctx, {strokeStyle: 'green'});
```

æœ€ç»ˆï¼Œæˆ‘ä»¬èƒ½å¤Ÿç»˜åˆ¶å‡ºå¦‚ä¸‹çš„æ•ˆæœï¼š

![](https://static001.geekbang.org/resource/image/47/fa/475905a6708e51yy234c640f292833fa.jpeg?wh=1920%2A1080)

æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼Œä½¿ç”¨æåæ ‡ç³»ä¸­å‚æ•°æ–¹ç¨‹æ¥ç»˜åˆ¶æ›²çº¿çš„æ–¹æ³•ï¼Œå…¶å®å’Œæˆ‘ä»¬å­¦è¿‡çš„ç›´è§’åæ ‡ç³»ä¸­å‚æ•°æ–¹ç¨‹ç»˜åˆ¶æ›²çº¿å·®ä¸å¤šï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯åœ¨å…·ä½“å®ç°çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦é¢å¤–å¢åŠ ä¸€ä¸ªåæ ‡æ˜ å°„å‡½æ•°ï¼Œå°†æåæ ‡è½¬ä¸ºç›´è§’åæ ‡æ‰èƒ½å®Œæˆæœ€ç»ˆçš„ç»˜åˆ¶ã€‚

## å¦‚ä½•ä½¿ç”¨ç‰‡å…ƒç€è‰²å™¨ä¸æåæ ‡ç³»ç»˜åˆ¶å›¾æ¡ˆï¼Ÿ

åœ¨å‰é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦è¿˜æ˜¯é€šè¿‡å‚æ•°æ–¹ç¨‹æ¥ç»˜åˆ¶æ›²çº¿ï¼Œç”¨Canvas2Dè¿›è¡Œæ¸²æŸ“ã€‚é‚£å¦‚æœæˆ‘ä»¬ä½¿ç”¨shaderæ¥æ¸²æŸ“ï¼Œåˆè¯¥æ€ä¹ˆä½¿ç”¨æåæ ‡ç³»ç»˜å›¾å‘¢ï¼Ÿ

è¿™é‡Œï¼Œæˆ‘ä»¬è¿˜æ˜¯ä»¥åœ†ä¸ºä¾‹ï¼Œæ¥çœ‹ä¸€ä¸‹ç”¨shaderæ¸²æŸ“ï¼Œå†ä»¥æåæ ‡ç”»åœ†çš„åšæ³•ã€‚ä½ å¯ä»¥å…ˆå°è¯•è‡ªå·±ç†è§£ä¸‹é¢çš„ä»£ç ï¼Œç„¶åå†çœ‹æˆ‘åé¢çš„è®²è§£ã€‚

```
#ifdef GL_ES
precision highp float;
#endif

varying vec2 vUv;

vec2 polar(vec2 st) {
  return vec2(length(st), atan(st.y, st.x));
}

void main() {
  vec2 st = vUv - vec2(0.5);
  st = polar(st);
  gl_FragColor.rgb = smoothstep(st.x, st.x + 0.01, 0.2) * vec3(1.0);
  gl_FragColor.a = 1.0;
}
```

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å…ˆé€šè¿‡åæ ‡è½¬æ¢å…¬å¼å®ç°polarå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ä½œç”¨æ˜¯å°†ç›´è§’åæ ‡è½¬æ¢ä¸ºæåæ ‡ï¼Œç›¸å½“äºè¯¾ç¨‹ä¸€å¼€å§‹ï¼Œæˆ‘ä»¬ç”¨JavaScriptå†™çš„toPolarå‡½æ•°ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªç»†èŠ‚éœ€è¦æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯GLSLå†…ç½®çš„float atan(float, float)æ–¹æ³•ï¼Œå¯¹åº”çš„æ–¹æ³•æ˜¯Math.atanï¼Œè€Œåœ¨JavaScriptç‰ˆæœ¬çš„toPolarå‡½æ•°ä¸­ï¼Œå¯¹åº”çš„æ–¹æ³•æ˜¯Math.atan2ã€‚

ç„¶åï¼Œæˆ‘ä»¬å°†åƒç´ åæ ‡è½¬æ¢ä¸ºæåæ ‡ï¼šst = polar(st); ï¼Œè½¬æ¢åçš„st.xå®é™…ä¸Šæ˜¯æåæ ‡çš„råˆ†é‡ï¼Œè€Œst.yå°±æ˜¯æåæ ‡çš„Î¸åˆ†é‡ã€‚

æˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äºæåæ ‡ä¸‹è¿‡æç‚¹çš„åœ†ï¼Œå®é™…ä¸Šçš„rå€¼å°±æ˜¯ä¸€ä¸ªå¸¸é‡å€¼ï¼Œå¯¹åº”åœ†çš„åŠå¾„ï¼Œæ‰€ä»¥æˆ‘ä»¬å–smoothstep(st.x, st.x + 0.01, 0.2)ï¼Œå°±èƒ½å¾—åˆ°ä¸€ä¸ªåŠå¾„ä¸º0.2çš„åœ†äº†ã€‚è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬ç”¨çš„è¿˜æ˜¯ä¸ŠèŠ‚è¯¾çš„**è·ç¦»åœº**æ–¹æ³•ã€‚åªä¸è¿‡ï¼Œåœ¨ç›´è§’åæ ‡ç³»ä¸‹ï¼Œç‚¹åˆ°åœ†å¿ƒçš„è·ç¦»déœ€è¦ç”¨xã€yå¹³æ–¹å’Œçš„å¼€æ–¹æ¥è®¡ç®—ï¼Œè€Œåœ¨æåæ ‡ä¸‹ï¼Œç‚¹çš„æåæ ‡rå€¼æ­£å¥½è¡¨ç¤ºäº†ç‚¹åˆ°åœ†å¿ƒçš„è·ç¦»dï¼Œæ‰€ä»¥è®¡ç®—èµ·æ¥å°±æ¯”ç›´è§’åæ ‡ç³»ç®€å•äº†å¾ˆå¤šã€‚

å…¶å®ï¼Œæˆ‘ä»¬æ— è®ºæ˜¯ç”¨ç›´è§’åæ ‡è¿˜æ˜¯æåæ ‡æ¥ç”»å›¾ï¼Œæ–¹æ³•éƒ½å·®ä¸å¤šã€‚ä½†æ˜¯ï¼Œä¸€äº›å…¶ä»–çš„æ›²çº¿ç”¨æåæ ‡ç»˜åˆ¶ä¼šå¾ˆæ–¹ä¾¿ã€‚æ¯”å¦‚è¯´ï¼Œè¦ç»˜åˆ¶ç«ç‘°çº¿ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ä»¥ä¸‹ä»£ç ï¼š

```
void main() {
  vec2 st = vUv - vec2(0.5);
  st = polar(st);
  float d = 0.5 * cos(st.y * 3.0) - st.x;
  gl_FragColor.rgb = smoothstep(-0.01, 0.01, d) * vec3(1.0);
  gl_FragColor.a = 1.0;
}
```

è¿™æ ·ï¼Œåœ¨ç”»å¸ƒä¸Šç»˜åˆ¶å‡ºæ¥çš„ç»“æœæ˜¯ä¸‰ç“£ç«ç‘°çº¿ï¼š

![](https://static001.geekbang.org/resource/image/f7/8a/f73a97f5f742dd5d9c2c53b8ecf5908a.jpeg?wh=1920%2A1080)

å¯èƒ½ä½ è¿˜æ˜¯ä¼šæœ‰ç–‘é—®ï¼Œä¸ºä»€ä¹ˆd = 0.5 * cos(st.y * 3.0) - st.x; ç»˜åˆ¶å‡ºçš„å›¾å½¢å°±æ˜¯ä¸‰ç“£ç«ç‘°çº¿çš„å›¾æ¡ˆå‘¢ï¼Ÿ

è¿™æ˜¯å› ä¸ºç«ç‘°çº¿çš„æåæ ‡æ–¹ç¨‹r = a * cos(k * Î¸)ï¼Œæ‰€ä»¥ç«ç‘°çº¿ä¸Šçš„æ‰€æœ‰ç‚¹éƒ½æ»¡è¶³0 = a * cos(k * Î¸) - r è¿™ä¸ªæ–¹ç¨‹å¼ã€‚å¦‚æœæˆ‘ä»¬å†æŠŠå®ƒå†™æˆè·ç¦»åœºçš„å½¢å¼ï¼šd = a * cos(k * Î¸) - rã€‚è¿™ä¸ªæ—¶å€™å°±æœ‰ä¸‰ç§æƒ…å†µï¼šç«ç‘°çº¿ä¸Šç‚¹çš„ d ç­‰äº 0ï¼›ç«ç‘°çº¿å›´å‡ºçš„å›¾å½¢å¤–çš„ç‚¹çš„ d å°äº0ï¼Œç«ç‘°çº¿å›´å‡ºçš„å›¾å½¢å†…çš„ç‚¹çš„ d å¤§äº 0ã€‚

![](https://static001.geekbang.org/resource/image/72/a9/7244ff9e7d36b8dd5ayy04e42430a5a9.jpeg?wh=1920%2A1080)

å› æ­¤ï¼Œsmoothstep(-0.01, 0.01, d) èƒ½å¤Ÿå°† d &gt;= 0ï¼Œä¹Ÿå°±æ˜¯ç«ç‘°çº¿å†…çš„ç‚¹é€‰å‡ºæ¥ï¼Œè¿™æ ·ä¹Ÿå°±ç»˜åˆ¶å‡ºäº†ä¸‰ç“£å›¾å½¢ã€‚

é‚£ç«ç‘°çº¿æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿå®ƒæ˜¯ä¸€ç§å¾ˆæœ‰è¶£å›¾æ¡ˆï¼Œæˆ‘ä»¬åªè¦ä¿®æ”¹u\_kçš„å€¼ï¼Œå¹¶ä¸”ä¿è¯å®ƒæ˜¯æ­£æ•´æ•°ï¼Œå°±å¯ä»¥ç»˜åˆ¶å‡ºä¸åŒç“£æ•°çš„ç«ç‘°çº¿å›¾æ¡ˆã€‚

```
uniform float u_k;

void main() {
  vec2 st = vUv - vec2(0.5);
  st = polar(st);
  float d = 0.5 * cos(st.y * u_k) - st.x;
  gl_FragColor.rgb = smoothstep(-0.01, 0.01, d) * vec3(1.0);
  gl_FragColor.a = 1.0;
}


renderer.uniforms.u_k = 3;

setInterval(() => {
  renderer.uniforms.u_k += 2;
}, 200);
```

![](https://static001.geekbang.org/resource/image/0f/18/0fa365713c9676219e72cd55073f7318.gif?wh=522%2A520)

ç±»ä¼¼çš„å›¾æ¡ˆè¿˜æœ‰èŠ±ç“£çº¿ï¼š

```
void main() {
  vec2 st = vUv - vec2(0.5);
  st = polar(st);
  float d = 0.5 * abs(cos(st.y * u_k * 0.5)) - st.x;
  gl_FragColor.rgb = smoothstep(-0.01, 0.01, d) * vec3(1.0);
  gl_FragColor.a = 1.0;
}
```

åœ¨u\_k=3çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹å›¾æ¡ˆï¼š

![](https://static001.geekbang.org/resource/image/e5/47/e51fc1ca89f103b3f949477424f18047.jpeg?wh=1920%2A1080)

æœ‰è¶£çš„æ˜¯ï¼Œå®ƒå’Œç«ç‘°çº¿ä¸ä¸€æ ·ï¼Œu\_kçš„å–å€¼ä¸ä¸€å®šè¦æ˜¯æ•´æ•°ã€‚è¿™è®©å®ƒèƒ½ç»˜åˆ¶å‡ºæ¥çš„å›¾å½¢æ›´åŠ ä¸°å¯Œï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬å¯ä»¥å–u\_k=1.3ï¼Œè¿™æ—¶å¾—åˆ°çš„å›¾æ¡ˆå°±åƒæ˜¯ä¸€ä¸ªæ¨ªæ”¾çš„è‹¹æœã€‚

![](https://static001.geekbang.org/resource/image/ff/96/ff98434df974b610078f76aab6c96896.jpeg?wh=1920%2A1080)

åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å†æ·»åŠ å‡ ä¸ªuniformå˜é‡ï¼Œå¦‚u\_scaleã€u\_offsetä½œä¸ºå‚æ•°ï¼Œæ¥ç»˜åˆ¶å‡ºæ›´å¤šå›¾å½¢ã€‚ä»£ç å¦‚ä¸‹ï¼š

```
varying vec2 vUv;
uniform float u_k;
uniform float u_scale;
uniform float u_offset;
      
void main() {
  vec2 st = vUv - vec2(0.5);
  st = polar(st);
  float d = u_scale * 0.5 * abs(cos(st.y * u_k * 0.5)) - st.x + u_offset;
  gl_FragColor.rgb = smoothstep(-0.01, 0.01, d) * vec3(1.0);
  gl_FragColor.a = 1.0;
}
```

å½“æˆ‘ä»¬å–u\_k=1.7ï¼Œu\_scale=0.5ï¼Œu\_offset=0.2æ—¶ï¼Œå°±èƒ½å¾—åˆ°ä¸€ä¸ªæ¨ªç½®çš„è‘«èŠ¦å›¾æ¡ˆã€‚

![](https://static001.geekbang.org/resource/image/5b/74/5b303d4e6e7afd2f2bb61f10e9717574.jpeg?wh=1920%2A1080)

å¦‚æœæˆ‘ä»¬ç»§ç»­ä¿®æ”¹ d çš„è®¡ç®—æ–¹ç¨‹ï¼Œè¿˜èƒ½ç»˜åˆ¶å‡ºå…¶ä»–æœ‰è¶£çš„å›¾å½¢ã€‚

```
void main() {
  vec2 st = vUv - vec2(0.5);
  st = polar(st);
  float d = smoothstep(-0.3, 1.0, u_scale * 0.5 * cos(st.y * u_k) + u_offset) - st.x;
  gl_FragColor.rgb = smoothstep(-0.01, 0.01, d) * vec3(1.0);
  gl_FragColor.a = 1.0;
}
```

æ¯”å¦‚ï¼Œå½“ç»§ç»­ä¿®æ”¹ d çš„è®¡ç®—æ–¹ç¨‹æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç»˜åˆ¶å‡ºèŠ±è‹å›¾æ¡ˆï¼š

![](https://static001.geekbang.org/resource/image/8e/e9/8e87d4e5c76a06645860819474a25fe9.jpeg?wh=1920%2A1080)

æ–¹æ³•å·²ç»çŸ¥é“äº†ï¼Œä½ å¯ä»¥åœ¨è¯¾åç»“åˆä¸‰è§’å‡½æ•°ã€absã€smoothstepï¼Œæ¥å°è¯•ç»˜åˆ¶ä¸€äº›æ›´æœ‰è¶£çš„å›¾æ¡ˆã€‚å¦‚æœæœ‰ä»€ä¹ˆç‰¹åˆ«å¥½ç©çš„å›¾æ¡ˆï¼Œä½ ä¹Ÿå¯ä»¥åˆ†äº«å‡ºæ¥ã€‚

## æåæ ‡ç³»å¦‚ä½•å®ç°è§’å‘æ¸å˜ï¼Ÿ

é™¤äº†ç»˜åˆ¶æœ‰è¶£çš„å›¾æ¡ˆä¹‹å¤–ï¼Œæåæ ‡çš„å¦ä¸€ä¸ªåº”ç”¨æ˜¯**è§’å‘æ¸å˜**ï¼ˆConic Gradientsï¼‰ã€‚é‚£è§’å‘æ¸å˜æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå¦‚æœä½ å¯¹CSSæ¯”è¾ƒç†Ÿæ‚‰ï¼Œä¸€å®šçŸ¥é“è§’å‘æ¸å˜å°±æ˜¯ä»¥å›¾å½¢ä¸­å¿ƒä¸ºè½´ï¼Œé¡ºæ—¶é’ˆåœ°å®ç°æ¸å˜æ•ˆæœã€‚è€Œä¸”æ–°çš„ [CSS Image Values and Replaced Content](https://www.w3.org/TR/css-images-4/#conic-gradients) æ ‡å‡† level4 å·²ç»æ·»åŠ äº†è§’å‘æ¸å˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ¥åˆ›å»ºä¸€ä¸ªåŸºäºæåæ ‡çš„é¢œè‰²æ¸å˜ï¼Œä»£ç å¦‚ä¸‹ï¼š

```
div.conic {
  width: 150px;
  height: 150px;
  border-radius: 50%;
  background: conic-gradient(red 0%, green 45%, blue);
}
```

![](https://static001.geekbang.org/resource/image/6b/3e/6bdeda39bcbff4b2269d641df8f9d33e.jpeg?wh=1920%2A630)

æˆ‘ä»¬å¯ä»¥é€šè¿‡è§’å‘æ¸å˜åˆ›å»ºä¸€ä¸ªé¢œè‰²ç”±è§’åº¦è¿‡æ¸¡çš„å…ƒç´ ã€‚åœ¨WebGLä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æåæ ‡ç”¨ç‰‡å…ƒç€è‰²å™¨å®ç°ç±»ä¼¼çš„è§’å‘æ¸å˜æ•ˆæœï¼Œä»£ç å¦‚ä¸‹ï¼š

```
void main() {
  vec2 st = vUv - vec2(0.5);
  st = polar(st);
  float d = smoothstep(st.x, st.x + 0.01, 0.2);
  // å°†è§’åº¦èŒƒå›´è½¬æ¢åˆ°0åˆ°2piä¹‹é—´
  if(st.y < 0.0) st.y += 6.28;
  // è®¡ç®—pçš„å€¼ï¼Œä¹Ÿå°±æ˜¯ç›¸å¯¹è§’åº¦ï¼Œpå–å€¼0åˆ°1
  float p = st.y / 6.28;
  if(p < 0.45) {
    // på–0åˆ°0.45æ—¶ä»çº¢è‰²çº¿æ€§è¿‡æ¸¡åˆ°ç»¿è‰²
    gl_FragColor.rgb = d * mix(vec3(1.0, 0, 0), vec3(0, 0.5, 0), p /  0.45);
  } else {
    // pè¶…è¿‡0.45ä»ç»¿è‰²è¿‡æ¸¡åˆ°è“è‰²
    gl_FragColor.rgb = d * mix(vec3(0, 0.5, 0), vec3(0, 0, 1.0), (p - 0.45) / (1.0 - 0.45));
  }
  gl_FragColor.a = 1.0;
}
```

å¦‚ä¸Šé¢ä»£ç æ‰€ç¤ºï¼Œæˆ‘ä»¬å°†åƒç´ åæ ‡è½¬å˜ä¸ºæåæ ‡ä¹‹åï¼Œst.yå°±æ˜¯ä¸xè½´çš„å¤¹è§’ã€‚å› ä¸ºpolarå‡½æ•°é‡Œè®¡ç®—çš„atan(y, x)çš„å–å€¼èŒƒå›´æ˜¯-Ï€åˆ°Ï€ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨st.yå°äº0çš„æ—¶å€™ï¼Œå°†å®ƒåŠ ä¸Š2Ï€ï¼Œè¿™æ ·å°±èƒ½æŠŠå–å€¼èŒƒå›´è½¬æ¢åˆ°0åˆ°2Ï€äº†ã€‚

ç„¶åï¼Œæˆ‘ä»¬æ ¹æ®è§’åº¦æ¢ç®—å‡ºå¯¹åº”çš„æ¯”ä¾‹å¯¹é¢œè‰²è¿›è¡Œçº¿æ€§æ’å€¼ã€‚æ¯”å¦‚ï¼Œæ¯”ä¾‹åœ¨0%~45%ä¹‹é—´ï¼Œæˆ‘ä»¬è®©é¢œè‰²ä»çº¢è‰²è¿‡æ¸¡ä¸ºç»¿è‰²ï¼Œé‚£åœ¨45%åˆ°100%ä¹‹é—´ï¼Œæˆ‘ä»¬è®©é¢œè‰²ä»ç»¿è‰²è¿‡æ¸¡åˆ°è“è‰²ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬æœ€ç»ˆå°±ä¼šå¾—åˆ°å¦‚ä¸‹æ•ˆæœï¼š

![](https://static001.geekbang.org/resource/image/67/19/678161af2d8ff7ee9029bc9116cc0219.jpeg?wh=1920%2A1080)

è¿™ä¸ªæ•ˆæœä¸CSSè§’å‘æ¸å˜å¾—åˆ°çš„åŸºæœ¬ä¸Šä¸€è‡´ï¼Œé™¤äº†CSSè§’å‘æ¸å˜çš„èµ·å§‹è§’åº¦æ˜¯ä¸Yè½´çš„å¤¹è§’ï¼Œè€Œshaderæ˜¯ä¸Xè½´çš„å¤¹è§’ä»¥å¤–ï¼Œæ²¡æœ‰å…¶ä»–çš„ä¸åŒã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨WebGLä¸­åˆ©ç”¨æåæ ‡ç³»å®ç°ä¸CSSè§’å‘æ¸å˜ä¸€è‡´çš„è§†è§‰æ•ˆæœäº†ã€‚

## æåæ ‡å¦‚ä½•ç»˜åˆ¶HSVè‰²è½®ï¼Ÿ

æƒ³è¦å®ç°ä¸°å¯Œçš„è§†è§‰æ•ˆæœç¦»ä¸å¼€é¢œè‰²ï¼Œé€šè¿‡å‰é¢çš„è¯¾ç¨‹ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“å„ç§é¢œè‰²çš„è¡¨ç¤ºæ–¹æ³•ï¼Œä¸ºäº†æ›´æ–¹ä¾¿åœ°è°ƒè¯•é¢œè‰²ï¼Œæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥æ¥å®ç°è‰²è½®ã€‚ä»€ä¹ˆæ˜¯è‰²è½®å‘¢ï¼Ÿè‰²è½®å¯ä»¥å¸®åŠ©æˆ‘ä»¬ï¼ŒæŠŠæŸç§é¢œè‰²è¡¨ç¤ºæ³•æ‰€èƒ½è¡¨ç¤ºçš„æ‰€æœ‰é¢œè‰²æ–¹ä¾¿ã€ç›´è§‚åœ°æ˜¾ç¤ºå‡ºæ¥ã€‚

é‚£åœ¨WebGLä¸­ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆç»˜åˆ¶HSVè‰²è½®å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ç”¨æåæ ‡ç»“åˆHSVé¢œè‰²æ¥ç»˜åˆ¶å®ƒã€‚

æ¥ä¸‹æ¥ï¼Œå°±è®©æˆ‘ä»¬ä¸€èµ·åœ¨ç‰‡å…ƒç€è‰²å™¨ä¸­å®ç°å®ƒå§ã€‚å®ç°çš„è¿‡ç¨‹å…¶å®å¹¶ä¸å¤æ‚ï¼Œæˆ‘ä»¬åªéœ€è¦å°†åƒç´ åæ ‡è½¬æ¢ä¸ºæåæ ‡ï¼Œå†é™¤ä»¥2Ï€ï¼Œå°±èƒ½å¾—åˆ°HSVçš„Hå€¼ã€‚ç„¶åæˆ‘ä»¬ç”¨é¼ æ ‡ä½ç½®çš„xã€yåæ ‡æ¥å†³å®šSå’ŒVçš„å€¼ï¼Œå®Œæ•´çš„ç‰‡å…ƒç€è‰²å™¨ä»£ç å¦‚ä¸‹ï¼š

```
#ifdef GL_ES
precision highp float;
#endif

varying vec2 vUv;
uniform vec2 uMouse;

vec3 hsv2rgb(vec3 c){
  vec3 rgb = clamp(abs(mod(c.x*6.0+vec3(0.0,4.0,2.0), 6.0)-3.0)-1.0, 0.0, 1.0);
  rgb = rgb * rgb * (3.0 - 2.0 * rgb);
  return c.z * mix(vec3(1.0), rgb, c.y);
}

vec2 polar(vec2 st) {
  return vec2(length(st), atan(st.y, st.x));
}

void main() {
  vec2 st = vUv - vec2(0.5);
  st = polar(st);
  float d = smoothstep(st.x, st.x + 0.01, 0.2);
  if(st.y < 0.0) st.y += 6.28;
  float p = st.y / 6.28;
  gl_FragColor.rgb = d * hsv2rgb(vec3(p, uMouse.x, uMouse.y));
  gl_FragColor.a = 1.0;
}
```

æœ€ç»ˆçš„æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://static001.geekbang.org/resource/image/39/bf/3998fd1107b9c234a28eeee1bb11fabf.gif?wh=320%2A318)

## åœ†æŸ±åæ ‡ä¸çƒåæ ‡

æœ€åï¼Œæˆ‘è¿˜æƒ³å’Œä½ è¯´è¯´æåæ ‡å’Œåœ†æŸ±åæ ‡ç³»ä»¥åŠçƒåæ ‡ç³»ä¹‹é—´çš„å…³ç³»ã€‚æˆ‘ä»¬çŸ¥é“æåæ ‡ç³»æ˜¯äºŒç»´åæ ‡ç³»ï¼Œå¦‚æœæˆ‘ä»¬å°†æåæ ‡ç³»å»¶zè½´æ‰©å±•ï¼Œå¯ä»¥å¾—åˆ°åœ†æŸ±åæ ‡ç³»ã€‚åœ†æŸ±åæ ‡ç³»æ˜¯ä¸€ç§ä¸‰ç»´åæ ‡ç³»ï¼Œå¯ä»¥ç”¨æ¥ç»˜åˆ¶ä¸€äº›ä¸‰ç»´æ›²çº¿ï¼Œæ¯”å¦‚èºæ—‹çº¿ã€åœ†å†…èºæ—‹çº¿ã€è´¹é©¬æ›²çº¿ç­‰ç­‰ã€‚

[![](https://static001.geekbang.org/resource/image/1d/10/1d697208453d1a9557a659b1f9c5db10.jpeg?wh=1920%2A1080 "åœ†æŸ±åæ ‡ç³»")](https://zh.wikipedia.org/)

å› ä¸ºæåæ ‡ç³»å¯ä»¥å’Œç›´è§’åæ ‡ç³»ç›¸äº’è½¬æ¢ï¼Œæ‰€ä»¥ç›´è§’åæ ‡ç³»å’Œåœ†æŸ±åæ ‡ç³»ä¹Ÿå¯ä»¥ç›¸äº’è½¬æ¢ï¼Œå…¬å¼å¦‚ä¸‹ï¼š

![](https://static001.geekbang.org/resource/image/86/ef/86a5b3052493841f8ec648eb260b17ef.jpg?wh=1920%2A1080)

ä»ä¸Šé¢çš„å…¬å¼ä¸­ä½ ä¼šå‘ç°ï¼Œæˆ‘ä»¬åªè½¬æ¢äº†xã€yçš„åæ ‡ï¼Œå› ä¸ºå®ƒä»¬æ˜¯æåæ ‡ï¼Œè€Œzçš„åæ ‡å› ä¸ºæœ¬èº«å°±æ˜¯ç›´è§’åæ ‡ä¸ç”¨è½¬æ¢ã€‚å› æ­¤åœ†æŸ±åæ ‡ç³»åˆè¢«ç§°ä¸º**åŠæåæ ‡ç³»ã€‚**

åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è¿›ä¸€æ­¥å°†åœ†æŸ±åæ ‡ç³»è½¬ä¸ºçƒåæ ‡ç³»ã€‚

[![](https://static001.geekbang.org/resource/image/a3/c1/a3ba1a1bb31090ffa90887907ee65ec1.jpeg?wh=1920%2A1080 "çƒåæ ‡ç³»")](https://zh.wikipedia.org)

åŒæ ·åœ°ï¼Œåœ†æŸ±åæ ‡ç³»ä¹Ÿå¯ä»¥å’Œçƒåæ ‡ç³»ç›¸äº’è½¬æ¢ï¼Œå…¬å¼å¦‚ä¸‹ï¼š

![](https://static001.geekbang.org/resource/image/82/a9/8262a74b379f8433f1326e851ed579a9.jpg?wh=1920%2A1080)

çƒåæ ‡ç³»åœ¨ä¸‰ç»´å›¾å½¢ç»˜åˆ¶ã€çƒé¢å®šä½ã€ç¢°æ’æ£€æµ‹ç­‰ç­‰å¯è§†åŒ–å®ç°æ—¶éƒ½å¾ˆæœ‰ç”¨ï¼Œåœ¨åç»­çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šæœ‰æœºä¼šç”¨åˆ°çƒåæ ‡ç³»ï¼Œåœ¨è¿™é‡Œä½ éœ€è¦å…ˆè®°ä½å®ƒçš„è½¬æ¢å…¬å¼ã€‚

## è¦ç‚¹æ€»ç»“

è¿™ä¸€èŠ‚è¯¾ï¼Œæˆ‘ä»¬å­¦ä¹ äº†ä¸€ä¸ªæ–°çš„åæ ‡ç³»ç»Ÿä¹Ÿå°±æ˜¯æåæ ‡ç³»ï¼Œå¹¶ä¸”ç†è§£äº†ç›´è§’åæ ‡ç³»ä¸æåæ ‡ç³»çš„ç›¸äº’è½¬æ¢ã€‚

æåæ ‡ç³»æ˜¯ä½¿ç”¨ç›¸å¯¹æç‚¹çš„è·ç¦»ï¼Œä»¥åŠä¸xè½´æ­£å‘çš„å¤¹è§’æ¥è¡¨ç¤ºç‚¹çš„åæ ‡ã€‚æåæ ‡ç³»æƒ³è¦è½¬æ¢ä¸ºç›´è§’åæ ‡ç³»éœ€è¦ç”¨åˆ°fromPolarå‡½æ•°ï¼Œåè¿‡æ¥éœ€è¦ç”¨åˆ°toPolarå‡½æ•°ã€‚

é‚£åœ¨å…·ä½“ä½¿ç”¨æåæ ‡æ¥ç»˜åˆ¶æ›²çº¿çš„æ—¶å€™ï¼Œæœ‰ä¸¤ç§æ¸²æŸ“æ–¹å¼ã€‚ç¬¬ä¸€ç§æ˜¯ç”¨Cavansæ¸²æŸ“ï¼Œè¿™æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åˆ°ä¹‹å‰å­¦è¿‡çš„parametricé«˜é˜¶å‡½æ•°ï¼Œå°†æåæ ‡å‚æ•°æ–¹ç¨‹å’Œåæ ‡æ˜ å°„å‡½æ•°fromPolarä¼ å…¥ï¼Œå¾—åˆ°ç»˜åˆ¶æ›²çº¿çš„å‡½æ•°ï¼Œå†ç”¨å®ƒæ¥æ‰§è¡Œç»˜åˆ¶ã€‚è¿™æ ·ï¼Œæåæ ‡ç³»å°±èƒ½å®ç°ç›´è§’åæ ‡ç³»ä¸å¤ªå¥½æè¿°çš„æ›²çº¿äº†ï¼Œæ¯”å¦‚ï¼Œç«ç‘°çº¿ã€å¿ƒå½¢çº¿ç­‰ç­‰ã€‚

ç¬¬äºŒç§æ˜¯ä½¿ç”¨shaderæ¸²æŸ“ï¼Œä¸€èˆ¬çš„æ–¹æ³•æ˜¯å…ˆå°†åƒç´ åæ ‡è½¬æ¢ä¸ºæåæ ‡ï¼Œç„¶åä½¿ç”¨æåæ ‡æ„å»ºè·ç¦»åœºå¹¶ç€è‰²ã€‚å®ƒèƒ½å®ç°æ›´å¤šå¤æ‚çš„å›¾æ¡ˆã€‚

é™¤äº†ç»˜å›¾ï¼Œä½¿ç”¨æåæ ‡è¿˜å¯ä»¥å®ç°è§’å‘æ¸å˜å’ŒHSVè‰²è½®ã€‚è§’å‘æ¸å˜é€šå¸¸å¯ä»¥ç”¨åœ¨æ„å»ºé¥¼å›¾ï¼Œè€ŒHSVè‰²è½®ä¸€èˆ¬ç”¨åœ¨é¢œè‰²å¯è§†åŒ–å’Œæ‹©è‰²äº¤äº’ç­‰åœºåˆé‡Œã€‚

æ­¤å¤–ï¼Œä½ è¿˜éœ€è¦äº†è§£åœ†æŸ±åæ ‡ã€çƒåæ ‡ä¸ç›´è§’åæ ‡ç³»çš„ç›¸äº’è½¬æ¢ã€‚åœ¨åç»­è¯¾ç¨‹é‡Œï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨åœ†æŸ±åæ ‡æˆ–çƒåæ ‡æ¥å¤„ç†ä¸‰ç»´å›¾å½¢ï¼Œåˆ°æ—¶å€™å®ƒä»¬ä¼šéå¸¸æœ‰ç”¨ã€‚

## å°è¯•ç‰›åˆ€

1. ç”¨æåæ ‡ç»˜åˆ¶å°å›¾æ¡ˆæ—¶ï¼Œæˆ‘ä»¬ç»˜åˆ¶äº†è‹¹æœå’Œè‘«èŠ¦çš„å›¾æ¡ˆï¼Œä½†å®ƒä»¬æ˜¯æ¨ªç½®çš„ã€‚ä½ å¯ä»¥è¯•ç€ä¿®æ”¹å®ƒä»¬ï¼Œè®©å®ƒä»¬çš„æ–¹å‘å˜ä¸ºæ­£å‘å—ï¼Ÿå…·ä½“æ€ä¹ˆåšå‘¢ï¼Ÿ
2. åœ¨è§’å‘æ¸å˜çš„ä¾‹å­ä¸­ï¼ŒCSSè§’å‘æ¸å˜æ˜¯ä¸Yè½´çš„å¤¹è§’ï¼Œè€Œä½¿ç”¨ç€è‰²å™¨ç»˜åˆ¶çš„ç‰ˆæœ¬æ˜¯ä¸Xè½´çš„å¤¹è§’ã€‚é‚£å¦‚æœè¦è®©ç€è‰²å™¨ç»˜åˆ¶ç‰ˆæœ¬çš„æ•ˆæœä¸CSSè§’å‘æ¸å˜æ•ˆæœå®Œå…¨ä¸€è‡´ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ
3. æˆ‘ä»¬å·²ç»å­¦è¿‡äº†éšæœºæ•°ã€è·ç¦»åœºä»¥åŠæåæ ‡ï¼Œä½ æ˜¯ä¸æ˜¯å¯ä»¥åˆ©ç”¨å®ƒä»¬ç»˜åˆ¶å‡ºä¸€ä¸ªç”»å¸ƒï¼Œå¹¶ä¸”å‘ˆç°éšæœºçš„å‰ªçº¸å›¾æ¡ˆï¼Œç±»ä¼¼çš„æ•ˆæœå¦‚ä¸‹æ‰€ç¤ºã€‚

![](https://static001.geekbang.org/resource/image/d8/8e/d899fd39482d17ff720c3f86d5d5858e.jpeg?wh=1920%2A1080)

æ¬¢è¿åœ¨ç•™è¨€åŒºå’Œæˆ‘è®¨è®ºï¼Œåˆ†äº«ä½ çš„ç­”æ¡ˆå’Œæ€è€ƒï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾åˆ†äº«ç»™ä½ çš„æœ‹å‹ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼

* * *

## æºç 

[parametric-shader](https://github.com/akira-cn/graphics/tree/master/parametric-polar)  
[ploar-shader](https://github.com/akira-cn/graphics/tree/master/polar-shader)
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ4ï¼‰</strong></div><ul>
<li><span>kylin</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>è€å¸ˆï¼Œèƒ½ä¸èƒ½ä»‹ç»ä¸€äº›å‡½æ•°å¼ç¼–ç¨‹æ€æƒ³çš„èµ„æ–™ï¼Œéå¸¸æƒ³æ·±å…¥å­¦ä¹ </p>2020-08-16</li><br/><li><span>ç•ªè–¯</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<p>ç¬¬ä¸‰é¢˜è¢«å¡ä½äº†ï¼Œè¯·é—®æ€ä¹ˆè®©fractçš„æ¯ä¸€æ ¼éšæœºæ•°ä¸åŒå‘¢ï¼Ÿ</p>2021-02-25</li><br/><li><span>æœ‰ä¸€ç§è¸å®</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<p>éšæœºæ•°æ˜ å°„åˆ° sd å‡½æ•°çš„æ–¹å¼ï¼Œé™¤äº†ç”¨ if æ¡ä»¶è¯­å¥å¤–ï¼Œè¿˜æœ‰å…¶å®ƒæ›´ä¼˜é›…çš„æ–¹å¼å—ï¼Ÿ

void main() {
        vec2 st = vUv * 10.0;

        vec2 p = fract(st);
        p = p - vec2(0.5);

        float i = random(floor(st));
        float d = 0.0;
        if (i &lt; 0.33) {
          d = sdCircle(p, vec2(0.0, 0.0), 0.25);
        } else if (i &gt;= 0.33 &amp;&amp; i &lt; 0.66) {
          d = sdBox(p, vec2(0.0, 0.0), vec2(0.25));
        } else {
          d = sdApple(p);
        }
        
        gl_FragColor.rgb = mix(vec3(1.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0), smoothstep(0.0, 0.01, d));

        gl_FragColor.a = 1.0;
      }</p>2023-12-11</li><br/><li><span>æœ‰ä¸€ç§è¸å®</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<p>å°è¯•ç‰›åˆ€ç¬¬ä¸€é¢˜ä¸­ï¼Œä¸ºä»€ä¹ˆæ—‹è½¬æåæ ‡å¾—åˆ°çš„å›¾å½¢å˜å½¢äº†ï¼Ÿ

const fragment = `
      #ifdef GL_ES
      precision highp float;
      #endif

      varying vec2 vUv;
      uniform float u_k;
      uniform float u_scale;
      uniform float u_offset;

      vec2 polar(vec2 st) {
        return vec2(length(st), atan(st.y, st.x));
      }

      float PI = 3.141592653;

      void main() {
        vec2 st = vUv - vec2(0.5);

        &#47;&#47; float rotateRad = PI &#47; 2.0;
        &#47;&#47; mat2 rotateMatrix = mat2(
        &#47;&#47;   cos(rotateRad), sin(rotateRad),
        &#47;&#47;   -sin(rotateRad), cos(rotateRad)
        &#47;&#47; );
        &#47;&#47; st = rotateMatrix * st;

        st = polar(st);

        st.y = st.y + PI &#47; 2.0; &#47;&#47; è¿™é‡Œæ—‹è½¬æåæ ‡å¾—åˆ°çš„å›¾å½¢å˜å½¢äº†ï¼Ÿ

        float d = u_scale * 0.5 * abs(cos(st.y * u_k * 0.5)) - st.x + u_offset;

        gl_FragColor.rgb = smoothstep(-0.01, 0.01, d) * vec3(1.0);
        gl_FragColor.a = 1.0;
      }
    `;</p>2023-12-11</li><br/>
</ul>