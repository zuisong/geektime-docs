ä½ å¥½ï¼Œæˆ‘æ˜¯æœˆå½±ã€‚

ä¸Šä¸€è¯¾æˆ‘ä»¬è®²äº†ä¸¤ç±»å¤„ç†åƒç´ çš„æ»¤é•œï¼Œåˆ†åˆ«æ˜¯é¢œè‰²æ»¤é•œå’Œé«˜æ–¯æ»¤é•œã€‚å…¶ä¸­ï¼Œ**é¢œè‰²æ»¤é•œæ˜¯åŸºæœ¬çš„ç®€å•æ»¤é•œ**ã€‚å› ä¸ºç®€å•æ»¤é•œé‡Œçš„æ¯ä¸ªåƒç´ éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œæ‰€ä»¥å®ƒçš„å¤„ç†ç»“æœ**ä¸ä¾èµ–äºå…¶ä»–åƒç´ ç‚¹çš„ä¿¡æ¯**ï¼Œå› æ­¤åº”ç”¨èµ·æ¥ä¹Ÿæ¯”è¾ƒç®€å•ã€‚**è€Œé«˜æ–¯æ»¤é•œä¹Ÿå°±æ˜¯å¹³æ»‘æ•ˆæœæ»¤é•œ**ï¼Œå®ƒæ˜¯æœ€åŸºæœ¬çš„**å¤æ‚æ»¤é•œ**ã€‚å¤æ‚æ»¤é•œçš„å¤„ç†ç»“æœä¸ä»…ä¸å½“å‰åƒç´ æœ‰å…³ï¼Œè¿˜ä¸å…¶å‘¨å›´çš„åƒç´ ç‚¹æœ‰å…³ï¼Œæ‰€ä»¥åº”ç”¨èµ·æ¥å¾ˆå¤æ‚ã€‚

å½“ç„¶äº†ï¼Œé¢œè‰²æ»¤é•œå’Œé«˜æ–¯æ»¤é•œèƒ½å¤Ÿå®ç°çš„è§†è§‰æ•ˆæœæœ‰é™ã€‚å¦‚æœæƒ³è¦å®ç°æ›´å¤æ‚çš„è§†è§‰æ•ˆæœï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨æ›´å¤šå…¶ä»–çš„æ»¤é•œã€‚æ‰€ä»¥è¿™ä¸€èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°±æ¥è¯´è¯´ï¼Œæ€ä¹ˆç»“åˆä¸åŒæ»¤é•œå®ç°æ›´å¤æ‚çš„è§†è§‰æ•ˆæœã€‚

## å…¶ä»–ç®€å•æ»¤é•œåœ¨Canvasä¸­çš„åº”ç”¨

æˆ‘ä»¬çŸ¥é“ï¼Œç®€å•æ»¤é•œçš„å¤„ç†æ•ˆæœå’Œåƒç´ ç‚¹çš„é¢œè‰²æœ‰å…³ã€‚å…¶å®ï¼Œè¿˜æœ‰ä¸€äº›ç®€å•æ»¤é•œçš„å¤„ç†æ•ˆæœå’Œåƒç´ ç‚¹çš„åæ ‡ã€å¤–éƒ¨ç¯å¢ƒï¼ˆæ¯”å¦‚é¼ æ ‡ä½ç½®ã€æ—¶é—´ï¼‰æœ‰å…³ã€‚è¿™äº›æ»¤é•œè™½ç„¶ä¹Ÿæ˜¯ç®€å•æ»¤é•œï¼Œä½†èƒ½å®ç°çš„æ•ˆæœå¯ä¸ç®€å•ã€‚è®©æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªæœ‰è¶£çš„ä¾‹å­ã€‚

**ç¬¬ä¸€ä¸ªä¾‹å­ï¼Œå®ç°å›¾ç‰‡è¾¹ç¼˜æ¨¡ç³Šçš„æ•ˆæœã€‚**

```
import {loadImage, getImageData, traverse} from './lib/util.js';
const canvas = document.getElementById('paper');
const context = canvas.getContext('2d');
(async function () {
  const img = await loadImage('assets/girl1.jpg');
  const imageData = getImageData(img);
  traverse(imageData, ({r, g, b, a, x, y}) => {
    const d = Math.hypot((x - 0.5), (y - 0.5));
    a *= 1.0 - 2 * d;
    return [r, g, b, a];
  });
  canvas.width = imageData.width;
  canvas.height = imageData.height;
  context.putImageData(imageData, 0, 0);
}());
```

å¦‚ä¸Šé¢ä»£ç æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥åœ¨éå†åƒç´ ç‚¹çš„æ—¶å€™è®¡ç®—å½“å‰åƒç´ ç‚¹åˆ°å›¾ç‰‡ä¸­å¿ƒç‚¹çš„è·ç¦»ï¼Œç„¶åæ ¹æ®è·ç¦»è®¾ç½®é€æ˜åº¦ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å®ç°ä¸‹é¢è¿™æ ·çš„è¾¹ç¼˜æ¨¡ç³Šæ•ˆæœäº†ã€‚

![](https://static001.geekbang.org/resource/image/33/c0/33450156f67efc94d33e6f93ea8b93c0.jpg?wh=1000%2A554 "è¾¹ç¼˜æ¨¡ç³Šæ•ˆæœç¤ºæ„å›¾")

**ç¬¬äºŒä¸ªï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨åƒç´ å¤„ç†å®ç°å›¾ç‰‡èåˆ**ã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ç»™ä¸€å¼ ç…§ç‰‡åŠ ä¸Šé˜³å…‰ç…§è€€çš„æ•ˆæœã€‚å…·ä½“æ“ä½œå°±æ˜¯ï¼ŒæŠŠä¸‹é¢è¿™å¼ é€æ˜çš„PNGå›¾ç‰‡å åŠ åˆ°ä¸€å¼ ç…§ç‰‡ä¸Šã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ8ï¼‰</strong></div><ul>
<li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/aFAYPyw7ywC1xE9h1qibnTBwtWn2ClJqlicy5cMomhZVaruMyqSq76wMkS279mUaGhrLGwWo9ZnW0WCWfmMovlXw/132" width="30px"><span>æœ¨ç“œ777</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>shaderä¸­æœ‰å¾ˆå¤šæ•°å­—ï¼Œä¸ºä»€ä¹ˆæ˜¯è¿™äº›æ•°å­—ï¼Ÿ</div>2020-07-22</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eokhlnrZO1G1SnxWka7hSeqwHnIcuQKugQDBDKUDXc2ZDXKsibHTNviaG6CiaqBiaK5Bwcu37xakaFthw/132" width="30px"><span>Zack</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>webglå®ç°ç°åº¦åŒ–ï¼Œä¸ºä»€ä¹ˆè¦å…ˆæŠŠé¢œè‰²çŸ©é˜µè½¬ç½®ï¼Ÿ</div>2020-12-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/25/34/81/f44f2f11.jpg" width="30px"><span>MG.Fre</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>é©¬èµ›å…‹æ•ˆæœï¼šå¯¹çº¹ç†åæ ‡åšæ”¾å¤§ç¼©å°å¤„ç†ï¼Œst = floor(vUv * 50.0) &#47; 50.0ï¼›ç²¾åº¦ä¸¢å¤±ï¼›å±€éƒ¨é©¬èµ›å…‹çš„è¯ï¼ŒåŠ åæ ‡èŒƒå›´çš„åˆ¤æ–­å°±å¯ä»¥äº†ã€‚</div>2021-07-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/d3/a3/52702576.jpg" width="30px"><span>becky</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>è¯¾åç»ƒä¹ ï¼šhttps:&#47;&#47;yeying0827.github.io&#47;visualization-demos&#47;#&#47;texture-and-complex-filter&#47;practiceã€‚é©¬èµ›å…‹æ•ˆæœæ ¹æ®â€ç²’å­åŒ–â€œçš„æ•ˆæœç”¨äº†ç½‘æ ¼çš„æ–¹å¼ã€‚</div>2024-04-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/28/34/c1/4e4917f5.jpg" width="30px"><span>æœ‰ä¸€ç§è¸å®</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>å±€éƒ¨â€œé©¬èµ›å…‹â€ä¸»è¦å®ç°ï¼š

&#47;&#47; ç‰‡å…ƒç€è‰²å™¨
const fragment = `
      #ifdef GL_ES
      precision highp float;
      #endif

      uniform sampler2D tMap;
      uniform int start;
      uniform vec2 mousepos;
      uniform float radiusX;
      uniform float radiusY;

      varying vec2 vUv;

      float random (vec2 st) {
        return fract(sin(dot(st.xy, vec2(12.9898, 78.233))) * 43758.5453123);
      }

      void main() {
          vec4 color = texture2D(tMap, vUv);
          if (start &gt; 0 &amp;&amp; pow(abs(mousepos.x - vUv.x), 2.0) &#47; pow(radiusX, 2.0) + pow(abs(mousepos.y - vUv.y), 2.0) &#47; pow(radiusY, 2.0) &lt;= 1.0) {
            vec2 st = vUv * vec2(100, 55.4);
            vec2 uv = vUv + 1.0 - 2.0 * random(floor(st));
            color = texture2D(tMap, uv);
          }

          gl_FragColor = color;
      }
    `;

&#47;&#47; uniform æ›´æ–°
const { canvas } = renderer;
      const { width, height } = canvas;
      const rect = canvas.getBoundingClientRect();
      let start = false;

      renderer.uniforms.start = 0;
      renderer.uniforms.mousepos = [0, 0];
      const radiusPX = 100;
      renderer.uniforms.radiusX = radiusPX &#47; width;
      renderer.uniforms.radiusY = radiusPX &#47; height;

      canvas.addEventListener(&#39;mousemove&#39;, e =&gt; {
        if (start) {
          const x = (e.clientX - rect.left) &#47; width;
          const y = (height - (e.clientY - rect.top)) &#47; height;
          renderer.uniforms.mousepos = [x, y];
        } else {
          start = true;
          renderer.uniforms.start = 1;
        }
      });
</div>2023-11-29</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Fnol5T7X9z9icw8yP1Zx5enHdYqbmP4EbNymaP87USujdeDp22QYMEwfYqkT7mOkXYegBZmhRx9bDbUbKGTPYlg/132" width="30px"><span>Geek_00734e</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>å› ä¸ºåŸå§‹å›¾åƒçš„å›¾ç‰‡åƒç´ å®½é«˜æ˜¯ 1000px å’Œ 554pxï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨ vec2 st = vUv * vec2(100, 55.4) å°±å¯ä»¥å¾—åˆ° 10px X 10px å¤§å°çš„ç½‘æ ¼ã€‚
è¿™ä¸€æ®µä¸ç†è§£,ä¸ºå•¥100ï¼Œ 55.4  å°±æ˜¯10X10çš„ç½‘æ ¼ï¼Ÿ å°±å› ä¸º1000&#47;100 = 10 ï¼Ÿæƒ³ä¸é€š</div>2023-02-16</li><br/><li><img src="" width="30px"><span>Geek3340</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>if(cat.r &lt; 0.5 &amp;&amp; cat.g &gt; 0.6) {
è¯·é—® è¿™é‡Œçš„ é˜€å€¼æ˜¯å¦‚ä½•å¾—åˆ°çš„å‘¢</div>2021-06-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/25/2a/53/5b9afe0a.jpg" width="30px"><span>ç•ªè–¯</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>å°è¯•äº†ç”¨webglå†™é«˜æ–¯æ¨¡ç³Šå’Œé©¬èµ›å…‹ï¼Œå‘ç°ä¸ªé—®é¢˜ï¼šç‰‡å…ƒç€è‰²å™¨é‡Œï¼Œå¾ªç¯å’Œæ•°ç»„éƒ½ä¸èƒ½å¸¦uniformå˜é‡ï¼Œåªèƒ½ç›´æ¥hardcodeä»£è¡¨åŠå¾„çš„æ•°å­—è¿›å»ï¼Œå†™ç‰‡å…ƒå°±æ˜¯è¿™æ ·å—ï¼Ÿè¿˜æ˜¯æœ‰æ›´åˆé€‚çš„æ–¹æ³•ï¼Ÿ
https:&#47;&#47;codepen.io&#47;sfyan-the-styleful&#47;pen&#47;OJbpXzx
https:&#47;&#47;codepen.io&#47;sfyan-the-styleful&#47;pen&#47;KKNWEgQ</div>2021-02-16</li><br/>
</ul>