ä½ å¥½ï¼Œæˆ‘æ˜¯æœˆå½±ã€‚

å‰é¢ï¼Œæˆ‘ä»¬ç”¨äº†3ä¸ªæ¨¡å—çš„æ—¶é—´ï¼Œå­¦ä¹ äº†å¤§é‡çš„å›¾å½¢å­¦å’Œæ•°å­¦çŸ¥è¯†ï¼Œæ˜¯ä¸æ˜¯è®©ä½ çš„è„‘è¢‹æœ‰ä¸€ç‚¹æ˜æ²‰ï¼Ÿæ²¡å…³ç³»ï¼Œä½ åªæ˜¯éœ€è¦ä¸€ç‚¹æ—¶é—´æ¥æ¶ˆåŒ–è¿™äº›çŸ¥è¯†è€Œå·²ã€‚æˆ‘èƒ½ç»™ä½ çš„å»ºè®®å°±æ˜¯å¤šæ€è€ƒã€å¤šç»ƒä¹ ï¼Œæœ‰äº†æ—¶é—´çš„ç§¯ç´¯ï¼Œä½ ä¸€å®šå¯ä»¥æŒæ¡è¿™äº›åŸºç¡€çŸ¥è¯†å’Œæ€ç»´æ–¹æ³•ã€‚

ä»è¿™ä¸€èŠ‚è¯¾å¼€å§‹ï¼Œæˆ‘ä»¬è¦å­¦ä¹ ä¸€ä¸ªéå¸¸æœ‰æ„æ€çš„æ–°æ¨¡å—ï¼Œé‚£å°±æ˜¯åŠ¨ç”»å’Œ3Dç»˜å›¾ã€‚å¯¹äºå¯è§†åŒ–å±•ç°æ¥è¯´ï¼ŒåŠ¨ç”»å’Œ3Déƒ½æ˜¯ç”¨æ¥å¼ºåŒ–æ•°æ®è¡¨è¾¾ï¼Œå¸å¼•ç”¨æˆ·çš„é‡è¦æŠ€æœ¯æ‰‹æ®µã€‚å®ƒä»¬å¾€å¾€æ¯”äºŒç»´å¹³é¢å›¾å½¢èƒ½å¤Ÿè¡¨è¾¾æ›´å¤æ‚çš„æ•°æ®ï¼Œå®ç°æ›´å¸å¼•äººçš„è§†è§‰æ•ˆæœã€‚

é‚£ä»Šå¤©ï¼Œæˆ‘ä»¬å…ˆæ¥èŠèŠåŠ¨ç”»çš„å®ç°ã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬ä¹‹å‰ä¹Ÿå®ç°äº†ä¸å°‘åŠ¨æ€æ•ˆæœï¼Œä½†ä½ å¯èƒ½è¿˜æ˜¯ä¸çŸ¥é“æ€ä¹ˆå»å®ç°åŠ¨ç”»ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥ç³»ç»Ÿåœ°æ¢³ç†ä¸€ä¸‹åŠ¨ç”»å®ç°çš„æ ‡å‡†æ–¹æ³•ã€‚

## åŠ¨ç”»çš„ä¸‰ç§å½¢å¼

ä»€ä¹ˆæ˜¯åŠ¨ç”»å‘¢ï¼Ÿç®€å•æ¥è¯´ï¼ŒåŠ¨ç”»å°±æ˜¯å°†è®¸å¤šå¸§é™æ­¢çš„ç”»é¢ä»¥å›ºå®šçš„é€Ÿç‡è¿ç»­æ’­æ”¾å‡ºæ¥ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒåŠ¨ç”»æœ‰ä¸‰ç§å½¢å¼ï¼Œåˆ†åˆ«æ˜¯å›ºå®šå¸§åŠ¨ç”»ã€å¢é‡åŠ¨ç”»å’Œæ—¶åºåŠ¨ç”»ã€‚

ç¬¬ä¸€ç§å½¢å¼æ˜¯æˆ‘ä»¬é¢„å…ˆå‡†å¤‡å¥½è¦æ’­æ”¾çš„é™æ€å›¾åƒï¼Œç„¶åå°†è¿™äº›å›¾ä¾æ¬¡æ’­æ”¾ï¼Œæ‰€ä»¥å®ƒå«åš**å›ºå®šå¸§åŠ¨ç”»**ã€‚**å¢é‡åŠ¨ç”»**æ˜¯åœ¨åŠ¨æ€ç»˜åˆ¶å›¾åƒçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¿®æ”¹æ¯ä¸€å¸§ä¸­æŸä¸ªæˆ–æŸå‡ ä¸ªå±æ€§çš„å€¼ï¼Œç»™å®ƒä»¬ä¸€å®šçš„å¢é‡ã€‚ç¬¬ä¸‰ç§å½¢å¼æ˜¯åœ¨åŠ¨æ€ç»˜åˆ¶å›¾åƒçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ ¹æ®æ—¶é—´å’ŒåŠ¨ç”»å‡½æ•°è®¡ç®—æ¯ä¸€å¸§ä¸­çš„å…³é”®å±æ€§å€¼ï¼Œç„¶åæ›´æ–°è¿™äº›å±æ€§ï¼Œæ‰€ä»¥å®ƒå«åš**æ—¶åºåŠ¨ç”»**ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ7ï¼‰</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/12/21/7e/fb725950.jpg" width="30px"><span>ç½— ä¹¾ æ—</span> ğŸ‘ï¼ˆ5ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æœ€ç›´æ¥çš„æƒ³æ³•

async function run_animator() {
      let _duration = 400
      const start_pos = 100
      const end_pos = 300
      let h = end_pos - start_pos

      const animator = new Animator({ duration: _duration, easing: p =&gt; p ** 2 });
      await animator.animate({ el: block, start: start_pos, end: end_pos }, ({ target: { el, start, end }, timing: { p, isFinished } }) =&gt; {
        const top = start * (1 - p) + end * p;
        el.style.top = `${top}px`;
      });

      
      while (h &gt; 2) {
        h &#47;= 2
        const top = end_pos - h
        _duration &#47;= Math.sqrt(2)
        &#47;&#47; console.log(`${h} ${_duration}`)
        const animator_up = new Animator({ duration: _duration, easing: p =&gt; p * (2 - p) });
        const animator_down = new Animator({ duration: _duration, easing: p =&gt; p ** 2 });

        await animator_up.animate({ el: block, start: end_pos, end: top }, ({ target: { el, start, end }, timing: { p, isFinished } }) =&gt; {
          const top = start * (1 - p) + end * p;
          el.style.top = `${top}px`;
        });

        await animator_down.animate({ el: block, start: top, end: end_pos }, ({ target: { el, start, end }, timing: { p, isFinished } }) =&gt; {
          const top = start * (1 - p) + end * p;
          el.style.top = `${top}px`;
        });
      }
    }</div>2020-08-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1e/12/34/15aff428.jpg" width="30px"><span>ä»¥æ¢¦ä¸ºé©¬</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆä½ å¥½ï¼Œtransformä¸­Matrixæ˜¯ä¸æ˜¯é™¤äº†è£…Bå¤–å°±æ²¡ä»€ä¹ˆç”¨å‘€.... ä¸€ç›´æ²¡å‘ç°å®ƒçš„ç”¨æ­¦ä¹‹åœ°</div>2020-08-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1e/81/aa/1f7a8e88.jpg" width="30px"><span>é‡å­è”·è–‡</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>&#47;&#47; å°è¯•ç‰›åˆ€ï¼Œè¿™é‡Œç»™å‡ºå…³é”®ä»£ç ï¼Œå‡½æ•° fallï¼š
async function fall(h, duration, k = 0.5) {
    await new Animator({ duration, easing: p =&gt; p ** 2 }).animate(circle, ({ target, timing }) =&gt; {
        target.y = h * (1 - timing.p);
    });
    const nextH = h * k;
    const nextDuration = (duration ** 2 * k) ** 0.5;
    if (nextDuration &gt; 16) {
        await new Animator({ duration: nextDuration, easing: p =&gt; p * (2 - p) }).animate(circle, ({ target, timing }) =&gt; {
            target.y = nextH * timing.p;
        });
        fall(nextH, nextDuration, k);
    }
}
&#47;&#47; h ä¸ºä¸‹è½é«˜åº¦ï¼Œduration ä¸ºæŒç»­æ—¶é—´ï¼Œk æ˜¯è¡°å‡ç³»æ•°ï¼Œé»˜è®¤æ¯æ¬¡å¼¹èµ·åé«˜åº¦å‡åŠ
&#47;&#47; åˆ©ç”¨äº†é€’å½’çš„æ€æƒ³ï¼Œå½“ nextDuration å°äº16ï¼ˆ60fps çš„å¸§é—´éš”æ˜¯16.666â€¦ï¼‰æ—¶åœæ­¢å¼¹èµ·
</div>2022-10-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/23/52/38/9f30d516.jpg" width="30px"><span>KaygNas</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>è¯·é—®æœˆå½±å¤§å¤§ï¼Œå°†çº¿æ€§çš„ f(p) = p æ˜ å°„æˆä»»æ„çš„å‡½æ•°æœ‰æ›´é€šç”¨çš„æ±‚è§£æ–¹å¼å—ï¼Ÿ</div>2023-06-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/f8/ff/ae800f6b.jpg" width="30px"><span>æˆ‘å«å¼ å°å’©Â²â°Â¹â¹</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>import {Animator} from &#39;..&#47;common&#47;lib&#47;animator&#47;index.js&#39;;
    const ball = document.querySelector(&#39;.ball&#39;);
    (async function () {
      let start = 0;
      let end = 200;
      let _duration = 1000
      while(start &lt; 200) { &#47;&#47; eslint-disable-next-line no-await-in-loop
        const animeFall = new Animator({duration: _duration, easing: p =&gt; p ** 2 });
        await animeFall.animate(ball, ({target, timing: { p }}) =&gt; {
          const top = start * (1 - p) + end * p;
          target.style.top = `${top}px`;
        });

        start = Math.ceil((end - start) &#47; 2 + start)
        _duration &#47;= Math.sqrt(2)

        const animeBound = new Animator({duration: _duration, easing: p =&gt; p * (2 - p) });
        await animeBound.animate({ el: ball, start: end, end: start }, ({target: { el, start, end }, timing: { p }}) =&gt; {
          const top = start * (1 - p) + end * p;
          el.style.top = `${top}px`;
        });
        
        console.log(start, end)
      }
    }());</div>2023-05-19</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/bOFMGebia5L9r0srOd8lblaoWHNSATQrAabGQgcL6MnvAP7V1QqU8sjwdnZib4Hsia5Kv8ozex7KDcYRKrrhiaQLqg/132" width="30px"><span>Geek_q04ku5</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>const ball = document.querySelector(&#39;.ball&#39;)
const downAnimator = new Animator({ duration: 700, iterations: 1, easing: p =&gt; p ** 2 })
const upAnimator = new Animator({ duration: 700, iterations: 1, easing: p =&gt; p * (2 - p) })

setTimeout(async () =&gt; {
    let start = 0;
    let end = 200;
    let T = 200;

    while (Math.round(start) !== end) {
        await downAnimator.animate({ el: ball, start, end }, (({ target: { el, start, end }, timing }) =&gt; {
            const { p } = timing
            const top = start * (1 - p) + end * p
            el.style.top = `${top}px`
        }))

        start += T &#47;= 2;

        await upAnimator.animate({ el: ball, start: end, end: start }, (({ target: { el, start, end }, timing }) =&gt; {
            const { p } = timing
            const top = start * (1 - p) + end * p
            el.style.top = `${top}px`
        }))
    }
}, 1000);</div>2022-02-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/25/34/81/f44f2f11.jpg" width="30px"><span>MG.Fre</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>        &#47;&#47; p = p ** 2; &#47;&#47; åŒ€åŠ é€Ÿè¿åŠ¨
        &#47;&#47; p = p * (2 - p); &#47;&#47; åŒ€å‡é€Ÿè¿åŠ¨
        let start = 0, end = 200, duration = 800;
        let distance = end - start;
        const animator = new Animator({ duration, easing: p =&gt; p ** 2 });

        document.addEventListener(&#39;click&#39;, async () =&gt; {
            while(Math.abs(distance) &gt;= 0.1){
                &#47;&#47; æ ¹æ®æ–¹å‘æ›´æ–°åŠ¨ç”»å‡½æ•°
                if(distance &gt; 0)
                    &#47;&#47; å‘ä¸‹è¿åŠ¨ï¼ŒåŒ€åŠ é€Ÿ
                    animator.updateTiming({easing: p =&gt; p ** 2});
                else
                    &#47;&#47; å‘ä¸Šè¿åŠ¨ï¼ŒåŒ€å‡é€Ÿ
                    animator.updateTiming({easing: p =&gt; p * (2 - p)});

                &#47;&#47; æ›´æ–°åŠ¨ç”»çš„å‘¨æœŸæ—¶é—´ï¼ˆä¿æŒåŠ é€Ÿåº¦æ’å®šï¼‰ 
                animator.updateTiming({duration: duration *= 0.7});

                await animator.animate({el: block, start, end}, ({target: {el, start, end}, timing: {p}}) =&gt; {
                    const top = start * (1 - p) + end * p;
                    el.style.top = `${top}px`;
                });

                &#47;&#47; é€šè¿‡distanceè®°å½•è¿åŠ¨æ–¹å‘
                distance = - distance &#47; 2;
                &#47;&#47; æ›´æ–°å¼€å§‹ä¸ç»“æŸçš„ä½ç½®å˜åŒ–
                if(distance &lt; 0){
                    [start, end] = [end, end + distance];
                }else{
                    [start, end] = [end, start];
                }
            }
        });</div>2021-08-10</li><br/>
</ul>