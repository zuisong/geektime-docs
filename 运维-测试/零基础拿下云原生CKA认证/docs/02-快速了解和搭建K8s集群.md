ä½ å¥½ï¼Œæˆ‘æ˜¯é›ªé£ã€‚

ä¸Šä¸€è®²æˆ‘ä»¬ä»‹ç»äº†å®¹å™¨ç›¸å…³çŸ¥è¯†ï¼Œç›¸ä¿¡ä½ å·²ç»ç†è§£äº†å®¹å™¨å¸¦æ¥çš„å·¨å¤§å˜é©ã€‚ä½ çš„åº”ç”¨ä¹Ÿå¯ä»¥æ‹†æˆå¤šä¸ªå¾®æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡å¯ä»¥é€šè¿‡å®¹å™¨çš„æ–¹å¼å¿«é€Ÿéƒ¨ç½²ã€‚ä½†æ˜¯é—®é¢˜æ¥äº†ï¼Œå¦‚æœä½ åªéƒ¨ç½²å°‘é‡å‡ ä¸ªå¾®æœåŠ¡åº”ç”¨ï¼Œé€šè¿‡ Docker å‘½ä»¤ç®¡ç†èµ·æ¥å¾ˆå®¹æ˜“ï¼Œä½†æ˜¯å¦‚æœä½ æœ‰å‡ åç”šè‡³ä¸Šç™¾ä¸ªå¾®æœåŠ¡éœ€è¦å®¹å™¨åŒ–éƒ¨ç½²ï¼Œé‚£ä¹ˆéƒ¨ç½²å’Œç®¡ç†è¿™äº›å¤§é‡å®¹å™¨ä¹Ÿæ˜¯å·¨å¤§çš„å·¥ä½œé‡ã€‚

è¿™ä¸ªæ—¶å€™ä½ ä¼šæƒ³ï¼Œå¦‚æœæœ‰ä¸ªå®¹å™¨ç®¡ç†å·¥å…·å°±å¥½äº†ï¼Œåªè¦æŠŠéœ€è¦éƒ¨ç½²å¾®æœåŠ¡çš„å®¹å™¨äº‹å…ˆç¼–æ’å¥½ï¼Œéƒ¨ç½²çš„æ—¶å€™ä¸€é”®æ‰§è¡Œï¼Œç„¶åä½ çš„åº”ç”¨å°±å¯ä»¥æŒ‰ç…§é¢„æœŸç›´æ¥è®¿é—®ï¼Œè¿™è¯¥æœ‰å¤šè½»æ¾å‘€ã€‚å¯¹ï¼ŒKubernetes å°±èƒ½æ»¡è¶³ä½ çš„éœ€æ±‚ã€‚

> åº”ç”¨ã€ä¸šåŠ¡åº”ç”¨ã€åº”ç”¨ç¨‹åºåœ¨æœ¬è¯¾ç¨‹ä¸­æ˜¯åŒæ ·çš„æ„æ€ï¼Œå°±æ˜¯ç ”å‘å¼€å‘å‡ºæ¥çš„ä¸€ä¸ªè½¯ä»¶ç³»ç»Ÿï¼Œæœ€ç»ˆæä¾›ç»™ç”¨æˆ·è®¿é—®ä½¿ç”¨ã€‚  
> å¾®æœåŠ¡æ¶æ„æ˜¯æŒ‡ä½ çš„åº”ç”¨å¯èƒ½æ‹†åˆ†æˆäº†å¤šä¸ªå­åº”ç”¨ï¼Œæ¯ä¸ªå­åº”ç”¨å®ç°äº†ä¸€éƒ¨åˆ†ä¸šåŠ¡åŠŸèƒ½ï¼Œè¿™äº›å­åº”ç”¨å°±æ˜¯ä¸€ä¸ªä¸ªå¾®æœåŠ¡ï¼Œè¿™äº›å¾®æœåŠ¡ç‹¬ç«‹æ‰“åŒ…é•œåƒå’Œéƒ¨ç½²ã€‚

## è®¤è¯† K8s

KubernetesÂ è¿™ä¸ªåå­—æºäºå¸Œè…Šè¯­ï¼Œæ„æ€ä¸ºâ€œèˆµæ‰‹â€ã€‚K8s è¿™ä¸ªç¼©å†™æ˜¯å› ä¸º K å’Œ s ä¹‹é—´æœ‰8ä¸ªå­—ç¬¦çš„å…³ç³»ï¼ˆåé¢çš„è¯¾ç¨‹æˆ‘ä¼šä½¿ç”¨ K8s è¿™ä¸ªç¼©å†™ä»£æ›¿ Kubernetesï¼‰ã€‚å®ƒæ˜¯ä¸€ä¸ªå¼€æºçš„å®¹å™¨ç¼–æ’å¹³å°ï¼Œç”¨äºè‡ªåŠ¨éƒ¨ç½²ã€æ‰©å±•å’Œç®¡ç†å¤§è§„æ¨¡å®¹å™¨åŒ–åº”ç”¨ã€‚K8s æœ€åˆç”± Google è®¾è®¡å¹¶æèµ ç»™äº‘åŸç”Ÿè®¡ç®—åŸºé‡‘ä¼šï¼ˆCNCFï¼ŒCloud Native Computing Foundationï¼‰æ¥ç»´æŠ¤ï¼Œæ‰€ä»¥ CKA è¯ä¹¦ä¹Ÿæ˜¯ç”± CNCF ç»„ç»‡é¢å‘ã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ13ï¼‰</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/11/04/60/64d166b6.jpg" width="30px"><span>Fan</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è¯·é—®ä¸‹å®‰è£…ç½‘ç»œæ’ä»¶ï¼Œåªéœ€è¦åœ¨Master èŠ‚ç‚¹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿˜æ˜¯éœ€è¦åœ¨æ‰€æœ‰çš„èŠ‚ç‚¹ä¸Šéƒ½æ‰§è¡Œå‘¢ï¼Ÿè°¢è°¢ã€‚
kubectl apply -f calico.yaml</div>2024-07-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/57/6e/b6795c44.jpg" width="30px"><span>å¤œç©ºä¸­æœ€äº®çš„æ˜Ÿ</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>â€œ3 å°æœåŠ¡å™¨ä¸Šéƒ½éœ€è¦å®‰è£… kubeadmã€kubelet å’Œ kubectl è¿™ä¸‰ä¸ªå·¥å…·ã€‚â€ nodeèŠ‚ç‚¹ä¸æ˜¯å¿…é¡»å®‰è£… kubectl ã€‚å†…å®¹å’Œå…¶ä»–ä¸“æ é‡å¤çš„å¤ªå¤šäº†ã€‚æ¢ä¸ªè§’åº¦æ¥ç»„ç»‡ä¸“æ ï¼Œæœ€æœ‰å¸å¼•åŠ›çš„æ˜¯è€ƒè¯•ç¯‡3è®²ï¼Œä¸å¦‚ä»è€ƒè¯•é¢˜çš„è§’åº¦åˆ‡å…¥ï¼Œä»é¢˜åæ¨k8sçŸ¥è¯†ç‚¹ï¼Œå±•å¼€è®²è§£ï¼Œå¹¶åŠ ä¸Šç­”é¢˜æŠ€å·§å’Œæ³¨æ„äº‹é¡¹ã€‚</div>2024-07-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/ff/28/040f6f01.jpg" width="30px"><span>Y</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æˆåŠŸäº†ã€‚è¢«Calico éƒ¨ç½²å¡äº†å¥½ä¹…ï¼Œä¸€ç›´å¤±è´¥ã€‚æŠŠcalico.yamlæ–‡ä»¶ä¸­çš„&quot;dcoker.io&quot;å…¨éƒ¨æ›¿æ¢æˆ&quot;swr.cn-north-4.myhuaweicloud.com&#47;ddn-k8s&#47;docker.io&quot; ã€‚å¯ä»¥å®‰è£…æˆåŠŸ</div>2024-07-09</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIyNIia6IFvSwtvZLa9jMFuvTGCuyRTFiavshEmaLe0PBFZHdw8OnxibFe50HgXs1JCqFQymPUXqrJIA/132" width="30px"><span>Geek_042e8a</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ç”¨çš„ç¦»çº¿åŒ…å®‰è£…çš„calicoï¼ŒæŒ‰ç…§æ­¥éª¤æ“ä½œï¼Œè¿˜æ˜¯æœ‰é—®é¢˜ï¼Œç¦»çº¿é•œåƒéƒ½å·²ç»å¯¼å…¥äº†
Failed to pull image &quot;docker.io&#47;calico&#47;pod2daemon-flexvol:v3.25.1&quot;: failed to pull and unpack image &quot;docker.io&#47;calico&#47;pod2daemon-flexvol:v3.25.1&quot;: failed to copy: httpReadSeeker: failed open: failed to do request: Get &quot;https:&#47;&#47;production.cloudflare.docker.com&#47;registry-v2&#47;docker&#47;registry&#47;v2&#47;blobs&#47;sha256&#47;95&#47;958f4d5195504adfd95a02db97af7c6649f23aa9ab20d83230d957fe1eaafecc&#47;data?verify=1724405801-f122Q6NBeSTcxIgJdLmxQQ%2FlyyY%3D&quot;: dial tcp [2a03:2880:f136:83:face:b00c:0:25de]:443: connect: network is unreachable
</div>2024-08-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/3c/48/ca/eb136302.jpg" width="30px"><span>20æ¸…æ™¨</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>è€å¸ˆæ‚¨å¥½ï¼ŒworkèŠ‚ç‚¹æ‰§è¡Œkubeadm joinæ—¶ï¼Œä¸€ç›´å¡åœ¨[preflight] Running pre-flight checkså¦‚ä½•è§£å†³ï¼ŸåŒæ­¥æ—¶é—´è¯•è¿‡äº†</div>2024-08-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/56/03/81141019.jpg" width="30px"><span>æ„Ÿå†’ç—…æ¯’</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>work åŠ å…¥é›†ç¾¤çš„æ—¶å€™æŠ¥         [ERROR SystemVerification]: missing required cgroups: pidsï¼Œæ˜¯è¦å‡çº§ç³»ç»Ÿå†…æ ¸ç‰ˆæœ¬å—?</div>2024-07-31</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/UWDBUEsDLIKpeIujPLsrRG9l0cFhWlXB9CcaOpNKrOdhDAia6PialmJZ4MQgYtBpDdu58leIDDlsOxaZsRvknZZA/132" width="30px"><span>Geek_cc0645</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è¯·é—®ä¸‹å®‰è£…calicoä¸­æŠ¥é”™ï¼ŒReadiness probe failed: calico&#47;node is not ready: BIRD is not ready: Error querying BIRD: unable to connect to BIRDv4 socket: dial unix &#47;var&#47;run&#47;calico&#47;bird.ctl: connect: connection refusedï¼Œè¿™ä¸ªæ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„</div>2024-07-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/8a/6f/3d4f7e31.jpg" width="30px"><span>å¨„æ±Ÿå›½</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>å®‰è£…k8sé›†ç¾¤ï¼Œå¯¹linuxç‰ˆæœ¬æœ‰ä»€ä¹ˆè¦æ±‚ï¼Ÿ</div>2024-07-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/32/c2/ffa6c819.jpg" width="30px"><span>å†°å†»æŸ æª¬</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>è€å¸ˆå¯ä»¥è®²è®²æ€ä¹ˆå®‰è£…å¤šmasterèŠ‚ç‚¹çš„é›†ç¾¤å—ï¼Ÿ</div>2024-07-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/21/9a/114015aa.jpg" width="30px"><span>jay</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è¯·é—®ä½¿ç”¨ç¦»çº¿å¯¼å…¥çš„calicoåŒ…ï¼Œä¸ºä»€ä¹ˆä¸éœ€è¦ä¿®æ”¹CALICO_IPV4POOL_CIDRï¼Ÿ åœ¨å¯¼å…¥çš„ä¸¤ä¸ªyamlä¸­æ²¡æœ‰çœ‹åˆ°è¿™ä¸ªå­—æ®µ</div>2024-07-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/7b/4b/95812b15.jpg" width="30px"><span>æŠ±ç´§æˆ‘çš„å°é²¤é±¼</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>```shell
kubectl apply -f tigera-operator.yaml --server-side
kubectl apply -f custom-resources.yaml
```

è¿™ä¸¤ä¸ªæ˜¯åšä»€ä¹ˆç”¨çš„å‘¢</div>2024-07-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/7a/93/c9302518.jpg" width="30px"><span>é«˜å¿—å¼º</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>kubectl apply -f calico.yaml æ‰§è¡ŒæˆåŠŸä»¥åï¼Œkubectl get node è¿˜æ˜¯NotReadyç­‰äº†å¾ˆä¹…ä¾ç„¶æ˜¯ã€‚
kubectl describe pod coredns-66f779496c-m2qwx -n kube-system æ‰§è¡Œè¿™ä¸ªå‘½ä»¤åè¾“å‡ºï¼Œ
Warning  FailedScheduling  2m23s (x4 over 17m)  default-scheduler  0&#47;3 nodes are available: 3 node(s) had untolerated taint {node.kubernetes.io&#47;not-ready: }. preemption: 0&#47;3 nodes are available: 3 Preemption is not helpful for scheduling.. è¯·è€å¸ˆæŒ‡ç‚¹</div>2025-02-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/7a/93/c9302518.jpg" width="30px"><span>é«˜å¿—å¼º</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>kubeadm join 192.168.137.2:6443 --token 0rnts4.wh2rlfqnfv9p2vj2 \
        --discovery-token-ca-cert-hash sha256:9e0d64f553d41e9bffe439c4ee284c7bdcb50e638edd5f6a07a19739afb8928f

æ‰§è¡Œå®Œä»¥åæŠ¥é”™å¦‚ä¸‹ï¼Œè¯·é—®è€å¸ˆæœ‰åŠæ³•å¤„ç†ä¹ˆ
Found multiple CRI endpoints on the host. Please define which one do you wish to use by setting the &#39;criSocket&#39; field in the kubeadm configuration file: unix:&#47;&#47;&#47;var&#47;run&#47;containerd&#47;containerd.sock, unix:&#47;&#47;&#47;var&#47;run&#47;cri-dockerd.sock
To see the stack trace of this error execute with --v=5 or higher</div>2025-02-09</li><br/>
</ul>