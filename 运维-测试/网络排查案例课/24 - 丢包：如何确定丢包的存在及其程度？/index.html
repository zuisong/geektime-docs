<!--geek time docs 🚀, MIT license-->


<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="极客时间文档">
      
      
        <meta name="author" content="zkep">
      
      
        <link rel="canonical" href="https://github.com/uaxe/geektime-docs/%E8%BF%90%E7%BB%B4-%E6%B5%8B%E8%AF%95/%E7%BD%91%E7%BB%9C%E6%8E%92%E6%9F%A5%E6%A1%88%E4%BE%8B%E8%AF%BE/24%20-%20%E4%B8%A2%E5%8C%85%EF%BC%9A%E5%A6%82%E4%BD%95%E7%A1%AE%E5%AE%9A%E4%B8%A2%E5%8C%85%E7%9A%84%E5%AD%98%E5%9C%A8%E5%8F%8A%E5%85%B6%E7%A8%8B%E5%BA%A6%EF%BC%9F/">
      
      
        <link rel="prev" href="../23%20-%20%E8%B7%AF%E5%BE%84%E6%8E%92%E6%9F%A5%EF%BC%9A%E6%B2%A1%E6%9C%89%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%9D%83%E9%99%90%E8%A6%81%E5%A6%82%E4%BD%95%E5%81%9A%E6%8E%92%E6%9F%A5%EF%BC%9F/">
      
      
        <link rel="next" href="../%E4%B8%8D%E5%AE%9A%E6%9C%9F%E5%8A%A0%E9%A4%90%EF%BC%88%E4%B8%80%EF%BC%89%20-%20%E5%85%AB%E4%BB%99%E8%BF%87%E6%B5%B7%EF%BC%8C%E5%90%84%E6%98%BE%E7%A5%9E%E9%80%9A%EF%BC%9A%E9%80%8F%E4%BC%A0%E7%9C%9F%E5%AE%9E%E6%BA%90IP%E7%9A%84%E5%90%84%E7%A7%8D%E6%96%B9%E6%B3%95/">
      
      
      <link rel="icon" href="../../../None">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.5">
    
    
      
        <title>24 丢包：如何确定丢包的存在及其程度？ - 极客时间文档</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/style.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            


          </div>
          
        </aside>
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="极客时间文档" class="md-header__button md-logo" aria-label="极客时间文档" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            极客时间文档
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              24   丢包：如何确定丢包的存在及其程度？
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/zkep/mygeektime" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    zkep/mygeektime
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../AI-%E5%A4%A7%E6%95%B0%E6%8D%AE/" class="md-tabs__link">
          
  
    
  
  AI-大数据

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E4%BA%A7%E5%93%81-%E8%BF%90%E8%90%A5/" class="md-tabs__link">
          
  
    
  
  产品-运营

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E5%89%8D%E7%AB%AF-%E7%A7%BB%E5%8A%A8/" class="md-tabs__link">
          
  
    
  
  前端-移动

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E5%90%8E%E7%AB%AF-%E6%9E%B6%E6%9E%84/" class="md-tabs__link">
          
  
    
  
  后端-架构

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E7%AE%A1%E7%90%86-%E6%88%90%E9%95%BF/" class="md-tabs__link">
          
  
    
  
  管理-成长

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" class="md-tabs__link">
          
  
    
  
  计算机基础

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
    
  
  运维-测试

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="极客时间文档" class="md-nav__button md-logo" aria-label="极客时间文档" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    极客时间文档
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/zkep/mygeektime" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    zkep/mygeektime
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../AI-%E5%A4%A7%E6%95%B0%E6%8D%AE/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    AI-大数据
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../%E4%BA%A7%E5%93%81-%E8%BF%90%E8%90%A5/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    产品-运营
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../%E5%89%8D%E7%AB%AF-%E7%A7%BB%E5%8A%A8/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    前端-移动
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../%E5%90%8E%E7%AB%AF-%E6%9E%B6%E6%9E%84/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    后端-架构
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../%E7%AE%A1%E7%90%86-%E6%88%90%E9%95%BF/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    管理-成长
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    计算机基础
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    运维-测试
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            运维-测试
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../AI%E9%87%8D%E5%A1%91%E4%BA%91%E5%8E%9F%E7%94%9F%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/AI%E9%87%8D%E5%A1%91%E4%BA%91%E5%8E%9F%E7%94%9F%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    AI重塑云原生应用开发实战
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../DevOps%E5%AE%9E%E6%88%98%E7%AC%94%E8%AE%B0/DevOps%E5%AE%9E%E6%88%98%E7%AC%94%E8%AE%B0/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    DevOps实战笔记
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../Kubernetes%E5%85%A5%E9%97%A8%E5%AE%9E%E6%88%98%E8%AF%BE/Kubernetes%E5%85%A5%E9%97%A8%E5%AE%9E%E6%88%98%E8%AF%BE/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Kubernetes入门实战课
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../Linux%E5%86%85%E6%A0%B8%E6%8A%80%E6%9C%AF%E5%AE%9E%E6%88%98%E8%AF%BE/Linux%E5%86%85%E6%A0%B8%E6%8A%80%E6%9C%AF%E5%AE%9E%E6%88%98%E8%AF%BE/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Linux内核技术实战课
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../Linux%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98/Linux%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Linux性能优化实战
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../SRE%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C/SRE%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    SRE实战手册
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../SRE%E5%AE%9E%E8%B7%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E5%8F%AF%E9%9D%A0%E6%80%A7%E6%A1%88%E4%BE%8B%E8%AF%BE/SRE%E5%AE%9E%E8%B7%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E5%8F%AF%E9%9D%A0%E6%80%A7%E6%A1%88%E4%BE%8B%E8%AF%BE/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    SRE实践：服务可靠性案例课
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../Serverless%E8%BF%9B%E9%98%B6%E5%AE%9E%E6%88%98%E8%AF%BE/Serverless%E8%BF%9B%E9%98%B6%E5%AE%9E%E6%88%98%E8%AF%BE/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Serverless进阶实战课
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../Web%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E5%AE%9E%E6%88%98/Web%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E5%AE%9E%E6%88%98/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Web漏洞挖掘实战
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../eBPF%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%AE%9E%E6%88%98/eBPF%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%AE%9E%E6%88%98/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    eBPF核心技术与实战
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E4%BA%91%E5%8E%9F%E7%94%9F%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E5%AE%9E%E6%88%98%E8%AF%BE/%E4%BA%91%E5%8E%9F%E7%94%9F%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E5%AE%9E%E6%88%98%E8%AF%BE/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    云原生基础架构实战课
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E5%8F%8D%E7%88%AC%E8%99%AB%E5%85%B5%E6%B3%95%E6%BC%94%E7%BB%8E20%E8%AE%B2/%E5%8F%8D%E7%88%AC%E8%99%AB%E5%85%B5%E6%B3%95%E6%BC%94%E7%BB%8E20%E8%AE%B2/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    反爬虫兵法演绎20讲
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2%E6%8A%80%E8%83%BD30%E8%AE%B2/%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2%E6%8A%80%E8%83%BD30%E8%AE%B2/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    安全攻防技能30讲
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E5%AE%B9%E5%99%A8%E5%AE%9E%E6%88%98%E9%AB%98%E6%89%8B%E8%AF%BE/%E5%AE%B9%E5%99%A8%E5%AE%9E%E6%88%98%E9%AB%98%E6%89%8B%E8%AF%BE/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    容器实战高手课
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E9%AB%98%E6%89%8B%E8%AF%BE/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E9%AB%98%E6%89%8B%E8%AF%BE/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    性能优化高手课
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E5%AE%9E%E6%88%9830%E8%AE%B2/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E5%AE%9E%E6%88%9830%E8%AE%B2/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    性能测试实战30讲
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E6%8C%81%E7%BB%AD%E4%BA%A4%E4%BB%9836%E8%AE%B2/%E6%8C%81%E7%BB%AD%E4%BA%A4%E4%BB%9836%E8%AE%B2/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    持续交付36讲
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95%E5%85%A5%E9%97%A8%E8%AF%BE/%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95%E5%85%A5%E9%97%A8%E8%AF%BE/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    接口测试入门课
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90Kubernetes/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90Kubernetes/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    深入剖析Kubernetes
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA%E4%BA%91%E8%AE%A1%E7%AE%97/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA%E4%BA%91%E8%AE%A1%E7%AE%97/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    深入浅出云计算
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E6%B5%8B%E8%AF%95%E8%AF%BE/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E6%B5%8B%E8%AF%95%E8%AF%BE/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    程序员的测试课
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_23" checked>
        
          
          <label class="md-nav__link" for="__nav_7_23" id="__nav_7_23_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    网络排查案例课
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_23_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7_23">
            <span class="md-nav__icon md-icon"></span>
            网络排查案例课
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%BD%91%E7%BB%9C%E6%8E%92%E6%9F%A5%E6%A1%88%E4%BE%8B%E8%AF%BE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    网络排查案例课
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%BC%80%E7%AF%87%E8%AF%8D%20-%20%E7%BD%91%E7%BB%9C%E6%8E%92%E6%9F%A5%E6%98%AF%E5%B7%A5%E7%A8%8B%E5%B8%88%E7%9A%84%E5%BF%85%E5%A4%87%E8%83%BD%E5%8A%9B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    开篇词   网络排查是工程师的必备能力
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01%20-%20%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%9E%8B%E5%92%8C%E5%B7%A5%E5%85%B7%EF%BC%9A%E7%BD%91%E7%BB%9C%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%88%86%E5%B1%82%EF%BC%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01   网络模型和工具：网络为什么要分层？
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02%20-%20%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90%E6%8A%80%E6%9C%AF%E5%88%9D%E6%8E%A2%EF%BC%9A%E4%BD%A0%E4%BC%9A%E7%94%A8tcpdump%E5%92%8CWireshark%E5%90%97%EF%BC%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    02   抓包分析技术初探：你会用tcpdump和Wireshark吗？
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03%20-%20%E6%8F%A1%E6%89%8B%EF%BC%9ATCP%E8%BF%9E%E6%8E%A5%E9%83%BD%E6%98%AF%E7%94%A8TCP%E5%8D%8F%E8%AE%AE%E6%B2%9F%E9%80%9A%E7%9A%84%E5%90%97%EF%BC%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    03   握手：TCP连接都是用TCP协议沟通的吗？
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04%20-%20%E6%8C%A5%E6%89%8B%EF%BC%9ANginx%E6%97%A5%E5%BF%97%E6%8A%A5connection%20reset%20by%20peer%E6%98%AF%E6%80%8E%E4%B9%88%E5%9B%9E%E4%BA%8B%EF%BC%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    04   挥手：Nginx日志报connection reset by peer是怎么回事？
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05%20-%20%E5%AE%9A%E4%BD%8D%E9%98%B2%E7%81%AB%E5%A2%99%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E4%BC%A0%E8%BE%93%E5%B1%82%E7%9A%84%E5%AF%B9%E6%AF%94%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    05   定位防火墙（一）：传输层的对比分析
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AD%94%E7%96%91%EF%BC%88%E4%B8%80%EF%BC%89-%20%E7%AC%AC1~5%E8%AE%B2%E6%80%9D%E8%80%83%E9%A2%98%E7%AD%94%E6%A1%88/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    答疑（一）  第1~5讲思考题答案
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06%20-%20%E5%AE%9A%E4%BD%8D%E9%98%B2%E7%81%AB%E5%A2%99%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E7%BD%91%E7%BB%9C%E5%B1%82%E7%9A%84%E7%B2%BE%E7%A1%AE%E6%89%93%E5%87%BB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    06   定位防火墙（二）：网络层的精确打击
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07%20-%20%E4%BF%9D%E6%B4%BB%E6%9C%BA%E5%88%B6%EF%BC%9A%E5%BF%83%E8%B7%B3%E5%8C%85%E5%BC%82%E5%B8%B8%E5%AF%BC%E8%87%B4%E5%BA%94%E7%94%A8%E9%87%8D%E5%90%AF%EF%BC%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    07   保活机制：心跳包异常导致应用重启？
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08%20-%20%E5%88%86%E6%AE%B5%EF%BC%9AMTU%E5%BC%95%E5%8F%91%E7%9A%84%E8%A1%80%E6%A1%88/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    08   分段：MTU引发的血案
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09%20-%20%E9%95%BF%E8%82%A5%E7%AE%A1%E9%81%93%EF%BC%9A%E4%B8%BA%E4%BD%95%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E9%80%9F%E5%BA%A6%E8%BF%99%E4%B9%88%E6%85%A2%EF%BC%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    09   长肥管道：为何文件传输速度这么慢？
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10%20-%20%E7%AA%97%E5%8F%A3%EF%BC%9ATCP%20Window%20Full%E4%BC%9A%E5%BD%B1%E5%93%8D%E4%BC%A0%E8%BE%93%E6%95%88%E7%8E%87%E5%90%97%EF%BC%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10   窗口：TCP Window Full会影响传输效率吗？
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AD%94%E7%96%91%EF%BC%88%E4%BA%8C%EF%BC%89-%20%E7%AC%AC6~10%E8%AE%B2%E6%80%9D%E8%80%83%E9%A2%98%E7%AD%94%E6%A1%88/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    答疑（二）  第6~10讲思考题答案
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11%20-%20%E6%8B%A5%E5%A1%9E%EF%BC%9ATCP%E6%98%AF%E5%A6%82%E4%BD%95%E6%8E%A2%E6%B5%8B%E5%88%B0%E6%8B%A5%E5%A1%9E%E7%9A%84%EF%BC%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11   拥塞：TCP是如何探测到拥塞的？
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../12%20-%20%E9%87%8D%E4%BC%A0%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E9%87%8D%E4%BC%A0%E5%88%B0%E5%BA%95%E6%98%AF%E6%80%8E%E4%B9%88%E5%9B%9E%E4%BA%8B%EF%BC%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    12   重传的认识：重传到底是怎么回事？
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../13%20-%20%E9%87%8D%E4%BC%A0%E7%9A%84%E5%86%8D%E8%AE%A4%E8%AF%86%EF%BC%9A%E6%B2%A1%E6%9C%89%E4%BB%BB%E4%BD%95%E4%B8%A2%E5%8C%85%E5%8D%B4%E4%B9%9F%E4%B8%80%E7%9B%B4%E9%87%8D%E4%BC%A0%EF%BC%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    13   重传的再认识：没有任何丢包却也一直重传？
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../14%20-%20%E5%AE%89%E5%85%A8%EF%BC%9A%E7%94%A8Wireshark%E6%8A%8ADDoS%E6%94%BB%E5%87%BB%E7%85%A7%E5%87%BA%E5%8E%9F%E5%BD%A2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    14   安全：用Wireshark把DDoS攻击照出原形
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E6%98%A5%E8%8A%82%E7%89%B9%E5%88%AB%E6%94%BE%E9%80%81%EF%BC%88%E4%B8%80%EF%BC%89-%20%E4%B9%A6%E5%8D%95%E6%8E%A8%E8%8D%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    春节特别放送（一）  书单推荐
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E6%98%A5%E8%8A%82%E7%89%B9%E5%88%AB%E6%94%BE%E9%80%81%EF%BC%88%E4%BA%8C%EF%BC%89-%20%E8%81%8A%E8%81%8A%E8%83%BD%E5%8A%9B%E9%99%B7%E9%98%B1%E5%92%8C%E7%BB%88%E8%BA%AB%E5%AD%A6%E4%B9%A0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    春节特别放送（二）  聊聊能力陷阱和终身学习
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E6%98%A5%E8%8A%82%E7%89%B9%E5%88%AB%E6%94%BE%E9%80%81%EF%BC%88%E4%B8%89%EF%BC%89-%20%E6%88%91%E7%9A%84%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%96%99%E5%92%8C%E5%B7%A5%E5%85%B7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    春节特别放送（三）  我的学习资料和工具
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E6%98%A5%E8%8A%82%E7%89%B9%E5%88%AB%E6%94%BE%E9%80%81%EF%BC%88%E5%9B%9B%EF%BC%89-%20%E6%B5%8B%E4%B8%80%E6%B5%8B%E4%BD%A0%E7%9A%84%E7%BD%91%E7%BB%9C%E6%8E%92%E6%9F%A5%E8%83%BD%E5%8A%9B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    春节特别放送（四）  测一测你的网络排查能力
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../15%20-%20Nginx%E7%9A%84499%E7%8A%B6%E6%80%81%E7%A0%81%E6%98%AF%E6%80%8E%E4%B9%88%E5%9B%9E%E4%BA%8B%EF%BC%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    15   Nginx的499状态码是怎么回事？
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AD%94%E7%96%91%EF%BC%88%E4%B8%89%EF%BC%89-%20%E7%AC%AC11~15%E8%AE%B2%E6%80%9D%E8%80%83%E9%A2%98%E7%AD%94%E6%A1%88/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    答疑（三）  第11~15讲思考题答案
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../16%20-%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%BA%E4%BB%80%E4%B9%88%E5%9B%9E%E5%A4%8DHTTP%20400%EF%BC%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    16   服务器为什么回复HTTP 400？
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../17%20-%20%E4%B8%BA%E4%BB%80%E4%B9%88%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E9%87%8C%E5%A4%9A%E9%80%89%E4%B8%80%E4%B8%AA%E5%9F%8E%E5%B8%82%E5%B0%B1%E6%8A%A5%E9%94%99%EF%BC%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    17   为什么前端页面里多选一个城市就报错？
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../18%20-%20%E5%81%B6%E5%8F%91%E6%80%A7%E9%97%AE%E9%A2%98%E5%A6%82%E4%BD%95%E6%8E%92%E6%9F%A5%EF%BC%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    18   偶发性问题如何排查？
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../19%20-%20TLS%E7%9A%84%E5%90%84%E7%A7%8D%E7%89%B9%E6%80%A7%EF%BC%9ATLS%E6%8F%A1%E6%89%8B%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BC%9A%E5%A4%B1%E8%B4%A5%EF%BC%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    19   TLS的各种特性：TLS握手为什么会失败？
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20%20-%20TLS%E5%8A%A0%E8%A7%A3%E5%AF%86%EF%BC%9A%E5%A6%82%E4%BD%95%E8%A7%A3%E5%AF%86HTTPS%E6%B5%81%E9%87%8F%EF%BC%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    20   TLS加解密：如何解密HTTPS流量？
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AD%94%E7%96%91%EF%BC%88%E5%9B%9B%EF%BC%89-%20%E7%AC%AC16~20%E8%AE%B2%E6%80%9D%E8%80%83%E9%A2%98%E7%AD%94%E6%A1%88/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    答疑（四）  第16~20讲思考题答案
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21%20-%20%E4%B8%BA%E4%BB%80%E4%B9%88%E7%94%A8%E4%BA%86%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E6%9B%B4%E5%8A%A0%E4%B8%8D%E5%9D%87%E8%A1%A1%EF%BC%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    21   为什么用了负载均衡更加不均衡？
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22%20-%20%E4%B8%BA%E4%BB%80%E4%B9%88%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95TPS%E6%80%BB%E6%98%AF%E4%B8%8A%E4%B8%8D%E5%8E%BB%EF%BC%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    22   为什么压力测试TPS总是上不去？
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23%20-%20%E8%B7%AF%E5%BE%84%E6%8E%92%E6%9F%A5%EF%BC%9A%E6%B2%A1%E6%9C%89%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%9D%83%E9%99%90%E8%A6%81%E5%A6%82%E4%BD%95%E5%81%9A%E6%8E%92%E6%9F%A5%EF%BC%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    23   路径排查：没有网络设备权限要如何做排查？
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    24   丢包：如何确定丢包的存在及其程度？
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    24   丢包：如何确定丢包的存在及其程度？
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      路径排查工具概览
    </span>
  </a>
  
    <nav class="md-nav" aria-label="路径排查工具概览">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      探测类工具
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      统计类工具
    </span>
  </a>
  
    <nav class="md-nav" aria-label="统计类工具">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nstat" class="md-nav__link">
    <span class="md-ellipsis">
      nstat工具
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snmp" class="md-nav__link">
    <span class="md-ellipsis">
      内核的SNMP计数器
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      如何确定丢包位置和丢包率？
    </span>
  </a>
  
    <nav class="md-nav" aria-label="如何确定丢包位置和丢包率？">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#traceroutemtr" class="md-nav__link">
    <span class="md-ellipsis">
      traceroute和mtr的工作原理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mtr" class="md-nav__link">
    <span class="md-ellipsis">
      用mtr定位丢包点
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      为何中间节点丢包率更高？
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      如何解读中间节点的丢包率？
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mtu" class="md-nav__link">
    <span class="md-ellipsis">
      丢包与MTU
    </span>
  </a>
  
    <nav class="md-nav" aria-label="丢包与MTU">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pmtu" class="md-nav__link">
    <span class="md-ellipsis">
      快速探测PMTU的方法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      如何统计丢包率？
    </span>
  </a>
  
    <nav class="md-nav" aria-label="如何统计丢包率？">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      图形界面方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      命令行方法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      丢包多少算严重？
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      小结
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      思考题
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E4%B8%8D%E5%AE%9A%E6%9C%9F%E5%8A%A0%E9%A4%90%EF%BC%88%E4%B8%80%EF%BC%89%20-%20%E5%85%AB%E4%BB%99%E8%BF%87%E6%B5%B7%EF%BC%8C%E5%90%84%E6%98%BE%E7%A5%9E%E9%80%9A%EF%BC%9A%E9%80%8F%E4%BC%A0%E7%9C%9F%E5%AE%9E%E6%BA%90IP%E7%9A%84%E5%90%84%E7%A7%8D%E6%96%B9%E6%B3%95/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    不定期加餐（一）   八仙过海，各显神通：透传真实源IP的各种方法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%94%A8%E6%88%B7%E6%95%85%E4%BA%8B%20-%20%E5%B0%8FS%EF%BC%9A%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E8%B7%AF%E4%B8%8A%E7%94%9F%E7%94%9F%E4%B8%8D%E6%81%AF%E7%9A%84%E6%B4%BB%E6%B3%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    用户故事   小S：学习是人生路上生生不息的活泉
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%94%A8%E6%88%B7%E6%95%85%E4%BA%8B%20-%20%E7%8E%8B%E6%9C%AA%EF%BC%9A%E7%BD%91%E7%BB%9C%E6%8E%92%E6%9F%A5%E8%83%BD%E5%8A%9B%E6%98%AF%E4%B8%80%E5%90%8D%E5%90%88%E6%A0%BC%E8%BF%90%E7%BB%B4%E5%B7%A5%E7%A8%8B%E5%B8%88%E7%9A%84%E5%BF%85%E5%A4%87%E6%8A%80%E8%83%BD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    用户故事   王未：网络排查能力是一名合格运维工程师的必备技能
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../25%20-%20%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90%E7%9A%84%E5%9B%9E%E9%A1%BE%E3%80%81%E6%8B%BE%E9%81%97%EF%BC%8C%E5%92%8C%E6%8F%90%E9%AB%98/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    25   抓包分析的回顾、拾遗，和提高
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%BB%93%E6%9D%9F%E8%AF%AD%20-%20%E7%8F%8D%E6%83%9C%E6%8F%A1%E6%89%8B%EF%BC%8C%E9%9A%BE%E8%AF%B4%E5%86%8D%E8%A7%81/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    结束语   珍惜握手，难说再见
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%BB%93%E8%AF%BE%E6%B5%8B%E8%AF%95%20-%20%E2%80%9C%E7%BD%91%E7%BB%9C%E6%8E%92%E6%9F%A5%E6%A1%88%E4%BE%8B%E8%AF%BE%E2%80%9D100%E5%88%86%E8%AF%95%E5%8D%B7%E7%AD%89%E4%BD%A0%E6%9D%A5%E6%8C%91%E6%88%98%EF%BC%81/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    结课测试   “网络排查案例课”100分试卷等你来挑战！
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95%E9%AB%98%E6%89%8B%E8%AF%BE/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95%E9%AB%98%E6%89%8B%E8%AF%BE/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    自动化测试高手课
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E8%AF%B4%E9%80%8F%E6%95%8F%E6%8D%B7/%E8%AF%B4%E9%80%8F%E6%95%8F%E6%8D%B7/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    说透敏捷
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E8%B5%B5%E6%88%90%E7%9A%84%E8%BF%90%E7%BB%B4%E4%BD%93%E7%B3%BB%E7%AE%A1%E7%90%86%E8%AF%BE/%E8%B5%B5%E6%88%90%E7%9A%84%E8%BF%90%E7%BB%B4%E4%BD%93%E7%B3%BB%E7%AE%A1%E7%90%86%E8%AF%BE/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    赵成的运维体系管理课
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%9552%E8%AE%B2/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%9552%E8%AE%B2/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    软件测试52讲
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E8%BF%90%E7%BB%B4%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F%E5%AE%9E%E6%88%98%E7%AC%94%E8%AE%B0/%E8%BF%90%E7%BB%B4%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F%E5%AE%9E%E6%88%98%E7%AC%94%E8%AE%B0/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    运维监控系统实战笔记
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E9%9B%B6%E5%9F%BA%E7%A1%80%E6%8B%BF%E4%B8%8B%E4%BA%91%E5%8E%9F%E7%94%9FCKA%E8%AE%A4%E8%AF%81/%E9%9B%B6%E5%9F%BA%E7%A1%80%E6%8B%BF%E4%B8%8B%E4%BA%91%E5%8E%9F%E7%94%9FCKA%E8%AE%A4%E8%AF%81/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    零基础拿下云原生CKA认证
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E9%AB%98%E6%A5%BC%E7%9A%84%E6%80%A7%E8%83%BD%E5%B7%A5%E7%A8%8B%E5%AE%9E%E6%88%98%E8%AF%BE/%E9%AB%98%E6%A5%BC%E7%9A%84%E6%80%A7%E8%83%BD%E5%B7%A5%E7%A8%8B%E5%AE%9E%E6%88%98%E8%AF%BE/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    高楼的性能工程实战课
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      路径排查工具概览
    </span>
  </a>
  
    <nav class="md-nav" aria-label="路径排查工具概览">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      探测类工具
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      统计类工具
    </span>
  </a>
  
    <nav class="md-nav" aria-label="统计类工具">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nstat" class="md-nav__link">
    <span class="md-ellipsis">
      nstat工具
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snmp" class="md-nav__link">
    <span class="md-ellipsis">
      内核的SNMP计数器
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      如何确定丢包位置和丢包率？
    </span>
  </a>
  
    <nav class="md-nav" aria-label="如何确定丢包位置和丢包率？">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#traceroutemtr" class="md-nav__link">
    <span class="md-ellipsis">
      traceroute和mtr的工作原理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mtr" class="md-nav__link">
    <span class="md-ellipsis">
      用mtr定位丢包点
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      为何中间节点丢包率更高？
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      如何解读中间节点的丢包率？
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mtu" class="md-nav__link">
    <span class="md-ellipsis">
      丢包与MTU
    </span>
  </a>
  
    <nav class="md-nav" aria-label="丢包与MTU">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pmtu" class="md-nav__link">
    <span class="md-ellipsis">
      快速探测PMTU的方法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      如何统计丢包率？
    </span>
  </a>
  
    <nav class="md-nav" aria-label="如何统计丢包率？">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      图形界面方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      命令行方法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      丢包多少算严重？
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      小结
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      思考题
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>24   丢包：如何确定丢包的存在及其程度？</h1>

<p>你好，我是胜辉。</p>
<p>在上一讲里，我们回顾了一个网络路径排查的典型案例。我们是通过 <strong>nc工具</strong>发起不同源端口的连接，从而定位了ECMP路径中的问题。这个排查方法的背后，其实是我们对三层网络的深入理解和灵活应对。在这一类的网络排查中，我们都未必要上抓包分析这样的“重型武器”，只要场景合适，我们就可以用小工具达到大效果。</p>
<p>现在我们也知道了，这个案例的根因是ECMP路径中某个节点存在<strong>丢包</strong>。而丢包，也是网络排查中特别普遍的现象，特别是下面这三个问题：</p>
<ul>
<li>有没有丢包？</li>
<li>在哪里丢包？</li>
<li>丢包程度多严重？</li>
</ul>
<p>这三个问题的组合，就使得很多故障场景变得复杂。特别是当丢包情况不太明显的时候，问题表象就变得更加“神出鬼没”了。</p>
<p>所以在这一讲里，我们将会对“丢包”这个十分典型的问题场景进行一次深入的探讨。这样，下次你遇到丢包等问题的时候，就有很多种“兵器”，也知道在什么场景下使用它们，从而真正突破“丢包”这个难点了。</p>
<p>那么首先，在讨论丢包之前，我们要先对网络排查工具做一下总体的审视。</p>
<h2 id="_1">路径排查工具概览</h2>
<p>网络路径排查的工具有挺多，大体上可以分为两大类：探测类工具和统计类工具。</p>
<p>为什么要这么分呢？在我看来，网络信息的获取方式，大体上有动态和静态之分：</p>
<ul>
<li><strong>动态</strong>的信息在传输过程中体现，传输结束后就没有了。它获得的是通信两端在动态变化中的网络状况，所以我们需要做实时的探测，才能把这个动态的状态抓取下来。</li>
<li><strong>静态</strong>的信息在传输结束后依然存在，继续保存在通信端的系统中。它是通信端的网络信息的历史统计。我们只要通过运行统计类工具，就能把这种累计的信息读取出来了。</li>
</ul>
<p>所以下面，我们就先来看看这两类工具具体都包括了什么。</p>
<h3 id="_2">探测类工具</h3>
<p>探测类工具主要包括ping、traceroute、mtr、nc、telnet等，它们都是从一端发起，对另外一端发送探测报文，然后观测报文的丢失、乱序、时延等情况。</p>
<p>其中，ping、traceroute、mtr主要是利用ICMP或者UDP的特性，实现了<strong>对网络路径状况的检测</strong>。在接下来的课程中，我们会深入探讨traceroute和mtr的工作原理。</p>
<p>而nc和telnet，则主要是测试<strong>传输层连通性</strong>的，比较典型的场景就是探测TCP握手能否成功。有了这两个工具，我们不需要做tcpdump抓包，就可以检测出TCP端口是否可以连通了。</p>
<h3 id="_3">统计类工具</h3>
<p>统计类工具包括netstat、ss，这些工具都是在一端读取自己的历史统计值，而并不发送出探测报文。比如，我们可以通过netstat -s命令，看到很详细的传输层、网络层、数据链路层等的质量状况，包括报文丢失、重传、重置（RST）等情况的统计。比如下面这样：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># netstat -s</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>Ip:
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span>Forwarding:<span class="w"> </span><span class="m">1</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">    </span><span class="m">41406</span><span class="w"> </span>total<span class="w"> </span>packets<span class="w"> </span>received
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">    </span><span class="m">0</span><span class="w"> </span>forwarded
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">    </span><span class="m">0</span><span class="w"> </span>incoming<span class="w"> </span>packets<span class="w"> </span>discarded
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">    </span><span class="m">41406</span><span class="w"> </span>incoming<span class="w"> </span>packets<span class="w"> </span>delivered
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">    </span><span class="m">30976</span><span class="w"> </span>requests<span class="w"> </span>sent<span class="w"> </span>out
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>Icmp:
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">    </span><span class="m">16</span><span class="w"> </span>ICMP<span class="w"> </span>messages<span class="w"> </span>received
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="w">    </span><span class="m">0</span><span class="w"> </span>input<span class="w"> </span>ICMP<span class="w"> </span>message<span class="w"> </span>failed
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="w">    </span>ICMP<span class="w"> </span>input<span class="w"> </span>histogram:
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="w">        </span><span class="nb">echo</span><span class="w"> </span>replies:<span class="w"> </span><span class="m">16</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="w">    </span><span class="m">16</span><span class="w"> </span>ICMP<span class="w"> </span>messages<span class="w"> </span>sent
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="w">    </span><span class="m">0</span><span class="w"> </span>ICMP<span class="w"> </span>messages<span class="w"> </span>failed
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="w">    </span>ICMP<span class="w"> </span>output<span class="w"> </span>histogram:
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="w">        </span><span class="nb">echo</span><span class="w"> </span>requests:<span class="w"> </span><span class="m">16</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>IcmpMsg:
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="w">        </span>InType0:<span class="w"> </span><span class="m">16</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="w">        </span>OutType8:<span class="w"> </span><span class="m">16</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>Tcp:
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="w">    </span><span class="m">18</span><span class="w"> </span>active<span class="w"> </span>connection<span class="w"> </span>openings
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="w">    </span><span class="m">0</span><span class="w"> </span>passive<span class="w"> </span>connection<span class="w"> </span>openings
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="w">    </span><span class="m">0</span><span class="w"> </span>failed<span class="w"> </span>connection<span class="w"> </span>attempts
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="w">    </span><span class="m">1</span><span class="w"> </span>connection<span class="w"> </span>resets<span class="w"> </span>received
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="w">    </span><span class="m">2</span><span class="w"> </span>connections<span class="w"> </span>established
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="w">    </span><span class="m">41353</span><span class="w"> </span>segments<span class="w"> </span>received
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="w">    </span><span class="m">30924</span><span class="w"> </span>segments<span class="w"> </span>sent<span class="w"> </span>out
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="w">    </span><span class="m">0</span><span class="w"> </span>segments<span class="w"> </span>retransmitted
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="w">    </span><span class="m">0</span><span class="w"> </span>bad<span class="w"> </span>segments<span class="w"> </span>received
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="w">    </span><span class="m">0</span><span class="w"> </span>resets<span class="w"> </span>sent
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>Udp:
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="w">    </span><span class="m">37</span><span class="w"> </span>packets<span class="w"> </span>received
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="w">    </span><span class="m">0</span><span class="w"> </span>packets<span class="w"> </span>to<span class="w"> </span>unknown<span class="w"> </span>port<span class="w"> </span>received
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="w">    </span><span class="m">0</span><span class="w"> </span>packet<span class="w"> </span>receive<span class="w"> </span>errors
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="w">    </span><span class="m">37</span><span class="w"> </span>packets<span class="w"> </span>sent
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="w">    </span><span class="m">0</span><span class="w"> </span>receive<span class="w"> </span>buffer<span class="w"> </span>errors
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="w">    </span><span class="m">0</span><span class="w"> </span>send<span class="w"> </span>buffer<span class="w"> </span>errors
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>......
</code></pre></div>
<p>其中，跟丢包直接相关的是 <strong>segments retransmitted</strong> 这个指标，<strong>如果它一直在增长，那一般意味着网络上存在丢包</strong>，我们需要多加注意了。</p>
<p>当然，netstat命令是相对传统的命令，属于早已停止维护的net-tools工具集。新的工具集是iproute2，其中包括了ip、ss、nstat等命令。这些命令也可以读取到类似的网络统计信息。</p>
<p>不过，既然新老命令的功能类似，那为什么我们还要重复造这个轮子呢？</p>
<p>这其实是因为，netstat主要是通过/proc文件系统收集信息的，而ss主要通过netlink内核接口获取数据（有些信息也依然要从/proc中读取），这个netlink接口的效率要比/proc接口更高，所以ss能更快地返回数据。</p>
<p>另外，ss能获得的信息要比netstat更丰富。比如，ss就可以获取到socket option的信息，但netstat就做不到。</p>
<p>我们可以看一个例子。我在自己的Ubuntu容器里运行了这条命令：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>$<span class="w"> </span>ss<span class="w"> </span>-eit
</code></pre></div>
<p>就可以获取到很多netstat无法获取的信息：</p>
<p><img alt="图片" src="https://static001.geekbang.org/resource/image/07/8b/07c095c22467de0d73b982184c0db98b.jpg?wh=1464x244" /></p>
<p>我们可以挑几个信息展开一下。</p>
<ul>
<li><code>cubic</code>：这条TCP连接用的拥塞控制算法是cubic。</li>
<li><code>wscale:2,7</code>：这条TCP连接的两端的Window Scale分别是2和7。</li>
<li><code>cwnd:10</code>：这条TCP连接的拥塞窗口为10个MSS。</li>
</ul>
<p>如果你感到好奇：“ss是如何获取到这么多有用的信息的呢？”其实这个也不难。一个简单的办法就是使用<a href="https://time.geekbang.org/column/article/493040">第21讲</a>我们介绍的strace，然后就能观察到ss -eit拿到这些信息的具体过程了。</p>
<blockquote>
<p>其实，类似这样的细微的探究过程，都能不经意间不断深化我们的技术能力。</p>
</blockquote>
<h4 id="nstat">nstat工具</h4>
<p>我们还可以了解一下nstat这个工具。它跟ss一样，也是iproute2工具包里面的。nstat的一个特点是，如果不加参数，<strong>它每次运行时输出的数值，是从上一次被执行以来这些计数器的变化值</strong>。这就带来了一个挺明显的优势：我们不用像使用netstat那样，在两次输出值中找出变化量了，nstat输出的直接就是变化量。</p>
<p>首次运行nstat时，输出的就是全部计数器的值。第二次运行时，就只是发生变化的数值了，比如下面的nstat输出的就是变化的值：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>root@08d984197cfb:/#<span class="w"> </span>nstat
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="c1">#kernel</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>IpInReceives<span class="w">                    </span><span class="m">5</span><span class="w">                  </span><span class="m">0</span>.0
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>IpInDelivers<span class="w">                    </span><span class="m">5</span><span class="w">                  </span><span class="m">0</span>.0
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>IpOutRequests<span class="w">                   </span><span class="m">4</span><span class="w">                  </span><span class="m">0</span>.0
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>TcpEstabResets<span class="w">                  </span><span class="m">1</span><span class="w">                  </span><span class="m">0</span>.0
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>TcpInSegs<span class="w">                       </span><span class="m">5</span><span class="w">                  </span><span class="m">0</span>.0
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>TcpOutSegs<span class="w">                      </span><span class="m">4</span><span class="w">                  </span><span class="m">0</span>.0
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>TcpOutRsts<span class="w">                      </span><span class="m">3</span><span class="w">                  </span><span class="m">0</span>.0
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>IpExtInOctets<span class="w">                   </span><span class="m">336</span><span class="w">                </span><span class="m">0</span>.0
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>IpExtOutOctets<span class="w">                  </span><span class="m">160</span><span class="w">                </span><span class="m">0</span>.0
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>IpExtInNoECTPkts<span class="w">                </span><span class="m">5</span><span class="w">                  </span><span class="m">0</span>.0
</code></pre></div>
<p>当然，要查看全部值也是可以的，执行这条命令即可：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>nstat<span class="w"> </span>-a
</code></pre></div>
<p>nstat还有个功能是按JSON格式做输出，这有助于我们做自动化运维。做法是nstat命令加上<code>--json</code>参数：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>nstat<span class="w"> </span>--json
</code></pre></div>
<p>而既然netstat和ss都能读取到计数器的值，那么<strong>这些计数器本身又是如何产生的呢？</strong></p>
<h4 id="snmp">内核的SNMP计数器</h4>
<p>这些计数器的统计和更新其实都是Linux内核的行为。内核根据<a href="https://datatracker.ietf.org/doc/html/rfc1213">RFC1213</a>的标准，定义了IP、ICMP、TCP、UDP等协议相关的<a href="https://www.kernel.org/doc/html/latest/networking/snmp_counter.html">SNMP计数器</a>。在每次报文发送、接收、重传等行为发生时，都会往相应的计数器中更新数值。具体来说，这些计数器的定义在内核代码的include/linux/snmp.h文件中。</p>
<blockquote>
<p>补充：SNMP名义上是“简单网络管理协议”，其实名字叫“简单”的技术往往并不简单。事实上SNMP还是很庞大的，这里就不展开了。</p>
</blockquote>
<p>所以说，这些数值都不是netstat、nstat这些命令去“生成”的，而是内核早就准备好这些数据了，工具去完成读取就好了。</p>
<p><img alt="" src="https://static001.geekbang.org/resource/image/e7/b1/e77af0a0d27bfcf2a1790844bf4408b1.jpg?wh=2000x740" /></p>
<p>好了，讨论完各种工具，接下来我们就进入丢包这个核心话题。</p>
<h2 id="_4">如何确定丢包位置和丢包率？</h2>
<p>在丢包这个问题上，我们最关心的可能就是<strong>丢包在哪里、丢包率是多少</strong>这两个问题。这里我们重点使用的工具，是traceroute和mtr。</p>
<h3 id="traceroutemtr">traceroute和mtr的工作原理</h3>
<p>我们先说traceroute。其实在<a href="https://time.geekbang.org/column/article/477510">第1讲</a>，我就提到过traceroute的两种模式：UDP模式和ICMP模式。但是，<strong>traceroute为什么可以做到探测网络路径中的节点的呢？</strong>要知道，ping也是用ICMP，它咋就看不到中间节点呢？</p>
<p>你可以找一个工程师问这个问题：“traceroute是如何显示每一个节点的？”很多人可能都会卡住，或者会给一个似是而非的答案，比如说：“可能是有什么协议吧，可以展示每一个节点的”。</p>
<blockquote>
<p>所以我们不要小看一些表面上不起眼的小技术点，也许里面藏着的，还正是你的盲区，也是我们可以提高的地方。</p>
</blockquote>
<p>实际上，traceroute的工作原理，是巧妙地利用了IP报文的 <strong>TTL属性</strong>。具体过程是这样的：</p>
<ul>
<li>发送端首次探测时把UDP源端口为33434，TTL设置为1。这个报文经过第一个路由器时TTL会被减1，也就是变为0，因此包被丢弃，这个路由器向源地址发回一个ICMP超时通知（ICMP Time Exceeded Message），于是第一跳就被探测出来了。</li>
<li>发送端把下一次发送的包的UDP源端口也加一，变为33435，TTL也在原来的基础加一，变为2，这样就可以多前进一步。跟上面的步骤类似，第二跳也被探测出来了。</li>
<li>发送端一直重复TTL加一和UDP源端口加一的操作，直到报文最终到达目的地，后者回复一个端口不可达的ICMP错误信息（ICMP Port Unreachable）。当源地址收到这个消息时，就停止traceroute。</li>
</ul>
<blockquote>
<p>补充：实际工作中，traceroute会批量发送多个不同TTL值的报文然后等待回应，这样效率更高。</p>
</blockquote>
<p>当然，在探测过程中，任何一个探测报文如果在限定时间内没有收到，traceroute就会认为超时，在输出中这一跳就显示为一个星号。</p>
<p>另外，目的地也可能不回复ICMP Port unreachable，那么traceroute的输出就会出现从某一个位置开始的后续跳数全部是星号，直到你按Ctrl + C终止探测，或者是直到默认的64跳检测全部完成。对于这种情况，你可以<strong>加上-I参数</strong>，让traceroute用ICMP协议的echo request消息进行探测，一般来说，<strong>目的地总能对UDP和ICMP中的一种进行响应</strong>。</p>
<p>我们看一下原理示意图：</p>
<p><img alt="" src="https://static001.geekbang.org/resource/image/4a/89/4a7cf207be80c4f0c628f86766ed3889.jpg?wh=2000x1125" /></p>
<p>Linux的traceroute命令默认用的就是UDP模式，而Windows的tracert默认用了ICMP模式。有时候我们会看到每一跳有2个或者3个节点IP，其实就表明这几个路径是启用了ECMP的，所以有多个节点会被选到。比如下面这个例子：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>$<span class="w"> </span>traceroute<span class="w"> </span>www.ebay.com
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>traceroute<span class="w"> </span>to<span class="w"> </span>e9428.a.akamaiedge.net<span class="w"> </span><span class="o">(</span><span class="m">23</span>.45.61.92<span class="o">)</span>,<span class="w"> </span><span class="m">64</span><span class="w"> </span>hops<span class="w"> </span>max
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">10</span>.0.2.2<span class="w">  </span><span class="m">0</span>.308ms<span class="w">  </span><span class="m">0</span>.192ms<span class="w">  </span><span class="m">0</span>.353ms
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">  </span><span class="m">2</span><span class="w">   </span><span class="m">192</span>.168.1.1<span class="w">  </span><span class="m">4</span>.284ms<span class="w">  </span><span class="m">1</span>.379ms<span class="w">  </span><span class="m">1</span>.360ms
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">  </span><span class="m">3</span><span class="w">   </span><span class="m">100</span>.65.0.1<span class="w">  </span><span class="m">5</span>.916ms<span class="w">  </span><span class="m">5</span>.464ms<span class="w">  </span><span class="m">5</span>.520ms
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">  </span><span class="m">4</span><span class="w">   </span><span class="m">61</span>.152.53.149<span class="w">  </span><span class="m">148</span>.051ms<span class="w">  </span><span class="m">146</span>.005ms<span class="w">  </span><span class="m">4</span>.126ms
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">  </span><span class="m">5</span><span class="w">   </span><span class="m">61</span>.152.25.2<span class="w">  </span><span class="m">16</span>.216ms<span class="w">  </span><span class="m">61</span>.152.25.101<span class="w">  </span><span class="m">14</span>.618ms<span class="w">  </span><span class="m">144</span>.713ms
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">  </span><span class="m">6</span><span class="w">   </span>*<span class="w">  </span><span class="m">202</span>.97.83.13<span class="w">  </span><span class="m">8</span>.385ms<span class="w">  </span>*
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">  </span><span class="m">7</span><span class="w">   </span><span class="m">202</span>.97.12.186<span class="w">  </span><span class="m">5</span>.112ms<span class="w">  </span><span class="m">13</span>.341ms<span class="w">  </span><span class="m">14</span>.592ms
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">  </span><span class="m">8</span><span class="w">   </span><span class="m">202</span>.97.41.142<span class="w">  </span><span class="m">49</span>.747ms<span class="w">  </span><span class="m">54</span>.797ms<span class="w">  </span><span class="m">202</span>.97.41.130<span class="w">  </span><span class="m">58</span>.370ms
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">  </span><span class="m">9</span><span class="w">   </span>*<span class="w">  </span>*<span class="w">  </span>*
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="w"> </span><span class="m">10</span><span class="w">   </span>*<span class="w">  </span>*<span class="w">  </span>*
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="w"> </span><span class="m">11</span><span class="w">   </span>*<span class="w">  </span>*<span class="w">  </span>*
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="w"> </span><span class="m">12</span><span class="w">   </span>*<span class="w">  </span>*<span class="w">  </span>*
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="w"> </span><span class="m">13</span><span class="w">   </span>*<span class="w">  </span>*<span class="w">  </span>*
</code></pre></div>
<p>当你改成用ICMP模式后，每一跳就变成只有一个IP了。原因我们在上一讲讨论过，就是因为五元组是一致的，所以路径也不变。比如我们还是对www.ebay.com进行探测，这次用ICMP模式，每跳就只有一个IP了，而且目的地也返回了有效的响应。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>$<span class="w"> </span>traceroute<span class="w"> </span>-I<span class="w"> </span>www.ebay.com
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>traceroute<span class="w"> </span>to<span class="w"> </span>e9428.a.akamaiedge.net<span class="w"> </span><span class="o">(</span><span class="m">23</span>.45.61.92<span class="o">)</span>,<span class="w"> </span><span class="m">64</span><span class="w"> </span>hops<span class="w"> </span>max
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">10</span>.0.2.2<span class="w">  </span><span class="m">0</span>.003ms<span class="w">  </span><span class="m">0</span>.002ms<span class="w">  </span><span class="m">0</span>.003ms
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">  </span><span class="m">2</span><span class="w">   </span><span class="m">192</span>.168.1.1<span class="w">  </span><span class="m">7</span>.616ms<span class="w">  </span><span class="m">1</span>.315ms<span class="w">  </span><span class="m">6</span>.206ms
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">  </span><span class="m">3</span><span class="w">   </span>*<span class="w">  </span><span class="m">100</span>.65.0.1<span class="w">  </span><span class="m">11</span>.057ms<span class="w">  </span><span class="m">7</span>.746ms
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">  </span><span class="m">4</span><span class="w">   </span>*<span class="w">  </span><span class="m">61</span>.152.53.149<span class="w">  </span><span class="m">18</span>.436ms<span class="w">  </span><span class="m">9</span>.598ms
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">  </span><span class="m">5</span><span class="w">   </span>*<span class="w">  </span><span class="m">61</span>.152.25.158<span class="w">  </span><span class="m">12</span>.918ms<span class="w">  </span>*
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">  </span><span class="m">6</span><span class="w">   </span>*<span class="w">  </span>*<span class="w">  </span>*
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">  </span><span class="m">7</span><span class="w">   </span>*<span class="w">  </span>*<span class="w">  </span>*
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">  </span><span class="m">8</span><span class="w">   </span><span class="m">202</span>.97.41.142<span class="w">  </span><span class="m">50</span>.746ms<span class="w">  </span><span class="m">58</span>.052ms<span class="w">  </span><span class="m">59</span>.546ms
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">  </span><span class="m">9</span><span class="w">   </span><span class="m">203</span>.215.237.22<span class="w">  </span><span class="m">62</span>.385ms<span class="w">  </span><span class="m">66</span>.607ms<span class="w">  </span><span class="m">54</span>.561ms
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="w"> </span><span class="m">10</span><span class="w">   </span><span class="m">23</span>.45.61.92<span class="w">  </span><span class="m">49</span>.609ms<span class="w">  </span><span class="m">46</span>.586ms<span class="w">  </span><span class="m">45</span>.567ms
</code></pre></div>
<h3 id="mtr">用mtr定位丢包点</h3>
<p>在上一讲的案例中，我们是用nc加上-p参数指定多个源端口来测试，定位到了问题路径的存在。这对于问题节点丢包率比较高时，作用比较明显。</p>
<p>但是，当问题节点的丢包率不高的时候，我们用nc做多次测试，未必正巧能抓到现场。我们最好还要有<strong>持续监控</strong>的手段，运行一段时间或者发送一定数量（比如1000次以上）的报文，通过足够的探测数，来抓到偶发的故障现象。</p>
<p>这里呢，我们就要用到预习篇提到过的工具：<strong>mtr</strong>。mtr相当于traceroute的加强版，特别是它可以指定任意次数的探测并生成详细的探测报告，而traceroute只能对每个节点发起3次探测，数据量就不够了。</p>
<blockquote>
<p>你也可以理解为mtr = traceroute + ping，因为ping也可以发送很多次，也有最终的报告。</p>
</blockquote>
<p>比如，我们用下面这条命令，就可以对目标IP完成指定次数的探测并生成详细的报告，报告里包含了每一跳的丢包率，很有帮助。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>$<span class="w"> </span>mtr<span class="w"> </span>-c<span class="w"> </span><span class="m">10</span><span class="w"> </span>-r<span class="w"> </span><span class="m">8</span>.8.8.8
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>Start:<span class="w"> </span><span class="m">2022</span>-03-27T00:44:36+0000
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>HOST:<span class="w"> </span>victorebpf<span class="w">                  </span>Loss%<span class="w">   </span>Snt<span class="w">   </span>Last<span class="w">   </span>Avg<span class="w">  </span>Best<span class="w">  </span>Wrst<span class="w"> </span>StDev
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">  </span><span class="m">1</span>.<span class="p">|</span>--<span class="w"> </span>_gateway<span class="w">                   </span><span class="m">0</span>.0%<span class="w">    </span><span class="m">10</span><span class="w">    </span><span class="m">0</span>.2<span class="w">   </span><span class="m">0</span>.3<span class="w">   </span><span class="m">0</span>.2<span class="w">   </span><span class="m">0</span>.5<span class="w">   </span><span class="m">0</span>.1
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">  </span><span class="m">2</span>.<span class="p">|</span>--<span class="w"> </span><span class="m">192</span>.168.1.1<span class="w">                </span><span class="m">0</span>.0%<span class="w">    </span><span class="m">10</span><span class="w">    </span><span class="m">1</span>.9<span class="w">  </span><span class="m">14</span>.9<span class="w">   </span><span class="m">1</span>.6<span class="w"> </span><span class="m">119</span>.8<span class="w">  </span><span class="m">37</span>.0
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">  </span><span class="m">3</span>.<span class="p">|</span>--<span class="w"> </span><span class="m">100</span>.65.0.1<span class="w">                 </span><span class="m">0</span>.0%<span class="w">    </span><span class="m">10</span><span class="w">   </span><span class="m">11</span>.9<span class="w">  </span><span class="m">27</span>.8<span class="w">   </span><span class="m">6</span>.6<span class="w"> </span><span class="m">157</span>.0<span class="w">  </span><span class="m">46</span>.6
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">  </span><span class="m">4</span>.<span class="p">|</span>--<span class="w"> </span><span class="m">61</span>.152.53.149<span class="w">             </span><span class="m">20</span>.0%<span class="w">    </span><span class="m">10</span><span class="w">    </span><span class="m">4</span>.3<span class="w">  </span><span class="m">29</span>.9<span class="w">   </span><span class="m">3</span>.2<span class="w"> </span><span class="m">128</span>.5<span class="w">  </span><span class="m">45</span>.4
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">  </span><span class="m">5</span>.<span class="p">|</span>--<span class="w"> </span><span class="m">61</span>.152.24.226<span class="w">             </span><span class="m">20</span>.0%<span class="w">    </span><span class="m">10</span><span class="w">    </span><span class="m">4</span>.0<span class="w">  </span><span class="m">10</span>.1<span class="w">   </span><span class="m">3</span>.9<span class="w">  </span><span class="m">44</span>.2<span class="w">  </span><span class="m">13</span>.8
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">  </span><span class="m">6</span>.<span class="p">|</span>--<span class="w"> </span><span class="m">202</span>.97.94.237<span class="w">             </span><span class="m">10</span>.0%<span class="w">    </span><span class="m">10</span><span class="w">   </span><span class="m">28</span>.1<span class="w">  </span><span class="m">41</span>.8<span class="w">  </span><span class="m">22</span>.2<span class="w"> </span><span class="m">157</span>.4<span class="w">  </span><span class="m">43</span>.5
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="w">  </span><span class="m">7</span>.<span class="p">|</span>--<span class="w"> </span><span class="m">202</span>.97.12.182<span class="w">             </span><span class="m">60</span>.0%<span class="w">    </span><span class="m">10</span><span class="w">    </span><span class="m">4</span>.9<span class="w">  </span><span class="m">27</span>.9<span class="w">   </span><span class="m">4</span>.9<span class="w">  </span><span class="m">57</span>.5<span class="w">  </span><span class="m">25</span>.7
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">  </span><span class="m">8</span>.<span class="p">|</span>--<span class="w"> </span><span class="m">202</span>.97.93.158<span class="w">             </span><span class="m">10</span>.0%<span class="w">    </span><span class="m">10</span><span class="w">   </span><span class="m">89</span>.4<span class="w"> </span><span class="m">111</span>.8<span class="w">  </span><span class="m">80</span>.8<span class="w"> </span><span class="m">217</span>.6<span class="w">  </span><span class="m">55</span>.0
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">  </span><span class="m">9</span>.<span class="p">|</span>--<span class="w"> </span><span class="m">72</span>.14.211.144<span class="w">             </span><span class="m">20</span>.0%<span class="w">    </span><span class="m">10</span><span class="w">   </span><span class="m">79</span>.7<span class="w"> </span><span class="m">107</span>.9<span class="w">  </span><span class="m">79</span>.6<span class="w"> </span><span class="m">231</span>.9<span class="w">  </span><span class="m">51</span>.6
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="w"> </span><span class="m">10</span>.<span class="p">|</span>--<span class="w"> </span><span class="m">108</span>.170.240.225<span class="w">           </span><span class="m">10</span>.0%<span class="w">    </span><span class="m">10</span><span class="w">   </span><span class="m">89</span>.8<span class="w">  </span><span class="m">91</span>.5<span class="w">  </span><span class="m">81</span>.0<span class="w"> </span><span class="m">148</span>.2<span class="w">  </span><span class="m">21</span>.5
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="w"> </span><span class="m">11</span>.<span class="p">|</span>--<span class="w"> </span><span class="m">74</span>.125.251.207<span class="w">             </span><span class="m">0</span>.0%<span class="w">    </span><span class="m">10</span><span class="w">   </span><span class="m">87</span>.7<span class="w">  </span><span class="m">95</span>.4<span class="w">  </span><span class="m">81</span>.0<span class="w"> </span><span class="m">193</span>.3<span class="w">  </span><span class="m">34</span>.5
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="w"> </span><span class="m">12</span>.<span class="p">|</span>--<span class="w"> </span>dns.google<span class="w">                </span><span class="m">10</span>.0%<span class="w">    </span><span class="m">10</span><span class="w">   </span><span class="m">81</span>.0<span class="w"> </span><span class="m">106</span>.2<span class="w">  </span><span class="m">80</span>.1<span class="w"> </span><span class="m">286</span>.9<span class="w">  </span><span class="m">67</span>.9
</code></pre></div>
<p>可见，终点处的丢包率为10.0%。不过，你也可能注意到了：为什么中间有好几个节点的丢包达到了20.0%甚至60.0%，但终点丢包率反而更低？这是怎么回事？</p>
<p><img alt="图片" src="https://static001.geekbang.org/resource/image/f8/8c/f8555257dbfbe05d766a9199cefc2c8c.jpg?wh=629x268" /></p>
<h3 id="_5">为何中间节点丢包率更高？</h3>
<p>首先，终点的丢包率（在这里是10.0%）肯定是正确的，因为这就是ICMP报文到达终点后的情况。按常规的理解，中间节点的丢包率应该比终点的丢包率低或者持平，但第4跳的20.0%和第7跳的60.0%，都比终点丢包率更高，这就令人费解了。另外，Last等列的响应耗时指标，也出现了中间节点和终点倒挂的情况。</p>
<p>其实，这个问题需要我们结合两个知识点来理解：</p>
<ul>
<li><strong>mtr探测路径节点的工作机制；</strong></li>
<li><strong>网络设备回复ICMP报文的工作机制。</strong></li>
</ul>
<p>第一个知识点，mtr跟traceroute一样，也是通过递增TTL的方式，使得ICMP或者UDP报文终止在中间节点，从而获取到这些节点回复的ICMP time exceeded消息。也正是通过这个消息，我们知道了这个节点的IP、时延，以及我们关心的丢包率。</p>
<p>第二个知识点，是网络设备在回复ICMP报文时候的工作机制。其实，网络设备（交换机和路由器）在“转发”和 “回复”这两个任务上的工作机制是不同的：</p>
<ul>
<li>对于“转发”，大部分工作是卸载到数据面的硬件芯片完成的，这也是实现高速转发的底层基础。</li>
<li>对于“回复”，因为需要自己生成一个ICMP响应报文，那就需要动用自己的CPU资源了，速度就会慢一些。</li>
</ul>
<p>我们可以通过下面这个图来理解这个知识点：</p>
<p><img alt="" src="https://static001.geekbang.org/resource/image/5c/da/5cca38e739b33185140f6cca05366fda.jpg?wh=2000x1006" /></p>
<p>另外还有一些原因会导致这个现象，比如，<strong>不少网络设备对自己的ICMP响应报文设置了限速</strong>（rate limit），这也会加剧这种中间节点丢包的情况。</p>
<h3 id="_6">如何解读中间节点的丢包率？</h3>
<p>那么，这个中间节点的丢包率是不是就毫无价值了呢？我们再看另外一个例子：</p>
<p><img alt="图片" src="https://static001.geekbang.org/resource/image/55/20/5538d1517190bdf2cbe1fc73b7e97120.jpg?wh=810x271" /></p>
<p>我们从这里可以解读出很多的信息，包括：</p>
<ul>
<li>从第5跳开始到最后一跳都有丢包。其中的第8跳到最后一跳的丢包率接近（都在20%左右），那么这几跳需要重点关注。</li>
<li>从第9到第11跳的节点名称解析来看，这些是日本东京（tokyjp）的路由节点，运营商是NTT。</li>
<li>第11跳的名称里带fastly，这是一个CDN厂商的名称，所以这是fastly CDN的节点。</li>
<li>Last这一列是最近一次响应耗时，第7和第8跳的耗时突增了70ms。我们知道，时延跟地理距离成正比，而70ms是一个比较长的耗时了，所以我们可以判断，这两跳就是中日之间的海底光缆的两端。</li>
</ul>
<p>根据这些信息，我们大致可以认为，丢包（本质是链路拥塞）主要发生在中日海底光缆这个位置。</p>
<p>当然，这是一个粗略的推断。<strong>一般来说，mtr最好在两端都做</strong>，然后结合两边的mtr的报告来综合分析，结论会更加准确。</p>
<p>为什么要在两端都做呢？这是因为，网络路由一般是“不对称的”，也就是发送是一条路径，回来往往是另外一条路径了。那么从一端发起mtr，只能看到这个方向的网络状况，另外一个方向的网络状况，就需要另外一端运行mtr来获取了。</p>
<p>比如我们借用一下上一讲的示意图。假设蓝色路径是起点到终点的路径，而紫色的是返回的路径，那么两条路径在r1，r3，r14这节点上是重合的，而在其他节点上“各走各的”。</p>
<p><img alt="" src="https://static001.geekbang.org/resource/image/f8/90/f8f50362fyyeabbb5be8c6ca056e7590.jpg?wh=2000x1125" /></p>
<p>你看，这跟我们抓包经常要在两端同时抓，背后的逻辑是不是差不多的？大道相通，我们积累得越多，越有可能打通这些知识之间的，达成更深的掌握。</p>
<h2 id="mtu">丢包与MTU</h2>
<p>在<a href="https://time.geekbang.org/column/article/484667">第8讲</a>里，我们学习了MTU相关的概念。MTU是最大传输单元，而PMTU就是路径上的瓶颈MTU（最小MTU）。一旦报文设置了DF=1并超出PMTU的大小，就会被丢弃。特别是对于<strong>相对较大尺寸的TCP报文（比如超过1400字节）总是传输失败的情况，可以优先排查PMTU</strong>。</p>
<p>那么，我们有什么方法可以很方便地就找到PMTU呢？</p>
<h3 id="pmtu">快速探测PMTU的方法</h3>
<p>其实，我们可以用一个十分简单的命令：ping。给 <strong>ping命令加上“-s 尺寸”</strong>这个参数，就可以发送自定义载荷尺寸的报文。比如你可以试试这个命令：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>ping<span class="w"> </span>www.baidu.com<span class="w"> </span>-s<span class="w"> </span><span class="m">1472</span>
</code></pre></div>
<p>然后再运行：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>ping<span class="w"> </span>www.baidu.com<span class="w"> </span>-s<span class="w"> </span><span class="m">1473</span>
</code></pre></div>
<p>看看两者的返回有没有区别？</p>
<p>ping报文属于网络层的ICMP控制报文，所以整体的IP报文大小是载荷（1472或者1473）加上IP头部的20字节和ICMP头部的8字节。显然，指定IP报文载荷为1473后，整个IP报文就达到1501字节，正好超过了1500字节，所以 <code>ping www.baidu.com -s 1473</code> 就在发送的途中丢失，也就无法收到ICMP响应了。</p>
<p>不过，也许你的网络环境跟我不同，特别是如果有隧道的存在，那-s 1472也无法通过。那么你可以不断调整这个值，直到试出一个刚刚能通过的尺寸，然后在它基础上加上28字节，就是你的网络环境的PMTU了。</p>
<blockquote>
<p>补充：这里还隐含了另外一个知识点，就是IP分片。关于它的细节，你可以回顾第8讲的内容。</p>
</blockquote>
<h2 id="_7">如何统计丢包率？</h2>
<p>最后，我们来学习一下丢包率的统计方法。要统计丢包率，众所周知的方法应该就是用ping了，或者说“长ping”。比如下面的例子里，丢包率为1%：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>---<span class="w"> </span>turner-tls.map.fastly.net<span class="w"> </span>ping<span class="w"> </span>statistics<span class="w"> </span>---
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="m">100</span><span class="w"> </span>packets<span class="w"> </span>transmitted,<span class="w"> </span><span class="m">99</span><span class="w"> </span>received,<span class="w"> </span><span class="m">1</span>%<span class="w"> </span>packet<span class="w"> </span>loss,<span class="w"> </span><span class="nb">time</span><span class="w"> </span>99204ms
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>rtt<span class="w"> </span>min/avg/max/mdev<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">122</span>.012/134.749/301.225/27.648<span class="w"> </span>ms
</code></pre></div>
<p>不过ping还是有可能无法探测出网络的真实状况。其实在上一讲里，我们就发现，如果路径中有ECMP，那么因为ECMP哈希转发策略的存在，ping的网络路径可能就跟TCP的网络路径不同。这样可能就会造成这样的状况：</p>
<ul>
<li>长ping没丢包的话，不等于应用也不丢包；</li>
<li>长ping丢包的话，应用丢包的可能性也很大。</li>
</ul>
<p>所以，既然ping也未必准，那<strong>不如直接一边跑应用一边抓包，然后对抓包文件进行分析</strong>，从而得出丢包率。而这里，又分了两种途径：图形界面和命令行。</p>
<h3 id="_8">图形界面方法</h3>
<p>在Wireshark中我们能看到TCP retransmission、Out-of-Order等信息提示，那么我们就可以借助这些信息，计算出丢包率来。</p>
<p>我们看一个抓包文件的Expert Information：</p>
<p><img alt="图片" src="https://static001.geekbang.org/resource/image/d1/83/d13cd47bf1209eb8e007921b71d4fc83.jpg?wh=1804x326" /></p>
<p>在<a href="https://time.geekbang.org/column/article/480068">第4讲</a>中，我详细介绍过解读Expert Information的方法，这里就不赘述了，相信你也已经比较熟悉了。这里我们最关心的指标是retransmission，它有100个。</p>
<p>这些数量算多吗？没有基数就不好说了，所以让我们看一下整体包量。打开Wireshark的Statistics下拉菜单，选中第一个选项即Capture File Properties：</p>
<p><img alt="图片" src="https://static001.geekbang.org/resource/image/74/04/74450c5ce46afe58c42f485d03ec3604.png?wh=512x162" /></p>
<p>在弹出的界面中我们就能看到具体的数据了，比如这个抓包的整体包量是750个。</p>
<p><img alt="图片" src="https://static001.geekbang.org/resource/image/22/6a/22ac21a51273525d01421646037b9a6a.jpg?wh=1564x374" /></p>
<p>然后<strong>丢包率可以大致认为是重传率，也就是重传报文数/整体报文数</strong>。在这里就是100/750 = 13.3%。</p>
<h3 id="_9">命令行方法</h3>
<p>另外一个办法是用 <strong>capinfos命令</strong>获取总的报文数：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>$ capinfos viaLB.pcap
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>File name:           viaLB.pcap
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>File type:           Wireshark/tcpdump/... - pcap
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>File encapsulation:  Ethernet
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>File timestamp precision:  microseconds (6)
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>Packet size limit:   file hdr: 65535 bytes
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>Packet size limit:   inferred: 84 bytes
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>Number of packets:   750
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>File size:           68 kB
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>Data size:           315 kB
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>Capture duration:    2.076944 seconds
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>First packet time:   2016-12-09 20:06:00.629223
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>Last packet time:    2016-12-09 20:06:02.706167
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a>Data byte rate:      151 kBps
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a>Data bit rate:       1215 kbps
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a>Average packet size: 420.67 bytes
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a>Average packet rate: 361 packets/s
<a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a>SHA256:              9c34dc15bcf69b419c0e3eb0c37fa851485adbe3953018b957b14de330fa0882
<a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a>RIPEMD160:           c353fdd8d634dd38ac395980b4824751f667908f
<a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a>SHA1:                fd86e4f6969cc8a27ff1a29cf2de88ab6d57db7d
<a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a>Strict time order:   True
<a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a>Number of interfaces in file: 1
<a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a>Interface #0 info:
<a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a>                     Encapsulation = Ethernet (1 - ether)
<a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a>                     Capture length = 65535
<a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a>                     Time precision = microseconds (6)
<a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a>                     Time ticks per second = 1000000
<a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a>                     Number of stat entries = 0
<a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a>                     Number of packets = 750
</code></pre></div>
<p>结尾处就是总的报文数量，即Number of packets = 750。那么重传个数如何在命令行里获取呢？</p>
<p>你是否还记得之前我们学习过tshark这个命令？这里也是用 <strong>tshark</strong>，执行下面的命令：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>$<span class="w"> </span>tshark<span class="w"> </span>-n<span class="w"> </span>-q<span class="w"> </span>-r<span class="w"> </span>viaLB.pcap<span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;io,stat,0,tcp.analysis.retransmission&quot;</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="o">======================================</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="p">|</span><span class="w"> </span>IO<span class="w"> </span>Statistics<span class="w">                      </span><span class="p">|</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="p">|</span><span class="w">                                    </span><span class="p">|</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="p">|</span><span class="w"> </span>Duration:<span class="w"> </span><span class="m">2</span>.077<span class="w"> </span>secs<span class="w">               </span><span class="p">|</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="p">|</span><span class="w"> </span>Interval:<span class="w"> </span><span class="m">2</span>.077<span class="w"> </span>secs<span class="w">               </span><span class="p">|</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="p">|</span><span class="w">                                    </span><span class="p">|</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="p">|</span><span class="w"> </span>Col<span class="w"> </span><span class="m">1</span>:<span class="w"> </span>tcp.analysis.retransmission<span class="w"> </span><span class="p">|</span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="p">|</span>------------------------------------<span class="p">|</span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="p">|</span><span class="w">                </span><span class="p">|</span><span class="m">1</span><span class="w">                </span><span class="p">|</span><span class="w"> </span><span class="p">|</span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="p">|</span><span class="w"> </span>Interval<span class="w">       </span><span class="p">|</span><span class="w"> </span>Frames<span class="w"> </span><span class="p">|</span><span class="w">  </span>Bytes<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="p">|</span>----------------------------------<span class="p">|</span><span class="w"> </span><span class="p">|</span>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="p">|</span><span class="w"> </span><span class="m">0</span>.000<span class="w"> </span>&lt;&gt;<span class="w"> </span><span class="m">2</span>.077<span class="w"> </span><span class="p">|</span><span class="w">    </span><span class="m">100</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">145400</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="o">======================================</span>
</code></pre></div>
<p>最后一行的Frames 100就是指重传报文个数100。同样的，把两个数字相除就得出了丢包率。</p>
<h2 id="_10">丢包多少算严重？</h2>
<p>回到重传数量占整体比例的讨论。前面的例子里丢包率是13.3%。直觉上看，这个比例也高了。那如果降低一个数量级，比如1.33%，这算高还是低呢？</p>
<p>这个问题可能也没有标准答案，毕竟每个应用对于丢包和重传的敏感度也有不同。而且由于公网情况复杂，本身就有一定的丢包率存在，比如像前面的海底光缆拥塞造成的丢包，也难以避免。</p>
<p><strong>实际上，公网丢包率在1%左右是一个可以接受的范围</strong>。如果明显超过1%，比如达到了5%以上，那对应用的影响就会比较明显了，此时应该通过节点修复或者链路调整，来解决丢包的问题，把丢包率控制在1%左右，最好是1%以下。</p>
<p>而内网网络会比公网稳定很多。一般来说，<strong>一个正常的内网也有万分之一左右的丢包率</strong>。如果明显超过了这个比率，比如达到了千分之一的话，尽管依然比公网丢包率低一个数量级，但也需要认真对待并解决。</p>
<h2 id="_11">小结</h2>
<p>这节课，我们一起探讨了丢包这个关键话题的工具、原理，还有方法。我们学习了多种工具，包括：</p>
<ul>
<li>探测类工具：ping、mtr、traceroute、nc、telnet等。</li>
<li>统计类工具：netstat、ss、nstat。</li>
</ul>
<p>其中，netstat和nstat都会展示 <strong>TCP retransmission的数值，如果它随时间递增，那就说明这台主机的对外通信存在丢包的现象</strong>。我们也了解了Linux内核本身实现了SNMP计数器，这些计数器记录了系统启动后的各个网络指标的数值，而netstat等工具正是读取内核中这些计数器，获得了相应指标的数值。</p>
<p>另外我们也要清楚一点，ss能提供比netstat更多的网络信息，特别是TCP socket的各种属性。这些信息对TCP方面的排查工作很有帮助，比如运行：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>ss<span class="w"> </span>-iet
</code></pre></div>
<p>而对于路径排查的重要工具 <strong>mtr</strong> 的原理和使用方法，你也要好好掌握。在mtr的输出中，要注意中间节点的丢包率。如果终点的丢包率比前面节点的低，那前面节点的丢包率只能作为有限的参考。如果节点丢包率出现越往后越高的情况，这样的丢包率的参考价值就高很多了。</p>
<p>而且，最好<strong>在通信两端都做mtr，然后结合两边的探测结果做综合分析</strong>。</p>
<p>另外，在丢包这个主题中，<strong>MTU</strong> 也是重要角色。因为路径MTU的不一致，某些情况下就会发生超出MTU而丢包的现象。由于ICMP消息不一定会回到发送方，就会导致发送方的PMTU机制不能正常工作，也就是无法感知到这个MTU超限的事实，导致连续发送失败。</p>
<p>一般我们会建议对自己网络情况了解清楚后，再对主机设置合适的MTU，这样可以最大程度上确保不发生MTU超限引发问题。另外呢，我们也可以<strong>用ping来探测PMTU</strong>，也就是运行：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>ping<span class="w"> </span>-s<span class="w"> </span><span class="m">1472</span><span class="w">   </span><span class="c1">#或者其他数值</span>
</code></pre></div>
<p>最后，我们还学习了如何根据抓包文件，计算出丢包率，也就是<strong>丢包率=重传个数/总报文数</strong>。另外公网丢包率1%和内网丢包率万分之一，可以认为是正常范围。</p>
<h2 id="_12">思考题</h2>
<p>最后，再给你留两道思考题：</p>
<ul>
<li>Linux中运行ifconfig -a看到的网卡接口的dropped指标，是指我们这里讨论的丢包吗？为什么？</li>
<li>TCP是如何在发生丢包的情况下保证传输可靠性的呢？</li>
</ul>
<p>欢迎你在留言区分享你的答案，我们一同进步、成长。</p>
<div><strong>精选留言（10）</strong></div>
<ul>
<li><span>那时刻</span> 👍（8） 💬（1）<p>网卡dropped 指标表示数据包已经进入了 Ring Buffer，但是由于内存不够等系统原因，导致在拷贝到内存的过程中被丢弃。而我们讨论的丢包是传输过程中，数据包在网络中丢失了，经过交换机转发过程中丢包，或者传输介质的原因丢失数据。

TCP 是如何在发生丢包的情况下保证传输可靠性的呢？

1. 通过序列号和确认应答信号确保了数据不会重复发送和重复接收。
2. 同时通过超时重发控制保证即使数据包在传输过程中丢失，也能重发保持数据完整。
3. 通过三次握手，四次挥手建立和关闭连接的连接管理保证了端对端的通信可靠性。
4. TCP还使用了滑动窗口控制提高了数据传输效率</p>2022-03-28</li><br/><li><span>JianXu</span> 👍（2） 💬（1）<p>出了事故以后，再来补课-：）</p>2022-07-23</li><br/><li><span>老万</span> 👍（2） 💬（1）<p>traceroute 应该是使用目的端口为33434以上的高端口</p>2022-04-29</li><br/><li><span>Chao</span> 👍（2） 💬（1）<p>tcp发生丢包 最大措施就是降速，通过降速来保证传输。</p>2022-03-28</li><br/><li><span>家军</span> 👍（0） 💬（2）<p>老师请教一个问题：业务压测时，通过netstat -s监控发现：tcp重传较多(千分之2.5）其中快速重传占了99%以上，丢包重传较低（万分之0.25），造成这种情况的原因是什么？这种程度的重传需要关注吗？</p>2023-04-21</li><br/><li><span>青梅煮酒</span> 👍（0） 💬（1）<p>对比了tshark和wireshark的丢包计算结果，是所有的重传相加来计算丢包率的</p>2022-05-26</li><br/><li><span>青梅煮酒</span> 👍（0） 💬（1）<p>如果存在超时重传和快速重传是不是需要全部相加才可以计算丢包率呢</p>2022-05-26</li><br/><li><span>Realm</span> 👍（0） 💬（1）<p>Packet Dropped seen from ifconfig could be due to many reasons, you should dig deeper into NIC statistics to figure out real reason. Below are some general reasons
* NIC ring buffers getting full and unable to cope-up with incoming bursts of traffic
* CPU receiving NIC interrupts is very busy and unable to process
* some cable&#47;hardware&#47;duplex issues
* some bug in NIC driver

Packet Dropped seen from ifconfig could be due to many reasons, you should dig deeper into NIC statistics to figure out real reason. Below are some general reasons
* NIC ring buffers getting full and unable to cope-up with incoming bursts of traffic
* CPU receiving NIC interrupts is very busy and unable to process
* some cable&#47;hardware&#47;duplex issues
* some bug in NIC driver

1 我们讨论的丢包是站在客户端的角度，多指网络传输层面；
ifconfig中dropped，是站着服务器的角度，包进入了网卡，由于各种原因没有被处理，被统计为丢弃了，两者应该不是一回事。

2 tcp通过重传、拥塞控制等机制保障可用性；</p>2022-03-28</li><br/><li><span>追风筝的人</span> 👍（1） 💬（0）<p>探测类工具：ping、mtr、traceroute、nc、telnet 等。
统计类工具：netstat、ss、nstat。</p>2022-03-30</li><br/><li><span>上杉夏香</span> 👍（0） 💬（0）<p>文章随机二刷：
一、为什么会发生丢包的情况
数据到达目的地的情况
1、到达目的地，只是不予受理。比如traceroute 采用ICMP、UDP探测，一般有一种方式在最后总是会丢包，变现为一直输出『* * * * 』

数据未到达目的地的情况 
1、路径上MTU的限制+IP报文的不分段的联合机制
如何发现路径上最小的MTU：
ping -s &lt;icmp 报文的载荷大小&gt; &lt;目的IP&gt;，不断试探。哦，没错，在这里你可以搞一个二分查找。

2、网络状态不好
路径上某台路由器达到最大的转发能力等等

二、如何检测到丢包？
统计类工具，比如netstat、ss等工具。因为是静态的，你可以动起来~
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>watch<span class="w"> </span>--diff<span class="w"> </span>netstat<span class="w"> </span>-s
</code></pre></div>

三、在哪里丢包？
traceroute、mtr上场

四、丢包率是多少？
wireshark抓包，从专家信息中查看丢包的数量，然后获得整个过程的抓包总量。丢包率 = 丢包量&#47;抓包总量</p>2022-08-12</li><br/>
</ul>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="../23%20-%20%E8%B7%AF%E5%BE%84%E6%8E%92%E6%9F%A5%EF%BC%9A%E6%B2%A1%E6%9C%89%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%9D%83%E9%99%90%E8%A6%81%E5%A6%82%E4%BD%95%E5%81%9A%E6%8E%92%E6%9F%A5%EF%BC%9F/" class="md-footer__link md-footer__link--prev" aria-label="上一页: 23   路径排查：没有网络设备权限要如何做排查？">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                23   路径排查：没有网络设备权限要如何做排查？
              </div>
            </div>
          </a>
        
        
          
          <a href="../%E4%B8%8D%E5%AE%9A%E6%9C%9F%E5%8A%A0%E9%A4%90%EF%BC%88%E4%B8%80%EF%BC%89%20-%20%E5%85%AB%E4%BB%99%E8%BF%87%E6%B5%B7%EF%BC%8C%E5%90%84%E6%98%BE%E7%A5%9E%E9%80%9A%EF%BC%9A%E9%80%8F%E4%BC%A0%E7%9C%9F%E5%AE%9E%E6%BA%90IP%E7%9A%84%E5%90%84%E7%A7%8D%E6%96%B9%E6%B3%95/" class="md-footer__link md-footer__link--next" aria-label="下一页: 不定期加餐（一）   八仙过海，各显神通：透传真实源IP的各种方法">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                不定期加餐（一）   八仙过海，各显神通：透传真实源IP的各种方法
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2025-Present zkep
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.annotate", "content.code.copy", "content.tooltips", "toc.follow", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "navigation.prune", "navigation.footer", "navigation.tracking", "navigation.instant", "navigation.instant.progress", "navigation.indexes", "content.tabs.link"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="../../../javascript/extra.js"></script>
      
        <script src="../../../javascript/giscus.js"></script>
      
    
  </body>
</html>