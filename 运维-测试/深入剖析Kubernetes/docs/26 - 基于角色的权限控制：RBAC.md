ä½ å¥½ï¼Œæˆ‘æ˜¯å¼ ç£Šã€‚ä»Šå¤©æˆ‘å’Œä½ åˆ†äº«çš„ä¸»é¢˜æ˜¯ï¼šåŸºäºè§’è‰²çš„æƒé™æ§åˆ¶ä¹‹RBACã€‚

åœ¨å‰é¢çš„æ–‡ç« ä¸­ï¼Œæˆ‘å·²ç»ä¸ºä½ è®²è§£äº†å¾ˆå¤šç§Kuberneteså†…ç½®çš„ç¼–æ’å¯¹è±¡ï¼Œä»¥åŠå¯¹åº”çš„æ§åˆ¶å™¨æ¨¡å¼çš„å®ç°åŸç†ã€‚æ­¤å¤–ï¼Œæˆ‘è¿˜å‰–æäº†è‡ªå®šä¹‰APIèµ„æºç±»å‹å’Œæ§åˆ¶å™¨çš„ç¼–å†™æ–¹å¼ã€‚

è¿™æ—¶å€™ï¼Œä½ å¯èƒ½å·²ç»å†’å‡ºäº†è¿™æ ·ä¸€ä¸ªæƒ³æ³•ï¼šæ§åˆ¶å™¨æ¨¡å¼çœ‹èµ·æ¥å¥½åƒä¹Ÿä¸éš¾å˜›ï¼Œæˆ‘èƒ½ä¸èƒ½è‡ªå·±å†™ä¸€ä¸ªç¼–æ’å¯¹è±¡å‘¢ï¼Ÿ

ç­”æ¡ˆå½“ç„¶æ˜¯å¯ä»¥çš„ã€‚è€Œä¸”ï¼Œè¿™æ‰æ˜¯Kubernetesé¡¹ç›®æœ€å…·å¸å¼•åŠ›çš„åœ°æ–¹ã€‚

æ¯•ç«Ÿï¼Œåœ¨äº’è”ç½‘çº§åˆ«çš„å¤§è§„æ¨¡é›†ç¾¤é‡Œï¼ŒKuberneteså†…ç½®çš„ç¼–æ’å¯¹è±¡ï¼Œå¾ˆéš¾åšåˆ°å®Œå…¨æ»¡è¶³æ‰€æœ‰éœ€æ±‚ã€‚æ‰€ä»¥ï¼Œå¾ˆå¤šå®é™…çš„å®¹å™¨åŒ–å·¥ä½œï¼Œéƒ½ä¼šè¦æ±‚ä½ è®¾è®¡ä¸€ä¸ªè‡ªå·±çš„ç¼–æ’å¯¹è±¡ï¼Œå®ç°è‡ªå·±çš„æ§åˆ¶å™¨æ¨¡å¼ã€‚

è€Œåœ¨Kubernetesé¡¹ç›®é‡Œï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºæ’ä»¶æœºåˆ¶æ¥å®Œæˆè¿™äº›å·¥ä½œï¼Œè€Œå®Œå…¨ä¸éœ€è¦ä¿®æ”¹ä»»ä½•ä¸€è¡Œä»£ç ã€‚

ä¸è¿‡ï¼Œä½ è¦é€šè¿‡ä¸€ä¸ªå¤–éƒ¨æ’ä»¶ï¼Œåœ¨Kubernetesé‡Œæ–°å¢å’Œæ“ä½œAPIå¯¹è±¡ï¼Œé‚£ä¹ˆå°±å¿…é¡»å…ˆäº†è§£ä¸€ä¸ªéå¸¸é‡è¦çš„çŸ¥è¯†ï¼šRBACã€‚

æˆ‘ä»¬çŸ¥é“ï¼ŒKubernetesä¸­æ‰€æœ‰çš„APIå¯¹è±¡ï¼Œéƒ½ä¿å­˜åœ¨Etcdé‡Œã€‚å¯æ˜¯ï¼Œå¯¹è¿™äº›APIå¯¹è±¡çš„æ“ä½œï¼Œå´ä¸€å®šéƒ½æ˜¯é€šè¿‡è®¿é—®kube-apiserverå®ç°çš„ã€‚å…¶ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„åŸå› ï¼Œå°±æ˜¯ä½ éœ€è¦APIServeræ¥å¸®åŠ©ä½ åšæˆæƒå·¥ä½œã€‚
<div><strong>ç²¾é€‰ç•™è¨€ï¼ˆ30ï¼‰</strong></div><ul>
<li><img src="" width="30px"><span>æ— ç—•é£å®¢</span> ğŸ‘ï¼ˆ39ï¼‰ ğŸ’¬ï¼ˆ4ï¼‰<div>è€å¸ˆï¼Œæ€ä¹ˆä¼˜é›…çš„å¸è½½æ‰kuberneteså‘¢ï¼Ÿ</div>2018-10-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/6b/56/37a4cea7.jpg" width="30px"><span>å•æœ‹è£</span> ğŸ‘ï¼ˆ29ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>ä¸ºä»€ä¹ˆè¦ç”Ÿå‘½è¿™ç±»service accountï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨roleè¿›è¡Œæƒé™åˆ†é…å—ï¼Ÿè¿™ä¸ªä¸­é—´ä»£ç†çš„å¥½å¤„æ˜¯å•¥å‘¢ï¼Ÿ</div>2018-12-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/4f/eb/b5bb4227.jpg" width="30px"><span>runner</span> ğŸ‘ï¼ˆ13ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆè¿˜æ˜¯ä¹‹å‰çš„é—®é¢˜ï¼Œç°åœ¨æœºå™¨ä¸Šæœ‰ä¸€ä¸ªæ‰‹åŠ¨èµ·çš„å®¹å™¨ï¼ˆæ¯”å¦‚æ˜¯è€çš„ä¸šåŠ¡å®¹å™¨ï¼‰ï¼Œæƒ³æŠŠä»–åŠ åˆ°podé‡Œç®¡ç†èµ·æ¥ï¼Œæ¯”å¦‚podç”Ÿæˆçš„æ—¶å€™å‘ç°å·²ç»æœ‰è¿™ä¸ªå®¹å™¨äº†ï¼Œå°±å…³è”è¿™ä¸ªå®¹å™¨ï¼Œä¸å†åˆ›å»ºäº†ã€‚æœ‰åŠæ³•å®ç°ä¹ˆï¼Ÿ</div>2018-10-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/94/47/75875257.jpg" width="30px"><span>è™è™â¤ï¸</span> ğŸ‘ï¼ˆ8ï¼‰ ğŸ’¬ï¼ˆ5ï¼‰<div>ä½†åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿™ä¸ªé»˜è®¤ ServiceAccount å¹¶æ²¡æœ‰å…³è”ä»»ä½• Roleã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ­¤æ—¶å®ƒæœ‰è®¿é—® APIServer çš„ç»å¤§å¤šæ•°æƒé™ã€‚
ä¸ºä»€ä¹ˆæ²¡æœ‰å…³è”roleï¼Œå°±ä¼šæœ‰ç»å¤§å¤šæ•°æƒé™å‘¢ï¼Ÿæœ‰ä¸€ä¸ªé»˜è®¤çš„roleä¹ˆï¼Œéƒ½æœ‰ä»€ä¹ˆæƒé™å‘¢ï¼Ÿ

å¦å¤–ï¼Œå»ºè®®åœ¨æ‰€æœ‰çš„namespaceç»™default serviceaccountç»‘å®šviewï¼Œæ˜¯å‡ºäºå®‰å…¨çš„è€ƒè™‘æ˜¯ä¹ˆï¼Ÿ</div>2018-10-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/94/47/75875257.jpg" width="30px"><span>è™è™â¤ï¸</span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ6ï¼‰<div>Prior to Kubernetes 1.6, many deployments used very permissive ABAC policies, including granting full API access to all service accounts.

Default RBAC policies grant scoped permissions to control-plane components, nodes, and controllers, but grant no permissions to service accounts outside the kube-system namespace (beyond discovery permissions given to all authenticated users).

Quoting from https:&#47;&#47;kubernetes.io&#47;docs&#47;reference&#47;access-authn-authz&#47;rbac&#47;#service-account-permissions

æŒ‰æˆ‘å¯¹å®˜æ–¹æ–‡æ¡£çš„ç†è§£ï¼ŒRBACç­–ç•¥ä¸‹ default service account æ˜¯ä¸æ˜¯å¹¶æ²¡æœ‰ä»»ä½•æƒé™ï¼ŒABACæ‰ä¼šgrant full accessï¼Ÿ

å¦‚æœç»™æ‰€æœ‰namespaceçš„default service accountéƒ½èµ‹äºˆview æƒé™ã€‚ä¼šä¸ä¼šå‡ºç°å¦‚ä¸‹é£é™©ï¼Ÿ
Warning: This allows any user with read access to secrets or the ability to create a pod to access super-user credentials.
</div>2018-10-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/46/5b/07858c33.jpg" width="30px"><span>Pixar</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>role roleBanding serviceAccount éƒ½æ˜¯ namespaced , é‚£è·¨namespace æ“ä½œä¼šæ€ä¹ˆæ ·ï¼Ÿ</div>2018-10-26</li><br/><li><img src="" width="30px"><span>æ— ç—•é£å®¢</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>è€å¸ˆï¼Œæˆ‘kuberneteså®‰è£…å¥½äº†ï¼Œæ€ä¹ˆåœæ­¢å¯åŠ¨çš„kubeè¿›ç¨‹å¹¶ä¸”å¸è½½æ‰kuberneteså‘¢ï¼Ÿ</div>2018-10-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/72/3e/534db55d.jpg" width="30px"><span>huan</span> ğŸ‘ï¼ˆ66ï¼‰ ğŸ’¬ï¼ˆ12ï¼‰<div>kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io&#47;v1
metadata:
  name: readonly-all-default
subjects:
- kind: User
  name: system.serviceaccount.default
roleRef:
  kind: ClusterRole
  name: view
  apiGroup: rbac.authorization.k8s.io</div>2018-10-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/e8/f9/4412b473.jpg" width="30px"><span>å–œå‰§ã€‚</span> ğŸ‘ï¼ˆ40ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io&#47;v1
metadata:
name: readonly-all-default
subjects:
- kind: ServiceAccount
name: system.serviceaccount.default
roleRef:
kind: ClusterRole
name: view
apiGroup: rbac.authorization.k8s.io

å‰é¢çš„æœ‹å‹å†™çš„é—®é¢˜åœ¨äºï¼Œdefaultåº”è¯¥æ˜¯serciveacount</div>2018-11-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1f/5d/c8/7ece6f4b.jpg" width="30px"><span>è¹¦è¹¦</span> ğŸ‘ï¼ˆ14ï¼‰ ğŸ’¬ï¼ˆ4ï¼‰<div>kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io&#47;v1
metadata:
  name: readonly-all-default
subjects:
- kind: ServiceAccount
  name: default
roleRef:
  kind: ClusterRole
  name: view
  apiGroup: rbac.authorization.k8s.io

kindæ˜¯ServiceAccountï¼Œä¸æ˜¯Groupã€‚nameç›´æ¥å†™defaultï¼Œä¸æŒ‡å®šnamespace
</div>2020-07-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/9a/0f/da7ed75a.jpg" width="30px"><span>èŠ’æœå°‘ä¾ </span> ğŸ‘ï¼ˆ9ï¼‰ ğŸ’¬ï¼ˆ4ï¼‰<div>è€å¸ˆï¼Œæˆ‘æŸ¥é˜…äº†ç›¸å…³èµ„æ–™ã€‚è§‰å¾—æ€è€ƒé¢˜ä¸­çš„åœºæ™¯ï¼ˆä¸ºã€æ‰€æœ‰namespaceã€‘ä¸‹çš„ã€default service accountã€‘æ·»åŠ åªè¯»æƒé™ï¼‰æ— æ³•å®ç°ã€‚ClusterRoleBindingçš„subjectså­—æ®µæœ€å¤šèƒ½å…è®¸æˆ‘ä»¬ç»™ã€default namespaceã€‘ä¸‹çš„ã€æ‰€æœ‰service accountã€‘æˆ–è€…æ‰€æœ‰namespaceä¸‹çš„æ‰€æœ‰ service accountæ·»åŠ åªè¯»æƒé™ã€‚ä¸çŸ¥é“è€å¸ˆæ˜¯å¦æœ‰å…¶ä»–æ–¹å¼å®ç°ï¼Ÿæ³è¯·å›ç­”ï¼Œæ„Ÿè°¢ã€‚

æ€è€ƒé¢˜è¯·é—®:
å¦‚ä½•ä¸ºæ‰€æœ‰ Namespace ä¸‹çš„é»˜è®¤ ServiceAccountï¼ˆdefault ServiceAccountï¼‰ï¼Œç»‘å®šä¸€ä¸ªåªè¯»æƒé™çš„ Role å‘¢ï¼Ÿè¯·ä½ æä¾› ClusterRoleBindingï¼ˆæˆ–è€… RoleBindingï¼‰çš„ YAML æ–‡ä»¶ã€‚</div>2020-03-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/40/c3/e545ba80.jpg" width="30px"><span>å¼ æŒ¯å®‡</span> ğŸ‘ï¼ˆ9ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>è€å¸ˆrbacæ€ä¹ˆç»“åˆä¼ä¸šè‡ªå·±çš„ldapç”¨æˆ·æ•°æ®è¿›è¡Œå¤–éƒ¨ç™»å½•è‡ªç ”çš„webå¹³å°</div>2019-02-23</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/nhLS152kEs5J65bBpM2fzMn4agfoow8xibFzNSDcmo9Oiby2lNB4hWRcetRWFyY2y05IJu8GbkZer9BUiahtadU0w/132" width="30px"><span>yuanlinios</span> ğŸ‘ï¼ˆ7ï¼‰ ğŸ’¬ï¼ˆ4ï¼‰<div>è™½ç„¶ clusterrole&#47;clusterrolebinding ä¸å— namespace é™åˆ¶, ä½†æ˜¯ serviceaccount æ€»æ˜¯å­˜åœ¨äº namespace ä¸‹. ä¸ºä¸€ä¸ª namespace ä¸‹çš„ default sa åšåªè¯»é™åˆ¶å¾ˆå®¹æ˜“. é‚£ä¹ˆæ€ä¹ˆä¸º&quot;æ‰€æœ‰&quot; (åŒ…æ‹¬ç°æœ‰çš„å’Œæœªæ¥çš„) çš„ namespace ä¸‹çš„ default sa åšåªè¯»çš„é™åˆ¶? å¸Œæœ›ç»™ç‚¹æç¤º

</div>2018-12-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/3c/c4/4ee2968a.jpg" width="30px"><span>è‰¾åˆ©ç‰¹-G</span> ğŸ‘ï¼ˆ6ï¼‰ ğŸ’¬ï¼ˆ3ï¼‰<div>å…³äºè¯¾åæ€è€ƒï¼Œæˆ‘çœ‹äº†å®˜æ–¹æ–‡æ¡£çš„è¿™ä¸ªä¾‹å­ã€‚
&gt; https:&#47;&#47;kubernetes.io&#47;docs&#47;reference&#47;access-authn-authz&#47;rbac&#47;#rolebinding-and-clusterrolebinding
æš‚æ—¶å¾—å‡ºçš„ç»“è®ºæ˜¯é€šè¿‡ClusterRoleBindingåšä¸åˆ°è®©æ¯ä¸ªNameSpaceä¸‹çš„&quot;default&quot; ServiceAccountæ‹¥æœ‰namespaced resourcesçš„åªè¯»æƒé™ã€‚
è¿™é‡Œé¢æè¿°äº†å¦‚ä½•åœ¨ClusterRolebindingä¸­å°†ClusterRoleä¸&quot;manager&quot;è¿™ä¸ªgroupç»‘å®šã€‚ä½†æ˜¯è¿™ä¸ª&quot;manager&quot; groupï¼Œæ˜¯ä¸€ä¸ªuserçš„groupï¼Œä¸æ˜¯ServiceAccountçš„groupã€‚
æˆ‘æƒ³ï¼Œå°†ClusterRolebindingå…¶ä¸­çš„subjects[0].kindå±æ€§æŒ‡å®šä¸ºServiceAccountï¼ŒnameæŒ‡å®šä¸ºsystem:serviceaccount:*:defaultï¼Œåº”è¯¥æ˜¯æ— æ•ˆçš„å§ã€‚
å¦‚æœè¿™æ ·ä¸è¡Œçš„è¯ï¼Œé‚£å°±åªæœ‰subjects[0].kindå±æ€§æŒ‡å®šä¸ºgroupï¼Œç„¶ånameæŒ‡å®šä¸ºsystem:serviceaccountsï¼Œè¿™å°†ä¼šå¯¹æ‰€æœ‰ServiceAccountç»‘å®š&quot;view&quot;è¿™ä¸ªClusterRoleï¼ŒåŒ…æ‹¬&quot;default&quot;ä¹‹å¤–çš„ServiceAccountã€‚è¿™æ ·ä¼šå¯¹æ‰€æœ‰ServiceAccountæˆæƒé›†ç¾¤çº§åˆ«çš„åªè¯»æƒé™ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½é™åˆ¶åœ¨è¯¥ServiceAccountæ‰€åœ¨çš„Namespaceä¸‹ã€‚
å¦‚æœåœ¨æ¯ä¸ªNamespaceä¸‹åˆ›å»ºRoleBindingï¼Œsubjects[0].kindå±æ€§æŒ‡å®šä¸ºServiceAccountï¼ŒnameæŒ‡å®šä¸ºdefaultï¼ŒnamespaceæŒ‡å®šä¸ºè¯¥namespaceï¼Œåˆ™å¯ä»¥ä½¿æ¯ä¸ªNameSpaceä¸‹çš„&quot;default&quot; ServiceAccountæ‹¥æœ‰è¯¥Namespaceçš„åªè¯»æƒé™ã€‚</div>2020-03-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/9a/0f/da7ed75a.jpg" width="30px"><span>èŠ’æœå°‘ä¾ </span> ğŸ‘ï¼ˆ4ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io&#47;v1
metadata:
  name: readonly-all-default
subjects:
- kind: ServiceAccount
  name: default
  namespace: system:systemaccounts
roleRef:
  kind: ClusterRole
  name: view
  apiGroup: rbac.authorization.k8s.io

è€å¸ˆï¼Œè¯·é—®è¿™æ ·å†™å¯¹å—ï¼Ÿ</div>2020-03-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1b/ac/bb/db0f9d8c.jpg" width="30px"><span>tale</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>æ€è€ƒé¢˜æ­£è§£åœ¨æ­¤ï¼š

kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io&#47;v1
metadata:
  name: readonly-all-default
subjects:
- kind: Group
  name: system:serviceaccounts
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: view
  apiGroup: rbac.authorization.k8s.io

å…³äºsubjectsä¸­kindçš„è§£é‡Šï¼š

1ã€kindä¸ºServiceAccountçš„è¯ï¼Œå®˜æ–¹æ–‡æ¡£æ˜ç¡®è¯´äº†å¿…é¡»æŒ‡å®šnamespaceçš„ï¼Œæ‰€ä»¥æ’é™¤è¿™ç§æ–¹å¼ã€‚
2ã€kindä¸ºUseræ—¶ï¼Œnameä¸­ä¸€å®šä¼šå¸¦æœ‰&lt;namespace&gt;ä¿¡æ¯ï¼Œä¸é¢˜ç›®è¦æ±‚â€œæ‰€æœ‰namespaceâ€ä¸ç¬¦ï¼Œæ‰€ä»¥ä¹Ÿæ’é™¤ã€‚
3ã€kindä¸ºGroupæ—¶ï¼Œnameä¸­å¡«system:serviceaccountså³å¯ã€‚å¾ˆå¤šäººæ‹…å¿ƒè¿™ä¸ªGroupè¿‡å¤§ï¼Œå¯èƒ½ä¸æ­¢åŒ…å«äº†æ‰€æœ‰defaultâ€œç”¨æˆ·â€ã€‚ä½†ç»æˆ‘æŸ¥æ˜ï¼Œè¿™ä¸ªGroupåªæœ‰Getæƒé™ï¼Œæ‰€ä»¥ç¬¦åˆViewè§„åˆ™ï¼Œå³ä½¿åŒ…å«äº†å…¶ä»–â€œç”¨æˆ·â€ä¹Ÿæ— å¦¨ã€‚</div>2021-12-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/aa/9a/92d2df36.jpg" width="30px"><span>tianfeiyu</span> ğŸ‘ï¼ˆ3ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>è€å¸ˆï¼Œæˆ‘å°±æƒ³é—®ä¸€ä¸‹ï¼Œnamespace ä¸‹çš„ default sa æ²¡æœ‰å…³è”ä»»ä½• roleï¼Œå®ƒåˆ°åº•æœ‰å“ªäº›æƒé™å‘¢ï¼Ÿ</div>2019-08-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/be/b9/f2481c2c.jpg" width="30px"><span>è¯—æ³½</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>â€œå®é™…ä¸Šï¼Œä¸€ä¸ª ServiceAccountï¼Œåœ¨ Kubernetes é‡Œå¯¹åº”çš„â€œç”¨æˆ·â€çš„åå­—æ˜¯ï¼šâ€
ServiceAccount æœ‰namespace ä½†æ˜¯ç”¨æˆ·æ²¡æœ‰ï¼Œé‚£serviceaccount ä¸ç”¨æˆ·çš„æ˜ å°„å…³ç³»æ˜¯æ€æ ·çš„å‘¢ï¼Œæ‰€æœ‰namespace çš„default ServiceAccount å¯¹åº”åŒä¸€ä¸ªuser å—ï¼Ÿå³system.serviceaccount.default ï¼Ÿ</div>2019-05-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/9c/67/c0128e6c.jpg" width="30px"><span>Dillion</span> ğŸ‘ï¼ˆ2ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>system:serviceaccount:&lt;ServiceAccount åå­— &gt;
è€å¸ˆï¼Œè¿™ä¸ªServiceAccountåå­—å‰é¢ï¼Œæ˜¯ä¸æ˜¯åº”è¯¥è¿˜æœ‰namespace</div>2018-10-22</li><br/><li><img src="" width="30px"><span>å­™ä¿Šä¼Ÿ</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>æˆ‘æµ‹è¯•æƒ…å†µæ˜¯ï¼Œé»˜è®¤default namespaceçš„default saè´¦å·è¿åªè¯»æƒé™éƒ½æ²¡æœ‰ã€‚åŠ äº†view åå¯ä»¥åªè¯»list getã€‚å¦å¤–å³ä½¿åŠ äº†cluster-adminï¼Œä¾æ—§æ— æ³•ä¿®æ”¹é›†ç¾¤æœåŠ¡yamlã€‚ã€‚ã€‚æ±‚è§£ï¼Ÿèƒ½å¦çªç ´è¯¥é™åˆ¶ï¼Ÿ</div>2022-09-21</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/20/c3/94/e89ebc50.jpg" width="30px"><span>ç¥æ¯“é€é¥</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>è¯¾ä»£è¡¨æ¥äº†ï¼Œæœ€è¿‘ä½¿ç”¨éƒ¨ç½²çš„ AWS ä¸Šçš„é¡¹ç›®ï¼Œç”±äºconfig ä¸­æ˜¯ aws ç‰¹è´¨çš„ CLI å‘½ä»¤ï¼Œéœ€è¦é‡æ–°ç”Ÿæˆä¸€ä¸ªè´¦å·ä¸å»å“ªå…ˆï¼Œæˆ‘è‡ªå·±ä½¿ç”¨çš„ LEN å·¥å…·ï¼Œå›¾å½¢åŒ–ç•Œé¢æ“ä½œï¼Œéå¸¸å¥½ç”¨ï¼›å¦å¤–è¿™å¼ å†…å®¹è›®é‡è¦çš„ï¼Œç»“åˆè‡ªå·±çš„ç»éªŒä¸»è¦åœ¨ï¼Œ1. å­¦ä¼šå¦‚ä½•åˆ›å»º è´¦å·ã€è§’è‰²ã€ç»‘å®šï¼Œæ–¹ä¾¿æˆæƒæƒé™ï¼Œ2åˆ™ç†è§£ 
system:serviceaccount:&lt;Namespaceåå­—&gt;:&lt;ServiceAccountåå­—&gt; è¿™ä¸ªç»“æ„çš„å«ä¹‰ï¼Œä¸€å®šè¦æ³¨æ„ï¼Œå› ä¸ºæ“ä½œä¸­æŠ¥é”™ï¼Œæå¤§çš„æ¦‚ç‡ä¼šé‡åˆ°è¿™ä¸ªé—®é¢˜ï¼Œç†è§£æ¦‚å¿µæ–¹ä¾¿æ’æŸ¥</div>2021-11-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/37/3b/495e2ce6.jpg" width="30px"><span>é™ˆæ–¯ä½³</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>ç¬¬äºŒåå…­è¯¾:åŸºäºè§’è‰²æƒé™çš„æ§åˆ¶ï¼šRBAC
K8sè´Ÿè´£å®Œæˆæˆæƒå·¥ä½œçš„æœºåˆ¶å°±æ˜¯RBACã€‚å…¶ä¸­æœ‰ä¸‰ä¸ªåŸºæœ¬æ¦‚å¿µï¼šRoleï¼ˆå®šä¹‰äº†ä¸€ç»„å¯¹K8s APIå¯¹è±¡çš„æ“ä½œæƒé™çš„è§„åˆ™ï¼‰ï¼ŒSubjectï¼ˆè¢«è§„åˆ™ä½œç”¨çš„ç”¨æˆ·ï¼Œå¯ä»¥æ˜¯äººuserï¼Œä¹Ÿå¯ä»¥æ˜¯æœºå™¨servicaccountï¼‰å’ŒRoleBindingï¼ˆå°†Roleå’ŒSubjectç»‘å®šèµ·æ¥ï¼‰ã€‚ä»¥ä¸Šæ¦‚å¿µæ˜¯é’ˆå¯¹namespaceçš„APIå¯¹è±¡ï¼Œæ¯”å¦‚Podç­‰ï¼Œå¯¹äºæ²¡æœ‰namespaceæ¦‚å¿µçš„,æ¯”å¦‚Nodeï¼ŒPVï¼Œç”¨çš„æ˜¯ClusterRoleå’ŒClusterRoleBinding</div>2021-10-15</li><br/><li><img src="" width="30px"><span>ch_ort</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>å®æµ‹é€šè¿‡ï¼Œæ‰€æœ‰é»˜è®¤default serviceaccountæœ‰äº†list podçš„æƒé™

#cat example-clusterrolebinding.yaml
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io&#47;v1
metadata:
  name: example-clusterrolebinding
subjects:
- kind: Group
  name: system:serviceaccounts
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: example-clusterrole
  apiGroup: rbac.authorization.k8s.io</div>2020-05-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/12/04/5837b21c.jpg" width="30px"><span>Brownç¾Šç¾Š</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>kind: RoleBinding
apiVersion: rbac.authorization.k8s.io&#47;v1
metadata:
  name: example-rolebinding
subjects:
- kind: Group
  name: system:serviceaccounts
roleRef:
  kind: ClusterRole
  name: view
  apiGroup: rbac.authorization.k8s.io</div>2019-01-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/d9/f9/f5d0dbc8.jpg" width="30px"><span>å•å‡¯ ğŸŒ´</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>æˆ‘æ˜¯ä½¿ç”¨çš„äºŒè¿›åˆ¶æ–¹å¼éƒ¨ç½²ï¼ŒClusterRoleä¸ºsystem:kube-schedulerç»‘å®šåˆ°system:kube-schedulerç”¨æˆ·ï¼Œè·Ÿkube-system namespaceæ— å…³</div>2018-10-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/38/f9/2b4755b5.jpg" width="30px"><span>çœ‹ä¸ç©¿</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ2ï¼‰<div>è€å¸ˆï¼Œé—®ä¸ªç½‘ç»œé—®é¢˜ï¼Œå¦‚æœé›†ç¾¤å¤–éƒ¨æƒ³è®¿é—®é›†ç¾¤é‡Œé¢çš„podæœåŠ¡ï¼Œå¯ä»¥ç”¨ingressæˆ–è€…NodePortå®ç°ï¼›é‚£è¯·é—®podæƒ³è®¿é—®é›†ç¾¤å¤–éƒ¨çš„æœåŠ¡åº”è¯¥æ€ä¹ˆåŠï¼Ÿ</div>2018-10-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/40/ba/2c8af305.jpg" width="30px"><span>Geek_zz</span> ğŸ‘ï¼ˆ1ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>rbac å’Œtokenæ˜¯æ€ä¹ˆè”ç³»çš„å‘¢</div>2018-10-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2d/d9/bf/897f4f93.jpg" width="30px"><span>æ‰“å°å°±ä¼šæ•²ä»£ç </span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ1ï¼‰<div>apiVersion: rbac.authorization.k8s.io&#47;v1
kind: RoleBinding
metadata:
  name: readonly-all-serviceaccount
subjects:
  - kind: Group
    name: system:serviceaccounts
    apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  apiGroup: rbac.authorization.k8s.io
  name: view
</div>2023-11-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/28/1b/f9/018197f1.jpg" width="30px"><span>å°æ±Ÿçˆ±å­¦æœ¯</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>æ€è€ƒé¢˜å°±æ²¡äººæƒ³è¿‡ä¿®æ”¹default secretså—ğŸ¤”</div>2023-03-07</li><br/><li><img src="" width="30px"><span>click</span> ğŸ‘ï¼ˆ0ï¼‰ ğŸ’¬ï¼ˆ0ï¼‰<div>https:&#47;&#47;stackoverflow.com&#47;questions&#47;52995962&#47;kubernetes-namespace-default-service-account
&gt; By default, the default service account in a namespace has no permissions other than those of an unauthenticated user. </div>2023-02-07</li><br/>
</ul>